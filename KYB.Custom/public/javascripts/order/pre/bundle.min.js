(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/24.
 */
"use strict";

(function ($) {
  /**
   * 生成分页器
   * @param ele 需要添加分页器的元素
   * @param offset 偏移量，即从第data-offset开始
   * @param length 总记录条数
   * @param showPages 分页器显示的页数，超过则隐藏多余的页
   * @param rows 每页显示的记录条数
   */
  $.burster = function (ele, offset, length, showPages, rows) {
    offset = offset ? parseInt(offset) : 0;
    //将分页器装入table中
    if (length && length > offset) {
      var pageHtml = ""
        , ass = ""//清空需要装入的html
        , beforePages = Math.ceil(offset / rows)//需要显示的前页数/当前页
        , afterPages = Math.ceil((length - offset ) / rows)//需要显示的后页数
        , pages = Math.ceil(length / rows) //总页数
        , k = 0;
      //alert("总页数" + pages + " 前页数 " + beforePages + " 后页数 " + afterPages);
      //若页数小于showPages页，则全部显示
      if (pages >= 0 && pages <= showPages) {
        for (k = 0; k < pages; k++) {
          if (k == beforePages) {
            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
          } else {
            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
          }
        }
      } else if (pages > showPages) {//总页数大于showPages页
        if (beforePages <= Math.ceil(showPages / 2) && afterPages > showPages + 1) {
          for (k = 0; k < showPages; k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages <= Math.ceil(showPages / 2) && afterPages == showPages + 1) {
          for (k = 0; k < showPages - 1; k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages <= Math.ceil(showPages / 2) && afterPages <= showPages) {
          for (k = 0; k < showPages - 1; k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > Math.ceil(showPages / 2) && beforePages <= showPages && afterPages > showPages) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > showPages && afterPages > showPages) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > Math.ceil(showPages / 2) && beforePages <= pages && afterPages <= showPages && afterPages > Math.ceil(showPages / 2) + 1) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > pages && afterPages <= showPages && afterPages > Math.ceil(showPages / 2) + 1) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > Math.ceil(showPages / 2) && afterPages <= Math.ceil(showPages / 2) + 1) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < pages; k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
        }
      }
      //判断"首页"和"末页"是否可点击
      var firstPage, lastPage;
      if (offset == 0) {//此时首页无法点击
        firstPage = '<li class="disabled"><a class="pages" data-offset="0">首页</a></li>';
        lastPage = '<li><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '" >末页</a></li>';
      } else if ((offset + rows) >= length) {//此时末页无法点击
        firstPage = '<li><a class="pages" data-offset="0">首页</a></li>';
        lastPage = '<li class="disabled"><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '">末页</a></li>';
      } else {
        firstPage = '<li><a class="pages" data-offset="0">首页</a></li>';
        lastPage = '<li><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '">末页</a></li>';
      }
      //判断"上一页"和"下一页"是否存在
      var upPage, downPage;
      if (offset == 0 || (offset < rows && (offset % rows != 0))) {
        upPage = "<li class='disabled'><a class='pages' func='previous' data-offset='" + parseInt(offset) + "' >上页</a></li>"
      } else {
        upPage = "<li><a class='pages' func='previous' data-offset='" + (parseInt(offset) - parseInt(rows)) + "' >上页</a></li>";
      }
      if (offset >= (length - rows)) {
        downPage = "<li class='disabled'><a class='pages' func='next' data-offset='" + parseInt(offset) + "'>下页</a></li>"
      } else {
        downPage = "<li><a class='pages' func='next' data-offset='" + parseInt(parseInt(offset) + parseInt(rows)) + "'>下页</a></li>"
      }
      if (pages != 1) {
        //分页部分
        ass += "<div id='pager' class='pager-info'>" +
        "<h6 id='result' class='pager-record'>共有<span>" + length + "</span>条记录</h6>" +
        "<ul class='pagination'>" + firstPage + upPage + pageHtml + downPage + lastPage + "</ul></div>";
        //table中注入拼装的记录
        ele.html(ass);
      } else {
        ele.html('');
      }
    }
  }
}(jQuery));
},{}],2:[function(require,module,exports){
/**
 * Created by zrz on 2016/2/26.
 * @version 1.0.0 created 通用性功能方法
 */

'use strict';

var Fun = (function () {
    var _timeOut = 100000;//请求超时时间为10s
    /**
     * 封装ajax
     * @param option
     * {
     *      url:"请求的地址"
     *      ,method:"请求的方法"
     *      ,async:"是否并发"
     *      ,data:"发送的数据"
     *      ,success:"成功时回调"
     *      ,error:"失败/超时时回调"
     *      ,timeout:"超时时间"
     *      ,complete:"完成后的回调"
     * }
     */
    var ajax = function (option) {
        //ajax开始时应显示“加载信息框”
        Modal.showLoading();
        $.ajax({
            url: option.url
            , type: "type" in option && option.type || "GET"
            , timeout: option.timeout || _timeOut
            , data: "data" in option && option.data || {}
            , dataType: "json"
            , async: ("async" in option && option.async) ? true : false
            , success: function (json) {
                if ("status" in json && json.status > 0 && "data" in json) {
                    if ("success" in option) {
                        option.success(json.data);
                    } else {
                        Modal.setAlert("无success方法!");
                    }
                } else if ("error" in option && option.error instanceof Function) {
                    option.error(json);
                } else {
                    Modal.setAlert('操作失败!');
                }
            }, error: function (xhr) {//404或者超时
                if ("error" in option && option.error instanceof Function) {
                    //提示用户错误信息
                    Modal.showLoading(false);
                    Modal.setAlert("连接服务器失败，状态：" + (xhr.status || -1) + ",信息：" + (xhr.statusText || "-"));
                    option.error(xhr.status, xhr.statusText);//回调请求的状态和错误信息
                }
            }, complete: function (xhr, type) {
                //关闭“加载信息框”
                Modal.showLoading(false);
                if ("complete" in option && option.complete instanceof Function) {
                    option.complete(xhr, type);//回调请求的xhr信息和类型
                }
            }
        });
    };
    //全选和单选的绑定
    var setCheckboxListener = function (allCheck, radioChecks) {
        //筛选单选按钮组
        var radioValueEles = $(radioChecks);
        //点击全选时，同组按钮被同步
        $(document).delegate(allCheck, "click", function () {
            if (radioValueEles && radioValueEles.length > 0) {
                for (var _r = 0; _r < radioValueEles.length; _r++) {
                    radioValueEles[_r].checked = $(this).is(":checked");
                }
            }
        });
        //点击单选按钮时，
        $(document).delegate(radioChecks, "click", function () {
            $(allCheck)[0].checked = $(radioChecks + ":checked").length == $(radioChecks).length;
        });
    };
    var url = (function () {
        var get = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURI(r[2]);
            return null;
        };
        /**
         * 根据参数列表长度进行判断，兼容IE9
         * @returns {string}
         */
        var set = function () {
            if (arguments.length === 1 && typeof arguments[0] === 'object') {//一个对象，使用key标记value
                var obj = arguments[0]
                    , search = location.search;
                for (var o in obj) {
                    if (obj.hasOwnProperty(o)) {
                        search = changeURLKeyValue(search, o, obj[o]);
                    }
                }
                if ('pushState' in history) {
                    history.pushState(null, document.title, search);
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, search);//返回重新构造后search串
                }
            } else if (arguments.length === 2) {//key+value
                var key = arguments[0]
                    , value = arguments[1];
                if ('pushState' in history) {
                    history.pushState(null, document.title, changeURLKeyValue(location.toString(), key, value));
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, changeURLKeyValue(location.search, key, value));//返回重新构造后search串
                }
            }
            function changeURLKeyValue(url, arg, arg_val) {
                var pattern = arg + '=([^&]*)';
                var replaceText = arg + '=' + arg_val;
                if (url.match(pattern)) {
                    var tmp = '/(' + arg + '=)([^&]*)/gi';
                    tmp = url.replace(eval(tmp), replaceText);
                    return tmp;
                } else {
                    if (url.match('[\?]')) {
                        return url + '&' + replaceText;
                    } else {
                        return url + '?' + replaceText;
                    }
                }
            }
        };
        return {
            get: get
            , set: set
        }
    }());
    var formatImage=function (path, size, ele) {
        if(path instanceof  Array && path.length>0){
            path = path[0];
        }
        var IMAGE_SIZE = {
            original: {
                path: "",
                size: ""
            },
            xlarge: {
                path: "_xlarge",
                size: "660*660"
            },
            large: {
                path: "_large",
                size: "420*420"
            },
            middle: {
                path: "_middle",
                size: "300*300"
            },
            small: {
                path: "_small",
                size: "240*240"
            },
            little: {
                path: "_little",
                size: "120*120"
            },
            micro: {
                path: "_micro",
                size: "60*60"
            }
        };
        size = IMAGE_SIZE[size || "middle"] || IMAGE_SIZE.middle;
        var pathTemp = /\.\w+?$/.exec(path);
        if (!pathTemp) {
            path += size.path;
        } else {
            path = (path.substr(0, pathTemp.index || path.length)) + size.path + pathTemp[0];
        }
        if (ele && ele.attr) {
            ele.attr("src", path);
        }
        return path;
    };
    return {
        ajax: ajax
        , getTimtout: _timeOut
        , setCheckboxListener: setCheckboxListener
        , url: url
        , formatImage: formatImage
    }
}());

exports.ajax = Fun.ajax;
exports.getTimeout = Fun.getTimtout;
exports.setCheckboxListener = Fun.setCheckboxListener;
exports.url = Fun.url;
exports.formatImage = Fun.formatImage;

},{}],3:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/23.
 */
'use strict';
var general = (function () {
  var run = function () {
    //时间格式化
    Date.prototype.Format = function (fmt) { //author: Jeremyyy
      var o = {
        "M+": this.getMonth() + 1, //月份
        "d+": this.getDate(), //日
        "h+": this.getHours(), //小时
        "m+": this.getMinutes(), //分
        "s+": this.getSeconds(), //秒
        "q+": Math.floor((this.getMonth() + 3) / 3), //季度
        "S": this.getMilliseconds() //毫秒
      };
      if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      for (var k in o)
        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
      return fmt;
    };
  };
  return {
    run: run
  }
}());
module.exports.general = general;
},{}],4:[function(require,module,exports){
/**
 * Created by zrz on 2016/2/24.
 * @version 1.0.0 created
 */

'use strict';

//构造信息框主体
var Modal = (function () {
    //构造原始类
    function M(m) {
        this.s = m.s;//是否显示
        this.id = m.id;
    }

    //构造标准show方法，用于继承
    M.prototype.show = function () {
        var ele = document.getElementById(this.id);
        if (ele) {
            if (this.s && !isShow()) {//显示当前隐藏
                ele.className = ele.className.replace("dp-n", "");
            } else if (!this.s && isShow()) {//隐藏当前显示
                ele.className += " dp-n";
            }
            //去除两边的空格
            ele.className = String(ele.className).trim();
        }
        function isShow() {//是否已显示，无class时显示
            return ele.className.split("dp-n").length == 1;
        }
    };

    //加载信息框
    var loading = (function () {
        //初始化生成加载信息框
        var init = function () {
            if (!document.getElementById("loading_modal_element")) {
                $('body').append('<div id="loading_modal_element" class="loading-modal-body dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="loading-modal-image"></div>' +
                    '<div class="loading-modal-text">' +
                    '<h2>玩命加载中……</h2>' +
                    '</div></div>');
            }
            return false;
        };
        //显示、隐藏信息框
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;//无参数显示信息框
            var m = new M({id: "loading_modal_element", s: s});
            m.show();
        };
        return {
            init: init
            , show: show
        }
    }());
    //弹出信息框
    var alert = (function () {
        var init = function () {
            if (!document.getElementById("alert_modal_element")) {
                $('body').append('<div id="alert_modal_element" class="alert-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="alert-modal-content">' +
                    '<div class="alert-modal-body"><span class="alert-modal-text"></span></div>' +
                    '<div class="alert-modal-footer"><button id="alert_modal_close" class="alert-modal-button">关闭</button></div>' +
                    '</div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "alert_modal_element", s: s});
            m.show();
        };
        /**
         * 设置弹出信息框
         * @param msg       显示的信息，支持html
         * @param sed       倒计时关闭时间，单位：second
         * @param callback  关闭触发回调函数
         */
        var set = function (msg, sed, callback) {
            var ele = document.getElementById("alert_modal_element");
            if (msg) {
                if (typeof msg === 'object') {//应对后端返回提示时使用Object封装
                    msg = JSON.stringify(msg);
                }
                if(ele){
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }else{
                    init();
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }
                show();
            }
            if (sed > 0) {
                setTimeout(function () {
                    show(false);
                }, 1000 * sed);
            }//无关闭时间或者关闭时间为0，不自动关闭
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#alert_modal_close").on("click", function () {
                if (callback && callback instanceof Function) {
                    callback();
                }
                show(false);
                //阻止事件继续传递
                return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //选择信息框
    var confirm = (function () {
        var init = function () {
            if (!document.getElementById("confirm_modal_element")) {
                $('body').append('<div id="confirm_modal_element" class="confirm-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="confirm-modal-content">' +
                    '<div id="confirm_modal_header" class="confirm-modal-header dp-n"></div>' +
                    '<div class="confirm-modal-body"><span id="confirm_modal_text" class="confirm-modal-text"></span></div>' +
                    '<div class="confirm-modal-footer">' +
                    '<div class="footer-button-success"><button class="confirm-modal-button  modal-success" data-confirm="success">确认</button></div>' +
                    '<div class="footer-button-false"><button class="confirm-modal-button" data-confirm="error">取消</button></div>' +
                    '</div></div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "confirm_modal_element", s: s});
            m.show();
        };
        /**
         * 设置选择信息框的内容
         * @param option    配置
         * {
         *      title:"头部显示的信息"
         *      ,text:"显示的提示信息"
         *      ,success:"点击成功后的回调"
         *      ,error:"点击失败后的回调"
         *      ,complete:"点击按钮后的整体回调"
         * }
         */
        var bar = 0;
        var set = function (option) {
            if (!option) {
                return false;
            }
            if ("title" in option && option.title.length > 0) {//有头部，则显示头部
                document.getElementById("confirm_modal_header").innerHTML = option.title;
            }
            if ("text" in option && option.text.length > 0) {//有内容，则显示整个选择信息框
                document.getElementById("confirm_modal_text").innerHTML = option.text;
            }
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#confirm_modal_element").find(".confirm-modal-button").off("click").on("click", function () {
                //fixme .off("click")用于防止多次触发<--很玄学，我也不知道为什么，但是请不要修改。
                var atr = $(this).attr("data-confirm");//选择的按钮
                bar++;
                if (option && atr in option && option[atr] instanceof Function) {
                    option[atr]();
                }
                if (option && "complete" in option && option.complete instanceof Function) {
                    option.complete();//若有完成函数，则执行
                } else {//否则，关闭选择框
                    show(false);
                }
                //阻止事件继续传递
                //return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //覆盖层
    var cover = (function () {
        var init = function () {
            if (!document.getElementById("cover_modal_element")) {
                $('body').append('<div id="cover_modal_element" class="cover-modal-element dp-n"></div>');
            }
            return false;
        };
        var hide = function () {
            document.getElementById("cover_modal_element").style.display = "none";
        };
        var show = function () {
            document.getElementById("cover_modal_element").style.display = "block";
        };
        return {
            init: init
            , show: show
            , hide: hide
        }
    }());
    return {
        initLoading: loading.init
        , showLoading: loading.show

        , initAlert: alert.init
        , showAlert: alert.show
        , setAlert: alert.set

        , initConfirm: confirm.init
        , setConfirm: confirm.set
        , showConfirm: confirm.show
        , initCover: cover.init
    }
}());

//页面加载完毕后生成四个自定义模态框
setTimeout(function () {
    //页面加载时生成一个覆盖层
    Modal.initCover();
    //页面加载时生成一个加载信息框
    Modal.initLoading();
    //页面加载时生成一个弹出信息框
    Modal.initAlert();
    //页面加载时生成一个选择信息框
    Modal.initConfirm();
}, 100);


//抛出上层调用
exports.showLoading = Modal.showLoading;
exports.setAlert = Modal.setAlert;
exports.showAlert = Modal.showAlert;
exports.setConfirm = Modal.setConfirm;
exports.showConfirm = Modal.showConfirm;
},{}],5:[function(require,module,exports){
/**
 * Created by Auser on 2016/12/6.
 */
"use strict";
var Data = (function () {
    var list = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/preList'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var changeState = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/changeState'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var down = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/other/ossDown'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var up = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/other/ossUp'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var ossUpload = function (param, data, callback) {
        var _data = {};
        var formdata = new FormData();
        formdata.append("OSSAccessKeyId", param.AccessKeyId);
        formdata.append("policy", param.Policy);
        formdata.append("Signature", param.Signature);
        formdata.append("key", param.Keyname);
        formdata.append("Content-Disposition", "attachment;filename=\"" + data.name + "\"");
        formdata.append("file", data);
        $.ajax({
            url: param.UploadURL
            , data: formdata
            , processData: false
            , cache: false
            , async: false
            , contentType: false
            , type: 'post'
            , timeout: 100000
            , success: function () {
                _data = {
                    status: 1
                }
            }, error: function () {
                _data = {
                    status: -1
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var orderFile = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/orderFile/list'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var addFile = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/orderFile/add'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var removeFile = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/orderFile/remove'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    return {
        list: list
        , changeState: changeState
        , down: down
        , up: up
        , ossUpload: ossUpload
        , orderFile: orderFile
        , addFile: addFile
        , removeFile: removeFile
    }
}());
module.exports.Data = Data;
},{}],6:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/2/6.
 */
'use strict';
var Dom = (function () {
    var list = function (json, param) {
        var str = '';
        str += '<thead> <tr> <td>订单号/主单号</td> <td colspan="2">客户信息</td> <td colspan="4">航线信息</td> <td colspan="4">货物信息</td> <td>操作员</td> <td>文件</td> <td>操作</td> </tr> </thead>';
        if (json && json.resCode == 0 && 'resBody' in json && json.resBody && 'sList' in json.resBody && json.resBody.sList instanceof Array) {
            if (json.resBody.sList.length > 0) {
                var arr = json.resBody.sList;
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        str += render(arr[a]);
                    }
                }
                $.burster($(".outer-page"), param.offset || 0, json.resBody.totalCount || 0, 5, param.limit || 20);
                $('.list-cout').html('共为您找到 ' + json.resBody.totalCount + ' 条结果');
            } else {
                str += '<tobdy><tr class="wrong"><td colspan="14">暂无订单信息，请添加！</td></tr></tobdy>';
                $('.outer-page').html('');
                $('.list-cout').html('共为您找到 0 条结果');
            }
        } else {
            str += '<tr class="wrong"><td colspan="14">请求失败，<a href="">请重试！</a></td></tr>';
            $('.outer-page').html('');
            $('.list-cout').html('共为您找到 0 条结果');
        }
        function render(d) {
            var c = d.company || {}
                , o = d.order || {}
                , a = d.agent
                , type;
            switch (o.orderChannel) {
                case 1:
                    type = '自助订舱';
                    break;
                case 2:
                    type = '快速订舱';
                    break;
                case 3:
                    type = '后台下单';
                    break;
                default:
                    type = '自助订舱';
                    break;
            }
            var czy = '';
            if (a) {
                if (a.name) {
                    czy += '姓名：' + a.name;
                }
                if (a.mobile) {
                    czy += (czy ? '<br/>' : '') + '电话：' + a.mobile;
                }
                if (a.QQ) {
                    czy += (czy ? '<br/>' : '') + 'QQ：' + a.QQ;
                }
            } else {
                czy = '/';
            }
            return '<tbody><tr><td class="short-td" colspan="14"></td></tr></tbody><tbody class="data-tbd"> <tr> <td>' + (o.orderNum || '/') + '</td>' +
                ' <td class="font-g">客户公司</td> ' +
                '<td class="font-g">海关注册编码</td> <td class="font-g">起始港</td>' +
                ' <td class="font-g">目的港</td> <td class="font-g">航空公司</td> ' +
                '<td class="font-g">起飞时间</td> <td class="font-g">数量（PCS）</td> <td class="font-g">重量（KGS）</td>' +
                ' <td class="font-g">体积（CBM）</td> <td class="font-g">品名</td>' +
                '<td rowspan="2">' + czy + '</td> <td rowspan="2"><a class="d-files" href="javascript:void(0);" data-id="' + o.orderId + '" data-subid="' + o.subNum + '">下载报关资料</a> <br> <a class="u-files" href="javascript:void(0);" data-id="' + o.orderId + '" data-subid="' + o.subNum + '">上传文件</a></td> <td rowspan="2" class="font-q"><a data-subnum="' + o.subNum + '" data-id="' + o.orderId + '" class="show-bg" href="javascript:void(0);">预审通过</a></td></tr> ' +
                '<tr><td>' + (o.airwayBillNum || '/') + (o.subNum ? '<br/>_' + o.subNum : '') + '</td><td>' + (c.companyName || '/') + '</td> <td>' + (c.registerCode || '/') + '</td> <td>' + (o.deptCode || '/') + '</td>' +
                ' <td>' + (o.destCode || '/') + '</td> <td>' + (o.airCompanyCode || '/') + '</td> ' +
                '<td>' + new Date(o.flightDate).Format('yyyy-MM-dd') + '</td> <td>' + (o['cargo'].cargoCount || '/') + '</td> ' +
                '<td>' + (o['cargo'].cargoWeight || '/') + '</td> <td>' + (o['cargo'].cargoSize || '/') + '</td>' +
                ' <td>' + (o['cargo'].cargoName || '/') + '</td> </tr> </tbody>'

        }

        $('.outer-tb').html(str);
    };
    return {
        list: list
    }
}());
module.exports.Dom = Dom;
},{}],7:[function(require,module,exports){
/**
 * Created by Auser on 2017/3/28.
 */

var general = require('../../general/general').general;
general.run();
var Listener = require('./listener').Listener;
Listener.run();
},{"../../general/general":3,"./listener":8}],8:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/5.
 */
'use strict';
require('../../general/burster');
var url = require('../../general/function').url
    , Modal = require('../../general/modal');
var Data = require('./data').Data
    , Dom = require('./dom').Dom;
var List = {}
    , operateId, subNumber;
var Listener = (function () {
    var listener = function () {
        $(document).on('click', '.close-btn', function () {
            $('.white-back').addClass('dp-n');
            $('.alert-part').addClass('dp-n');
        });
        $(document).on('click', '.outer-page .pages', function () {
            url.set('offset', $(this).data('offset'));
            init();
        });
        $(document).on('click', '#search', function () {
            url.set('offset', 0);
            init();
        });
        $(document).on('click', '.show-bg', function () {
            operateId = $(this).data('id');
            subNumber = $(this).data('subnum');
            var d = List[operateId];
            var ele = $('.bg-part');
            var jczt = '', dczt = '';
            switch (d.order.bookingState) {
                case 0:
                    dczt = '未订舱';
                    break;
                case 1:
                    dczt = '已订舱';
                    break;
                case -1:
                    dczt = '订舱失败';
                    break;
                case 2:
                    dczt = '已改配';
                    break;
            }
            switch (d.order.entryState) {
                case 0:
                    jczt = '待进仓';
                    break;
                case 1:
                    jczt = '已进仓';
                    break;
                case 2:
                    jczt = '已确认';
                    break;
            }
            ele.find('.ddh').html(d.order.orderNum);
            ele.find('.fdh').html(d.order.subNum);
            ele.find('.qsg').html(d.order.deptCode);
            ele.find('.mdg').html(d.order.destCode);
            ele.find('.hkgs').html(d.order.airCompanyCode);
            ele.find('.qfrq').html(new Date(d.order.flightDate).Format('yyyy-MM-dd'));
            ele.find('.jczt').html(jczt);
            ele.find('.dczt').html(dczt);
            $('.white-back').removeClass('dp-n');
            ele.removeClass('dp-n');
        });
        $(document).on('click', '#bg-ensure', function () {
            var data = {
                "orderId":operateId,
                "subNum": subNumber,
                "agentId": 0,
                "state": $('#c-bgzt').find('option:selected').val()
            };
            Data.changeState(data, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    Modal.setAlert(json.resMsg || '更新成功！', null, function () {
                        location.reload();
                    });
                } else {
                    Modal.setAlert(json.resMsg || '更新失败，请重试！');
                }
            });
        });
    };
    var fileList = function () {
        //待删除的元素
        var removeEle;
        //缓存删除内容
        var removeFile = {
            "orderId": '',
            "keyName": 0
        };
        $(document).on('click', '.close-this', function () {
            $(this).parents('.alert-part').addClass('dp-n');
        });
        $(document).on('click', 'a.rm-type', function () {
            removeFile['orderId'] = operateId;
            removeFile['keyName'] = $(this).data('key');
            removeEle = $(this).parents('.add-type');
            $('.white-back').removeClass('dp-n');
            $('.remove-type-part').removeClass('dp-n');
        });
        $(document).on('click', 'a.dl', function () {
            var file = $(this).data('key');
            Data.down({file: file}, function (json) {
                if (json && 'resBody' in json) {
                    window.open(json.resBody);
                }
            });
        });
        $(document).on('click', '.d-files', function () {
            Data.orderFile({id: $(this).data('id'),subId :$(this).data('subid') }, function (json) {
                if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                    var str = '';
                    var arr = json.resBody;
                    for (var a in arr) {
                        if (arr.hasOwnProperty(a)) {
                            var d = arr[a];
                            if (d.fileType != 21 && d.fileType != 22) {
                                var name = '';
                                switch (d.fileType) {
                                    case 11:
                                        name = '报关单';
                                        break;
                                    case 12:
                                        name = '申报要素';
                                        break;
                                    case 13:
                                        name = '报关发票';
                                        break;
                                    case 14:
                                        name = '装箱单';
                                        break;
                                    case 15:
                                        name = '报关委托书';
                                        break;
                                }
                                str += '<div class="up-part"><p class="main-name">' + name + '</p><div class="top">' + d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> ' +
                                    '</div> <a href="javascript:void(0);" class="dp-b">' + d.fileName + '</a> ' +
                                    '</div>';
                            }
                        }
                    }
                    $('.bh-part .file-body .dp-tb').html(str);
                    $('.white-back').removeClass('dp-n');
                    $('.bh-part').removeClass('dp-n');
                }
            });
        });
        $(document).on('click', '.u-files', function () {
            var str = ' <div class="add-type" data-type="21"> <div class="top"> + </div> <a href="javascript:void(0);" class="dp-b f-name" data-name="预录单">预录单</a> <input type="file" class="up-type" data-type="21"/> </div> <div class="add-type" data-type="22"> <div class="top"> + </div> <a href="javascript:void(0);" class="dp-b f-name" data-name="查验费用清单">查验费用清单</a> <input type="file" class="up-type" data-type="22"/> </div>';
            $('.upFile-part .file-body').find('.dp-tb').html(str);
            operateId = $(this).data('id');
            subNumber =$(this).data('subid');
            Data.orderFile({id: $(this).data('id'),subId :$(this).data('subid')}, function (json) {
                if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                    var str = '';
                    var arr = json.resBody;
                    for (var a in arr) {
                        if (arr.hasOwnProperty(a)) {
                            var d = arr[a];
                            if (d.fileType == 21 || d.fileType == 22) {
                                var ele = $('.add-type[data-type=' + d.fileType + ']');
                                ele.addClass('active');
                                ele.find('input').hide();
                                ele.find('.top').html(d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> <a href="javascript:void(0);" class="rm-type" data-key="' + d.keyName + '"></a> ');
                                ele.find('.f-name').html(d.fileName);
                            }
                        }
                    }
                    $('.white-back').removeClass('dp-n');
                    $('.upFile-part').removeClass('dp-n');
                }
            });
        });
        $(document).on('change', '.up-type', function () {
            var arr = ['doc', 'docx', 'xls', 'xlsx', 'pdf', 'jpg', 'png', 'bmp'];
            var _this = $(this);
            var file = this.files[0]
                , size = this.files[0].size
                , name = this.files[0].name;
            var na = name.split('.');
            if (arr.indexOf(na[na.length - 1]) >= 0) {
                if (size < 2097152) {
                    Data.up({"file": name}, function (json) {
                        var token;
                        if (json && 'resCode' in json && json.resCode == 0) {
                            token = json.resBody;
                        }
                        if (token) {
                            Data.ossUpload(token, file, function (data) {
                                if (data && 'status' in data && data.status > 0) {
                                    var d = {
                                        "orderId": operateId,
                                        "subNum": subNumber,
                                        "fileName": name,
                                        "fileComment": '',
                                        "keyName": token.Keyname
                                        , "fileType": _this.data('type')
                                    };
                                    Data.addFile(d, function (json) {
                                        if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                                            var d = json.resBody;
                                            var ele = _this.parents('.add-type');
                                            var str = d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> <a href="javascript:void(0);" class="rm-type" data-key="' + d.keyName + '"></a>'
                                            ele.addClass('active');
                                            ele.find('.top').html(str);
                                            ele.find('.f-name').html(d.fileName);
                                            ele.find('input').hide();
                                        } else {
                                            Modal.setAlert('上传失败！');
                                        }
                                    });
                                }
                            });
                        }
                    });
                } else {
                    Modal.setAlert('您上传的文件超过2M！请重新选择。');
                }
            } else {
                Modal.setAlert('文件格式支持.doc/.docx/.xls/.xlsx/.pdf/.jpg/.png/.bmp');
            }
        });
        $(document).on('click', '#remove-type-ensure', function () {
            Data.removeFile(removeFile, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    removeEle.removeClass('active');
                    removeEle.find('.top').html('+');
                    var a = removeEle.find('.f-name');
                    a.html(a.data('name'));
                    removeEle.find('input').show();
                    $('.remove-type-part').addClass('dp-n');
                } else {
                    Modal.setAlert('删除失败，请重试！');
                }
            });
        });
    };
    var init = function () {
        var data = {
            offset: url.get('offset') || 0
            , limit: url.get('limit') || 20
            , agentCompanyId: 0
            , number: $('#order-num').val()
        };
        Data.list(data, function (json) {
            Dom.list(json, data);
            var dt = {};
            if (json && 'resCode' in json && json.resCode == 0 && json.resBody && json.resBody.sList.length > 0) {
                var list = json.resBody.sList;
                for (var l in list) {
                    if (list.hasOwnProperty(l)) {
                        var d = list[l];
                        dt[d.order.orderId] = d;
                    }
                }
            }
            List = dt;
        });
    };
    var run = function () {
        listener();
        init();
        fileList();
    };
    return {
        run: run
    }
}());
module.exports.Listener = Listener;
},{"../../general/burster":1,"../../general/function":2,"../../general/modal":4,"./data":5,"./dom":6}]},{},[7])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L1VzZXJzL0FkbWluaXN0cmF0b3IvQXBwRGF0YS9Sb2FtaW5nL25wbS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiLi4vLi4vZ2VuZXJhbC9idXJzdGVyLmpzIiwiLi4vLi4vZ2VuZXJhbC9mdW5jdGlvbi5qcyIsIi4uLy4uL2dlbmVyYWwvZ2VuZXJhbC5qcyIsIi4uLy4uL2dlbmVyYWwvbW9kYWwuanMiLCJkYXRhLmpzIiwiZG9tLmpzIiwiaW5kZXguanMiLCJsaXN0ZW5lci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSmVyZW15IG9uIDIwMTYvMTEvMjQuXHJcbiAqL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbiAoJCkge1xyXG4gIC8qKlxyXG4gICAqIOeUn+aIkOWIhumhteWZqFxyXG4gICAqIEBwYXJhbSBlbGUg6ZyA6KaB5re75Yqg5YiG6aG15Zmo55qE5YWD57SgXHJcbiAgICogQHBhcmFtIG9mZnNldCDlgY/np7vph4/vvIzljbPku47nrKxkYXRhLW9mZnNldOW8gOWni1xyXG4gICAqIEBwYXJhbSBsZW5ndGgg5oC76K6w5b2V5p2h5pWwXHJcbiAgICogQHBhcmFtIHNob3dQYWdlcyDliIbpobXlmajmmL7npLrnmoTpobXmlbDvvIzotoXov4fliJnpmpDol4/lpJrkvZnnmoTpobVcclxuICAgKiBAcGFyYW0gcm93cyDmr4/pobXmmL7npLrnmoTorrDlvZXmnaHmlbBcclxuICAgKi9cclxuICAkLmJ1cnN0ZXIgPSBmdW5jdGlvbiAoZWxlLCBvZmZzZXQsIGxlbmd0aCwgc2hvd1BhZ2VzLCByb3dzKSB7XHJcbiAgICBvZmZzZXQgPSBvZmZzZXQgPyBwYXJzZUludChvZmZzZXQpIDogMDtcclxuICAgIC8v5bCG5YiG6aG15Zmo6KOF5YWldGFibGXkuK1cclxuICAgIGlmIChsZW5ndGggJiYgbGVuZ3RoID4gb2Zmc2V0KSB7XHJcbiAgICAgIHZhciBwYWdlSHRtbCA9IFwiXCJcclxuICAgICAgICAsIGFzcyA9IFwiXCIvL+a4heepuumcgOimgeijheWFpeeahGh0bWxcclxuICAgICAgICAsIGJlZm9yZVBhZ2VzID0gTWF0aC5jZWlsKG9mZnNldCAvIHJvd3MpLy/pnIDopoHmmL7npLrnmoTliY3pobXmlbAv5b2T5YmN6aG1XHJcbiAgICAgICAgLCBhZnRlclBhZ2VzID0gTWF0aC5jZWlsKChsZW5ndGggLSBvZmZzZXQgKSAvIHJvd3MpLy/pnIDopoHmmL7npLrnmoTlkI7pobXmlbBcclxuICAgICAgICAsIHBhZ2VzID0gTWF0aC5jZWlsKGxlbmd0aCAvIHJvd3MpIC8v5oC76aG15pWwXHJcbiAgICAgICAgLCBrID0gMDtcclxuICAgICAgLy9hbGVydChcIuaAu+mhteaVsFwiICsgcGFnZXMgKyBcIiDliY3pobXmlbAgXCIgKyBiZWZvcmVQYWdlcyArIFwiIOWQjumhteaVsCBcIiArIGFmdGVyUGFnZXMpO1xyXG4gICAgICAvL+iLpemhteaVsOWwj+S6jnNob3dQYWdlc+mhte+8jOWImeWFqOmDqOaYvuekulxyXG4gICAgICBpZiAocGFnZXMgPj0gMCAmJiBwYWdlcyA8PSBzaG93UGFnZXMpIHtcclxuICAgICAgICBmb3IgKGsgPSAwOyBrIDwgcGFnZXM7IGsrKykge1xyXG4gICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAocGFnZXMgPiBzaG93UGFnZXMpIHsvL+aAu+mhteaVsOWkp+S6jnNob3dQYWdlc+mhtVxyXG4gICAgICAgIGlmIChiZWZvcmVQYWdlcyA8PSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgJiYgYWZ0ZXJQYWdlcyA+IHNob3dQYWdlcyArIDEpIHtcclxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBzaG93UGFnZXM7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPD0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICYmIGFmdGVyUGFnZXMgPT0gc2hvd1BhZ2VzICsgMSkge1xyXG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IHNob3dQYWdlcyAtIDE7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPD0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICYmIGFmdGVyUGFnZXMgPD0gc2hvd1BhZ2VzKSB7XHJcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgc2hvd1BhZ2VzIC0gMTsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBiZWZvcmVQYWdlcyA8PSBzaG93UGFnZXMgJiYgYWZ0ZXJQYWdlcyA+IHNob3dQYWdlcykge1xyXG4gICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nMCc+MS4uLjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgYmVmb3JlUGFnZXMgKyBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMik7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPiBzaG93UGFnZXMgJiYgYWZ0ZXJQYWdlcyA+IHNob3dQYWdlcykge1xyXG4gICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nMCc+MS4uLjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgYmVmb3JlUGFnZXMgKyBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMik7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPiBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgJiYgYmVmb3JlUGFnZXMgPD0gcGFnZXMgJiYgYWZ0ZXJQYWdlcyA8PSBzaG93UGFnZXMgJiYgYWZ0ZXJQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDEpIHtcclxuICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9JzAnPjEuLi48L2E+PC9saT5cIjtcclxuICAgICAgICAgIGZvciAoayA9IGJlZm9yZVBhZ2VzIC0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICsgMTsgayA8IGJlZm9yZVBhZ2VzICsgTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpOyBrKyspIHtcclxuICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaSBjbGFzcz0nYWN0aXZlJyA+PGE+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoKHBhZ2VzIC0gMSkgKiByb3dzKSArIFwiJz4uLi5cIiArIHBhZ2VzICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZVBhZ2VzID4gcGFnZXMgJiYgYWZ0ZXJQYWdlcyA8PSBzaG93UGFnZXMgJiYgYWZ0ZXJQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDEpIHtcclxuICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9JzAnPjEuLi48L2E+PC9saT5cIjtcclxuICAgICAgICAgIGZvciAoayA9IGJlZm9yZVBhZ2VzIC0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICsgMTsgayA8IGJlZm9yZVBhZ2VzICsgTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpOyBrKyspIHtcclxuICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaSBjbGFzcz0nYWN0aXZlJyA+PGE+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoKHBhZ2VzIC0gMSkgKiByb3dzKSArIFwiJz4uLi5cIiArIHBhZ2VzICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZVBhZ2VzID4gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICYmIGFmdGVyUGFnZXMgPD0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICsgMSkge1xyXG4gICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nMCc+MS4uLjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgcGFnZXM7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8v5Yik5patXCLpppbpobVcIuWSjFwi5pyr6aG1XCLmmK/lkKblj6/ngrnlh7tcclxuICAgICAgdmFyIGZpcnN0UGFnZSwgbGFzdFBhZ2U7XHJcbiAgICAgIGlmIChvZmZzZXQgPT0gMCkgey8v5q2k5pe26aaW6aG15peg5rOV54K55Ye7XHJcbiAgICAgICAgZmlyc3RQYWdlID0gJzxsaSBjbGFzcz1cImRpc2FibGVkXCI+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiMFwiPummlumhtTwvYT48L2xpPic7XHJcbiAgICAgICAgbGFzdFBhZ2UgPSAnPGxpPjxhIGNsYXNzPVwicGFnZXNcIiBkYXRhLW9mZnNldD1cIicgKyBwYXJzZUludChwYXJzZUludCgobGVuZ3RoICUgcm93cyA9PSAwID8gKGxlbmd0aCAtIDEpIDogbGVuZ3RoKSAvIHJvd3MpICogcm93cykgKyAnXCIgPuacq+mhtTwvYT48L2xpPic7XHJcbiAgICAgIH0gZWxzZSBpZiAoKG9mZnNldCArIHJvd3MpID49IGxlbmd0aCkgey8v5q2k5pe25pyr6aG15peg5rOV54K55Ye7XHJcbiAgICAgICAgZmlyc3RQYWdlID0gJzxsaT48YSBjbGFzcz1cInBhZ2VzXCIgZGF0YS1vZmZzZXQ9XCIwXCI+6aaW6aG1PC9hPjwvbGk+JztcclxuICAgICAgICBsYXN0UGFnZSA9ICc8bGkgY2xhc3M9XCJkaXNhYmxlZFwiPjxhIGNsYXNzPVwicGFnZXNcIiBkYXRhLW9mZnNldD1cIicgKyBwYXJzZUludChwYXJzZUludCgobGVuZ3RoICUgcm93cyA9PSAwID8gKGxlbmd0aCAtIDEpIDogbGVuZ3RoKSAvIHJvd3MpICogcm93cykgKyAnXCI+5pyr6aG1PC9hPjwvbGk+JztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBmaXJzdFBhZ2UgPSAnPGxpPjxhIGNsYXNzPVwicGFnZXNcIiBkYXRhLW9mZnNldD1cIjBcIj7pppbpobU8L2E+PC9saT4nO1xyXG4gICAgICAgIGxhc3RQYWdlID0gJzxsaT48YSBjbGFzcz1cInBhZ2VzXCIgZGF0YS1vZmZzZXQ9XCInICsgcGFyc2VJbnQocGFyc2VJbnQoKGxlbmd0aCAlIHJvd3MgPT0gMCA/IChsZW5ndGggLSAxKSA6IGxlbmd0aCkgLyByb3dzKSAqIHJvd3MpICsgJ1wiPuacq+mhtTwvYT48L2xpPic7XHJcbiAgICAgIH1cclxuICAgICAgLy/liKTmlq1cIuS4iuS4gOmhtVwi5ZKMXCLkuIvkuIDpobVcIuaYr+WQpuWtmOWcqFxyXG4gICAgICB2YXIgdXBQYWdlLCBkb3duUGFnZTtcclxuICAgICAgaWYgKG9mZnNldCA9PSAwIHx8IChvZmZzZXQgPCByb3dzICYmIChvZmZzZXQgJSByb3dzICE9IDApKSkge1xyXG4gICAgICAgIHVwUGFnZSA9IFwiPGxpIGNsYXNzPSdkaXNhYmxlZCc+PGEgY2xhc3M9J3BhZ2VzJyBmdW5jPSdwcmV2aW91cycgZGF0YS1vZmZzZXQ9J1wiICsgcGFyc2VJbnQob2Zmc2V0KSArIFwiJyA+5LiK6aG1PC9hPjwvbGk+XCJcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB1cFBhZ2UgPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGZ1bmM9J3ByZXZpb3VzJyBkYXRhLW9mZnNldD0nXCIgKyAocGFyc2VJbnQob2Zmc2V0KSAtIHBhcnNlSW50KHJvd3MpKSArIFwiJyA+5LiK6aG1PC9hPjwvbGk+XCI7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG9mZnNldCA+PSAobGVuZ3RoIC0gcm93cykpIHtcclxuICAgICAgICBkb3duUGFnZSA9IFwiPGxpIGNsYXNzPSdkaXNhYmxlZCc+PGEgY2xhc3M9J3BhZ2VzJyBmdW5jPSduZXh0JyBkYXRhLW9mZnNldD0nXCIgKyBwYXJzZUludChvZmZzZXQpICsgXCInPuS4i+mhtTwvYT48L2xpPlwiXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZG93blBhZ2UgPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGZ1bmM9J25leHQnIGRhdGEtb2Zmc2V0PSdcIiArIHBhcnNlSW50KHBhcnNlSW50KG9mZnNldCkgKyBwYXJzZUludChyb3dzKSkgKyBcIic+5LiL6aG1PC9hPjwvbGk+XCJcclxuICAgICAgfVxyXG4gICAgICBpZiAocGFnZXMgIT0gMSkge1xyXG4gICAgICAgIC8v5YiG6aG16YOo5YiGXHJcbiAgICAgICAgYXNzICs9IFwiPGRpdiBpZD0ncGFnZXInIGNsYXNzPSdwYWdlci1pbmZvJz5cIiArXHJcbiAgICAgICAgXCI8aDYgaWQ9J3Jlc3VsdCcgY2xhc3M9J3BhZ2VyLXJlY29yZCc+5YWx5pyJPHNwYW4+XCIgKyBsZW5ndGggKyBcIjwvc3Bhbj7mnaHorrDlvZU8L2g2PlwiICtcclxuICAgICAgICBcIjx1bCBjbGFzcz0ncGFnaW5hdGlvbic+XCIgKyBmaXJzdFBhZ2UgKyB1cFBhZ2UgKyBwYWdlSHRtbCArIGRvd25QYWdlICsgbGFzdFBhZ2UgKyBcIjwvdWw+PC9kaXY+XCI7XHJcbiAgICAgICAgLy90YWJsZeS4reazqOWFpeaLvOijheeahOiusOW9lVxyXG4gICAgICAgIGVsZS5odG1sKGFzcyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZWxlLmh0bWwoJycpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59KGpRdWVyeSkpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHpyeiBvbiAyMDE2LzIvMjYuXHJcbiAqIEB2ZXJzaW9uIDEuMC4wIGNyZWF0ZWQg6YCa55So5oCn5Yqf6IO95pa55rOVXHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxudmFyIEZ1biA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgX3RpbWVPdXQgPSAxMDAwMDA7Ly/or7fmsYLotoXml7bml7bpl7TkuLoxMHNcclxuICAgIC8qKlxyXG4gICAgICog5bCB6KOFYWpheFxyXG4gICAgICogQHBhcmFtIG9wdGlvblxyXG4gICAgICoge1xyXG4gICAgICogICAgICB1cmw6XCLor7fmsYLnmoTlnLDlnYBcIlxyXG4gICAgICogICAgICAsbWV0aG9kOlwi6K+35rGC55qE5pa55rOVXCJcclxuICAgICAqICAgICAgLGFzeW5jOlwi5piv5ZCm5bm25Y+RXCJcclxuICAgICAqICAgICAgLGRhdGE6XCLlj5HpgIHnmoTmlbDmja5cIlxyXG4gICAgICogICAgICAsc3VjY2VzczpcIuaIkOWKn+aXtuWbnuiwg1wiXHJcbiAgICAgKiAgICAgICxlcnJvcjpcIuWksei0pS/otoXml7bml7blm57osINcIlxyXG4gICAgICogICAgICAsdGltZW91dDpcIui2heaXtuaXtumXtFwiXHJcbiAgICAgKiAgICAgICxjb21wbGV0ZTpcIuWujOaIkOWQjueahOWbnuiwg1wiXHJcbiAgICAgKiB9XHJcbiAgICAgKi9cclxuICAgIHZhciBhamF4ID0gZnVuY3Rpb24gKG9wdGlvbikge1xyXG4gICAgICAgIC8vYWpheOW8gOWni+aXtuW6lOaYvuekuuKAnOWKoOi9veS/oeaBr+ahhuKAnVxyXG4gICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBvcHRpb24udXJsXHJcbiAgICAgICAgICAgICwgdHlwZTogXCJ0eXBlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi50eXBlIHx8IFwiR0VUXCJcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiBvcHRpb24udGltZW91dCB8fCBfdGltZU91dFxyXG4gICAgICAgICAgICAsIGRhdGE6IFwiZGF0YVwiIGluIG9wdGlvbiAmJiBvcHRpb24uZGF0YSB8fCB7fVxyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgICAgICAsIGFzeW5jOiAoXCJhc3luY1wiIGluIG9wdGlvbiAmJiBvcHRpb24uYXN5bmMpID8gdHJ1ZSA6IGZhbHNlXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChcInN0YXR1c1wiIGluIGpzb24gJiYganNvbi5zdGF0dXMgPiAwICYmIFwiZGF0YVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJzdWNjZXNzXCIgaW4gb3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbi5zdWNjZXNzKGpzb24uZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoXCLml6BzdWNjZXNz5pa55rOVIVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiZXJyb3JcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmVycm9yIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uZXJyb3IoanNvbik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmk43kvZzlpLHotKUhJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGVycm9yOiBmdW5jdGlvbiAoeGhyKSB7Ly80MDTmiJbogIXotoXml7ZcclxuICAgICAgICAgICAgICAgIGlmIChcImVycm9yXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5lcnJvciBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/mj5DnpLrnlKjmiLfplJnor6/kv6Hmga9cclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoXCLov57mjqXmnI3liqHlmajlpLHotKXvvIznirbmgIHvvJpcIiArICh4aHIuc3RhdHVzIHx8IC0xKSArIFwiLOS/oeaBr++8mlwiICsgKHhoci5zdGF0dXNUZXh0IHx8IFwiLVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmVycm9yKHhoci5zdGF0dXMsIHhoci5zdGF0dXNUZXh0KTsvL+Wbnuiwg+ivt+axgueahOeKtuaAgeWSjOmUmeivr+S/oeaBr1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKHhociwgdHlwZSkge1xyXG4gICAgICAgICAgICAgICAgLy/lhbPpl63igJzliqDovb3kv6Hmga/moYbigJ1cclxuICAgICAgICAgICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChcImNvbXBsZXRlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5jb21wbGV0ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmNvbXBsZXRlKHhociwgdHlwZSk7Ly/lm57osIPor7fmsYLnmoR4aHLkv6Hmga/lkoznsbvlnotcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v5YWo6YCJ5ZKM5Y2V6YCJ55qE57uR5a6aXHJcbiAgICB2YXIgc2V0Q2hlY2tib3hMaXN0ZW5lciA9IGZ1bmN0aW9uIChhbGxDaGVjaywgcmFkaW9DaGVja3MpIHtcclxuICAgICAgICAvL+etm+mAieWNlemAieaMiemSrue7hFxyXG4gICAgICAgIHZhciByYWRpb1ZhbHVlRWxlcyA9ICQocmFkaW9DaGVja3MpO1xyXG4gICAgICAgIC8v54K55Ye75YWo6YCJ5pe277yM5ZCM57uE5oyJ6ZKu6KKr5ZCM5q2lXHJcbiAgICAgICAgJChkb2N1bWVudCkuZGVsZWdhdGUoYWxsQ2hlY2ssIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAocmFkaW9WYWx1ZUVsZXMgJiYgcmFkaW9WYWx1ZUVsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX3IgPSAwOyBfciA8IHJhZGlvVmFsdWVFbGVzLmxlbmd0aDsgX3IrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJhZGlvVmFsdWVFbGVzW19yXS5jaGVja2VkID0gJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/ngrnlh7vljZXpgInmjInpkq7ml7bvvIxcclxuICAgICAgICAkKGRvY3VtZW50KS5kZWxlZ2F0ZShyYWRpb0NoZWNrcywgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoYWxsQ2hlY2spWzBdLmNoZWNrZWQgPSAkKHJhZGlvQ2hlY2tzICsgXCI6Y2hlY2tlZFwiKS5sZW5ndGggPT0gJChyYWRpb0NoZWNrcykubGVuZ3RoO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB1cmwgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBnZXQgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChcIihefCYpXCIgKyBuYW1lICsgXCI9KFteJl0qKSgmfCQpXCIsIFwiaVwiKTtcclxuICAgICAgICAgICAgdmFyIHIgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxKS5tYXRjaChyZWcpO1xyXG4gICAgICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gZGVjb2RlVVJJKHJbMl0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOagueaNruWPguaVsOWIl+ihqOmVv+W6pui/m+ihjOWIpOaWre+8jOWFvOWuuUlFOVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ29iamVjdCcpIHsvL+S4gOS4quWvueixoe+8jOS9v+eUqGtleeagh+iusHZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gYXJndW1lbnRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgLCBzZWFyY2ggPSBsb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBvIGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkobykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoID0gY2hhbmdlVVJMS2V5VmFsdWUoc2VhcmNoLCBvLCBvYmpbb10pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgncHVzaFN0YXRlJyBpbiBoaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgZG9jdW1lbnQudGl0bGUsIHNlYXJjaCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCdwdXNoU3RhdGUnIGluIEhpc3RvcnkpIHsvL2llOSDkuI3mlK/mjIFwdXNoU3RhdGXmlrnms5UsamF2YXNjcmlwdC5lanPkuK3mt7vliqBoaXN0b3J5Lmpz5a6M5oiQaHRtbDTlr7lwdXNoU3RhdGXnmoTmlK/mjIFcclxuICAgICAgICAgICAgICAgICAgICBIaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBzZWFyY2gpOy8v6L+U5Zue6YeN5paw5p6E6YCg5ZCOc2VhcmNo5LiyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgey8va2V5K3ZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gYXJndW1lbnRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgLCB2YWx1ZSA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgICAgICAgIGlmICgncHVzaFN0YXRlJyBpbiBoaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgZG9jdW1lbnQudGl0bGUsIGNoYW5nZVVSTEtleVZhbHVlKGxvY2F0aW9uLnRvU3RyaW5nKCksIGtleSwgdmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJ3B1c2hTdGF0ZScgaW4gSGlzdG9yeSkgey8vaWU5IOS4jeaUr+aMgXB1c2hTdGF0ZeaWueazlSxqYXZhc2NyaXB0LmVqc+S4rea3u+WKoGhpc3RvcnkuanPlrozmiJBodG1sNOWvuXB1c2hTdGF0ZeeahOaUr+aMgVxyXG4gICAgICAgICAgICAgICAgICAgIEhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIGNoYW5nZVVSTEtleVZhbHVlKGxvY2F0aW9uLnNlYXJjaCwga2V5LCB2YWx1ZSkpOy8v6L+U5Zue6YeN5paw5p6E6YCg5ZCOc2VhcmNo5LiyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gY2hhbmdlVVJMS2V5VmFsdWUodXJsLCBhcmcsIGFyZ192YWwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gYXJnICsgJz0oW14mXSopJztcclxuICAgICAgICAgICAgICAgIHZhciByZXBsYWNlVGV4dCA9IGFyZyArICc9JyArIGFyZ192YWw7XHJcbiAgICAgICAgICAgICAgICBpZiAodXJsLm1hdGNoKHBhdHRlcm4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9ICcvKCcgKyBhcmcgKyAnPSkoW14mXSopL2dpJztcclxuICAgICAgICAgICAgICAgICAgICB0bXAgPSB1cmwucmVwbGFjZShldmFsKHRtcCksIHJlcGxhY2VUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG1wO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodXJsLm1hdGNoKCdbXFw/XScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwgKyAnJicgKyByZXBsYWNlVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJsICsgJz8nICsgcmVwbGFjZVRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXQ6IGdldFxyXG4gICAgICAgICAgICAsIHNldDogc2V0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIHZhciBmb3JtYXRJbWFnZT1mdW5jdGlvbiAocGF0aCwgc2l6ZSwgZWxlKSB7XHJcbiAgICAgICAgaWYocGF0aCBpbnN0YW5jZW9mICBBcnJheSAmJiBwYXRoLmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgcGF0aCA9IHBhdGhbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBJTUFHRV9TSVpFID0ge1xyXG4gICAgICAgICAgICBvcmlnaW5hbDoge1xyXG4gICAgICAgICAgICAgICAgcGF0aDogXCJcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgeGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl94bGFyZ2VcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiNjYwKjY2MFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9sYXJnZVwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI0MjAqNDIwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWlkZGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWRkbGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMzAwKjMwMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNtYWxsOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9zbWFsbFwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCIyNDAqMjQwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGl0dGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9saXR0bGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMTIwKjEyMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1pY3JvOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWNyb1wiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI2MCo2MFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHNpemUgPSBJTUFHRV9TSVpFW3NpemUgfHwgXCJtaWRkbGVcIl0gfHwgSU1BR0VfU0laRS5taWRkbGU7XHJcbiAgICAgICAgdmFyIHBhdGhUZW1wID0gL1xcLlxcdys/JC8uZXhlYyhwYXRoKTtcclxuICAgICAgICBpZiAoIXBhdGhUZW1wKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gc2l6ZS5wYXRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhdGggPSAocGF0aC5zdWJzdHIoMCwgcGF0aFRlbXAuaW5kZXggfHwgcGF0aC5sZW5ndGgpKSArIHNpemUucGF0aCArIHBhdGhUZW1wWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZWxlICYmIGVsZS5hdHRyKSB7XHJcbiAgICAgICAgICAgIGVsZS5hdHRyKFwic3JjXCIsIHBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGFqYXg6IGFqYXhcclxuICAgICAgICAsIGdldFRpbXRvdXQ6IF90aW1lT3V0XHJcbiAgICAgICAgLCBzZXRDaGVja2JveExpc3RlbmVyOiBzZXRDaGVja2JveExpc3RlbmVyXHJcbiAgICAgICAgLCB1cmw6IHVybFxyXG4gICAgICAgICwgZm9ybWF0SW1hZ2U6IGZvcm1hdEltYWdlXHJcbiAgICB9XHJcbn0oKSk7XHJcblxyXG5leHBvcnRzLmFqYXggPSBGdW4uYWpheDtcclxuZXhwb3J0cy5nZXRUaW1lb3V0ID0gRnVuLmdldFRpbXRvdXQ7XHJcbmV4cG9ydHMuc2V0Q2hlY2tib3hMaXN0ZW5lciA9IEZ1bi5zZXRDaGVja2JveExpc3RlbmVyO1xyXG5leHBvcnRzLnVybCA9IEZ1bi51cmw7XHJcbmV4cG9ydHMuZm9ybWF0SW1hZ2UgPSBGdW4uZm9ybWF0SW1hZ2U7XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEplcmVteSBvbiAyMDE3LzEvMjMuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBnZW5lcmFsID0gKGZ1bmN0aW9uICgpIHtcclxuICB2YXIgcnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy/ml7bpl7TmoLzlvI/ljJZcclxuICAgIERhdGUucHJvdG90eXBlLkZvcm1hdCA9IGZ1bmN0aW9uIChmbXQpIHsgLy9hdXRob3I6IEplcmVteXl5XHJcbiAgICAgIHZhciBvID0ge1xyXG4gICAgICAgIFwiTStcIjogdGhpcy5nZXRNb250aCgpICsgMSwgLy/mnIjku71cclxuICAgICAgICBcImQrXCI6IHRoaXMuZ2V0RGF0ZSgpLCAvL+aXpVxyXG4gICAgICAgIFwiaCtcIjogdGhpcy5nZXRIb3VycygpLCAvL+Wwj+aXtlxyXG4gICAgICAgIFwibStcIjogdGhpcy5nZXRNaW51dGVzKCksIC8v5YiGXHJcbiAgICAgICAgXCJzK1wiOiB0aGlzLmdldFNlY29uZHMoKSwgLy/np5JcclxuICAgICAgICBcInErXCI6IE1hdGguZmxvb3IoKHRoaXMuZ2V0TW9udGgoKSArIDMpIC8gMyksIC8v5a2j5bqmXHJcbiAgICAgICAgXCJTXCI6IHRoaXMuZ2V0TWlsbGlzZWNvbmRzKCkgLy/mr6vnp5JcclxuICAgICAgfTtcclxuICAgICAgaWYgKC8oeSspLy50ZXN0KGZtdCkpIGZtdCA9IGZtdC5yZXBsYWNlKFJlZ0V4cC4kMSwgKHRoaXMuZ2V0RnVsbFllYXIoKSArIFwiXCIpLnN1YnN0cig0IC0gUmVnRXhwLiQxLmxlbmd0aCkpO1xyXG4gICAgICBmb3IgKHZhciBrIGluIG8pXHJcbiAgICAgICAgaWYgKG5ldyBSZWdFeHAoXCIoXCIgKyBrICsgXCIpXCIpLnRlc3QoZm10KSkgZm10ID0gZm10LnJlcGxhY2UoUmVnRXhwLiQxLCAoUmVnRXhwLiQxLmxlbmd0aCA9PSAxKSA/IChvW2tdKSA6ICgoXCIwMFwiICsgb1trXSkuc3Vic3RyKChcIlwiICsgb1trXSkubGVuZ3RoKSkpO1xyXG4gICAgICByZXR1cm4gZm10O1xyXG4gICAgfTtcclxuICB9O1xyXG4gIHJldHVybiB7XHJcbiAgICBydW46IHJ1blxyXG4gIH1cclxufSgpKTtcclxubW9kdWxlLmV4cG9ydHMuZ2VuZXJhbCA9IGdlbmVyYWw7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgenJ6IG9uIDIwMTYvMi8yNC5cclxuICogQHZlcnNpb24gMS4wLjAgY3JlYXRlZFxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbi8v5p6E6YCg5L+h5oGv5qGG5Li75L2TXHJcbnZhciBNb2RhbCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAvL+aehOmAoOWOn+Wni+exu1xyXG4gICAgZnVuY3Rpb24gTShtKSB7XHJcbiAgICAgICAgdGhpcy5zID0gbS5zOy8v5piv5ZCm5pi+56S6XHJcbiAgICAgICAgdGhpcy5pZCA9IG0uaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy/mnoTpgKDmoIflh4ZzaG935pa55rOV77yM55So5LqO57un5om/XHJcbiAgICBNLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlkKTtcclxuICAgICAgICBpZiAoZWxlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnMgJiYgIWlzU2hvdygpKSB7Ly/mmL7npLrlvZPliY3pmpDol49cclxuICAgICAgICAgICAgICAgIGVsZS5jbGFzc05hbWUgPSBlbGUuY2xhc3NOYW1lLnJlcGxhY2UoXCJkcC1uXCIsIFwiXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLnMgJiYgaXNTaG93KCkpIHsvL+makOiXj+W9k+WJjeaYvuekulxyXG4gICAgICAgICAgICAgICAgZWxlLmNsYXNzTmFtZSArPSBcIiBkcC1uXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy/ljrvpmaTkuKTovrnnmoTnqbrmoLxcclxuICAgICAgICAgICAgZWxlLmNsYXNzTmFtZSA9IFN0cmluZyhlbGUuY2xhc3NOYW1lKS50cmltKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGlzU2hvdygpIHsvL+aYr+WQpuW3suaYvuekuu+8jOaXoGNsYXNz5pe25pi+56S6XHJcbiAgICAgICAgICAgIHJldHVybiBlbGUuY2xhc3NOYW1lLnNwbGl0KFwiZHAtblwiKS5sZW5ndGggPT0gMTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8v5Yqg6L295L+h5oGv5qGGXHJcbiAgICB2YXIgbG9hZGluZyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy/liJ3lp4vljJbnlJ/miJDliqDovb3kv6Hmga/moYZcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvYWRpbmdfbW9kYWxfZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD1cImxvYWRpbmdfbW9kYWxfZWxlbWVudFwiIGNsYXNzPVwibG9hZGluZy1tb2RhbC1ib2R5IGRwLW5cIj48ZGl2IGNsYXNzPVwiY292ZXJfbW9kYWxfZWxlbWVudFwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibG9hZGluZy1tb2RhbC1pbWFnZVwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibG9hZGluZy1tb2RhbC10ZXh0XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxoMj7njqnlkb3liqDovb3kuK3igKbigKY8L2gyPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvL+aYvuekuuOAgemakOiXj+S/oeaBr+ahhlxyXG4gICAgICAgIHZhciBzaG93ID0gZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgcyA9IHR5cGVvZiBzID09IFwidW5kZWZpbmVkXCIgPyB0cnVlIDogczsvL+aXoOWPguaVsOaYvuekuuS/oeaBr+ahhlxyXG4gICAgICAgICAgICB2YXIgbSA9IG5ldyBNKHtpZDogXCJsb2FkaW5nX21vZGFsX2VsZW1lbnRcIiwgczogc30pO1xyXG4gICAgICAgICAgICBtLnNob3coKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXRcclxuICAgICAgICAgICAgLCBzaG93OiBzaG93XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIC8v5by55Ye65L+h5oGv5qGGXHJcbiAgICB2YXIgYWxlcnQgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWxlcnRfbW9kYWxfZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD1cImFsZXJ0X21vZGFsX2VsZW1lbnRcIiBjbGFzcz1cImFsZXJ0LW1vZGFsLWVsZW1lbnQgZHAtblwiPjxkaXYgY2xhc3M9XCJjb3Zlcl9tb2RhbF9lbGVtZW50XCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbGVydC1tb2RhbC1jb250ZW50XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbGVydC1tb2RhbC1ib2R5XCI+PHNwYW4gY2xhc3M9XCJhbGVydC1tb2RhbC10ZXh0XCI+PC9zcGFuPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWxlcnQtbW9kYWwtZm9vdGVyXCI+PGJ1dHRvbiBpZD1cImFsZXJ0X21vZGFsX2Nsb3NlXCIgY2xhc3M9XCJhbGVydC1tb2RhbC1idXR0b25cIj7lhbPpl608L2J1dHRvbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHNob3cgPSBmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICBzID0gdHlwZW9mIHMgPT0gXCJ1bmRlZmluZWRcIiA/IHRydWUgOiBzO1xyXG4gICAgICAgICAgICB2YXIgbSA9IG5ldyBNKHtpZDogXCJhbGVydF9tb2RhbF9lbGVtZW50XCIsIHM6IHN9KTtcclxuICAgICAgICAgICAgbS5zaG93KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDorr7nva7lvLnlh7rkv6Hmga/moYZcclxuICAgICAgICAgKiBAcGFyYW0gbXNnICAgICAgIOaYvuekuueahOS/oeaBr++8jOaUr+aMgWh0bWxcclxuICAgICAgICAgKiBAcGFyYW0gc2VkICAgICAgIOWAkuiuoeaXtuWFs+mXreaXtumXtO+8jOWNleS9je+8mnNlY29uZFxyXG4gICAgICAgICAqIEBwYXJhbSBjYWxsYmFjayAg5YWz6Zet6Kem5Y+R5Zue6LCD5Ye95pWwXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHNldCA9IGZ1bmN0aW9uIChtc2csIHNlZCwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdmFyIGVsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWxlcnRfbW9kYWxfZWxlbWVudFwiKTtcclxuICAgICAgICAgICAgaWYgKG1zZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtc2cgPT09ICdvYmplY3QnKSB7Ly/lupTlr7nlkI7nq6/ov5Tlm57mj5DnpLrml7bkvb/nlKhPYmplY3TlsIHoo4VcclxuICAgICAgICAgICAgICAgICAgICBtc2cgPSBKU09OLnN0cmluZ2lmeShtc2cpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoZWxlKXtcclxuICAgICAgICAgICAgICAgICAgICBlbGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImFsZXJ0LW1vZGFsLXRleHRcIilbMF0uaW5uZXJIVE1MID0gbXNnO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYWxlcnQtbW9kYWwtdGV4dFwiKVswXS5pbm5lckhUTUwgPSBtc2c7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzaG93KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHNlZCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwMCAqIHNlZCk7XHJcbiAgICAgICAgICAgIH0vL+aXoOWFs+mXreaXtumXtOaIluiAheWFs+mXreaXtumXtOS4ujDvvIzkuI3oh6rliqjlhbPpl61cclxuICAgICAgICAgICAgLy9maXhtZSDkuovku7bnm5HlkKznmoRpZeWFvOWuueaAp1xyXG4gICAgICAgICAgICAvL+WFs+mXreaMiemSrueahOS6i+S7tuS+puWQrFxyXG4gICAgICAgICAgICAkKFwiI2FsZXJ0X21vZGFsX2Nsb3NlXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAvL+mYu+atouS6i+S7tue7p+e7reS8oOmAklxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXRcclxuICAgICAgICAgICAgLCBzaG93OiBzaG93XHJcbiAgICAgICAgICAgICwgc2V0OiBzZXRcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgLy/pgInmi6nkv6Hmga/moYZcclxuICAgIHZhciBjb25maXJtID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1fbW9kYWxfZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD1cImNvbmZpcm1fbW9kYWxfZWxlbWVudFwiIGNsYXNzPVwiY29uZmlybS1tb2RhbC1lbGVtZW50IGRwLW5cIj48ZGl2IGNsYXNzPVwiY292ZXJfbW9kYWxfZWxlbWVudFwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29uZmlybS1tb2RhbC1jb250ZW50XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgaWQ9XCJjb25maXJtX21vZGFsX2hlYWRlclwiIGNsYXNzPVwiY29uZmlybS1tb2RhbC1oZWFkZXIgZHAtblwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29uZmlybS1tb2RhbC1ib2R5XCI+PHNwYW4gaWQ9XCJjb25maXJtX21vZGFsX3RleHRcIiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtdGV4dFwiPjwvc3Bhbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtZm9vdGVyXCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmb290ZXItYnV0dG9uLXN1Y2Nlc3NcIj48YnV0dG9uIGNsYXNzPVwiY29uZmlybS1tb2RhbC1idXR0b24gIG1vZGFsLXN1Y2Nlc3NcIiBkYXRhLWNvbmZpcm09XCJzdWNjZXNzXCI+56Gu6K6kPC9idXR0b24+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmb290ZXItYnV0dG9uLWZhbHNlXCI+PGJ1dHRvbiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtYnV0dG9uXCIgZGF0YS1jb25maXJtPVwiZXJyb3JcIj7lj5bmtog8L2J1dHRvbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHNob3cgPSBmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICBzID0gdHlwZW9mIHMgPT0gXCJ1bmRlZmluZWRcIiA/IHRydWUgOiBzO1xyXG4gICAgICAgICAgICB2YXIgbSA9IG5ldyBNKHtpZDogXCJjb25maXJtX21vZGFsX2VsZW1lbnRcIiwgczogc30pO1xyXG4gICAgICAgICAgICBtLnNob3coKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiuvue9rumAieaLqeS/oeaBr+ahhueahOWGheWuuVxyXG4gICAgICAgICAqIEBwYXJhbSBvcHRpb24gICAg6YWN572uXHJcbiAgICAgICAgICoge1xyXG4gICAgICAgICAqICAgICAgdGl0bGU6XCLlpLTpg6jmmL7npLrnmoTkv6Hmga9cIlxyXG4gICAgICAgICAqICAgICAgLHRleHQ6XCLmmL7npLrnmoTmj5DnpLrkv6Hmga9cIlxyXG4gICAgICAgICAqICAgICAgLHN1Y2Nlc3M6XCLngrnlh7vmiJDlip/lkI7nmoTlm57osINcIlxyXG4gICAgICAgICAqICAgICAgLGVycm9yOlwi54K55Ye75aSx6LSl5ZCO55qE5Zue6LCDXCJcclxuICAgICAgICAgKiAgICAgICxjb21wbGV0ZTpcIueCueWHu+aMiemSruWQjueahOaVtOS9k+Wbnuiwg1wiXHJcbiAgICAgICAgICogfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBiYXIgPSAwO1xyXG4gICAgICAgIHZhciBzZXQgPSBmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICghb3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKFwidGl0bGVcIiBpbiBvcHRpb24gJiYgb3B0aW9uLnRpdGxlLmxlbmd0aCA+IDApIHsvL+acieWktOmDqO+8jOWImeaYvuekuuWktOmDqFxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtX21vZGFsX2hlYWRlclwiKS5pbm5lckhUTUwgPSBvcHRpb24udGl0bGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKFwidGV4dFwiIGluIG9wdGlvbiAmJiBvcHRpb24udGV4dC5sZW5ndGggPiAwKSB7Ly/mnInlhoXlrrnvvIzliJnmmL7npLrmlbTkuKrpgInmi6nkv6Hmga/moYZcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybV9tb2RhbF90ZXh0XCIpLmlubmVySFRNTCA9IG9wdGlvbi50ZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vZml4bWUg5LqL5Lu255uR5ZCs55qEaWXlhbzlrrnmgKdcclxuICAgICAgICAgICAgLy/lhbPpl63mjInpkq7nmoTkuovku7bkvqblkKxcclxuICAgICAgICAgICAgJChcIiNjb25maXJtX21vZGFsX2VsZW1lbnRcIikuZmluZChcIi5jb25maXJtLW1vZGFsLWJ1dHRvblwiKS5vZmYoXCJjbGlja1wiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIC8vZml4bWUgLm9mZihcImNsaWNrXCIp55So5LqO6Ziy5q2i5aSa5qyh6Kem5Y+RPC0t5b6I546E5a2m77yM5oiR5Lmf5LiN55+l6YGT5Li65LuA5LmI77yM5L2G5piv6K+35LiN6KaB5L+u5pS544CCXHJcbiAgICAgICAgICAgICAgICB2YXIgYXRyID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1jb25maXJtXCIpOy8v6YCJ5oup55qE5oyJ6ZKuXHJcbiAgICAgICAgICAgICAgICBiYXIrKztcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb24gJiYgYXRyIGluIG9wdGlvbiAmJiBvcHRpb25bYXRyXSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uW2F0cl0oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb24gJiYgXCJjb21wbGV0ZVwiIGluIG9wdGlvbiAmJiBvcHRpb24uY29tcGxldGUgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbi5jb21wbGV0ZSgpOy8v6Iul5pyJ5a6M5oiQ5Ye95pWw77yM5YiZ5omn6KGMXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Ugey8v5ZCm5YiZ77yM5YWz6Zet6YCJ5oup5qGGXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL+mYu+atouS6i+S7tue7p+e7reS8oOmAklxyXG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICAsIHNob3c6IHNob3dcclxuICAgICAgICAgICAgLCBzZXQ6IHNldFxyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICAvL+imhuebluWxglxyXG4gICAgdmFyIGNvdmVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvdmVyX21vZGFsX2VsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJjb3Zlcl9tb2RhbF9lbGVtZW50XCIgY2xhc3M9XCJjb3Zlci1tb2RhbC1lbGVtZW50IGRwLW5cIj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgaGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb3Zlcl9tb2RhbF9lbGVtZW50XCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBzaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvdmVyX21vZGFsX2VsZW1lbnRcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXRcclxuICAgICAgICAgICAgLCBzaG93OiBzaG93XHJcbiAgICAgICAgICAgICwgaGlkZTogaGlkZVxyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGluaXRMb2FkaW5nOiBsb2FkaW5nLmluaXRcclxuICAgICAgICAsIHNob3dMb2FkaW5nOiBsb2FkaW5nLnNob3dcclxuXHJcbiAgICAgICAgLCBpbml0QWxlcnQ6IGFsZXJ0LmluaXRcclxuICAgICAgICAsIHNob3dBbGVydDogYWxlcnQuc2hvd1xyXG4gICAgICAgICwgc2V0QWxlcnQ6IGFsZXJ0LnNldFxyXG5cclxuICAgICAgICAsIGluaXRDb25maXJtOiBjb25maXJtLmluaXRcclxuICAgICAgICAsIHNldENvbmZpcm06IGNvbmZpcm0uc2V0XHJcbiAgICAgICAgLCBzaG93Q29uZmlybTogY29uZmlybS5zaG93XHJcbiAgICAgICAgLCBpbml0Q292ZXI6IGNvdmVyLmluaXRcclxuICAgIH1cclxufSgpKTtcclxuXHJcbi8v6aG16Z2i5Yqg6L295a6M5q+V5ZCO55Sf5oiQ5Zub5Liq6Ieq5a6a5LmJ5qih5oCB5qGGXHJcbnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgLy/pobXpnaLliqDovb3ml7bnlJ/miJDkuIDkuKropobnm5blsYJcclxuICAgIE1vZGFsLmluaXRDb3ZlcigpO1xyXG4gICAgLy/pobXpnaLliqDovb3ml7bnlJ/miJDkuIDkuKrliqDovb3kv6Hmga/moYZcclxuICAgIE1vZGFsLmluaXRMb2FkaW5nKCk7XHJcbiAgICAvL+mhtemdouWKoOi9veaXtueUn+aIkOS4gOS4quW8ueWHuuS/oeaBr+ahhlxyXG4gICAgTW9kYWwuaW5pdEFsZXJ0KCk7XHJcbiAgICAvL+mhtemdouWKoOi9veaXtueUn+aIkOS4gOS4qumAieaLqeS/oeaBr+ahhlxyXG4gICAgTW9kYWwuaW5pdENvbmZpcm0oKTtcclxufSwgMTAwKTtcclxuXHJcblxyXG4vL+aKm+WHuuS4iuWxguiwg+eUqFxyXG5leHBvcnRzLnNob3dMb2FkaW5nID0gTW9kYWwuc2hvd0xvYWRpbmc7XHJcbmV4cG9ydHMuc2V0QWxlcnQgPSBNb2RhbC5zZXRBbGVydDtcclxuZXhwb3J0cy5zaG93QWxlcnQgPSBNb2RhbC5zaG93QWxlcnQ7XHJcbmV4cG9ydHMuc2V0Q29uZmlybSA9IE1vZGFsLnNldENvbmZpcm07XHJcbmV4cG9ydHMuc2hvd0NvbmZpcm0gPSBNb2RhbC5zaG93Q29uZmlybTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBBdXNlciBvbiAyMDE2LzEyLzYuXHJcbiAqL1xyXG5cInVzZSBzdHJpY3RcIjtcclxudmFyIERhdGEgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGxpc3QgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVyL3ByZUxpc3QnXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIGNoYW5nZVN0YXRlID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlci9jaGFuZ2VTdGF0ZSdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgZG93biA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3RoZXIvb3NzRG93bidcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgdXAgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL290aGVyL29zc1VwJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBvc3NVcGxvYWQgPSBmdW5jdGlvbiAocGFyYW0sIGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgdmFyIGZvcm1kYXRhID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKFwiT1NTQWNjZXNzS2V5SWRcIiwgcGFyYW0uQWNjZXNzS2V5SWQpO1xyXG4gICAgICAgIGZvcm1kYXRhLmFwcGVuZChcInBvbGljeVwiLCBwYXJhbS5Qb2xpY3kpO1xyXG4gICAgICAgIGZvcm1kYXRhLmFwcGVuZChcIlNpZ25hdHVyZVwiLCBwYXJhbS5TaWduYXR1cmUpO1xyXG4gICAgICAgIGZvcm1kYXRhLmFwcGVuZChcImtleVwiLCBwYXJhbS5LZXluYW1lKTtcclxuICAgICAgICBmb3JtZGF0YS5hcHBlbmQoXCJDb250ZW50LURpc3Bvc2l0aW9uXCIsIFwiYXR0YWNobWVudDtmaWxlbmFtZT1cXFwiXCIgKyBkYXRhLm5hbWUgKyBcIlxcXCJcIik7XHJcbiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKFwiZmlsZVwiLCBkYXRhKTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IHBhcmFtLlVwbG9hZFVSTFxyXG4gICAgICAgICAgICAsIGRhdGE6IGZvcm1kYXRhXHJcbiAgICAgICAgICAgICwgcHJvY2Vzc0RhdGE6IGZhbHNlXHJcbiAgICAgICAgICAgICwgY2FjaGU6IGZhbHNlXHJcbiAgICAgICAgICAgICwgYXN5bmM6IGZhbHNlXHJcbiAgICAgICAgICAgICwgY29udGVudFR5cGU6IGZhbHNlXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAxXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGVycm9yOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IC0xXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBvcmRlckZpbGUgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVyRmlsZS9saXN0J1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBhZGRGaWxlID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlckZpbGUvYWRkJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciByZW1vdmVGaWxlID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlckZpbGUvcmVtb3ZlJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbGlzdDogbGlzdFxyXG4gICAgICAgICwgY2hhbmdlU3RhdGU6IGNoYW5nZVN0YXRlXHJcbiAgICAgICAgLCBkb3duOiBkb3duXHJcbiAgICAgICAgLCB1cDogdXBcclxuICAgICAgICAsIG9zc1VwbG9hZDogb3NzVXBsb2FkXHJcbiAgICAgICAgLCBvcmRlckZpbGU6IG9yZGVyRmlsZVxyXG4gICAgICAgICwgYWRkRmlsZTogYWRkRmlsZVxyXG4gICAgICAgICwgcmVtb3ZlRmlsZTogcmVtb3ZlRmlsZVxyXG4gICAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cy5EYXRhID0gRGF0YTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNy8yLzYuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBEb20gPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGxpc3QgPSBmdW5jdGlvbiAoanNvbiwgcGFyYW0pIHtcclxuICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgc3RyICs9ICc8dGhlYWQ+IDx0cj4gPHRkPuiuouWNleWPty/kuLvljZXlj7c8L3RkPiA8dGQgY29sc3Bhbj1cIjJcIj7lrqLmiLfkv6Hmga88L3RkPiA8dGQgY29sc3Bhbj1cIjRcIj7oiKrnur/kv6Hmga88L3RkPiA8dGQgY29sc3Bhbj1cIjRcIj7otKfniankv6Hmga88L3RkPiA8dGQ+5pON5L2c5ZGYPC90ZD4gPHRkPuaWh+S7tjwvdGQ+IDx0ZD7mk43kvZw8L3RkPiA8L3RyPiA8L3RoZWFkPic7XHJcbiAgICAgICAgaWYgKGpzb24gJiYganNvbi5yZXNDb2RlID09IDAgJiYgJ3Jlc0JvZHknIGluIGpzb24gJiYganNvbi5yZXNCb2R5ICYmICdzTGlzdCcgaW4ganNvbi5yZXNCb2R5ICYmIGpzb24ucmVzQm9keS5zTGlzdCBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIGlmIChqc29uLnJlc0JvZHkuc0xpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IGpzb24ucmVzQm9keS5zTGlzdDtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGEgaW4gYXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFyci5oYXNPd25Qcm9wZXJ0eShhKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gcmVuZGVyKGFyclthXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJC5idXJzdGVyKCQoXCIub3V0ZXItcGFnZVwiKSwgcGFyYW0ub2Zmc2V0IHx8IDAsIGpzb24ucmVzQm9keS50b3RhbENvdW50IHx8IDAsIDUsIHBhcmFtLmxpbWl0IHx8IDIwKTtcclxuICAgICAgICAgICAgICAgICQoJy5saXN0LWNvdXQnKS5odG1sKCflhbHkuLrmgqjmib7liLAgJyArIGpzb24ucmVzQm9keS50b3RhbENvdW50ICsgJyDmnaHnu5PmnpwnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHN0ciArPSAnPHRvYmR5Pjx0ciBjbGFzcz1cIndyb25nXCI+PHRkIGNvbHNwYW49XCIxNFwiPuaaguaXoOiuouWNleS/oeaBr++8jOivt+a3u+WKoO+8gTwvdGQ+PC90cj48L3RvYmR5Pic7XHJcbiAgICAgICAgICAgICAgICAkKCcub3V0ZXItcGFnZScpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAgICAgJCgnLmxpc3QtY291dCcpLmh0bWwoJ+WFseS4uuaCqOaJvuWIsCAwIOadoee7k+aenCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RyICs9ICc8dHIgY2xhc3M9XCJ3cm9uZ1wiPjx0ZCBjb2xzcGFuPVwiMTRcIj7or7fmsYLlpLHotKXvvIw8YSBocmVmPVwiXCI+6K+36YeN6K+V77yBPC9hPjwvdGQ+PC90cj4nO1xyXG4gICAgICAgICAgICAkKCcub3V0ZXItcGFnZScpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAkKCcubGlzdC1jb3V0JykuaHRtbCgn5YWx5Li65oKo5om+5YiwIDAg5p2h57uT5p6cJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbmRlcihkKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gZC5jb21wYW55IHx8IHt9XHJcbiAgICAgICAgICAgICAgICAsIG8gPSBkLm9yZGVyIHx8IHt9XHJcbiAgICAgICAgICAgICAgICAsIGEgPSBkLmFnZW50XHJcbiAgICAgICAgICAgICAgICAsIHR5cGU7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoby5vcmRlckNoYW5uZWwpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJ+iHquWKqeiuouiIsSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICflv6vpgJ/orqLoiLEnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn5ZCO5Y+w5LiL5Y2VJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICfoh6rliqnorqLoiLEnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBjenkgPSAnJztcclxuICAgICAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjenkgKz0gJ+Wnk+WQje+8micgKyBhLm5hbWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYS5tb2JpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjenkgKz0gKGN6eSA/ICc8YnIvPicgOiAnJykgKyAn55S16K+d77yaJyArIGEubW9iaWxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGEuUVEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjenkgKz0gKGN6eSA/ICc8YnIvPicgOiAnJykgKyAnUVHvvJonICsgYS5RUTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGN6eSA9ICcvJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gJzx0Ym9keT48dHI+PHRkIGNsYXNzPVwic2hvcnQtdGRcIiBjb2xzcGFuPVwiMTRcIj48L3RkPjwvdHI+PC90Ym9keT48dGJvZHkgY2xhc3M9XCJkYXRhLXRiZFwiPiA8dHI+IDx0ZD4nICsgKG8ub3JkZXJOdW0gfHwgJy8nKSArICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJyA8dGQgY2xhc3M9XCJmb250LWdcIj7lrqLmiLflhazlj7g8L3RkPiAnICtcclxuICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJmb250LWdcIj7mtbflhbPms6jlhoznvJbnoIE8L3RkPiA8dGQgY2xhc3M9XCJmb250LWdcIj7otbflp4vmuK88L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJyA8dGQgY2xhc3M9XCJmb250LWdcIj7nm67nmoTmuK88L3RkPiA8dGQgY2xhc3M9XCJmb250LWdcIj7oiKrnqbrlhazlj7g8L3RkPiAnICtcclxuICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJmb250LWdcIj7otbfpo57ml7bpl7Q8L3RkPiA8dGQgY2xhc3M9XCJmb250LWdcIj7mlbDph4/vvIhQQ1PvvIk8L3RkPiA8dGQgY2xhc3M9XCJmb250LWdcIj7ph43ph4/vvIhLR1PvvIk8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJyA8dGQgY2xhc3M9XCJmb250LWdcIj7kvZPnp6/vvIhDQk3vvIk8L3RkPiA8dGQgY2xhc3M9XCJmb250LWdcIj7lk4HlkI08L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZCByb3dzcGFuPVwiMlwiPicgKyBjenkgKyAnPC90ZD4gPHRkIHJvd3NwYW49XCIyXCI+PGEgY2xhc3M9XCJkLWZpbGVzXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBkYXRhLWlkPVwiJyArIG8ub3JkZXJJZCArICdcIiBkYXRhLXN1YmlkPVwiJyArIG8uc3ViTnVtICsgJ1wiPuS4i+i9veaKpeWFs+i1hOaWmTwvYT4gPGJyPiA8YSBjbGFzcz1cInUtZmlsZXNcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGRhdGEtaWQ9XCInICsgby5vcmRlcklkICsgJ1wiIGRhdGEtc3ViaWQ9XCInICsgby5zdWJOdW0gKyAnXCI+5LiK5Lyg5paH5Lu2PC9hPjwvdGQ+IDx0ZCByb3dzcGFuPVwiMlwiIGNsYXNzPVwiZm9udC1xXCI+PGEgZGF0YS1zdWJudW09XCInICsgby5zdWJOdW0gKyAnXCIgZGF0YS1pZD1cIicgKyBvLm9yZGVySWQgKyAnXCIgY2xhc3M9XCJzaG93LWJnXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj7pooTlrqHpgJrov4c8L2E+PC90ZD48L3RyPiAnICtcclxuICAgICAgICAgICAgICAgICc8dHI+PHRkPicgKyAoby5haXJ3YXlCaWxsTnVtIHx8ICcvJykgKyAoby5zdWJOdW0gPyAnPGJyLz5fJyArIG8uc3ViTnVtIDogJycpICsgJzwvdGQ+PHRkPicgKyAoYy5jb21wYW55TmFtZSB8fCAnLycpICsgJzwvdGQ+IDx0ZD4nICsgKGMucmVnaXN0ZXJDb2RlIHx8ICcvJykgKyAnPC90ZD4gPHRkPicgKyAoby5kZXB0Q29kZSB8fCAnLycpICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnIDx0ZD4nICsgKG8uZGVzdENvZGUgfHwgJy8nKSArICc8L3RkPiA8dGQ+JyArIChvLmFpckNvbXBhbnlDb2RlIHx8ICcvJykgKyAnPC90ZD4gJyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyBuZXcgRGF0ZShvLmZsaWdodERhdGUpLkZvcm1hdCgneXl5eS1NTS1kZCcpICsgJzwvdGQ+IDx0ZD4nICsgKG9bJ2NhcmdvJ10uY2FyZ29Db3VudCB8fCAnLycpICsgJzwvdGQ+ICcgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD4nICsgKG9bJ2NhcmdvJ10uY2FyZ29XZWlnaHQgfHwgJy8nKSArICc8L3RkPiA8dGQ+JyArIChvWydjYXJnbyddLmNhcmdvU2l6ZSB8fCAnLycpICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnIDx0ZD4nICsgKG9bJ2NhcmdvJ10uY2FyZ29OYW1lIHx8ICcvJykgKyAnPC90ZD4gPC90cj4gPC90Ym9keT4nXHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJCgnLm91dGVyLXRiJykuaHRtbChzdHIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbGlzdDogbGlzdFxyXG4gICAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cy5Eb20gPSBEb207IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQXVzZXIgb24gMjAxNy8zLzI4LlxyXG4gKi9cclxuXHJcbnZhciBnZW5lcmFsID0gcmVxdWlyZSgnLi4vLi4vZ2VuZXJhbC9nZW5lcmFsJykuZ2VuZXJhbDtcclxuZ2VuZXJhbC5ydW4oKTtcclxudmFyIExpc3RlbmVyID0gcmVxdWlyZSgnLi9saXN0ZW5lcicpLkxpc3RlbmVyO1xyXG5MaXN0ZW5lci5ydW4oKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNy8xLzUuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnJlcXVpcmUoJy4uLy4uL2dlbmVyYWwvYnVyc3RlcicpO1xyXG52YXIgdXJsID0gcmVxdWlyZSgnLi4vLi4vZ2VuZXJhbC9mdW5jdGlvbicpLnVybFxyXG4gICAgLCBNb2RhbCA9IHJlcXVpcmUoJy4uLy4uL2dlbmVyYWwvbW9kYWwnKTtcclxudmFyIERhdGEgPSByZXF1aXJlKCcuL2RhdGEnKS5EYXRhXHJcbiAgICAsIERvbSA9IHJlcXVpcmUoJy4vZG9tJykuRG9tO1xyXG52YXIgTGlzdCA9IHt9XHJcbiAgICAsIG9wZXJhdGVJZCwgc3ViTnVtYmVyO1xyXG52YXIgTGlzdGVuZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2xvc2UtYnRuJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5hbGVydC1wYXJ0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLm91dGVyLXBhZ2UgLnBhZ2VzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB1cmwuc2V0KCdvZmZzZXQnLCAkKHRoaXMpLmRhdGEoJ29mZnNldCcpKTtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjc2VhcmNoJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB1cmwuc2V0KCdvZmZzZXQnLCAwKTtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2hvdy1iZycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgb3BlcmF0ZUlkID0gJCh0aGlzKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICBzdWJOdW1iZXIgPSAkKHRoaXMpLmRhdGEoJ3N1Ym51bScpO1xyXG4gICAgICAgICAgICB2YXIgZCA9IExpc3Rbb3BlcmF0ZUlkXTtcclxuICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy5iZy1wYXJ0Jyk7XHJcbiAgICAgICAgICAgIHZhciBqY3p0ID0gJycsIGRjenQgPSAnJztcclxuICAgICAgICAgICAgc3dpdGNoIChkLm9yZGVyLmJvb2tpbmdTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgIGRjenQgPSAn5pyq6K6i6IixJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICBkY3p0ID0gJ+W3suiuouiIsSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIC0xOlxyXG4gICAgICAgICAgICAgICAgICAgIGRjenQgPSAn6K6i6Iix5aSx6LSlJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICBkY3p0ID0gJ+W3suaUuemFjSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3dpdGNoIChkLm9yZGVyLmVudHJ5U3RhdGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICBqY3p0ID0gJ+W+hei/m+S7kyc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgamN6dCA9ICflt7Lov5vku5MnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgIGpjenQgPSAn5bey56Gu6K6kJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmRkaCcpLmh0bWwoZC5vcmRlci5vcmRlck51bSk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcuZmRoJykuaHRtbChkLm9yZGVyLnN1Yk51bSk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcucXNnJykuaHRtbChkLm9yZGVyLmRlcHRDb2RlKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJy5tZGcnKS5odG1sKGQub3JkZXIuZGVzdENvZGUpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmhrZ3MnKS5odG1sKGQub3JkZXIuYWlyQ29tcGFueUNvZGUpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLnFmcnEnKS5odG1sKG5ldyBEYXRlKGQub3JkZXIuZmxpZ2h0RGF0ZSkuRm9ybWF0KCd5eXl5LU1NLWRkJykpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmpjenQnKS5odG1sKGpjenQpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmRjenQnKS5odG1sKGRjenQpO1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgIGVsZS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjYmctZW5zdXJlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIFwib3JkZXJJZFwiOm9wZXJhdGVJZCxcclxuICAgICAgICAgICAgICAgIFwic3ViTnVtXCI6IHN1Yk51bWJlcixcclxuICAgICAgICAgICAgICAgIFwiYWdlbnRJZFwiOiAwLFxyXG4gICAgICAgICAgICAgICAgXCJzdGF0ZVwiOiAkKCcjYy1iZ3p0JykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKClcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgRGF0YS5jaGFuZ2VTdGF0ZShkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn5pu05paw5oiQ5Yqf77yBJywgbnVsbCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+abtOaWsOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgZmlsZUxpc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy/lvoXliKDpmaTnmoTlhYPntKBcclxuICAgICAgICB2YXIgcmVtb3ZlRWxlO1xyXG4gICAgICAgIC8v57yT5a2Y5Yig6Zmk5YaF5a65XHJcbiAgICAgICAgdmFyIHJlbW92ZUZpbGUgPSB7XHJcbiAgICAgICAgICAgIFwib3JkZXJJZFwiOiAnJyxcclxuICAgICAgICAgICAgXCJrZXlOYW1lXCI6IDBcclxuICAgICAgICB9O1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2xvc2UtdGhpcycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuYWxlcnQtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJ2Eucm0tdHlwZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmVtb3ZlRmlsZVsnb3JkZXJJZCddID0gb3BlcmF0ZUlkO1xyXG4gICAgICAgICAgICByZW1vdmVGaWxlWydrZXlOYW1lJ10gPSAkKHRoaXMpLmRhdGEoJ2tleScpO1xyXG4gICAgICAgICAgICByZW1vdmVFbGUgPSAkKHRoaXMpLnBhcmVudHMoJy5hZGQtdHlwZScpO1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5yZW1vdmUtdHlwZS1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnYS5kbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSAkKHRoaXMpLmRhdGEoJ2tleScpO1xyXG4gICAgICAgICAgICBEYXRhLmRvd24oe2ZpbGU6IGZpbGV9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0JvZHknIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3Blbihqc29uLnJlc0JvZHkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmQtZmlsZXMnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIERhdGEub3JkZXJGaWxlKHtpZDogJCh0aGlzKS5kYXRhKCdpZCcpLHN1YklkIDokKHRoaXMpLmRhdGEoJ3N1YmlkJykgfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwICYmIGpzb24ucmVzQm9keSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXJyID0ganNvbi5yZXNCb2R5O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgaW4gYXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnIuaGFzT3duUHJvcGVydHkoYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYXJyW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuZmlsZVR5cGUgIT0gMjEgJiYgZC5maWxlVHlwZSAhPSAyMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChkLmZpbGVUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gJ+aKpeWFs+WNlSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSAn55Sz5oql6KaB57SgJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICfmiqXlhbPlj5HnpagnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gJ+ijheeuseWNlSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSAn5oql5YWz5aeU5omY5LmmJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9XCJ1cC1wYXJ0XCI+PHAgY2xhc3M9XCJtYWluLW5hbWVcIj4nICsgbmFtZSArICc8L3A+PGRpdiBjbGFzcz1cInRvcFwiPicgKyBkLmZpbGVFeHRlbnNpb24udG9VcHBlckNhc2UoKSArICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwiZGxcIiBkYXRhLWtleT1cIicgKyBkLmtleU5hbWUgKyAnXCI+PC9hPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PiA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwiZHAtYlwiPicgKyBkLmZpbGVOYW1lICsgJzwvYT4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICQoJy5iaC1wYXJ0IC5maWxlLWJvZHkgLmRwLXRiJykuaHRtbChzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcuYmgtcGFydCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudS1maWxlcycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHN0ciA9ICcgPGRpdiBjbGFzcz1cImFkZC10eXBlXCIgZGF0YS10eXBlPVwiMjFcIj4gPGRpdiBjbGFzcz1cInRvcFwiPiArIDwvZGl2PiA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwiZHAtYiBmLW5hbWVcIiBkYXRhLW5hbWU9XCLpooTlvZXljZVcIj7pooTlvZXljZU8L2E+IDxpbnB1dCB0eXBlPVwiZmlsZVwiIGNsYXNzPVwidXAtdHlwZVwiIGRhdGEtdHlwZT1cIjIxXCIvPiA8L2Rpdj4gPGRpdiBjbGFzcz1cImFkZC10eXBlXCIgZGF0YS10eXBlPVwiMjJcIj4gPGRpdiBjbGFzcz1cInRvcFwiPiArIDwvZGl2PiA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwiZHAtYiBmLW5hbWVcIiBkYXRhLW5hbWU9XCLmn6XpqozotLnnlKjmuIXljZVcIj7mn6XpqozotLnnlKjmuIXljZU8L2E+IDxpbnB1dCB0eXBlPVwiZmlsZVwiIGNsYXNzPVwidXAtdHlwZVwiIGRhdGEtdHlwZT1cIjIyXCIvPiA8L2Rpdj4nO1xyXG4gICAgICAgICAgICAkKCcudXBGaWxlLXBhcnQgLmZpbGUtYm9keScpLmZpbmQoJy5kcC10YicpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgb3BlcmF0ZUlkID0gJCh0aGlzKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICBzdWJOdW1iZXIgPSQodGhpcykuZGF0YSgnc3ViaWQnKTtcclxuICAgICAgICAgICAgRGF0YS5vcmRlckZpbGUoe2lkOiAkKHRoaXMpLmRhdGEoJ2lkJyksc3ViSWQgOiQodGhpcykuZGF0YSgnc3ViaWQnKX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCAmJiBqc29uLnJlc0JvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFyciA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGFyclthXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmZpbGVUeXBlID09IDIxIHx8IGQuZmlsZVR5cGUgPT0gMjIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlID0gJCgnLmFkZC10eXBlW2RhdGEtdHlwZT0nICsgZC5maWxlVHlwZSArICddJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGUuZmluZCgnaW5wdXQnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmZpbmQoJy50b3AnKS5odG1sKGQuZmlsZUV4dGVuc2lvbi50b1VwcGVyQ2FzZSgpICsgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkbFwiIGRhdGEta2V5PVwiJyArIGQua2V5TmFtZSArICdcIj48L2E+IDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJybS10eXBlXCIgZGF0YS1rZXk9XCInICsgZC5rZXlOYW1lICsgJ1wiPjwvYT4gJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmZpbmQoJy5mLW5hbWUnKS5odG1sKGQuZmlsZU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcudXBGaWxlLXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2hhbmdlJywgJy51cC10eXBlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJyID0gWydkb2MnLCAnZG9jeCcsICd4bHMnLCAneGxzeCcsICdwZGYnLCAnanBnJywgJ3BuZycsICdibXAnXTtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdXHJcbiAgICAgICAgICAgICAgICAsIHNpemUgPSB0aGlzLmZpbGVzWzBdLnNpemVcclxuICAgICAgICAgICAgICAgICwgbmFtZSA9IHRoaXMuZmlsZXNbMF0ubmFtZTtcclxuICAgICAgICAgICAgdmFyIG5hID0gbmFtZS5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICBpZiAoYXJyLmluZGV4T2YobmFbbmEubGVuZ3RoIC0gMV0pID49IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChzaXplIDwgMjA5NzE1Mikge1xyXG4gICAgICAgICAgICAgICAgICAgIERhdGEudXAoe1wiZmlsZVwiOiBuYW1lfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW4gPSBqc29uLnJlc0JvZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhLm9zc1VwbG9hZCh0b2tlbiwgZmlsZSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiAnc3RhdHVzJyBpbiBkYXRhICYmIGRhdGEuc3RhdHVzID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib3JkZXJJZFwiOiBvcGVyYXRlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVwiOiBzdWJOdW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGVOYW1lXCI6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGVDb21tZW50XCI6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlOYW1lXCI6IHRva2VuLktleW5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgXCJmaWxlVHlwZVwiOiBfdGhpcy5kYXRhKCd0eXBlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YS5hZGRGaWxlKGQsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCAmJiBqc29uLnJlc0JvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlID0gX3RoaXMucGFyZW50cygnLmFkZC10eXBlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9IGQuZmlsZUV4dGVuc2lvbi50b1VwcGVyQ2FzZSgpICsgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkbFwiIGRhdGEta2V5PVwiJyArIGQua2V5TmFtZSArICdcIj48L2E+IDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJybS10eXBlXCIgZGF0YS1rZXk9XCInICsgZC5rZXlOYW1lICsgJ1wiPjwvYT4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGUuZmluZCgnLnRvcCcpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGUuZmluZCgnLmYtbmFtZScpLmh0bWwoZC5maWxlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmZpbmQoJ2lucHV0JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5LiK5Lyg5aSx6LSl77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmgqjkuIrkvKDnmoTmlofku7botoXov4cyTe+8geivt+mHjeaWsOmAieaLqeOAgicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aWh+S7tuagvOW8j+aUr+aMgS5kb2MvLmRvY3gvLnhscy8ueGxzeC8ucGRmLy5qcGcvLnBuZy8uYm1wJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3JlbW92ZS10eXBlLWVuc3VyZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgRGF0YS5yZW1vdmVGaWxlKHJlbW92ZUZpbGUsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUVsZS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRWxlLmZpbmQoJy50b3AnKS5odG1sKCcrJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSByZW1vdmVFbGUuZmluZCgnLmYtbmFtZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuaHRtbChhLmRhdGEoJ25hbWUnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRWxlLmZpbmQoJ2lucHV0Jykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5yZW1vdmUtdHlwZS1wYXJ0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+WIoOmZpOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgb2Zmc2V0OiB1cmwuZ2V0KCdvZmZzZXQnKSB8fCAwXHJcbiAgICAgICAgICAgICwgbGltaXQ6IHVybC5nZXQoJ2xpbWl0JykgfHwgMjBcclxuICAgICAgICAgICAgLCBhZ2VudENvbXBhbnlJZDogMFxyXG4gICAgICAgICAgICAsIG51bWJlcjogJCgnI29yZGVyLW51bScpLnZhbCgpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBEYXRhLmxpc3QoZGF0YSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgRG9tLmxpc3QoanNvbiwgZGF0YSk7XHJcbiAgICAgICAgICAgIHZhciBkdCA9IHt9O1xyXG4gICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCAmJiBqc29uLnJlc0JvZHkgJiYganNvbi5yZXNCb2R5LnNMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0ganNvbi5yZXNCb2R5LnNMaXN0O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbCBpbiBsaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3QuaGFzT3duUHJvcGVydHkobCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBsaXN0W2xdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkdFtkLm9yZGVyLm9yZGVySWRdID0gZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgTGlzdCA9IGR0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGlzdGVuZXIoKTtcclxuICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgZmlsZUxpc3QoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJ1bjogcnVuXHJcbiAgICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzLkxpc3RlbmVyID0gTGlzdGVuZXI7Il19
