(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * Created by Auser on 2016/12/6.
 */
"use strict";
var Data = (function () {
  var list = function (callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/price/list'
      , type: 'post'
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var add = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/price/add'
      , type: 'post'
      , dataType: 'json'
      , data: data
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var del = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/price/del'
      , type: 'post'
      , dataType: 'json'
      , data: data
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var def = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/price/def'
      , type: 'post'
      , dataType: 'json'
      , data: data
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var detail = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/price/detail'
      , type: 'post'
      , dataType: 'json'
      , data: data
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var update = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/price/update'
      , type: 'post'
      , dataType: 'json'
      , data: data
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  return {
    list: list
    , add: add
    , del: del
    , def: def
    , detail: detail
    , update: update
  }
}());
module.exports.Data = Data;
},{}],2:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/2/6.
 */
'use strict';
var Dom = (function () {
  var list = function (json) {
    var str = '';
    var dStr = '<div class="sg-modal add-modal"> <p class="add-p"> <a href="javascript:void(0);" id="add">+添加新模板</a> </p> </div>';
    if (json && json.resCode == 0 && 'resBody' in json && json.resBody && 'sList' in json.resBody && json.resBody.sList instanceof Array) {
      if (json.resBody.sList.length > 0) {
        var arr = json.resBody.sList;
        for (var a in arr) {
          if (arr.hasOwnProperty(a)) {
            var d = arr[a];
            if (d.expenseDefault) {
              dStr += render(d);
            } else {
              str += render(d);
            }
          }
        }
        $('.list-cout').html('<strong>费用模板</strong>现有 ' + (arr.length ) + ' 个费用模板');
      } else {
        str = '<div class="wrong">暂无模板，请添加！</div>';
        $('.list-cout').html('<strong>费用模板</strong>现有 0 个费用模板');
      }
    } else {
      str = '<div class="wrong">请求出错，<a href="">请重试</a>！</div>';
      $('.list-cout').html('<strong>费用模板</strong>现有 0 个费用模板');
    }
    function render(d) {
      var str = '';
      for (var e in d.expenseTemplate) {
        if (d.expenseTemplate.hasOwnProperty(e)) {
          var dt = d.expenseTemplate[e];
          str += '<div class="price-info"> <span class="title">' + dt.itemName + '：</span> <span class="info">CNY ' + dt.itemPrice.toFixed(2) + '</span> </div>';
        }
      }
      return '<div class="sg-modal' + (d.expenseDefault ? ' active' : '') + '"> <p class="sg-header">' + d.expenseName + '</p> ' +
        '<div class="sg-body">' + str + '</div> <div class="sg-foot"> <div class="dp-tb">' +
        ' <a href="javascript:void(0);" class="set-editor" data-id="' + d.templateId + '">编辑</a> ' +
        '<a href="javascript:void(0);" class="set-remove" data-id="' + d.templateId + '">删除</a> ' +
        (d.expenseDefault ? '' : '<a href="javascript:void(0);" class="set-default" data-id="' + d.templateId + '">设为默认</a>' ) +
        '</div> </div> </div>'
    }

    $('.not-default').html(str);
    $('.default').html(dStr);
  };
  var setDetail = function (json) {
    var d = json.resBody, str = '';
    $('#e-name').val(d.expenseName);
    $('#editor-ensure').data('id', d.templateId);
    for (var e in d.expenseTemplate) {
      if (d.expenseTemplate.hasOwnProperty(e)) {
        var dt = d.expenseTemplate[e], unit;
        switch (dt.itemUnit) {
          case 1:
            unit = '/票';
            break;
          case 2:
            unit = '/KG';
            break;
          case 3:
            unit = '/m³';
            break;
          case 4:
            unit = '/件';
            break;
          default:
            unit = '/票';
            break;
        }
        str += '<tr> <td>' + (dt.itemName == '报关费' ? '' : '<input type="checkbox" class="inner-sg"/>') + '</td> <td><input ' + (dt.itemName == '报关费' ? 'readonly' : '') + ' type="text" class="ip-name" value="' + dt.itemName + '"/></td> ' +
        '<td><input type="text" class="ip-price" value="CNY ' + dt.itemPrice.toFixed(2) + '" /></td>' +
        ' <td><input type="text" class="sg-must" readonly value="' + (dt.itemOption ? '费用' : '杂费') + '">' + (dt.itemName == '报关费' ? '' : '<ul class="fill show-unit dp-n"><li>费用</li><li>杂费</li></ul>') + '</td> <td> ' +
        '<input type="text" class="ip-unit" readonly value="' + unit + '"/> ' +
        (dt.itemName == '报关费' ? '' : '<ul class="fill show-unit dp-n"><li>/票</li> <li>/KG</li> <li>/m³</li> <li>/件</li> </ul>') +
        '</td> <td><input type="text" class="ip-remark" value="' + dt.itemRemark + '"/></td> </tr>';
      }
    }
    $('.editor-modal').find('tbody').html(str);
    $('.white-back').removeClass('dp-n');
    $('.editor-modal').removeClass('dp-n');
  };
  return {
    list: list
    , setDetail: setDetail
  }
}());
module.exports.Dom = Dom;
},{}],3:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/4.
 */
'use strict';
var Listener = require('./listener').Listener;
var general = require('../../general/general').general;
general.run();
Listener.run();
},{"../../general/general":6,"./listener":4}],4:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/5.
 */
'use strict';
var Data = require('./data').Data
  , Dom = require('./dom').Dom
  , url = require('../../general/function').url
  , Modal = require('../../general/modal');
var Listener = (function () {
  var listener = function () {
    $(document).on('click', '.close-btn', function () {
      $('.alert-part').addClass('dp-n');
      $('.white-back').addClass('dp-n');
    });
    $(document).on('focus', 'input', function () {
      $(this).select();
    });
    $(document).on('blur', '.ip-price', function () {
      var value = $(this).val() || '0';
      value = value.replace(/[^\d.]/g, '');
      $(this).val('CNY ' + parseFloat(value).toFixed(2));
    });
    $(document).on('keyup', '.ip-price', function () {
      $(this).val($(this).val().replace(/[^\d.]/g, ""));
    });
    $(document).on('click', '.ip-unit,.sg-must', function () {
      $('.show-unit').addClass('dp-n');
      $(this).siblings('ul').removeClass('dp-n');
    });
    $(document).on('click', '.show-unit li', function () {
      $(this).parent().siblings('input').val($(this).text());
      $(this).parent().addClass('dp-n');
    });
    $(document).on('click', function (e) {
      var target = $(e.target);
      if (target.closest('.show-unit,.ip-unit,.sg-must').length == 0) {
        $('.show-unit').addClass('dp-n');
      }
    });
    $(document).on('click', '#add', function () {
      var str = '<tr> <td></td> <td><input type="text" class="ip-name" value="报关费" readonly/></td> ' +
        '<td><input type="text" class="ip-price" value="CNY 0.00" /></td>' +
        ' <td><input type="text" class="sg-must" readonly value="费用"/></td> <td> ' +
        '<input type="text" class="ip-unit" readonly value="/票"/></td> <td><input type="text" class="ip-remark"/></td> </tr>';
      $('#name').val('');
      $('.add-modal').find('tbody').html(str);
      $('.add-modal').removeClass('dp-n');
      $('.white-back').removeClass('dp-n');
    });
    $(document).on('click', '.inner-add', function () {
      var str = '<tr> <td><input type="checkbox" class="inner-sg"/></td> <td><input type="text" class="ip-name"/></td> ' +
        '<td><input type="text" class="ip-price" value="CNY 0.00" /></td>' +
        ' <td><input type="text" class="sg-must" readonly/><ul class="fill show-unit dp-n"><li>费用</li><li>杂费</li></ul></td> <td> ' +
        '<input type="text" class="ip-unit" readonly value="/票"/> <ul class="fill show-unit dp-n"> ' +
        '<li>/票</li> <li>/KG</li> <li>/m³</li> <li>/件</li> </ul> </td> <td><input type="text" class="ip-remark"/></td> </tr>';
      $(this).parents('.alert-part').find('tbody').append(str);
    });
    $(document).on('click', '.inner-remove', function () {
      $(this).parents('.alert-part').find('.inner-sg').each(function () {
        if ($(this).prop('checked')) {
          $(this).parents('tr').remove();
        }
      });
    });
    $(document).on('click', '#add-ensure', function () {
      var pass = true;
      if ($('#a-name').val()) {
        $('#a-name').removeClass('warm');
      } else {
        $('#a-name').addClass('warm');
        pass = false;
      }
      $('.add-modal').find('.ip-name').each(function () {
        if (!$(this).val()) {
          $(this).addClass('warm');
          pass = false;
        } else {
          $(this).removeClass('warm');
        }
      });
      $('.add-modal').find('.ip-price').each(function () {
        var value = $(this).val().replace(/[^\d.]/g, '');
        if (parseFloat(value) <= 0) {
          $(this).addClass('warm');
          pass = false;
        } else {
          $(this).removeClass('warm');
        }
      });
      if (pass) {
        var data = {
          "expenseName": $('#a-name').val(),
          "expenseTemplate": [],
          "companyId": 0
        };
        var ele = $('.add-modal').find('tbody').find('tr');
        ele.each(function () {
          var unit
            , price = $(this).find('.ip-price').val().replace(/[^\d.]/g, '');
          switch ($(this).find('.ip-unit').val()) {
            case '/票':
              unit = 1;
              break;
            case '/KG':
              unit = 2;
              break;
            case '/m³':
              unit = 3;
              break;
            case '/件':
              unit = 4;
              break;
            default:
              unit = 1;
              break;
          }
          var d = {
            "itemName": $(this).find('.ip-name').val(),
            "itemPrice": price,
            "itemUnit": unit,
            "itemOption": $(this).find('.sg-must').val() == '费用',
            "itemRemark": $(this).find('.ip-remark').val()
          };
          data['expenseTemplate'].push(d);
        });
        Data.add(data, function (json) {
          if (json && 'resCode' in json && json.resCode == 0) {
            Modal.setAlert(json.resMsg || '添加成功！', null, function () {
              location.reload();
            });
          } else {
            Modal.setAlert(json.resMsg || '添加失败，请重试！');
          }
        });
      }
    });
    $(document).on('click', '.set-remove', function () {
      $('#delete-ensure').data('id', $(this).data('id'));
      $('.white-back').removeClass('dp-n');
      $('.delete-part').removeClass('dp-n');
    });
    $(document).on('click', '.set-default', function () {
      $('#default-ensure').data('id', $(this).data('id'));
      $('.white-back').removeClass('dp-n');
      $('.default-part').removeClass('dp-n');
    });
    $(document).on('click', '.set-editor', function () {
      Data.detail({id: $(this).data('id')}, function (json) {
        if (json && 'resCode' in json && json.resCode == 0) {
          Dom.setDetail(json);
        } else {
          Modal.setAlert(json.resMsg || '获取详情失败，请重试！');
        }
      });
    });
    $(document).on('click', '#delete-ensure', function () {
      Data.del({templateId: $(this).data('id')}, function (json) {
        if (json && 'resCode' in json && json.resCode == 0) {
          Modal.setAlert(json.resMsg || '删除成功！', null, function () {
            location.reload();
          });
        } else {
          Modal.setAlert(json.resMsg || '删除失败，请重试！');
        }
      });
    });
    $(document).on('click', '#default-ensure', function () {
      Data.def({templateId: $(this).data('id')}, function (json) {
        if (json && 'resCode' in json && json.resCode == 0) {
          Modal.setAlert(json.resMsg || '设置成功！', null, function () {
            location.reload();
          });
        } else {
          Modal.setAlert(json.resMsg || '设置失败，请重试！');
        }
      });
    });
    $(document).on('click', '#editor-ensure', function () {
      var pass = true;
      if ($('#e-name').val()) {
        $('#e-name').removeClass('warm');
      } else {
        $('#e-name').addClass('warm');
        pass = false;
      }
      $('.editor-modal').find('.ip-name').each(function () {
        if (!$(this).val()) {
          $(this).addClass('warm');
          pass = false;
        } else {
          $(this).removeClass('warm');
        }
      });
      $('.editor-modal').find('.ip-price').each(function () {
        var value = $(this).val().replace(/[^\d.]/g, '');
        if (parseFloat(value) <= 0) {
          $(this).addClass('warm');
          pass = false;
        } else {
          $(this).removeClass('warm');
        }
      });
      if (pass) {
        var data = {
          "expenseName": $('#e-name').val(),
          "expenseTemplate": [],
          "companyId": 0,
          "templateId": $(this).data('id'),
          "expenseState": 1
        };
        var ele = $('.editor-modal').find('tbody').find('tr');
        ele.each(function () {
          var unit
            , price = $(this).find('.ip-price').val().replace(/[^\d.]/g, '');
          switch ($(this).find('.ip-unit').val()) {
            case '/票':
              unit = 1;
              break;
            case '/KG':
              unit = 2;
              break;
            case '/m³':
              unit = 3;
              break;
            case '/件':
              unit = 4;
              break;
            default:
              unit = 1;
              break;
          }
          var d = {
            "itemName": $(this).find('.ip-name').val(),
            "itemPrice": price,
            "itemUnit": unit,
            "itemOption": $(this).find('.sg-must').val() == '费用',
            "itemRemark": $(this).find('.ip-remark').val()
          };
          data['expenseTemplate'].push(d);
        });
        Data.update(data, function (json) {
          if (json && 'resCode' in json && json.resCode == 0) {
            Modal.setAlert(json.resMsg || '编辑成功！', null, function () {
              location.reload();
            });
          } else {
            Modal.setAlert(json.resMsg || '编辑失败，请重试！');
          }
        });
      }
    });
    $(document).on('click', '#refresh', function () {
      init();
    });
  };
  var init = function () {
    Data.list(function (json) {
      Dom.list(json);
    });
  };
  var run = function () {
    listener();
    init();
  };
  return {
    run: run
  }
}());
module.exports.Listener = Listener;
},{"../../general/function":5,"../../general/modal":7,"./data":1,"./dom":2}],5:[function(require,module,exports){
/**
 * Created by zrz on 2016/2/26.
 * @version 1.0.0 created 通用性功能方法
 */

'use strict';

var Fun = (function () {
    var _timeOut = 100000;//请求超时时间为10s
    /**
     * 封装ajax
     * @param option
     * {
     *      url:"请求的地址"
     *      ,method:"请求的方法"
     *      ,async:"是否并发"
     *      ,data:"发送的数据"
     *      ,success:"成功时回调"
     *      ,error:"失败/超时时回调"
     *      ,timeout:"超时时间"
     *      ,complete:"完成后的回调"
     * }
     */
    var ajax = function (option) {
        //ajax开始时应显示“加载信息框”
        Modal.showLoading();
        $.ajax({
            url: option.url
            , type: "type" in option && option.type || "GET"
            , timeout: option.timeout || _timeOut
            , data: "data" in option && option.data || {}
            , dataType: "json"
            , async: ("async" in option && option.async) ? true : false
            , success: function (json) {
                if ("status" in json && json.status > 0 && "data" in json) {
                    if ("success" in option) {
                        option.success(json.data);
                    } else {
                        Modal.setAlert("无success方法!");
                    }
                } else if ("error" in option && option.error instanceof Function) {
                    option.error(json);
                } else {
                    Modal.setAlert('操作失败!');
                }
            }, error: function (xhr) {//404或者超时
                if ("error" in option && option.error instanceof Function) {
                    //提示用户错误信息
                    Modal.showLoading(false);
                    Modal.setAlert("连接服务器失败，状态：" + (xhr.status || -1) + ",信息：" + (xhr.statusText || "-"));
                    option.error(xhr.status, xhr.statusText);//回调请求的状态和错误信息
                }
            }, complete: function (xhr, type) {
                //关闭“加载信息框”
                Modal.showLoading(false);
                if ("complete" in option && option.complete instanceof Function) {
                    option.complete(xhr, type);//回调请求的xhr信息和类型
                }
            }
        });
    };
    //全选和单选的绑定
    var setCheckboxListener = function (allCheck, radioChecks) {
        //筛选单选按钮组
        var radioValueEles = $(radioChecks);
        //点击全选时，同组按钮被同步
        $(document).delegate(allCheck, "click", function () {
            if (radioValueEles && radioValueEles.length > 0) {
                for (var _r = 0; _r < radioValueEles.length; _r++) {
                    radioValueEles[_r].checked = $(this).is(":checked");
                }
            }
        });
        //点击单选按钮时，
        $(document).delegate(radioChecks, "click", function () {
            $(allCheck)[0].checked = $(radioChecks + ":checked").length == $(radioChecks).length;
        });
    };
    var url = (function () {
        var get = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURI(r[2]);
            return null;
        };
        /**
         * 根据参数列表长度进行判断，兼容IE9
         * @returns {string}
         */
        var set = function () {
            if (arguments.length === 1 && typeof arguments[0] === 'object') {//一个对象，使用key标记value
                var obj = arguments[0]
                    , search = location.search;
                for (var o in obj) {
                    if (obj.hasOwnProperty(o)) {
                        search = changeURLKeyValue(search, o, obj[o]);
                    }
                }
                if ('pushState' in history) {
                    history.pushState(null, document.title, search);
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, search);//返回重新构造后search串
                }
            } else if (arguments.length === 2) {//key+value
                var key = arguments[0]
                    , value = arguments[1];
                if ('pushState' in history) {
                    history.pushState(null, document.title, changeURLKeyValue(location.toString(), key, value));
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, changeURLKeyValue(location.search, key, value));//返回重新构造后search串
                }
            }
            function changeURLKeyValue(url, arg, arg_val) {
                var pattern = arg + '=([^&]*)';
                var replaceText = arg + '=' + arg_val;
                if (url.match(pattern)) {
                    var tmp = '/(' + arg + '=)([^&]*)/gi';
                    tmp = url.replace(eval(tmp), replaceText);
                    return tmp;
                } else {
                    if (url.match('[\?]')) {
                        return url + '&' + replaceText;
                    } else {
                        return url + '?' + replaceText;
                    }
                }
            }
        };
        return {
            get: get
            , set: set
        }
    }());
    var formatImage=function (path, size, ele) {
        if(path instanceof  Array && path.length>0){
            path = path[0];
        }
        var IMAGE_SIZE = {
            original: {
                path: "",
                size: ""
            },
            xlarge: {
                path: "_xlarge",
                size: "660*660"
            },
            large: {
                path: "_large",
                size: "420*420"
            },
            middle: {
                path: "_middle",
                size: "300*300"
            },
            small: {
                path: "_small",
                size: "240*240"
            },
            little: {
                path: "_little",
                size: "120*120"
            },
            micro: {
                path: "_micro",
                size: "60*60"
            }
        };
        size = IMAGE_SIZE[size || "middle"] || IMAGE_SIZE.middle;
        var pathTemp = /\.\w+?$/.exec(path);
        if (!pathTemp) {
            path += size.path;
        } else {
            path = (path.substr(0, pathTemp.index || path.length)) + size.path + pathTemp[0];
        }
        if (ele && ele.attr) {
            ele.attr("src", path);
        }
        return path;
    };
    return {
        ajax: ajax
        , getTimtout: _timeOut
        , setCheckboxListener: setCheckboxListener
        , url: url
        , formatImage: formatImage
    }
}());

exports.ajax = Fun.ajax;
exports.getTimeout = Fun.getTimtout;
exports.setCheckboxListener = Fun.setCheckboxListener;
exports.url = Fun.url;
exports.formatImage = Fun.formatImage;

},{}],6:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/23.
 */
'use strict';
var Modal = require('./modal');
var general = (function () {
    var run = function () {
        //时间格式化
        Date.prototype.Format = function (fmt) { //author: Jeremyyy
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        };

        //修改密码
        $(document).on('click', '#change-pwd', function () {
            $('.change-back').removeClass('dp-n');
            $('.change-pwd').removeClass('dp-n');
        });
        //关闭修改密码
        $(document).on('click', '.close-pwd', function () {
            $('.change-back').addClass('dp-n');
            $('.change-pwd').addClass('dp-n');
        });
        $(document).on('click', '#ensure-pwd', function () {
            if ($('#new-password').val() != $('#ensure-password').val()) {
                $('#ensure-password').addClass('warm');
            } else {
                $('#ensure-password').removeClass('warm');
                var data = {
                    "agentMemberId": 0,
                    "oldPwd": $('#password').val(),
                    "pwd": $('#new-password').val(),
                    "pwdConfirm": $('#ensure-password').val()
                };
                $.ajax({
                    url: '/api/account/changePwd'
                    , type: 'post'
                    , data: data
                    , dataType: 'json'
                    , timeout: 100000
                    , success: function (json) {
                        if (json && 'resCode' in json && json.resCode == 0) {
                            Modal.setAlert('修改成功！', null, function () {
                                $('.change-back').addClass('dp-n');
                                $('.change-pwd').addClass('dp-n');
                            });
                        } else {
                            Modal.setAlert(json.resMsg || '修改失败，请重试！');
                        }
                    }
                });
            }
        });
    };
    return {
        run: run
    }
}());
module.exports.general = general;
},{"./modal":7}],7:[function(require,module,exports){
/**
 * Created by zrz on 2016/2/24.
 * @version 1.0.0 created
 */

'use strict';

//构造信息框主体
var Modal = (function () {
    //构造原始类
    function M(m) {
        this.s = m.s;//是否显示
        this.id = m.id;
    }

    //构造标准show方法，用于继承
    M.prototype.show = function () {
        var ele = document.getElementById(this.id);
        if (ele) {
            if (this.s && !isShow()) {//显示当前隐藏
                ele.className = ele.className.replace("dp-n", "");
            } else if (!this.s && isShow()) {//隐藏当前显示
                ele.className += " dp-n";
            }
            //去除两边的空格
            ele.className = String(ele.className).trim();
        }
        function isShow() {//是否已显示，无class时显示
            return ele.className.split("dp-n").length == 1;
        }
    };

    //加载信息框
    var loading = (function () {
        //初始化生成加载信息框
        var init = function () {
            if (!document.getElementById("loading_modal_element")) {
                $('body').append('<div id="loading_modal_element" class="loading-modal-body dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="loading-modal-image"></div>' +
                    '<div class="loading-modal-text">' +
                    '<h2>玩命加载中……</h2>' +
                    '</div></div>');
            }
            return false;
        };
        //显示、隐藏信息框
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;//无参数显示信息框
            var m = new M({id: "loading_modal_element", s: s});
            m.show();
        };
        return {
            init: init
            , show: show
        }
    }());
    //弹出信息框
    var alert = (function () {
        var init = function () {
            if (!document.getElementById("alert_modal_element")) {
                $('body').append('<div id="alert_modal_element" class="alert-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="alert-modal-content">' +
                    '<div class="alert-modal-body"><span class="alert-modal-text"></span></div>' +
                    '<div class="alert-modal-footer"><button id="alert_modal_close" class="alert-modal-button">关闭</button></div>' +
                    '</div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "alert_modal_element", s: s});
            m.show();
        };
        /**
         * 设置弹出信息框
         * @param msg       显示的信息，支持html
         * @param sed       倒计时关闭时间，单位：second
         * @param callback  关闭触发回调函数
         */
        var set = function (msg, sed, callback) {
            var ele = document.getElementById("alert_modal_element");
            if (msg) {
                if (typeof msg === 'object') {//应对后端返回提示时使用Object封装
                    msg = JSON.stringify(msg);
                }
                if(ele){
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }else{
                    init();
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }
                show();
            }
            if (sed > 0) {
                setTimeout(function () {
                    show(false);
                }, 1000 * sed);
            }//无关闭时间或者关闭时间为0，不自动关闭
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#alert_modal_close").on("click", function () {
                if (callback && callback instanceof Function) {
                    callback();
                }
                show(false);
                //阻止事件继续传递
                return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //选择信息框
    var confirm = (function () {
        var init = function () {
            if (!document.getElementById("confirm_modal_element")) {
                $('body').append('<div id="confirm_modal_element" class="confirm-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="confirm-modal-content">' +
                    '<div id="confirm_modal_header" class="confirm-modal-header dp-n"></div>' +
                    '<div class="confirm-modal-body"><span id="confirm_modal_text" class="confirm-modal-text"></span></div>' +
                    '<div class="confirm-modal-footer">' +
                    '<div class="footer-button-success"><button class="confirm-modal-button  modal-success" data-confirm="success">确认</button></div>' +
                    '<div class="footer-button-false"><button class="confirm-modal-button" data-confirm="error">取消</button></div>' +
                    '</div></div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "confirm_modal_element", s: s});
            m.show();
        };
        /**
         * 设置选择信息框的内容
         * @param option    配置
         * {
         *      title:"头部显示的信息"
         *      ,text:"显示的提示信息"
         *      ,success:"点击成功后的回调"
         *      ,error:"点击失败后的回调"
         *      ,complete:"点击按钮后的整体回调"
         * }
         */
        var bar = 0;
        var set = function (option) {
            if (!option) {
                return false;
            }
            if ("title" in option && option.title.length > 0) {//有头部，则显示头部
                document.getElementById("confirm_modal_header").innerHTML = option.title;
            }
            if ("text" in option && option.text.length > 0) {//有内容，则显示整个选择信息框
                document.getElementById("confirm_modal_text").innerHTML = option.text;
            }
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#confirm_modal_element").find(".confirm-modal-button").off("click").on("click", function () {
                //fixme .off("click")用于防止多次触发<--很玄学，我也不知道为什么，但是请不要修改。
                var atr = $(this).attr("data-confirm");//选择的按钮
                bar++;
                if (option && atr in option && option[atr] instanceof Function) {
                    option[atr]();
                }
                if (option && "complete" in option && option.complete instanceof Function) {
                    option.complete();//若有完成函数，则执行
                } else {//否则，关闭选择框
                    show(false);
                }
                //阻止事件继续传递
                //return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //覆盖层
    var cover = (function () {
        var init = function () {
            if (!document.getElementById("cover_modal_element")) {
                $('body').append('<div id="cover_modal_element" class="cover-modal-element dp-n"></div>');
            }
            return false;
        };
        var hide = function () {
            document.getElementById("cover_modal_element").style.display = "none";
        };
        var show = function () {
            document.getElementById("cover_modal_element").style.display = "block";
        };
        return {
            init: init
            , show: show
            , hide: hide
        }
    }());
    return {
        initLoading: loading.init
        , showLoading: loading.show

        , initAlert: alert.init
        , showAlert: alert.show
        , setAlert: alert.set

        , initConfirm: confirm.init
        , setConfirm: confirm.set
        , showConfirm: confirm.show
        , initCover: cover.init
    }
}());

//页面加载完毕后生成四个自定义模态框
setTimeout(function () {
    //页面加载时生成一个覆盖层
    Modal.initCover();
    //页面加载时生成一个加载信息框
    Modal.initLoading();
    //页面加载时生成一个弹出信息框
    Modal.initAlert();
    //页面加载时生成一个选择信息框
    Modal.initConfirm();
}, 100);


//抛出上层调用
exports.showLoading = Modal.showLoading;
exports.setAlert = Modal.setAlert;
exports.showAlert = Modal.showAlert;
exports.setConfirm = Modal.setConfirm;
exports.showConfirm = Modal.showConfirm;
},{}]},{},[3])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6L252bS92Ni4yLjAvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImRhdGEuanMiLCJkb20uanMiLCJpbmRleC5qcyIsImxpc3RlbmVyLmpzIiwiLi4vLi4vZ2VuZXJhbC9mdW5jdGlvbi5qcyIsIi4uLy4uL2dlbmVyYWwvZ2VuZXJhbC5qcyIsIi4uLy4uL2dlbmVyYWwvbW9kYWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQXVzZXIgb24gMjAxNi8xMi82LlxyXG4gKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBEYXRhID0gKGZ1bmN0aW9uICgpIHtcclxuICB2YXIgbGlzdCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICB1cmw6ICcvYXBpL2FpcmxpbmUvcHJpY2UvbGlzdCdcclxuICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9O1xyXG4gIHZhciBhZGQgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgJC5hamF4KHtcclxuICAgICAgdXJsOiAnL2FwaS9haXJsaW5lL3ByaWNlL2FkZCdcclxuICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfTtcclxuICB2YXIgZGVsID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICQuYWpheCh7XHJcbiAgICAgIHVybDogJy9hcGkvYWlybGluZS9wcmljZS9kZWwnXHJcbiAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcbiAgdmFyIGRlZiA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICB1cmw6ICcvYXBpL2FpcmxpbmUvcHJpY2UvZGVmJ1xyXG4gICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9O1xyXG4gIHZhciBkZXRhaWwgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgJC5hamF4KHtcclxuICAgICAgdXJsOiAnL2FwaS9haXJsaW5lL3ByaWNlL2RldGFpbCdcclxuICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfTtcclxuICB2YXIgdXBkYXRlID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICQuYWpheCh7XHJcbiAgICAgIHVybDogJy9hcGkvYWlybGluZS9wcmljZS91cGRhdGUnXHJcbiAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcbiAgcmV0dXJuIHtcclxuICAgIGxpc3Q6IGxpc3RcclxuICAgICwgYWRkOiBhZGRcclxuICAgICwgZGVsOiBkZWxcclxuICAgICwgZGVmOiBkZWZcclxuICAgICwgZGV0YWlsOiBkZXRhaWxcclxuICAgICwgdXBkYXRlOiB1cGRhdGVcclxuICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzLkRhdGEgPSBEYXRhOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEplcmVteSBvbiAyMDE3LzIvNi5cclxuICovXHJcbid1c2Ugc3RyaWN0JztcclxudmFyIERvbSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIGxpc3QgPSBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgdmFyIGRTdHIgPSAnPGRpdiBjbGFzcz1cInNnLW1vZGFsIGFkZC1tb2RhbFwiPiA8cCBjbGFzcz1cImFkZC1wXCI+IDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgaWQ9XCJhZGRcIj4r5re75Yqg5paw5qih5p2/PC9hPiA8L3A+IDwvZGl2Pic7XHJcbiAgICBpZiAoanNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCAmJiAncmVzQm9keScgaW4ganNvbiAmJiBqc29uLnJlc0JvZHkgJiYgJ3NMaXN0JyBpbiBqc29uLnJlc0JvZHkgJiYganNvbi5yZXNCb2R5LnNMaXN0IGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgaWYgKGpzb24ucmVzQm9keS5zTGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdmFyIGFyciA9IGpzb24ucmVzQm9keS5zTGlzdDtcclxuICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgaWYgKGFyci5oYXNPd25Qcm9wZXJ0eShhKSkge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGFyclthXTtcclxuICAgICAgICAgICAgaWYgKGQuZXhwZW5zZURlZmF1bHQpIHtcclxuICAgICAgICAgICAgICBkU3RyICs9IHJlbmRlcihkKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBzdHIgKz0gcmVuZGVyKGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoJy5saXN0LWNvdXQnKS5odG1sKCc8c3Ryb25nPui0ueeUqOaooeadvzwvc3Ryb25nPueOsOaciSAnICsgKGFyci5sZW5ndGggKSArICcg5Liq6LS555So5qih5p2/Jyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3RyID0gJzxkaXYgY2xhc3M9XCJ3cm9uZ1wiPuaaguaXoOaooeadv++8jOivt+a3u+WKoO+8gTwvZGl2Pic7XHJcbiAgICAgICAgJCgnLmxpc3QtY291dCcpLmh0bWwoJzxzdHJvbmc+6LS555So5qih5p2/PC9zdHJvbmc+546w5pyJIDAg5Liq6LS555So5qih5p2/Jyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHN0ciA9ICc8ZGl2IGNsYXNzPVwid3JvbmdcIj7or7fmsYLlh7rplJnvvIw8YSBocmVmPVwiXCI+6K+36YeN6K+VPC9hPu+8gTwvZGl2Pic7XHJcbiAgICAgICQoJy5saXN0LWNvdXQnKS5odG1sKCc8c3Ryb25nPui0ueeUqOaooeadvzwvc3Ryb25nPueOsOaciSAwIOS4qui0ueeUqOaooeadvycpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcmVuZGVyKGQpIHtcclxuICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICBmb3IgKHZhciBlIGluIGQuZXhwZW5zZVRlbXBsYXRlKSB7XHJcbiAgICAgICAgaWYgKGQuZXhwZW5zZVRlbXBsYXRlLmhhc093blByb3BlcnR5KGUpKSB7XHJcbiAgICAgICAgICB2YXIgZHQgPSBkLmV4cGVuc2VUZW1wbGF0ZVtlXTtcclxuICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cInByaWNlLWluZm9cIj4gPHNwYW4gY2xhc3M9XCJ0aXRsZVwiPicgKyBkdC5pdGVtTmFtZSArICfvvJo8L3NwYW4+IDxzcGFuIGNsYXNzPVwiaW5mb1wiPkNOWSAnICsgZHQuaXRlbVByaWNlLnRvRml4ZWQoMikgKyAnPC9zcGFuPiA8L2Rpdj4nO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCJzZy1tb2RhbCcgKyAoZC5leHBlbnNlRGVmYXVsdCA/ICcgYWN0aXZlJyA6ICcnKSArICdcIj4gPHAgY2xhc3M9XCJzZy1oZWFkZXJcIj4nICsgZC5leHBlbnNlTmFtZSArICc8L3A+ICcgK1xyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwic2ctYm9keVwiPicgKyBzdHIgKyAnPC9kaXY+IDxkaXYgY2xhc3M9XCJzZy1mb290XCI+IDxkaXYgY2xhc3M9XCJkcC10YlwiPicgK1xyXG4gICAgICAgICcgPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cInNldC1lZGl0b3JcIiBkYXRhLWlkPVwiJyArIGQudGVtcGxhdGVJZCArICdcIj7nvJbovpE8L2E+ICcgK1xyXG4gICAgICAgICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwic2V0LXJlbW92ZVwiIGRhdGEtaWQ9XCInICsgZC50ZW1wbGF0ZUlkICsgJ1wiPuWIoOmZpDwvYT4gJyArXHJcbiAgICAgICAgKGQuZXhwZW5zZURlZmF1bHQgPyAnJyA6ICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwic2V0LWRlZmF1bHRcIiBkYXRhLWlkPVwiJyArIGQudGVtcGxhdGVJZCArICdcIj7orr7kuLrpu5jorqQ8L2E+JyApICtcclxuICAgICAgICAnPC9kaXY+IDwvZGl2PiA8L2Rpdj4nXHJcbiAgICB9XHJcblxyXG4gICAgJCgnLm5vdC1kZWZhdWx0JykuaHRtbChzdHIpO1xyXG4gICAgJCgnLmRlZmF1bHQnKS5odG1sKGRTdHIpO1xyXG4gIH07XHJcbiAgdmFyIHNldERldGFpbCA9IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICB2YXIgZCA9IGpzb24ucmVzQm9keSwgc3RyID0gJyc7XHJcbiAgICAkKCcjZS1uYW1lJykudmFsKGQuZXhwZW5zZU5hbWUpO1xyXG4gICAgJCgnI2VkaXRvci1lbnN1cmUnKS5kYXRhKCdpZCcsIGQudGVtcGxhdGVJZCk7XHJcbiAgICBmb3IgKHZhciBlIGluIGQuZXhwZW5zZVRlbXBsYXRlKSB7XHJcbiAgICAgIGlmIChkLmV4cGVuc2VUZW1wbGF0ZS5oYXNPd25Qcm9wZXJ0eShlKSkge1xyXG4gICAgICAgIHZhciBkdCA9IGQuZXhwZW5zZVRlbXBsYXRlW2VdLCB1bml0O1xyXG4gICAgICAgIHN3aXRjaCAoZHQuaXRlbVVuaXQpIHtcclxuICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgdW5pdCA9ICcv56WoJztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgIHVuaXQgPSAnL0tHJztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgIHVuaXQgPSAnL23Csyc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICB1bml0ID0gJy/ku7YnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHVuaXQgPSAnL+elqCc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdHIgKz0gJzx0cj4gPHRkPicgKyAoZHQuaXRlbU5hbWUgPT0gJ+aKpeWFs+i0uScgPyAnJyA6ICc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2xhc3M9XCJpbm5lci1zZ1wiLz4nKSArICc8L3RkPiA8dGQ+PGlucHV0ICcgKyAoZHQuaXRlbU5hbWUgPT0gJ+aKpeWFs+i0uScgPyAncmVhZG9ubHknIDogJycpICsgJyB0eXBlPVwidGV4dFwiIGNsYXNzPVwiaXAtbmFtZVwiIHZhbHVlPVwiJyArIGR0Lml0ZW1OYW1lICsgJ1wiLz48L3RkPiAnICtcclxuICAgICAgICAnPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiaXAtcHJpY2VcIiB2YWx1ZT1cIkNOWSAnICsgZHQuaXRlbVByaWNlLnRvRml4ZWQoMikgKyAnXCIgLz48L3RkPicgK1xyXG4gICAgICAgICcgPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwic2ctbXVzdFwiIHJlYWRvbmx5IHZhbHVlPVwiJyArIChkdC5pdGVtT3B0aW9uID8gJ+i0ueeUqCcgOiAn5p2C6LS5JykgKyAnXCI+JyArIChkdC5pdGVtTmFtZSA9PSAn5oql5YWz6LS5JyA/ICcnIDogJzx1bCBjbGFzcz1cImZpbGwgc2hvdy11bml0IGRwLW5cIj48bGk+6LS555SoPC9saT48bGk+5p2C6LS5PC9saT48L3VsPicpICsgJzwvdGQ+IDx0ZD4gJyArXHJcbiAgICAgICAgJzxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiaXAtdW5pdFwiIHJlYWRvbmx5IHZhbHVlPVwiJyArIHVuaXQgKyAnXCIvPiAnICtcclxuICAgICAgICAoZHQuaXRlbU5hbWUgPT0gJ+aKpeWFs+i0uScgPyAnJyA6ICc8dWwgY2xhc3M9XCJmaWxsIHNob3ctdW5pdCBkcC1uXCI+PGxpPi/npag8L2xpPiA8bGk+L0tHPC9saT4gPGxpPi9twrM8L2xpPiA8bGk+L+S7tjwvbGk+IDwvdWw+JykgK1xyXG4gICAgICAgICc8L3RkPiA8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJpcC1yZW1hcmtcIiB2YWx1ZT1cIicgKyBkdC5pdGVtUmVtYXJrICsgJ1wiLz48L3RkPiA8L3RyPic7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgICQoJy5lZGl0b3ItbW9kYWwnKS5maW5kKCd0Ym9keScpLmh0bWwoc3RyKTtcclxuICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICQoJy5lZGl0b3ItbW9kYWwnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gIH07XHJcbiAgcmV0dXJuIHtcclxuICAgIGxpc3Q6IGxpc3RcclxuICAgICwgc2V0RGV0YWlsOiBzZXREZXRhaWxcclxuICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzLkRvbSA9IERvbTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNy8xLzQuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBMaXN0ZW5lciA9IHJlcXVpcmUoJy4vbGlzdGVuZXInKS5MaXN0ZW5lcjtcclxudmFyIGdlbmVyYWwgPSByZXF1aXJlKCcuLi8uLi9nZW5lcmFsL2dlbmVyYWwnKS5nZW5lcmFsO1xyXG5nZW5lcmFsLnJ1bigpO1xyXG5MaXN0ZW5lci5ydW4oKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNy8xLzUuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBEYXRhID0gcmVxdWlyZSgnLi9kYXRhJykuRGF0YVxyXG4gICwgRG9tID0gcmVxdWlyZSgnLi9kb20nKS5Eb21cclxuICAsIHVybCA9IHJlcXVpcmUoJy4uLy4uL2dlbmVyYWwvZnVuY3Rpb24nKS51cmxcclxuICAsIE1vZGFsID0gcmVxdWlyZSgnLi4vLi4vZ2VuZXJhbC9tb2RhbCcpO1xyXG52YXIgTGlzdGVuZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gIHZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2xvc2UtYnRuJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAkKCcuYWxlcnQtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICQoJy53aGl0ZS1iYWNrJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgIH0pO1xyXG4gICAgJChkb2N1bWVudCkub24oJ2ZvY3VzJywgJ2lucHV0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAkKHRoaXMpLnNlbGVjdCgpO1xyXG4gICAgfSk7XHJcbiAgICAkKGRvY3VtZW50KS5vbignYmx1cicsICcuaXAtcHJpY2UnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciB2YWx1ZSA9ICQodGhpcykudmFsKCkgfHwgJzAnO1xyXG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1teXFxkLl0vZywgJycpO1xyXG4gICAgICAkKHRoaXMpLnZhbCgnQ05ZICcgKyBwYXJzZUZsb2F0KHZhbHVlKS50b0ZpeGVkKDIpKTtcclxuICAgIH0pO1xyXG4gICAgJChkb2N1bWVudCkub24oJ2tleXVwJywgJy5pcC1wcmljZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgJCh0aGlzKS52YWwoJCh0aGlzKS52YWwoKS5yZXBsYWNlKC9bXlxcZC5dL2csIFwiXCIpKTtcclxuICAgIH0pO1xyXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5pcC11bml0LC5zZy1tdXN0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAkKCcuc2hvdy11bml0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgJCh0aGlzKS5zaWJsaW5ncygndWwnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgfSk7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNob3ctdW5pdCBsaScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgJCh0aGlzKS5wYXJlbnQoKS5zaWJsaW5ncygnaW5wdXQnKS52YWwoJCh0aGlzKS50ZXh0KCkpO1xyXG4gICAgICAkKHRoaXMpLnBhcmVudCgpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIHZhciB0YXJnZXQgPSAkKGUudGFyZ2V0KTtcclxuICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuc2hvdy11bml0LC5pcC11bml0LC5zZy1tdXN0JykubGVuZ3RoID09IDApIHtcclxuICAgICAgICAkKCcuc2hvdy11bml0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2FkZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHN0ciA9ICc8dHI+IDx0ZD48L3RkPiA8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJpcC1uYW1lXCIgdmFsdWU9XCLmiqXlhbPotLlcIiByZWFkb25seS8+PC90ZD4gJyArXHJcbiAgICAgICAgJzx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLXByaWNlXCIgdmFsdWU9XCJDTlkgMC4wMFwiIC8+PC90ZD4nICtcclxuICAgICAgICAnIDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cInNnLW11c3RcIiByZWFkb25seSB2YWx1ZT1cIui0ueeUqFwiLz48L3RkPiA8dGQ+ICcgK1xyXG4gICAgICAgICc8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLXVuaXRcIiByZWFkb25seSB2YWx1ZT1cIi/npahcIi8+PC90ZD4gPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiaXAtcmVtYXJrXCIvPjwvdGQ+IDwvdHI+JztcclxuICAgICAgJCgnI25hbWUnKS52YWwoJycpO1xyXG4gICAgICAkKCcuYWRkLW1vZGFsJykuZmluZCgndGJvZHknKS5odG1sKHN0cik7XHJcbiAgICAgICQoJy5hZGQtbW9kYWwnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuaW5uZXItYWRkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgc3RyID0gJzx0cj4gPHRkPjxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjbGFzcz1cImlubmVyLXNnXCIvPjwvdGQ+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLW5hbWVcIi8+PC90ZD4gJyArXHJcbiAgICAgICAgJzx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLXByaWNlXCIgdmFsdWU9XCJDTlkgMC4wMFwiIC8+PC90ZD4nICtcclxuICAgICAgICAnIDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cInNnLW11c3RcIiByZWFkb25seS8+PHVsIGNsYXNzPVwiZmlsbCBzaG93LXVuaXQgZHAtblwiPjxsaT7otLnnlKg8L2xpPjxsaT7mnYLotLk8L2xpPjwvdWw+PC90ZD4gPHRkPiAnICtcclxuICAgICAgICAnPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJpcC11bml0XCIgcmVhZG9ubHkgdmFsdWU9XCIv56WoXCIvPiA8dWwgY2xhc3M9XCJmaWxsIHNob3ctdW5pdCBkcC1uXCI+ICcgK1xyXG4gICAgICAgICc8bGk+L+elqDwvbGk+IDxsaT4vS0c8L2xpPiA8bGk+L23CszwvbGk+IDxsaT4v5Lu2PC9saT4gPC91bD4gPC90ZD4gPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiaXAtcmVtYXJrXCIvPjwvdGQ+IDwvdHI+JztcclxuICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuYWxlcnQtcGFydCcpLmZpbmQoJ3Rib2R5JykuYXBwZW5kKHN0cik7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuaW5uZXItcmVtb3ZlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAkKHRoaXMpLnBhcmVudHMoJy5hbGVydC1wYXJ0JykuZmluZCgnLmlubmVyLXNnJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCQodGhpcykucHJvcCgnY2hlY2tlZCcpKSB7XHJcbiAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3RyJykucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNhZGQtZW5zdXJlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgcGFzcyA9IHRydWU7XHJcbiAgICAgIGlmICgkKCcjYS1uYW1lJykudmFsKCkpIHtcclxuICAgICAgICAkKCcjYS1uYW1lJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKCcjYS1uYW1lJykuYWRkQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgJCgnLmFkZC1tb2RhbCcpLmZpbmQoJy5pcC1uYW1lJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCEkKHRoaXMpLnZhbCgpKSB7XHJcbiAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICAkKCcuYWRkLW1vZGFsJykuZmluZCgnLmlwLXByaWNlJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gJCh0aGlzKS52YWwoKS5yZXBsYWNlKC9bXlxcZC5dL2csICcnKTtcclxuICAgICAgICBpZiAocGFyc2VGbG9hdCh2YWx1ZSkgPD0gMCkge1xyXG4gICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKHBhc3MpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgIFwiZXhwZW5zZU5hbWVcIjogJCgnI2EtbmFtZScpLnZhbCgpLFxyXG4gICAgICAgICAgXCJleHBlbnNlVGVtcGxhdGVcIjogW10sXHJcbiAgICAgICAgICBcImNvbXBhbnlJZFwiOiAwXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZWxlID0gJCgnLmFkZC1tb2RhbCcpLmZpbmQoJ3Rib2R5JykuZmluZCgndHInKTtcclxuICAgICAgICBlbGUuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB2YXIgdW5pdFxyXG4gICAgICAgICAgICAsIHByaWNlID0gJCh0aGlzKS5maW5kKCcuaXAtcHJpY2UnKS52YWwoKS5yZXBsYWNlKC9bXlxcZC5dL2csICcnKTtcclxuICAgICAgICAgIHN3aXRjaCAoJCh0aGlzKS5maW5kKCcuaXAtdW5pdCcpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJy/npagnOlxyXG4gICAgICAgICAgICAgIHVuaXQgPSAxO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICcvS0cnOlxyXG4gICAgICAgICAgICAgIHVuaXQgPSAyO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICcvbcKzJzpcclxuICAgICAgICAgICAgICB1bml0ID0gMztcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnL+S7tic6XHJcbiAgICAgICAgICAgICAgdW5pdCA9IDQ7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgdW5pdCA9IDE7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2YXIgZCA9IHtcclxuICAgICAgICAgICAgXCJpdGVtTmFtZVwiOiAkKHRoaXMpLmZpbmQoJy5pcC1uYW1lJykudmFsKCksXHJcbiAgICAgICAgICAgIFwiaXRlbVByaWNlXCI6IHByaWNlLFxyXG4gICAgICAgICAgICBcIml0ZW1Vbml0XCI6IHVuaXQsXHJcbiAgICAgICAgICAgIFwiaXRlbU9wdGlvblwiOiAkKHRoaXMpLmZpbmQoJy5zZy1tdXN0JykudmFsKCkgPT0gJ+i0ueeUqCcsXHJcbiAgICAgICAgICAgIFwiaXRlbVJlbWFya1wiOiAkKHRoaXMpLmZpbmQoJy5pcC1yZW1hcmsnKS52YWwoKVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGRhdGFbJ2V4cGVuc2VUZW1wbGF0ZSddLnB1c2goZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgRGF0YS5hZGQoZGF0YSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfmt7vliqDmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+a3u+WKoOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2V0LXJlbW92ZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgJCgnI2RlbGV0ZS1lbnN1cmUnKS5kYXRhKCdpZCcsICQodGhpcykuZGF0YSgnaWQnKSk7XHJcbiAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgJCgnLmRlbGV0ZS1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgIH0pO1xyXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zZXQtZGVmYXVsdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgJCgnI2RlZmF1bHQtZW5zdXJlJykuZGF0YSgnaWQnLCAkKHRoaXMpLmRhdGEoJ2lkJykpO1xyXG4gICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICQoJy5kZWZhdWx0LXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgfSk7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNldC1lZGl0b3InLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIERhdGEuZGV0YWlsKHtpZDogJCh0aGlzKS5kYXRhKCdpZCcpfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgRG9tLnNldERldGFpbChqc29uKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+iOt+WPluivpuaDheWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZGVsZXRlLWVuc3VyZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgRGF0YS5kZWwoe3RlbXBsYXRlSWQ6ICQodGhpcykuZGF0YSgnaWQnKX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfliKDpmaTmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfliKDpmaTlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2RlZmF1bHQtZW5zdXJlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICBEYXRhLmRlZih7dGVtcGxhdGVJZDogJCh0aGlzKS5kYXRhKCdpZCcpfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+iuvue9ruaIkOWKn++8gScsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+iuvue9ruWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZWRpdG9yLWVuc3VyZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHBhc3MgPSB0cnVlO1xyXG4gICAgICBpZiAoJCgnI2UtbmFtZScpLnZhbCgpKSB7XHJcbiAgICAgICAgJCgnI2UtbmFtZScpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCgnI2UtbmFtZScpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgICQoJy5lZGl0b3ItbW9kYWwnKS5maW5kKCcuaXAtbmFtZScpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghJCh0aGlzKS52YWwoKSkge1xyXG4gICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgJCgnLmVkaXRvci1tb2RhbCcpLmZpbmQoJy5pcC1wcmljZScpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9ICQodGhpcykudmFsKCkucmVwbGFjZSgvW15cXGQuXS9nLCAnJyk7XHJcbiAgICAgICAgaWYgKHBhcnNlRmxvYXQodmFsdWUpIDw9IDApIHtcclxuICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChwYXNzKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICBcImV4cGVuc2VOYW1lXCI6ICQoJyNlLW5hbWUnKS52YWwoKSxcclxuICAgICAgICAgIFwiZXhwZW5zZVRlbXBsYXRlXCI6IFtdLFxyXG4gICAgICAgICAgXCJjb21wYW55SWRcIjogMCxcclxuICAgICAgICAgIFwidGVtcGxhdGVJZFwiOiAkKHRoaXMpLmRhdGEoJ2lkJyksXHJcbiAgICAgICAgICBcImV4cGVuc2VTdGF0ZVwiOiAxXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZWxlID0gJCgnLmVkaXRvci1tb2RhbCcpLmZpbmQoJ3Rib2R5JykuZmluZCgndHInKTtcclxuICAgICAgICBlbGUuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB2YXIgdW5pdFxyXG4gICAgICAgICAgICAsIHByaWNlID0gJCh0aGlzKS5maW5kKCcuaXAtcHJpY2UnKS52YWwoKS5yZXBsYWNlKC9bXlxcZC5dL2csICcnKTtcclxuICAgICAgICAgIHN3aXRjaCAoJCh0aGlzKS5maW5kKCcuaXAtdW5pdCcpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJy/npagnOlxyXG4gICAgICAgICAgICAgIHVuaXQgPSAxO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICcvS0cnOlxyXG4gICAgICAgICAgICAgIHVuaXQgPSAyO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICcvbcKzJzpcclxuICAgICAgICAgICAgICB1bml0ID0gMztcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnL+S7tic6XHJcbiAgICAgICAgICAgICAgdW5pdCA9IDQ7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgdW5pdCA9IDE7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2YXIgZCA9IHtcclxuICAgICAgICAgICAgXCJpdGVtTmFtZVwiOiAkKHRoaXMpLmZpbmQoJy5pcC1uYW1lJykudmFsKCksXHJcbiAgICAgICAgICAgIFwiaXRlbVByaWNlXCI6IHByaWNlLFxyXG4gICAgICAgICAgICBcIml0ZW1Vbml0XCI6IHVuaXQsXHJcbiAgICAgICAgICAgIFwiaXRlbU9wdGlvblwiOiAkKHRoaXMpLmZpbmQoJy5zZy1tdXN0JykudmFsKCkgPT0gJ+i0ueeUqCcsXHJcbiAgICAgICAgICAgIFwiaXRlbVJlbWFya1wiOiAkKHRoaXMpLmZpbmQoJy5pcC1yZW1hcmsnKS52YWwoKVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGRhdGFbJ2V4cGVuc2VUZW1wbGF0ZSddLnB1c2goZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgRGF0YS51cGRhdGUoZGF0YSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfnvJbovpHmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+e8lui+keWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjcmVmcmVzaCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgaW5pdCgpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIERhdGEubGlzdChmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICBEb20ubGlzdChqc29uKTtcclxuICAgIH0pO1xyXG4gIH07XHJcbiAgdmFyIHJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGxpc3RlbmVyKCk7XHJcbiAgICBpbml0KCk7XHJcbiAgfTtcclxuICByZXR1cm4ge1xyXG4gICAgcnVuOiBydW5cclxuICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzLkxpc3RlbmVyID0gTGlzdGVuZXI7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgenJ6IG9uIDIwMTYvMi8yNi5cclxuICogQHZlcnNpb24gMS4wLjAgY3JlYXRlZCDpgJrnlKjmgKflip/og73mlrnms5VcclxuICovXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG52YXIgRnVuID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBfdGltZU91dCA9IDEwMDAwMDsvL+ivt+axgui2heaXtuaXtumXtOS4ujEwc1xyXG4gICAgLyoqXHJcbiAgICAgKiDlsIHoo4VhamF4XHJcbiAgICAgKiBAcGFyYW0gb3B0aW9uXHJcbiAgICAgKiB7XHJcbiAgICAgKiAgICAgIHVybDpcIuivt+axgueahOWcsOWdgFwiXHJcbiAgICAgKiAgICAgICxtZXRob2Q6XCLor7fmsYLnmoTmlrnms5VcIlxyXG4gICAgICogICAgICAsYXN5bmM6XCLmmK/lkKblubblj5FcIlxyXG4gICAgICogICAgICAsZGF0YTpcIuWPkemAgeeahOaVsOaNrlwiXHJcbiAgICAgKiAgICAgICxzdWNjZXNzOlwi5oiQ5Yqf5pe25Zue6LCDXCJcclxuICAgICAqICAgICAgLGVycm9yOlwi5aSx6LSlL+i2heaXtuaXtuWbnuiwg1wiXHJcbiAgICAgKiAgICAgICx0aW1lb3V0Olwi6LaF5pe25pe26Ze0XCJcclxuICAgICAqICAgICAgLGNvbXBsZXRlOlwi5a6M5oiQ5ZCO55qE5Zue6LCDXCJcclxuICAgICAqIH1cclxuICAgICAqL1xyXG4gICAgdmFyIGFqYXggPSBmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgLy9hamF45byA5aeL5pe25bqU5pi+56S64oCc5Yqg6L295L+h5oGv5qGG4oCdXHJcbiAgICAgICAgTW9kYWwuc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IG9wdGlvbi51cmxcclxuICAgICAgICAgICAgLCB0eXBlOiBcInR5cGVcIiBpbiBvcHRpb24gJiYgb3B0aW9uLnR5cGUgfHwgXCJHRVRcIlxyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IG9wdGlvbi50aW1lb3V0IHx8IF90aW1lT3V0XHJcbiAgICAgICAgICAgICwgZGF0YTogXCJkYXRhXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5kYXRhIHx8IHt9XHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6IFwianNvblwiXHJcbiAgICAgICAgICAgICwgYXN5bmM6IChcImFzeW5jXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5hc3luYykgPyB0cnVlIDogZmFsc2VcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKFwic3RhdHVzXCIgaW4ganNvbiAmJiBqc29uLnN0YXR1cyA+IDAgJiYgXCJkYXRhXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN1Y2Nlc3NcIiBpbiBvcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLnN1Y2Nlc3MoanNvbi5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChcIuaXoHN1Y2Nlc3Pmlrnms5UhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJlcnJvclwiIGluIG9wdGlvbiAmJiBvcHRpb24uZXJyb3IgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbi5lcnJvcihqc29uKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aTjeS9nOWksei0pSEnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZXJyb3I6IGZ1bmN0aW9uICh4aHIpIHsvLzQwNOaIluiAhei2heaXtlxyXG4gICAgICAgICAgICAgICAgaWYgKFwiZXJyb3JcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmVycm9yIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+aPkOekuueUqOaIt+mUmeivr+S/oeaBr1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChcIui/nuaOpeacjeWKoeWZqOWksei0pe+8jOeKtuaAge+8mlwiICsgKHhoci5zdGF0dXMgfHwgLTEpICsgXCIs5L+h5oGv77yaXCIgKyAoeGhyLnN0YXR1c1RleHQgfHwgXCItXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uZXJyb3IoeGhyLnN0YXR1cywgeGhyLnN0YXR1c1RleHQpOy8v5Zue6LCD6K+35rGC55qE54q25oCB5ZKM6ZSZ6K+v5L+h5oGvXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoeGhyLCB0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAvL+WFs+mXreKAnOWKoOi9veS/oeaBr+ahhuKAnVxyXG4gICAgICAgICAgICAgICAgTW9kYWwuc2hvd0xvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKFwiY29tcGxldGVcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmNvbXBsZXRlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uY29tcGxldGUoeGhyLCB0eXBlKTsvL+Wbnuiwg+ivt+axgueahHhocuS/oeaBr+WSjOexu+Wei1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy/lhajpgInlkozljZXpgInnmoTnu5HlrppcclxuICAgIHZhciBzZXRDaGVja2JveExpc3RlbmVyID0gZnVuY3Rpb24gKGFsbENoZWNrLCByYWRpb0NoZWNrcykge1xyXG4gICAgICAgIC8v562b6YCJ5Y2V6YCJ5oyJ6ZKu57uEXHJcbiAgICAgICAgdmFyIHJhZGlvVmFsdWVFbGVzID0gJChyYWRpb0NoZWNrcyk7XHJcbiAgICAgICAgLy/ngrnlh7vlhajpgInml7bvvIzlkIznu4TmjInpkq7ooqvlkIzmraVcclxuICAgICAgICAkKGRvY3VtZW50KS5kZWxlZ2F0ZShhbGxDaGVjaywgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChyYWRpb1ZhbHVlRWxlcyAmJiByYWRpb1ZhbHVlRWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfciA9IDA7IF9yIDwgcmFkaW9WYWx1ZUVsZXMubGVuZ3RoOyBfcisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmFkaW9WYWx1ZUVsZXNbX3JdLmNoZWNrZWQgPSAkKHRoaXMpLmlzKFwiOmNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+eCueWHu+WNlemAieaMiemSruaXtu+8jFxyXG4gICAgICAgICQoZG9jdW1lbnQpLmRlbGVnYXRlKHJhZGlvQ2hlY2tzLCBcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJChhbGxDaGVjaylbMF0uY2hlY2tlZCA9ICQocmFkaW9DaGVja3MgKyBcIjpjaGVja2VkXCIpLmxlbmd0aCA9PSAkKHJhZGlvQ2hlY2tzKS5sZW5ndGg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHVybCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKFwiKF58JilcIiArIG5hbWUgKyBcIj0oW14mXSopKCZ8JClcIiwgXCJpXCIpO1xyXG4gICAgICAgICAgICB2YXIgciA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEpLm1hdGNoKHJlZyk7XHJcbiAgICAgICAgICAgIGlmIChyICE9IG51bGwpIHJldHVybiBkZWNvZGVVUkkoclsyXSk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5qC55o2u5Y+C5pWw5YiX6KGo6ZW/5bqm6L+b6KGM5Yik5pat77yM5YW85a65SUU5XHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0Jykgey8v5LiA5Liq5a+56LGh77yM5L2/55Soa2V55qCH6K6wdmFsdWVcclxuICAgICAgICAgICAgICAgIHZhciBvYmogPSBhcmd1bWVudHNbMF1cclxuICAgICAgICAgICAgICAgICAgICAsIHNlYXJjaCA9IGxvY2F0aW9uLnNlYXJjaDtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG8gaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2ggPSBjaGFuZ2VVUkxLZXlWYWx1ZShzZWFyY2gsIG8sIG9ialtvXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCdwdXNoU3RhdGUnIGluIGhpc3RvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBkb2N1bWVudC50aXRsZSwgc2VhcmNoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJ3B1c2hTdGF0ZScgaW4gSGlzdG9yeSkgey8vaWU5IOS4jeaUr+aMgXB1c2hTdGF0ZeaWueazlSxqYXZhc2NyaXB0LmVqc+S4rea3u+WKoGhpc3RvcnkuanPlrozmiJBodG1sNOWvuXB1c2hTdGF0ZeeahOaUr+aMgVxyXG4gICAgICAgICAgICAgICAgICAgIEhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIHNlYXJjaCk7Ly/ov5Tlm57ph43mlrDmnoTpgKDlkI5zZWFyY2jkuLJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7Ly9rZXkrdmFsdWVcclxuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBhcmd1bWVudHNbMF1cclxuICAgICAgICAgICAgICAgICAgICAsIHZhbHVlID0gYXJndW1lbnRzWzFdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCdwdXNoU3RhdGUnIGluIGhpc3RvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBkb2N1bWVudC50aXRsZSwgY2hhbmdlVVJMS2V5VmFsdWUobG9jYXRpb24udG9TdHJpbmcoKSwga2V5LCB2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgncHVzaFN0YXRlJyBpbiBIaXN0b3J5KSB7Ly9pZTkg5LiN5pSv5oyBcHVzaFN0YXRl5pa55rOVLGphdmFzY3JpcHQuZWpz5Lit5re75YqgaGlzdG9yeS5qc+WujOaIkGh0bWw05a+5cHVzaFN0YXRl55qE5pSv5oyBXHJcbiAgICAgICAgICAgICAgICAgICAgSGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgY2hhbmdlVVJMS2V5VmFsdWUobG9jYXRpb24uc2VhcmNoLCBrZXksIHZhbHVlKSk7Ly/ov5Tlm57ph43mlrDmnoTpgKDlkI5zZWFyY2jkuLJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBjaGFuZ2VVUkxLZXlWYWx1ZSh1cmwsIGFyZywgYXJnX3ZhbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBhcmcgKyAnPShbXiZdKiknO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcGxhY2VUZXh0ID0gYXJnICsgJz0nICsgYXJnX3ZhbDtcclxuICAgICAgICAgICAgICAgIGlmICh1cmwubWF0Y2gocGF0dGVybikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gJy8oJyArIGFyZyArICc9KShbXiZdKikvZ2knO1xyXG4gICAgICAgICAgICAgICAgICAgIHRtcCA9IHVybC5yZXBsYWNlKGV2YWwodG1wKSwgcmVwbGFjZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0bXA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1cmwubWF0Y2goJ1tcXD9dJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybCArICcmJyArIHJlcGxhY2VUZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwgKyAnPycgKyByZXBsYWNlVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldDogZ2V0XHJcbiAgICAgICAgICAgICwgc2V0OiBzZXRcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgdmFyIGZvcm1hdEltYWdlPWZ1bmN0aW9uIChwYXRoLCBzaXplLCBlbGUpIHtcclxuICAgICAgICBpZihwYXRoIGluc3RhbmNlb2YgIEFycmF5ICYmIHBhdGgubGVuZ3RoPjApe1xyXG4gICAgICAgICAgICBwYXRoID0gcGF0aFswXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIElNQUdFX1NJWkUgPSB7XHJcbiAgICAgICAgICAgIG9yaWdpbmFsOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCJcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB4bGFyZ2U6IHtcclxuICAgICAgICAgICAgICAgIHBhdGg6IFwiX3hsYXJnZVwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI2NjAqNjYwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGFyZ2U6IHtcclxuICAgICAgICAgICAgICAgIHBhdGg6IFwiX2xhcmdlXCIsXHJcbiAgICAgICAgICAgICAgICBzaXplOiBcIjQyMCo0MjBcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtaWRkbGU6IHtcclxuICAgICAgICAgICAgICAgIHBhdGg6IFwiX21pZGRsZVwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCIzMDAqMzAwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc21hbGw6IHtcclxuICAgICAgICAgICAgICAgIHBhdGg6IFwiX3NtYWxsXCIsXHJcbiAgICAgICAgICAgICAgICBzaXplOiBcIjI0MCoyNDBcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsaXR0bGU6IHtcclxuICAgICAgICAgICAgICAgIHBhdGg6IFwiX2xpdHRsZVwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCIxMjAqMTIwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWljcm86IHtcclxuICAgICAgICAgICAgICAgIHBhdGg6IFwiX21pY3JvXCIsXHJcbiAgICAgICAgICAgICAgICBzaXplOiBcIjYwKjYwXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2l6ZSA9IElNQUdFX1NJWkVbc2l6ZSB8fCBcIm1pZGRsZVwiXSB8fCBJTUFHRV9TSVpFLm1pZGRsZTtcclxuICAgICAgICB2YXIgcGF0aFRlbXAgPSAvXFwuXFx3Kz8kLy5leGVjKHBhdGgpO1xyXG4gICAgICAgIGlmICghcGF0aFRlbXApIHtcclxuICAgICAgICAgICAgcGF0aCArPSBzaXplLnBhdGg7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGF0aCA9IChwYXRoLnN1YnN0cigwLCBwYXRoVGVtcC5pbmRleCB8fCBwYXRoLmxlbmd0aCkpICsgc2l6ZS5wYXRoICsgcGF0aFRlbXBbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbGUgJiYgZWxlLmF0dHIpIHtcclxuICAgICAgICAgICAgZWxlLmF0dHIoXCJzcmNcIiwgcGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgYWpheDogYWpheFxyXG4gICAgICAgICwgZ2V0VGltdG91dDogX3RpbWVPdXRcclxuICAgICAgICAsIHNldENoZWNrYm94TGlzdGVuZXI6IHNldENoZWNrYm94TGlzdGVuZXJcclxuICAgICAgICAsIHVybDogdXJsXHJcbiAgICAgICAgLCBmb3JtYXRJbWFnZTogZm9ybWF0SW1hZ2VcclxuICAgIH1cclxufSgpKTtcclxuXHJcbmV4cG9ydHMuYWpheCA9IEZ1bi5hamF4O1xyXG5leHBvcnRzLmdldFRpbWVvdXQgPSBGdW4uZ2V0VGltdG91dDtcclxuZXhwb3J0cy5zZXRDaGVja2JveExpc3RlbmVyID0gRnVuLnNldENoZWNrYm94TGlzdGVuZXI7XHJcbmV4cG9ydHMudXJsID0gRnVuLnVybDtcclxuZXhwb3J0cy5mb3JtYXRJbWFnZSA9IEZ1bi5mb3JtYXRJbWFnZTtcclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSmVyZW15IG9uIDIwMTcvMS8yMy5cclxuICovXHJcbid1c2Ugc3RyaWN0JztcclxudmFyIE1vZGFsID0gcmVxdWlyZSgnLi9tb2RhbCcpO1xyXG52YXIgZ2VuZXJhbCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgcnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8v5pe26Ze05qC85byP5YyWXHJcbiAgICAgICAgRGF0ZS5wcm90b3R5cGUuRm9ybWF0ID0gZnVuY3Rpb24gKGZtdCkgeyAvL2F1dGhvcjogSmVyZW15eXlcclxuICAgICAgICAgICAgdmFyIG8gPSB7XHJcbiAgICAgICAgICAgICAgICBcIk0rXCI6IHRoaXMuZ2V0TW9udGgoKSArIDEsIC8v5pyI5Lu9XHJcbiAgICAgICAgICAgICAgICBcImQrXCI6IHRoaXMuZ2V0RGF0ZSgpLCAvL+aXpVxyXG4gICAgICAgICAgICAgICAgXCJoK1wiOiB0aGlzLmdldEhvdXJzKCksIC8v5bCP5pe2XHJcbiAgICAgICAgICAgICAgICBcIm0rXCI6IHRoaXMuZ2V0TWludXRlcygpLCAvL+WIhlxyXG4gICAgICAgICAgICAgICAgXCJzK1wiOiB0aGlzLmdldFNlY29uZHMoKSwgLy/np5JcclxuICAgICAgICAgICAgICAgIFwicStcIjogTWF0aC5mbG9vcigodGhpcy5nZXRNb250aCgpICsgMykgLyAzKSwgLy/lraPluqZcclxuICAgICAgICAgICAgICAgIFwiU1wiOiB0aGlzLmdldE1pbGxpc2Vjb25kcygpIC8v5q+r56eSXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmICgvKHkrKS8udGVzdChmbXQpKSBmbXQgPSBmbXQucmVwbGFjZShSZWdFeHAuJDEsICh0aGlzLmdldEZ1bGxZZWFyKCkgKyBcIlwiKS5zdWJzdHIoNCAtIFJlZ0V4cC4kMS5sZW5ndGgpKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgayBpbiBvKVxyXG4gICAgICAgICAgICAgICAgaWYgKG5ldyBSZWdFeHAoXCIoXCIgKyBrICsgXCIpXCIpLnRlc3QoZm10KSkgZm10ID0gZm10LnJlcGxhY2UoUmVnRXhwLiQxLCAoUmVnRXhwLiQxLmxlbmd0aCA9PSAxKSA/IChvW2tdKSA6ICgoXCIwMFwiICsgb1trXSkuc3Vic3RyKChcIlwiICsgb1trXSkubGVuZ3RoKSkpO1xyXG4gICAgICAgICAgICByZXR1cm4gZm10O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8v5L+u5pS55a+G56CBXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNjaGFuZ2UtcHdkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcuY2hhbmdlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcuY2hhbmdlLXB3ZCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/lhbPpl63kv67mlLnlr4bnoIFcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNsb3NlLXB3ZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLmNoYW5nZS1iYWNrJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnLmNoYW5nZS1wd2QnKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZW5zdXJlLXB3ZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCQoJyNuZXctcGFzc3dvcmQnKS52YWwoKSAhPSAkKCcjZW5zdXJlLXBhc3N3b3JkJykudmFsKCkpIHtcclxuICAgICAgICAgICAgICAgICQoJyNlbnN1cmUtcGFzc3dvcmQnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJCgnI2Vuc3VyZS1wYXNzd29yZCcpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBcImFnZW50TWVtYmVySWRcIjogMCxcclxuICAgICAgICAgICAgICAgICAgICBcIm9sZFB3ZFwiOiAkKCcjcGFzc3dvcmQnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICBcInB3ZFwiOiAkKCcjbmV3LXBhc3N3b3JkJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwd2RDb25maXJtXCI6ICQoJyNlbnN1cmUtcGFzc3dvcmQnKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9hY2NvdW50L2NoYW5nZVB3ZCdcclxuICAgICAgICAgICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAgICAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+S/ruaUueaIkOWKn++8gScsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuY2hhbmdlLWJhY2snKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5jaGFuZ2UtcHdkJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+S/ruaUueWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJ1bjogcnVuXHJcbiAgICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzLmdlbmVyYWwgPSBnZW5lcmFsOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHpyeiBvbiAyMDE2LzIvMjQuXHJcbiAqIEB2ZXJzaW9uIDEuMC4wIGNyZWF0ZWRcclxuICovXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG4vL+aehOmAoOS/oeaBr+ahhuS4u+S9k1xyXG52YXIgTW9kYWwgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgLy/mnoTpgKDljp/lp4vnsbtcclxuICAgIGZ1bmN0aW9uIE0obSkge1xyXG4gICAgICAgIHRoaXMucyA9IG0uczsvL+aYr+WQpuaYvuekulxyXG4gICAgICAgIHRoaXMuaWQgPSBtLmlkO1xyXG4gICAgfVxyXG5cclxuICAgIC8v5p6E6YCg5qCH5YeGc2hvd+aWueazle+8jOeUqOS6jue7p+aJv1xyXG4gICAgTS5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pZCk7XHJcbiAgICAgICAgaWYgKGVsZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zICYmICFpc1Nob3coKSkgey8v5pi+56S65b2T5YmN6ZqQ6JePXHJcbiAgICAgICAgICAgICAgICBlbGUuY2xhc3NOYW1lID0gZWxlLmNsYXNzTmFtZS5yZXBsYWNlKFwiZHAtblwiLCBcIlwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5zICYmIGlzU2hvdygpKSB7Ly/pmpDol4/lvZPliY3mmL7npLpcclxuICAgICAgICAgICAgICAgIGVsZS5jbGFzc05hbWUgKz0gXCIgZHAtblwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v5Y676Zmk5Lik6L6555qE56m65qC8XHJcbiAgICAgICAgICAgIGVsZS5jbGFzc05hbWUgPSBTdHJpbmcoZWxlLmNsYXNzTmFtZSkudHJpbSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBpc1Nob3coKSB7Ly/mmK/lkKblt7LmmL7npLrvvIzml6BjbGFzc+aXtuaYvuekulxyXG4gICAgICAgICAgICByZXR1cm4gZWxlLmNsYXNzTmFtZS5zcGxpdChcImRwLW5cIikubGVuZ3RoID09IDE7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvL+WKoOi9veS/oeaBr+ahhlxyXG4gICAgdmFyIGxvYWRpbmcgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8v5Yid5aeL5YyW55Sf5oiQ5Yqg6L295L+h5oGv5qGGXHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2FkaW5nX21vZGFsX2VsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJsb2FkaW5nX21vZGFsX2VsZW1lbnRcIiBjbGFzcz1cImxvYWRpbmctbW9kYWwtYm9keSBkcC1uXCI+PGRpdiBjbGFzcz1cImNvdmVyX21vZGFsX2VsZW1lbnRcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImxvYWRpbmctbW9kYWwtaW1hZ2VcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImxvYWRpbmctbW9kYWwtdGV4dFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8aDI+546p5ZG95Yqg6L295Lit4oCm4oCmPC9oMj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy/mmL7npLrjgIHpmpDol4/kv6Hmga/moYZcclxuICAgICAgICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgIHMgPSB0eXBlb2YgcyA9PSBcInVuZGVmaW5lZFwiID8gdHJ1ZSA6IHM7Ly/ml6Dlj4LmlbDmmL7npLrkv6Hmga/moYZcclxuICAgICAgICAgICAgdmFyIG0gPSBuZXcgTSh7aWQ6IFwibG9hZGluZ19tb2RhbF9lbGVtZW50XCIsIHM6IHN9KTtcclxuICAgICAgICAgICAgbS5zaG93KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0XHJcbiAgICAgICAgICAgICwgc2hvdzogc2hvd1xyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICAvL+W8ueWHuuS/oeaBr+ahhlxyXG4gICAgdmFyIGFsZXJ0ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFsZXJ0X21vZGFsX2VsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJhbGVydF9tb2RhbF9lbGVtZW50XCIgY2xhc3M9XCJhbGVydC1tb2RhbC1lbGVtZW50IGRwLW5cIj48ZGl2IGNsYXNzPVwiY292ZXJfbW9kYWxfZWxlbWVudFwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWxlcnQtbW9kYWwtY29udGVudFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWxlcnQtbW9kYWwtYm9keVwiPjxzcGFuIGNsYXNzPVwiYWxlcnQtbW9kYWwtdGV4dFwiPjwvc3Bhbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFsZXJ0LW1vZGFsLWZvb3RlclwiPjxidXR0b24gaWQ9XCJhbGVydF9tb2RhbF9jbG9zZVwiIGNsYXNzPVwiYWxlcnQtbW9kYWwtYnV0dG9uXCI+5YWz6ZetPC9idXR0b24+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBzaG93ID0gZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgcyA9IHR5cGVvZiBzID09IFwidW5kZWZpbmVkXCIgPyB0cnVlIDogcztcclxuICAgICAgICAgICAgdmFyIG0gPSBuZXcgTSh7aWQ6IFwiYWxlcnRfbW9kYWxfZWxlbWVudFwiLCBzOiBzfSk7XHJcbiAgICAgICAgICAgIG0uc2hvdygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6K6+572u5by55Ye65L+h5oGv5qGGXHJcbiAgICAgICAgICogQHBhcmFtIG1zZyAgICAgICDmmL7npLrnmoTkv6Hmga/vvIzmlK/mjIFodG1sXHJcbiAgICAgICAgICogQHBhcmFtIHNlZCAgICAgICDlgJLorqHml7blhbPpl63ml7bpl7TvvIzljZXkvY3vvJpzZWNvbmRcclxuICAgICAgICAgKiBAcGFyYW0gY2FsbGJhY2sgIOWFs+mXreinpuWPkeWbnuiwg+WHveaVsFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBzZXQgPSBmdW5jdGlvbiAobXNnLCBzZWQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFsZXJ0X21vZGFsX2VsZW1lbnRcIik7XHJcbiAgICAgICAgICAgIGlmIChtc2cpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbXNnID09PSAnb2JqZWN0Jykgey8v5bqU5a+55ZCO56uv6L+U5Zue5o+Q56S65pe25L2/55SoT2JqZWN05bCB6KOFXHJcbiAgICAgICAgICAgICAgICAgICAgbXNnID0gSlNPTi5zdHJpbmdpZnkobXNnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKGVsZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJhbGVydC1tb2RhbC10ZXh0XCIpWzBdLmlubmVySFRNTCA9IG1zZztcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICBlbGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImFsZXJ0LW1vZGFsLXRleHRcIilbMF0uaW5uZXJIVE1MID0gbXNnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2hvdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzZWQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBzaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0sIDEwMDAgKiBzZWQpO1xyXG4gICAgICAgICAgICB9Ly/ml6DlhbPpl63ml7bpl7TmiJbogIXlhbPpl63ml7bpl7TkuLow77yM5LiN6Ieq5Yqo5YWz6ZetXHJcbiAgICAgICAgICAgIC8vZml4bWUg5LqL5Lu255uR5ZCs55qEaWXlhbzlrrnmgKdcclxuICAgICAgICAgICAgLy/lhbPpl63mjInpkq7nmoTkuovku7bkvqblkKxcclxuICAgICAgICAgICAgJChcIiNhbGVydF9tb2RhbF9jbG9zZVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgLy/pmLvmraLkuovku7bnu6fnu63kvKDpgJJcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0XHJcbiAgICAgICAgICAgICwgc2hvdzogc2hvd1xyXG4gICAgICAgICAgICAsIHNldDogc2V0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIC8v6YCJ5oup5L+h5oGv5qGGXHJcbiAgICB2YXIgY29uZmlybSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtX21vZGFsX2VsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJjb25maXJtX21vZGFsX2VsZW1lbnRcIiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtZWxlbWVudCBkcC1uXCI+PGRpdiBjbGFzcz1cImNvdmVyX21vZGFsX2VsZW1lbnRcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtY29udGVudFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPVwiY29uZmlybV9tb2RhbF9oZWFkZXJcIiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtaGVhZGVyIGRwLW5cIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtYm9keVwiPjxzcGFuIGlkPVwiY29uZmlybV9tb2RhbF90ZXh0XCIgY2xhc3M9XCJjb25maXJtLW1vZGFsLXRleHRcIj48L3NwYW4+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb25maXJtLW1vZGFsLWZvb3RlclwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZm9vdGVyLWJ1dHRvbi1zdWNjZXNzXCI+PGJ1dHRvbiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtYnV0dG9uICBtb2RhbC1zdWNjZXNzXCIgZGF0YS1jb25maXJtPVwic3VjY2Vzc1wiPuehruiupDwvYnV0dG9uPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZm9vdGVyLWJ1dHRvbi1mYWxzZVwiPjxidXR0b24gY2xhc3M9XCJjb25maXJtLW1vZGFsLWJ1dHRvblwiIGRhdGEtY29uZmlybT1cImVycm9yXCI+5Y+W5raIPC9idXR0b24+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PjwvZGl2PicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBzaG93ID0gZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgcyA9IHR5cGVvZiBzID09IFwidW5kZWZpbmVkXCIgPyB0cnVlIDogcztcclxuICAgICAgICAgICAgdmFyIG0gPSBuZXcgTSh7aWQ6IFwiY29uZmlybV9tb2RhbF9lbGVtZW50XCIsIHM6IHN9KTtcclxuICAgICAgICAgICAgbS5zaG93KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDorr7nva7pgInmi6nkv6Hmga/moYbnmoTlhoXlrrlcclxuICAgICAgICAgKiBAcGFyYW0gb3B0aW9uICAgIOmFjee9rlxyXG4gICAgICAgICAqIHtcclxuICAgICAgICAgKiAgICAgIHRpdGxlOlwi5aS06YOo5pi+56S655qE5L+h5oGvXCJcclxuICAgICAgICAgKiAgICAgICx0ZXh0Olwi5pi+56S655qE5o+Q56S65L+h5oGvXCJcclxuICAgICAgICAgKiAgICAgICxzdWNjZXNzOlwi54K55Ye75oiQ5Yqf5ZCO55qE5Zue6LCDXCJcclxuICAgICAgICAgKiAgICAgICxlcnJvcjpcIueCueWHu+Wksei0peWQjueahOWbnuiwg1wiXHJcbiAgICAgICAgICogICAgICAsY29tcGxldGU6XCLngrnlh7vmjInpkq7lkI7nmoTmlbTkvZPlm57osINcIlxyXG4gICAgICAgICAqIH1cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgYmFyID0gMDtcclxuICAgICAgICB2YXIgc2V0ID0gZnVuY3Rpb24gKG9wdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoIW9wdGlvbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChcInRpdGxlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi50aXRsZS5sZW5ndGggPiAwKSB7Ly/mnInlpLTpg6jvvIzliJnmmL7npLrlpLTpg6hcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybV9tb2RhbF9oZWFkZXJcIikuaW5uZXJIVE1MID0gb3B0aW9uLnRpdGxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChcInRleHRcIiBpbiBvcHRpb24gJiYgb3B0aW9uLnRleHQubGVuZ3RoID4gMCkgey8v5pyJ5YaF5a6577yM5YiZ5pi+56S65pW05Liq6YCJ5oup5L+h5oGv5qGGXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1fbW9kYWxfdGV4dFwiKS5pbm5lckhUTUwgPSBvcHRpb24udGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2ZpeG1lIOS6i+S7tuebkeWQrOeahGll5YW85a655oCnXHJcbiAgICAgICAgICAgIC8v5YWz6Zet5oyJ6ZKu55qE5LqL5Lu25L6m5ZCsXHJcbiAgICAgICAgICAgICQoXCIjY29uZmlybV9tb2RhbF9lbGVtZW50XCIpLmZpbmQoXCIuY29uZmlybS1tb2RhbC1idXR0b25cIikub2ZmKFwiY2xpY2tcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvL2ZpeG1lIC5vZmYoXCJjbGlja1wiKeeUqOS6jumYsuatouWkmuasoeinpuWPkTwtLeW+iOeOhOWtpu+8jOaIkeS5n+S4jeefpemBk+S4uuS7gOS5iO+8jOS9huaYr+ivt+S4jeimgeS/ruaUueOAglxyXG4gICAgICAgICAgICAgICAgdmFyIGF0ciA9ICQodGhpcykuYXR0cihcImRhdGEtY29uZmlybVwiKTsvL+mAieaLqeeahOaMiemSrlxyXG4gICAgICAgICAgICAgICAgYmFyKys7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uICYmIGF0ciBpbiBvcHRpb24gJiYgb3B0aW9uW2F0cl0gaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvblthdHJdKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uICYmIFwiY29tcGxldGVcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmNvbXBsZXRlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uY29tcGxldGUoKTsvL+iLpeacieWujOaIkOWHveaVsO+8jOWImeaJp+ihjFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsvL+WQpuWIme+8jOWFs+mXremAieaLqeahhlxyXG4gICAgICAgICAgICAgICAgICAgIHNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy/pmLvmraLkuovku7bnu6fnu63kvKDpgJJcclxuICAgICAgICAgICAgICAgIC8vcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXRcclxuICAgICAgICAgICAgLCBzaG93OiBzaG93XHJcbiAgICAgICAgICAgICwgc2V0OiBzZXRcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgLy/opobnm5blsYJcclxuICAgIHZhciBjb3ZlciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb3Zlcl9tb2RhbF9lbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwiY292ZXJfbW9kYWxfZWxlbWVudFwiIGNsYXNzPVwiY292ZXItbW9kYWwtZWxlbWVudCBkcC1uXCI+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY292ZXJfbW9kYWxfZWxlbWVudFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb3Zlcl9tb2RhbF9lbGVtZW50XCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0XHJcbiAgICAgICAgICAgICwgc2hvdzogc2hvd1xyXG4gICAgICAgICAgICAsIGhpZGU6IGhpZGVcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpbml0TG9hZGluZzogbG9hZGluZy5pbml0XHJcbiAgICAgICAgLCBzaG93TG9hZGluZzogbG9hZGluZy5zaG93XHJcblxyXG4gICAgICAgICwgaW5pdEFsZXJ0OiBhbGVydC5pbml0XHJcbiAgICAgICAgLCBzaG93QWxlcnQ6IGFsZXJ0LnNob3dcclxuICAgICAgICAsIHNldEFsZXJ0OiBhbGVydC5zZXRcclxuXHJcbiAgICAgICAgLCBpbml0Q29uZmlybTogY29uZmlybS5pbml0XHJcbiAgICAgICAgLCBzZXRDb25maXJtOiBjb25maXJtLnNldFxyXG4gICAgICAgICwgc2hvd0NvbmZpcm06IGNvbmZpcm0uc2hvd1xyXG4gICAgICAgICwgaW5pdENvdmVyOiBjb3Zlci5pbml0XHJcbiAgICB9XHJcbn0oKSk7XHJcblxyXG4vL+mhtemdouWKoOi9veWujOavleWQjueUn+aIkOWbm+S4quiHquWumuS5ieaooeaAgeahhlxyXG5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgIC8v6aG16Z2i5Yqg6L295pe255Sf5oiQ5LiA5Liq6KaG55uW5bGCXHJcbiAgICBNb2RhbC5pbml0Q292ZXIoKTtcclxuICAgIC8v6aG16Z2i5Yqg6L295pe255Sf5oiQ5LiA5Liq5Yqg6L295L+h5oGv5qGGXHJcbiAgICBNb2RhbC5pbml0TG9hZGluZygpO1xyXG4gICAgLy/pobXpnaLliqDovb3ml7bnlJ/miJDkuIDkuKrlvLnlh7rkv6Hmga/moYZcclxuICAgIE1vZGFsLmluaXRBbGVydCgpO1xyXG4gICAgLy/pobXpnaLliqDovb3ml7bnlJ/miJDkuIDkuKrpgInmi6nkv6Hmga/moYZcclxuICAgIE1vZGFsLmluaXRDb25maXJtKCk7XHJcbn0sIDEwMCk7XHJcblxyXG5cclxuLy/mipvlh7rkuIrlsYLosIPnlKhcclxuZXhwb3J0cy5zaG93TG9hZGluZyA9IE1vZGFsLnNob3dMb2FkaW5nO1xyXG5leHBvcnRzLnNldEFsZXJ0ID0gTW9kYWwuc2V0QWxlcnQ7XHJcbmV4cG9ydHMuc2hvd0FsZXJ0ID0gTW9kYWwuc2hvd0FsZXJ0O1xyXG5leHBvcnRzLnNldENvbmZpcm0gPSBNb2RhbC5zZXRDb25maXJtO1xyXG5leHBvcnRzLnNob3dDb25maXJtID0gTW9kYWwuc2hvd0NvbmZpcm07Il19
