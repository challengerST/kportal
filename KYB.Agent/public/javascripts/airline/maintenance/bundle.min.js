(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * Created by Auser on 2016/12/6.
 */
"use strict";
var Data = (function () {
  var root = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/manage/root'
      , type: 'post'
      , data: data
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var add = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/manage/add'
      , type: 'post'
      , data: data
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var tree = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/manage/tree'
      , type: 'post'
      , data: data
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var del = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/manage/del'
      , type: 'post'
      , data: data
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var detail = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/manage/detail'
      , type: 'post'
      , data: data
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var update = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/manage/update'
      , type: 'post'
      , data: data
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var publish = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/manage/publish'
      , type: 'post'
      , data: data
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var getName = function (data, callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/manage/getName'
      , type: 'post'
      , data: data
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  var companyList = function (callback) {
    var _data = {};
    $.ajax({
      url: '/api/airline/company/list'
      , type: 'post'
      , dataType: 'json'
      , timeout: 100000
      , success: function (json) {
        if (json && "resCode" in json) {
          _data = json;
        } else {
          _data = {};
        }
      }, complete: function () {
        if (callback && callback instanceof Function) {
          callback(_data);
        }
      }
    });
  };
  return {
    add: add
    , tree: tree
    , root: root
    , del: del
    , detail: detail
    , update: update
    , publish: publish
    , getName: getName
    , companyList: companyList
  }
}());
module.exports.Data = Data;
},{}],2:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/4.
 */
'use strict';
var Listener = require('./listener').Listener;
var general = require('../../general/general').general;
general.run();
Listener.run();
},{"../../general/general":5,"./listener":3}],3:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/5.
 */
'use strict';
var Data = require('./data').Data
    , url = require('../../general/function').url
    , Modal = require('../../general/modal');
var Listener = (function () {
    //最小价格
    var minP = 0;
    var lines = {}
        , delArr = {}
        , road = [];
    var updateData = [];
    var listener = function () {
        $(document).on('click', '.bz-lv', function () {
            $(this).toggleClass('active');
        });
        $(document).on('click', '#o-sj', function () {
            $('.single-info:checked').each(function () {
                var ele = $(this).parents('tbody');
                ele.removeClass('bg-r');
                ele.data('state', 1);
            });
        });
        $(document).on('click', '#recommend', function () {
            $('.single-info:checked').each(function () {
                var ele = $(this).parents('tbody');
                ele.find('.name').parent().append('<i class="tuijian"></i>');
                ele.data('recommend', 1);
            });
        });
        $(document).on('click', '#cancel-recommend', function () {
            $('.single-info:checked').each(function () {
                var ele = $(this).parents('tbody');
                ele.find('.tuijian').remove();
                ele.data('recommend', 0);
            });
        });
        $(document).on('click', '#o-xj', function () {
            $('.single-info:checked').each(function () {
                var ele = $(this).parents('tbody');
                ele.addClass('bg-r');
                ele.data('state', 0);
            });
        });
        $(document).on('mouseenter', 'td.opt', function () {
            $(this).find('div').show();
        });
        $(document).on('mouseleave', 'td.opt', function () {
            $(this).find('div').hide();
        });
        //顶部分类选中
        $(document).on('click', '.sel-btn', function () {
            minP = parseInt($(this).data('min'));
            var str = '';
            $('#com_id').data('id', $(this).data('id')).html($(this).data('name'));
            $('.right').addClass('dp-n');
            $('.new-al').removeClass('dp-n');
            $('#start').addClass('select');
            url.set('code', $(this).data('id'));
            var arr = $(this).data('company').split(',');
            for (var i = 0; i < arr.length; i++) {
                if (i == 0) {
                    $('#start').val(arr[i]);
                }
                str += '<li>' + arr[i] + '</li>';
            }
            $('#start').siblings('ul').html(str);
            clear(true);
            initTree($(this).data('id'));
        });
        //添加航线
        $(document).on('click', '.add-line', function () {
            clear(false);
            var ele = $('#save');
            ele.data('index', 0);
            ele.data('id', 0);
            $('#start').addClass('select');
            $('.right').removeClass('dp-n');
        });
        //保存新航线
        $(document).on('click', '#save', function () {
            var price = [];
            var pass = true;
            var save = $(this)
                , ele = $('.table-container tbody[data-each="1"]');
            var indexEle = $('.show-detail.active').length > 0 ? parseInt($('.show-detail.active').data('index')) : 1;
            if (indexEle < 4) {
                //ele.each(function () {
                //    var tr = $(this).find('tr');
                //    tr.each(function () {
                //        var _this = $(this);
                //        var min = parseFloat($(this).find('.min').val());
                //        if (!min || min < minP) {
                //            pass = false;
                //            $(this).find('.min').addClass('warm');
                //        } else {
                //            $(this).find('.min').removeClass('warm');
                //            if (parseFloat(_this.find('.45').val()) && parseFloat(_this.find('.45').val()) >= (min / 45)) {
                //                _this.find('.45').removeClass('warm');
                //            } else {
                //                _this.find('.45').addClass('warm');
                //                pass = false;
                //            }
                //            if (parseFloat(_this.find('.100').val()) && parseFloat(_this.find('.100').val()) >= (min / 100)) {
                //                _this.find('.100').removeClass('warm');
                //            } else {
                //                _this.find('.100').addClass('warm');
                //                pass = false;
                //            }
                //            if (parseFloat(_this.find('.300').val()) && parseFloat(_this.find('.300').val()) >= (min / 300)) {
                //                _this.find('.300').removeClass('warm');
                //            } else {
                //                _this.find('.300').addClass('warm');
                //                pass = false;
                //            }
                //            if (parseFloat(_this.find('.500').val()) && parseFloat(_this.find('.500').val()) >= (min / 500)) {
                //                _this.find('.500').removeClass('warm');
                //            } else {
                //                _this.find('.500').addClass('warm');
                //                pass = false;
                //            }
                //            if (parseFloat(_this.find('.1000').val()) && parseFloat(_this.find('.1000').val()) >= (min / 1000)) {
                //                _this.find('.1000').removeClass('warm');
                //            } else {
                //                _this.find('.1000').addClass('warm');
                //                pass = false;
                //            }
                //        }
                //    });
                //});
                if (pass) {
                    //重新添加航线
                    if (save.data('index') == 0) {
                        var newData = [];
                        if (ele.length > 0) {
                            Data.root({
                                "companyId": 10000,
                                "airCompanyCode": $('#com_id').data('id'),
                                "deptPortCode": $('#start').val(),
                                "remarks": $('#remark').val()
                            }, function (json) {
                                if (json && 'resCode' in json && json.resCode == 0) {
                                    ele.each(function () {
                                        var _this = $(this),
                                            flightDay = [];
                                        _this.find('.week').each(function () {
                                            if ($(this).hasClass('active')) {
                                                flightDay.push(parseInt($(this).data('num')));
                                            }
                                        });
                                        price = [];
                                        _this.find('tr').each(function () {
                                            var bbbbb = $(this);
                                            price.push({
                                                proportion: parseInt(bbbbb.data('bz')) || 1
                                                , min: bbbbb.find('.min').val()
                                                , policy: {
                                                    45: bbbbb.find('.45').val()
                                                    , 100: bbbbb.find('.100').val()
                                                    , 300: bbbbb.find('.300').val()
                                                    , 500: bbbbb.find('.500').val()
                                                    , 1000: bbbbb.find('.1000').val()
                                                }
                                            })
                                        });

                                        var tag = _this.find('.single-info').data('tag');
                                        var d = {
                                            nodeId: null,
                                            companyId: 10000,
                                            groupTag: tag && tag != 0 ? tag : '',
                                            airCompanyCode: $('#com_id').data('id'),
                                            deptPortCode: $('#start').val(),
                                            destPortCode: _this.find('.name').val(),
                                            flightDay: flightDay,
                                            transMode: _this.find('.method').val() != '卡车' ? 1 : 2,
                                            airwayPrice: {
                                                rate: price
                                            },
                                            validStart: new Date(),
                                            airwayLimit: {
                                                "height": _this.find('.ope-xz').data('hei'),
                                                "width": _this.find('.ope-xz').data('wid'),
                                                "length": _this.find('.ope-xz').data('len'),
                                                "minbulk": 0,
                                                "maxbulk": 0,
                                                "totalBulk": 0,
                                                "minWeight": _this.find('.ope-xz').data('minwei'),
                                                "maxWeight": 0,
                                                "pieceWeight": _this.find('.ope-xz').data('wei'),
                                                "limtProducts": "string",
                                                "dangerousGoods": _this.find('.ope-xz').data('danger') == 1
                                            },
                                            validEnd: new Date(),
                                            remarks: _this.find('.ope-xz').data('remark'),
                                            nodeState: _this.data('state'),
                                            isHot: _this.data('recommend') == 1,
                                            MYC_Fee: _this.find('.myc').val(),
                                            SCC_Fee: _this.find('.scc').val(),
                                            parentNode: json.resBody.nodeId,
                                            childNodes: [],
                                            createDt: new Date(),
                                            modifyDt: new Date()
                                        };
                                        newData.push(d);
                                    });
                                    Data.add({data: JSON.stringify(newData)}, function (json) {
                                        if (json && 'resCode' in json && json.resCode == 0) {
                                            Modal.setAlert(json.resMsg || '添加成功！');
                                            clear(false);
                                            initTree(url.get('code'));
                                        } else {
                                            Modal.setAlert(json.resMsg || '添加失败，请重试！');
                                        }
                                    });
                                } else {
                                    Modal.setAlert(json.resMsg || '添加失败，请重试！');
                                }
                            });
                        }
                    }
                    if (save.data('index') == 1) {
                        var add = []
                            , update = [];
                        ele.each(function () {
                            var _this = $(this),
                                flightDay = [];
                            price = [];
                            _this.find('.week').each(function () {
                                if ($(this).hasClass('active')) {
                                    flightDay.push(parseInt($(this).data('num')));
                                }
                            });
                            _this.find('tr').each(function () {
                                var aaaaaa = $(this);
                                price.push({
                                    proportion: parseInt(aaaaaa.data('bz')) || 1
                                    , min: aaaaaa.find('.min').val()
                                    , policy: {
                                        45: aaaaaa.find('.45').val()
                                        , 100: aaaaaa.find('.100').val()
                                        , 300: aaaaaa.find('.300').val()
                                        , 500: aaaaaa.find('.500').val()
                                        , 1000: aaaaaa.find('.1000').val()
                                    }
                                })
                            });
                            var id = _this.find('.single-info').data('id');
                            var tag = _this.find('.single-info').data('tag');
                            var d = {
                                nodeId: id == 0 ? '' : id,
                                companyId: 10000,
                                groupTag: tag && tag != 0 ? tag : '',
                                airCompanyCode: $('#com_id').data('id'),
                                deptPortCode: save.data('ori'),
                                destPortCode: _this.find('.name').val(),
                                flightDay: flightDay,
                                transMode: _this.find('.method').val() != '卡车' ? 1 : 2,
                                airwayPrice: {
                                    rate: price
                                },
                                validStart: new Date(),
                                validEnd: new Date(),
                                airwayLimit: {
                                    "height": _this.find('.ope-xz').data('hei'),
                                    "width": _this.find('.ope-xz').data('wid'),
                                    "length": _this.find('.ope-xz').data('len'),
                                    "minbulk": 0,
                                    "maxbulk": 0,
                                    "totalBulk": 0,
                                    "minWeight": _this.find('.ope-xz').data('minwei'),
                                    "maxWeight": 0,
                                    "pieceWeight": _this.find('.ope-xz').data('wei'),
                                    "limtProducts": "string",
                                    "dangerousGoods": _this.find('.ope-xz').data('danger') == 1
                                },
                                remarks: _this.find('.ope-xz').data('remark'),
                                nodeState: _this.data('state'),
                                isHot: _this.data('recommend') == 1,
                                MYC_Fee: _this.find('.myc').val(),
                                SCC_Fee: _this.find('.scc').val(),
                                parentNode: save.data('id'),
                                childNodes: id == 0 ? [] : lines[id].childNodes,
                                createDt: new Date(),
                                modifyDt: new Date()
                            };
                            if (_this.find('.single-info').data('id') == 0) {
                                add.push(d);
                            } else {
                                update.push(d);
                            }
                        });
                        if (add.length > 0) {
                            //记录太多，超过一定长度服务器端会报“(413) Request Entity Too Large.”
                            //拆分记录上传，每次10条
                            if (add.length > 10) {
                                var index=0;
                                var errorCount = 0,sucessCount=0;
                                var processCount = 0;
                                var totalXHCount=  add.length%10 && add.length/10+1 || add.length/10;
                                var addPart = [];
                                for (var i = 0; i < add.length; i++) {
                                    index++;
                                    addPart.push(add[i]);
                                    if(index>10 || i ==add.length-1){
                                        Data.add({data: JSON.stringify(addPart)}, function (json) {
                                            processCount++;
                                            if (json && 'resCode' in json && json.resCode == 0) {
                                                sucessCount++;
                                            } else {
                                                errorCount++;
                                            }
                                            if(processCount ==parseInt(totalXHCount) ){
                                                if (errorCount == 0) {
                                                    Modal.setAlert('添加成功！');
                                                    clear(false);
                                                    initTree(url.get('code'), road);
                                                } else {
                                                    if (sucessCount > 0)Modal.setAlert('部分航线添加失败，请重试！');
                                                    else  Modal.setAlert('添加失败，请重试！');
                                                }
                                            }
                                        });
                                        index=0;
                                        addPart = [];
                                    }
                                }
                            }
                            else {
                                Data.add({data: JSON.stringify(add)}, function (json) {
                                    if (json && 'resCode' in json && json.resCode == 0) {
                                        Modal.setAlert(json.resMsg || '添加成功！');
                                        clear(false);
                                        initTree(url.get('code'), road);
                                    } else {
                                        Modal.setAlert(json.resMsg || '添加失败，请重试！');
                                    }
                                });
                            }
                        }
                        if (update.length > 0) {
                            //记录太多，超过一定长度服务器端会报“(413) Request Entity Too Large.”
                            //拆分记录上传，每次10条
                            if (update.length > 10) {
                                var index=0;
                                var errorCount = 0,sucessCount=0;
                                var processCount = 0;
                                var totalXHCount=  update.length%10 && update.length/10+1 || update.length/10;

                                var updatePart = [];
                                for (var i = 0; i < update.length; i++) {
                                    index++;
                                    updatePart.push(update[i]);
                                    if(index==10 || i ==update.length-1){
                                        Data.update({data: JSON.stringify(updatePart)}, function (json) {
                                            processCount++;
                                            if (json && 'resCode' in json && json.resCode == 0) {
                                                sucessCount++;
                                            } else {
                                                errorCount++;
                                            }

                                            if(processCount ==parseInt(totalXHCount) ){
                                                if(errorCount ==0){  Modal.setAlert( '更新成功！');
                                                    clear(false);
                                                    initTree(url.get('code'), road);
                                                } else {
                                                    if(sucessCount > 0)Modal.setAlert( '部分航线更新失败，请重试！');
                                                    else  Modal.setAlert( '更新失败，请重试！');
                                                }
                                            }
                                        });
                                        index=0;
                                        updatePart = [];
                                    }
                                }

                            }else{
                                Data.update({data: JSON.stringify(update)}, function (json) {
                                    if (json && 'resCode' in json && json.resCode == 0) {
                                        Modal.setAlert(json.resMsg || '更新成功！');
                                        clear(false);
                                        initTree(url.get('code'), road);
                                    } else {
                                        Modal.setAlert(json.resMsg || '更新失败，请重试！');
                                    }
                                });
                            }
                        }
                    }
                } else {
                    Modal.setAlert('最小价格为' + minP + '，每个等级的价格必须>=最小价格 / 等级重量！');
                }
            } else {
                Modal.setAlert('航线中转最多四次');
            }
        });
        //删除航线
        $(document).on('click', '.delete-line', function () {
            var id = $('.air-tree').find('.show-detail.active').data('id') || '';
            if (id) {
                delArr = {
                    list: [id]
                };
                $('.white-back').removeClass('dp-n');
                $('.del-part').removeClass('dp-n');
            }
        });
        //左侧航线选择
        $('.left').on('click', '.show-detail', function () {
            $('.right').removeClass('dp-n');
            $('.left').find('.show-detail').removeClass('active');
            $(this).addClass('active');
            $('#save').data('index', 1);
            $('#save').data('id', $(this).data('id'));
            clear(null);
            //重置路径
            road = [];
            getRoad($('.show-detail.active'));
            var data = {
                id: $(this).data('id')
            };
            Data.detail(data, function (json) {
                if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                    lines = {};
                    if (json.resBody.childList) {
                        var children = json.resBody.childList;
                        for (var c in children) {
                            if (children.hasOwnProperty(c)) {
                                for (var d in children[c]) {
                                    if (children[c].hasOwnProperty(d)) {
                                        var dt = children[c][d];
                                        lines[dt.nodeId] = dt;
                                    }
                                }
                            }
                        }
                    }
                    fill(json.resBody)
                } else {
                    Modal.setAlert(json.resMsg || '获取详情失败，请重试！');
                }
            });
        });
        //删除框关闭
        $(document).on('click', '.close-btn', function () {
            $('.white-back').addClass('dp-n');
            $('.show-part').addClass('dp-n');
        });
        //确认删除
        $(document).on('click', '#ensure-del', function () {
            $('.white-back').addClass('dp-n');
            $('.show-part').addClass('dp-n');
            del(delArr);
        });
        //刷新节点树
        $(document).on('click', '#refresh-tree', function () {
            initTree(url.get('code'));
        });
        //子节点折叠&打开
        $(document).on('click', '.open-icon', function () {
            $(this).parent('.get-size').siblings('ul').toggle();
            $(this).toggleClass('close-icon');
        });
        //设置分区
        $(document).on('click', '#set-group', function () {
            if ($('.single-info:checked').length > 0) {
                $('#ip-group').val('');
                $('.white-back').removeClass('dp-n');
                $('.group-part').removeClass('dp-n');
            }
        });
        //确认分区
        $(document).on('click', '#group-ensure', function () {
            var ele = $('.single-info:checked');
            if (ele.length > 0) {
                var tag = $('#ip-group').val() || 'null';
                if ($('tr[data-tg="' + tag + '"]').length <= 0) {
                    $('.table-container').find('table').append('<tbody data-each="0"><tr class=""><td colspan="13">' + tag + '</td></tr></tbody><tbody data-each="0"><tr class="hide" data-tg="' + tag + '"></tr></tbody>');
                }
                ele.each(function () {
                    $(this).data('tag', tag);
                    $('tr[data-tg="' + tag + '"]').parents('tbody').before($(this).parents('tbody'));
                });
                $('.white-back').addClass('dp-n');
                $('.group-part').addClass('dp-n');
            }
        });
    };
    /**
     *  填充航程信息
     *  @param data object 信息数据
     */
    var fill = function (data) {
        var ele = $('#start')
            , str = '<thead> <tr> <td class="th-small"><input type="checkbox" class="sel-all"/></td> <td class="th-mid">机场名称</td> <td class="th-big">头程航班</td> <td>中转方式</td><td>比重</td><td>MIN</td> <td>45KG</td> <td>100KG</td> <td>300KG</td> <td>500KG</td> <td>1000KG</td> <td>MYC</td><td>SCC</td> <td class="th-mid">操作</td> </tr> </thead>'
            , arr = data.childList;
        ele.val(data.current.destPortCode);
        ele.removeClass('select');
        $('#save').data('ori', data.current.deptPortCode);
        $('#remark').val(data.current.remarks);
        var hdTr = '', otherTd = '';
        for (var a in arr) {
            if (arr.hasOwnProperty(a)) {
                var inner = '';
                var hdInner = '';
                for (var l in arr[a]) {
                    if (arr[a].hasOwnProperty(l)) {
                        var d = arr[a][l];
                        if (a == '') {
                            hdInner += setTr(d);
                        } else {
                            inner += setTr(d);
                        }
                    }
                }
                if (a == '') {
                    hdTr += '<tbody data-each="0"><tr class="' + (a == '' ? ' hide' : '') + '"><td colspan="13">' + a + '</td></tr></tbody>' + hdInner + '<tbody data-each="0"><tr class="hide" data-tg="' + (a == '' ? 'null' : a) + '"></tr></tbody>';
                } else {
                    otherTd += '<tbody data-each="0"><tr class="' + (a == '' ? ' hide' : '') + '"><td colspan="13">' + a + '</td></tr></tbody>' + inner + '<tbody data-each="0"><tr class="hide" data-tg="' + (a == '' ? 'null' : a) + '"></tr></tbody>';
                }
            }
        }
        str += hdTr + otherTd;
        $('.table-container table').html(str);
        function setTr(d) {
            var flightDay = d.flightDay || [];
            var str = '';
            if (d['airwayPrice']['rate'].length > 0) {
                var arr = d['airwayPrice']['rate'];
                for (var a = 1; a < arr.length; a++) {
                    str += '<tr data-bz="' + arr[a].proportion + '"><td></td><td></td><td></td><td></td>' +
                        '<td><input class="bz weight" type="text" value="' + arr[a].proportion + '" readonly=""></td>' +
                        '<td><input class="min weight" type="text" value="' + arr[a].min + '"></td>' +
                        '<td><input class="45 weight" type="text" value="' + arr[a].policy['45'] + '"></td>' +
                        '<td><input class="100 weight" type="text" value="' + arr[a].policy['100'] + '"></td>' +
                        '<td><input class="300 weight" type="text" value="' + arr[a].policy['300'] + '"></td>' +
                        '<td><input class="500 weight" type="text" value="' + arr[a].policy['500'] + '"></td>' +
                        '<td><input class="1000 weight" type="text" value="' + arr[a].policy['1000'] + '"></td>' +
                        '<td></td><td></td><td></td></tr>';
                }
            }


            return '<tbody data-each="1" class="' + (d.nodeState == 1 ? '' : 'bg-r') + '" data-state="' + d.nodeState + '" data-recommend="' + (d.isHot ? '1' : '0') + '"><tr data-bz="1"> ' +
                '<td><input type="checkbox" class="single-info" data-tag="' + d.groupTag + '" data-id="' + d.nodeId + '"/></td> ' +
                '<td><input class="name" type="text" data-val="' + d.destPortCode + '" value="' + d.destPortCode + '"/> <ul class="get-name"></ul>' + (d.isHot ? '<i class="tuijian"></i>' : '') + '</td>' +
                '<td class="first">' +
                '<span class="weeks txt-input">' +
                '<span class="week' + (flightDay.indexOf(1) >= 0 ? ' active' : '') + '" data-num="1">一</span>' +
                '<span class="week' + (flightDay.indexOf(2) >= 0 ? ' active' : '') + '" data-num="2">二</span>' +
                '<span class="week' + (flightDay.indexOf(3) >= 0 ? ' active' : '') + '" data-num="3">三</span>' +
                '<span class="week' + (flightDay.indexOf(4) >= 0 ? ' active' : '') + '" data-num="4">四</span>' +
                '<span class="week' + (flightDay.indexOf(5) >= 0 ? ' active' : '') + '" data-num="5">五</span>' +
                '<span class="week' + (flightDay.indexOf(6) >= 0 ? ' active' : '') + '" data-num="6">六</span>' +
                '<span class="week' + (flightDay.indexOf(7) >= 0 ? ' active' : '') + '" data-num="7">日</span>' +
                '</span>' +
                '</td>' +
                '<td><input class="method select" type="text" readonly value="' + (d.transMode == 1 ? '飞机' : '卡车') + '"/><ul class="dp-n se-part"> <li>飞机</li> <li>卡车</li> </ul></td>' +
                '<td><input class="bz weight" type="text" value="/" readonly/></td>' +
                '<td><input class="min weight" type="text" value="' + (d['airwayPrice']['rate'][0]['min'] || '') + '"/></td>' +
                '<td><input class="45 weight" type="text" value="' + (d['airwayPrice']['rate'][0]['policy']['45'] || '') + '"/></td>' +
                '<td><input class="100 weight" type="text" value="' + (d['airwayPrice']['rate'][0]['policy']['100'] || '') + '"/></td>' +
                '<td><input class="300 weight" type="text" value="' + (d['airwayPrice']['rate'][0]['policy']['300'] || '') + '"/></td>' +
                '<td><input class="500 weight" type="text" value="' + (d['airwayPrice']['rate'][0]['policy']['500'] || '') + '"/></td>' +
                '<td><input class="1000 weight" type="text" value="' + (d['airwayPrice']['rate'][0]['policy']['1000'] || '') + '"/></td>' +
                '<td><input class="myc weight" type="text" value="' + (d.MYC_Fee || '0') + '"/></td>' +
                '<td><input class="scc weight" type="text" value="' + (d.SCC_Fee || '0') + '"/></td>' +
                '<td class="opt">操作<span class="caret"></span>' +
                '<div><a href="javascript:void(0);" class="ope-xz" data-remark="' + d.remarks + '" data-minwei="' + (d.airwayLimit ? d.airwayLimit.minWeight : '') + '" data-len="' + (d.airwayLimit ? d.airwayLimit.length : '') + '" data-wid="' + (d.airwayLimit ? d.airwayLimit.width : '') + '" data-hei="' + (d.airwayLimit ? d.airwayLimit.height : '') + '" data-wei="' + (d.airwayLimit ? d.airwayLimit.pieceWeight : '') + '" data-danger="' + (d.airwayLimit ? (d.airwayLimit.dangerousGoods ? 1 : 0) : 0) + '">限制</a>' +
                '<a href="javascript:void(0);" class="ope-bz">比重</a></div>' +
                '</td></tr>' + str + '</tbody>';
        }
    };
    /**
     *  初始化界面
     *  @param left boolean 删除左侧列表
     */
    var clear = function (left) {
        if (left) {
            $('.air-tree').html('');
        }
        $('.table-container .week').removeClass('active');
        $('#start').val($('#start').siblings('ul').find('li:first-child').text() || '');
        $('#method').val('飞机');
        $('#remark').val('');
        $('.table-container tbody').html('');
    };
    //自定义select元素事件
    var select = function () {
        $(document).on('click', '.select', function () {
            $('.se-part').addClass('dp-n');
            $(this).siblings('.se-part').removeClass('dp-n');
        });
        $(document).on('click', '.se-part li', function () {
            $(this).parents('ul').siblings('input').val($(this).html());
            if ($(this).html() == '已下架') {
                $(this).parents('ul').siblings('input').addClass('bg-r');
            } else {
                $(this).parents('ul').siblings('input').removeClass('bg-r');
            }
            $(this).parents('ul').addClass('dp-n');
        });
        $(document).on('click', function (e) {
            var target = $(e.target);
            if (target.closest('.select,.se-part li').length == 0) {
                $('.se-part').addClass('dp-n');
            }
        });
    };
    //自定义table事件
    var table = function () {
        //table添加新条目
        $(document).on('click', '#add', function () {
            var ele = '<tbody data-each="1" data-state="1"><tr data-bz="1"> ' +
                '<td><input type="checkbox" class="single-info" data-id="0" data-tag=""/></td> ' +
                '<td><input class="name" type="text" data-val=""/><ul class="get-name"></ul></td>' +
                '<td class="first">' +
                '<span class="weeks txt-input">' +
                '<span class="week active" data-num="1">一</span>' +
                '<span class="week active" data-num="2">二</span>' +
                '<span class="week active" data-num="3">三</span>' +
                '<span class="week active" data-num="4">四</span>' +
                '<span class="week active" data-num="5">五</span>' +
                '<span class="week active" data-num="6">六</span>' +
                '<span class="week active" data-num="7">日</span>' +
                '</span>' +
                '</td>' +
                '<td><input class="method select" type="text" value="飞机" readonly/><ul class="dp-n se-part"> <li>飞机</li> <li>卡车</li> </ul></td>' +
                '<td><input class="bz weight" type="text" value="/" readonly/></td>' +
                '<td><input class="min weight" type="text" value="' + minP + '"/></td>' +
                '<td><input class="45 weight" type="text"/></td>' +
                '<td><input class="100 weight" type="text"/></td>' +
                '<td><input class="300 weight" type="text"/></td>' +
                '<td><input class="500 weight" type="text"/></td>' +
                '<td><input class="1000 weight" type="text"/></td>' +
                '<td><input class="myc" type="text"/></td>' +
                '<td><input class="scc" type="text"/></td>' +
                '<td class="opt">操作<span class="caret"></span><div style="display: none;"><a href="javascript:void(0);" class="ope-xz" data-remark="" data-minwei="" data-len="" data-wid="" data-hei="" data-wei="" data-danger="0">限制</a><a href="javascript:void(0);" class="ope-bz">比重</a></div></td></tr></tbody>';
            if ($('.table-container tr[data-tg="null"]').length == 0) {
                $('.table-container thead').after('<tbody data-each="0"><tr class="hide"><td colspan="13"></td></tr></tbody><tbody data-each="0"><tr class="hide" data-tg="null"></tr></tbody>')
            }
            $('tr[data-tg="null"]').parents('tbody').before(ele);
        });
        //table删除按钮
        $(document).on('click', '#remove', function () {
            var arr = [];
            $('.single-info').each(function () {
                if ($(this).prop('checked')) {
                    if ($(this).data('id') != 0) {
                        arr.push($(this).data('id'));
                    } else {
                        $(this).parents('tbody').remove();
                    }
                }
            });
            if (arr.length > 0) {
                delArr = {
                    list: arr
                };
                $('.white-back').removeClass('dp-n');
                $('.del-part').removeClass('dp-n');
            }
            $('.sel-all').prop('checked', false);
        });
        //table全选按钮
        $(document).on('click', '.sel-all', function () {
            $('.single-info').prop('checked', $(this).prop('checked'));
        });
        //航班日期选择
        $(document).on('click', '.week', function () {
            $(this).toggleClass('active');
        });
        //获取机场名称
        $(document).on('keyup', 'input.name', function (e) {
            var _this = $(this)
                , ul = _this.siblings('.get-name');
            var index = ul.find('.active').index() || 0
                , len = ul.children().length;
            if (e.keyCode == 13) {//回车键
                var data = ul.children('.active').data('val') || ul.find('li:first-child').data('val') || '';
                $(this).val(data);
                $(this).data('val', data);
                ul.hide();
            } else if (e.keyCode == 38) {//上键
                index = index == 0 ? len - 1 : index - 1;
                ul.find('li').removeClass('active');
                ul.find('li').eq(index).addClass('active');
            } else if (e.keyCode == 40) {//下键
                index = index == len - 1 ? 0 : index + 1;
                ul.find('li').removeClass('active');
                ul.find('li').eq(index).addClass('active');
            } else {//正常输入
                Data.getName({key: _this.val()}, function (json) {
                    if (json && 'resBody' in json && json.resBody instanceof Array && json.resBody.length > 0) {
                        var str = ''
                            , body = json.resBody;
                        for (var b in body) {
                            if (body.hasOwnProperty(b)) {
                                var d = body[b];
                                str += '<li data-val="' + d.airportCode + '" class="' + (b == 0 ? 'active' : '') + '">' + d.displayName + '</li>'
                            }
                        }
                        ul.html(str);
                        ul.show();
                    }
                });
            }
        });
        //input失去焦点
        $(document).on('blur', 'input.name', function () {
            var ul = $(this).siblings('.get-name');
            if (ul.css('display') == 'block' && ul.children().length > 0) {
                var data = ul.children('.active').data('val') || ul.find('li:first-child').data('val') || '';
                $(this).val(data);
                $(this).data('val', data);
                ul.hide();
            }
        });
        //li元素悬浮获得焦点
        $(document).on('mouseenter ', '.get-name li', function () {
            $(this).addClass('active');
            $(this).siblings().removeClass('active');
        });
    };
    /**
     *  构建左侧dom树
     *  @param data object 航线节点树
     *  @param arr array 需要显示的航线
     *  @param open boolean 是否默认显示
     */
    var buildTree = function (data, arr, open, first, index) {
        var str = '';
        var i = index ? index + 1 : 1;
        for (var d in data) {
            if (data.hasOwnProperty(d)) {
                var child = data[d]['childNodes']
                    , name = data[d]['airportCode']
                    , id = data[d]['nodeId']
                    , deep = data[d]['nodeDepth'] ? parseInt(data[d]['nodeDepth']) + 1 : i;
                str += '<ul' + (open ? ' style="display: block;"' : '') + '><li><span class="get-size">' + (child.length > 0 ? '<span class="open-icon' + (arr.indexOf(id) >= 0 ? ' close-icon' : '') + '" data-id="' + id + '"></span>' : '') + '</span><div data-index="' + deep + '" class="show-detail" data-id="' + id + '"><span style="background-color: ' + (data[d]['nodeState'] ? '' : '#ccc;') + '" class="' + (first ? 'start' : 'end') + '">'
                    + (first ? '起' : '目') + '</span><span class="e-name">' + name + '</span></div>' + (child.length > 0 ? buildTree(child, arr, arr.indexOf(id) >= 0 ? 1 : 0, false, i) : '') + '</li></ul>';
            }
        }
        return str;
    };
    /**
     *  获取左侧节点树
     *  @param code string 航空公司代码
     *  @param arr string 是否需要显示路径
     */
    var initTree = function (code, arr) {
        var data = {
            cid: 10000
            , code: code
        };
        Data.tree(data, function (json) {
            if (json && 'resCode' in json && json.resCode == 0) {
                if ('nodeTree' in json.resBody && json.resBody.nodeTree.length >= 0) {
                    $('.air-tree').html(buildTree(json.resBody.nodeTree, arr && arr instanceof Array ? arr : [], null, true));
                }
            }
        });
    };
    //删除
    var del = function (data) {
        Data.del(data, function (json) {
            if (json && 'resCode' in json && json.resCode == 0) {
                Modal.setAlert(json.resMsg || '删除成功!');
                clear(false);
                var arr = data.list;
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        var d = arr[a];
                        $('.show-detail[data-id="' + d + '"]').parents('tbody').remove();
                    }
                }
            } else {
                Modal.setAlert(json.resMsg || '删除失败，请重试！');
            }
        })
    };
    //获取路径
    var getRoad = function (ele) {
        if (ele.data('id')) {
            road.push(ele.data('id'));
        }
        if (ele.parent().parent().siblings('.show-detail').length > 0) {
            getRoad(ele.parent().parent().siblings('.show-detail'));
        } else {
            return false;
        }
    };
    //发布
    var publish = function () {
        $(document).on('click', '.publish-btn', function () {
            $('#sel-time').datetimepicker({
                format: 'yyyy-mm-dd',//日期的格式
                startDate: new Date(),//选择器的开始日期
                autoclose: true,//日期选择完成后是否关闭选择框
                bootcssVer: 3,//显示向左向右的箭头
                language: 'zh-CN',//语言
                minView: "month",//表示日期选择的最小范围，默认是hour
                initialDate: new Date(new Date().getTime() + (7 * 24 * 60 * 60 * 1000))//默认选中时间
            }).on('changeDate', function (e) {
                var value = new Date(e.date).Format('yyyy-MM-dd');
                $('#expireDate').val(value);
            });
            $('#expireDate').val(new Date(new Date().getTime() + (7 * 24 * 60 * 60 * 1000)).Format('yyyy-MM-dd'));
            $('.white-back').removeClass('dp-n');
            $('.publish-part').removeClass('dp-n');
        });
        $(document).on('click', '#ensure-publish', function () {
            var data = {
                "airCompanyCode": url.get('code'),
                "expireDate": $('#expireDate').val()
            };
            Data.publish(data, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    Modal.setAlert(json.resMsg || '发布成功！', null, function () {
                        location.reload();
                    });
                } else {
                    Modal.setAlert(json.resMsg || '发布失败，请重试！');
                }
            });
        });
    };
    //批量添加
    var multi = function () {
        //显示批量添加
        $(document).on('click', '#multi-add', function () {
            var str = '<tr> <td class="first"><span class="weeks txt-input"><span class="week active" data-num="1">一</span><span class="week active" data-num="2">二</span><span class="week active" data-num="3">三</span><span class="week active" data-num="4">四</span><span class="week active" data-num="5">五</span><span class="week active" data-num="6">六</span><span class="week active" data-num="7">日</span></span></td> <td><input class="method select" type="text" value="飞机" readonly=""> <ul class="dp-n se-part"> <li>飞机</li> <li>卡车</li> </ul> </td> <td> / </td> <td><input class="min weight" value="' + (minP || 200) + '" type="text"></td><td><input class="45 weight" data-200="0" data-300="0" data-500="0" type="text"></td> <td><input class="100 weight" data-200="0" data-300="0" data-500="0" type="text"></td> <td><input class="300 weight" data-200="0" data-300="0" data-500="0" type="text"></td> <td><input class="500 weight" data-200="0" data-300="0" data-500="0" type="text"></td> <td><input class="1000 weight" data-200="0" data-300="0" data-500="0" type="text"></td><td><input class="myc" type="text"></td><td><input class="scc" type="text"></td></tr>';
            $('.tips').hide();
            $('#input-tag').val('');
            $('.create-body').html('');
            $('.multi-add tbody').html(str);
            $('.white-back').removeClass('dp-n');
            $('.add-part').removeClass('dp-n');
        });
        //获取机场名称
        $(document).on('keyup', 'input#create-end', function (e) {
            $('.tips').hide();
            var _this = $(this)
                , ul = _this.siblings('.get-name');
            var index = ul.find('.active').index() || 0
                , len = ul.children().length;
            if (e.keyCode == 13) {//回车键
                _this.val('');
                var data = ul.children('.active').data('val') || ul.find('li:first-child').data('val') || '';
                var str = '<div class="sg-add" data-val="' + data + '">' + data + '<span class="delete-sg">X</span> </div>';
                if (data && $('.create-body').children().length >= 20) {
                    $('.tips').html('每次最多添加20条').show();
                    ul.html('');
                } else if (data && $('.sg-add[data-val="' + data + '"]').length > 0) {
                    $('.tips').html('该目的地已存在').show();
                    ul.html('');
                } else if (data) {
                    $('.create-body').append(str);
                    ul.html('');
                }
                ul.hide();
            } else if (e.keyCode == 38) {//上键
                index = index == 0 ? len - 1 : index - 1;
                ul.find('li').removeClass('active');
                ul.find('li').eq(index).addClass('active');
            } else if (e.keyCode == 40) {//下键
                index = index == len - 1 ? 0 : index + 1;
                ul.find('li').removeClass('active');
                ul.find('li').eq(index).addClass('active');
            } else {//正常输入
                Data.getName({key: _this.val()}, function (json) {
                    if (json && 'resBody' in json && json.resBody instanceof Array && json.resBody.length > 0) {
                        var str = ''
                            , body = json.resBody;
                        for (var b in body) {
                            if (body.hasOwnProperty(b)) {
                                var d = body[b];
                                str += '<li data-val="' + d.airportCode + '" class="' + (b == 0 ? 'active' : '') + '">' + d.displayName + '</li>'
                            }
                        }
                        ul.html(str);
                        ul.show();
                    }
                });
            }
        });
        //input失去焦点
        $(document).on('blur', 'input#create-end', function () {
            $(this).val('');
            var ul = $(this).siblings('.get-name');
            var data = ul.children('.active').data('val') || ul.find('li:first-child').data('val') || '';
            var str = '<div class="sg-add" data-val="' + data + '">' + data + '<span class="delete-sg">X</span> </div>';
            if (data && $('.create-body').children().length >= 20) {
                $('.tips').html('每次最多添加20条').show();
                ul.html('');
            } else if (data && $('.sg-add[data-val="' + data + '"]').length > 0) {
                $('.tips').html('该目的地已存在').show();
                ul.html('');
            } else if (data) {
                $('.create-body').append(str);
                ul.html('');
            }
            ul.hide();
        });
        //确定添加
        $(document).on('click', '#ensure-add', function () {
            var str = ''
                , flightDay = [];
            var ele = $('.multi-add');
            var tg = $('#input-tag').val();
            var pass = true;

            var eleTr = ele.find('tbody').find('tr');
            //eleTr.each(function () {
            //    var _this = $(this);
            //    if (_this.find('td').length > 1) {
            //        var min = parseFloat($(this).find('.min').val());
            //        if (!min || min < minP) {
            //            pass = false;
            //            $(this).find('.min').addClass('warm');
            //            Modal.setAlert('最小价格为' + minP);
            //        } else {
            //            $(this).find('.min').removeClass('warm');
            //            if (parseFloat(_this.find('.45').val()) && parseFloat(_this.find('.45').val()) >= (min / 45)) {
            //                _this.find('.45').removeClass('warm');
            //            } else {
            //                _this.find('.45').addClass('warm');
            //                pass = false;
            //            }
            //            if (parseFloat(_this.find('.100').val()) && parseFloat(_this.find('.100').val()) >= (min / 100)) {
            //                _this.find('.100').removeClass('warm');
            //            } else {
            //                _this.find('.100').addClass('warm');
            //                pass = false;
            //            }
            //            if (parseFloat(_this.find('.300').val()) && parseFloat(_this.find('.300').val()) >= (min / 300)) {
            //                _this.find('.300').removeClass('warm');
            //            } else {
            //                _this.find('.300').addClass('warm');
            //                pass = false;
            //            }
            //            if (parseFloat(_this.find('.500').val()) && parseFloat(_this.find('.500').val()) >= (min / 500)) {
            //                _this.find('.500').removeClass('warm');
            //            } else {
            //                _this.find('.500').addClass('warm');
            //                pass = false;
            //            }
            //            if (parseFloat(_this.find('.1000').val()) && parseFloat(_this.find('.1000').val()) >= (min / 1000)) {
            //                _this.find('.1000').removeClass('warm');
            //            } else {
            //                _this.find('.1000').addClass('warm');
            //                pass = false;
            //            }
            //        }
            //    }
            //});

            if (pass) {
                ele.find('.week').each(function () {
                    if ($(this).hasClass('active')) {
                        flightDay.push(parseInt($(this).data('num')));
                    }
                });
                $('.sg-add').each(function () {
                    var d = {
                        id: 0
                        , code: $(this).data('val')
                        , tag: tg
                        , flightDay: flightDay
                        , type: ele.find('.method').val() == '飞机' ? 1 : 2
                        , min: ele.find('.min').val()
                        , 45: ele.find('.45').val()
                        , 100: ele.find('.100').val()
                        , 300: ele.find('.300').val()
                        , 500: ele.find('.500').val()
                        , 1000: ele.find('.1000').val()
                        , myc: ele.find('.myc').val()
                        , scc: ele.find('.scc').val()
                        , state: 1
                    };
                    str += '<tbody data-each="1" data-state="1"><tr> ' +
                        '<td data-bz="1"><input type="checkbox" class="single-info" data-tag="' + d.tag + '" data-id="' + d.id + '"/></td> ' +
                        '<td><input class="name" type="text" data-val="' + d.code + '" value="' + d.code + '"/> <ul class="get-name"></ul> </td>' +
                        '<td class="first">' +
                        '<span class="weeks txt-input">' +
                        '<span class="week' + (flightDay.indexOf(1) >= 0 ? ' active' : '') + '" data-num="1">一</span>' +
                        '<span class="week' + (flightDay.indexOf(2) >= 0 ? ' active' : '') + '" data-num="2">二</span>' +
                        '<span class="week' + (flightDay.indexOf(3) >= 0 ? ' active' : '') + '" data-num="3">三</span>' +
                        '<span class="week' + (flightDay.indexOf(4) >= 0 ? ' active' : '') + '" data-num="4">四</span>' +
                        '<span class="week' + (flightDay.indexOf(5) >= 0 ? ' active' : '') + '" data-num="5">五</span>' +
                        '<span class="week' + (flightDay.indexOf(6) >= 0 ? ' active' : '') + '" data-num="6">六</span>' +
                        '<span class="week' + (flightDay.indexOf(7) >= 0 ? ' active' : '') + '" data-num="7">日</span>' +
                        '</span>' +
                        '</td>' +
                        '<td><input class="method select" type="text" readonly value="' + (d.type == 1 ? '飞机' : '卡车') + '"/><ul class="dp-n se-part"> <li>飞机</li> <li>卡车</li> </ul></td>' +
                        '<td><input class="bz weight" type="text" value="/" readonly/></td>' +
                        '<td><input class="min weight" type="text" value="' + (d['min'] || '') + '"/></td>' +
                        '<td><input class="45 weight" type="text" value="' + (d['45'] || '') + '"/></td>' +
                        '<td><input class="100 weight" type="text" value="' + (d['100'] || '') + '"/></td>' +
                        '<td><input class="300 weight" type="text" value="' + (d['300'] || '') + '"/></td>' +
                        '<td><input class="500 weight" type="text" value="' + (d['500'] || '') + '"/></td>' +
                        '<td><input class="1000 weight" type="text" value="' + (d['1000'] || '') + '"/></td>' +
                        '<td><input class="myc weight" type="text" value="' + (d['myc'] || '') + '"/></td>' +
                        '<td><input class="scc weight" type="text" value="' + (d['scc'] || '') + '"/></td>' +
                        '<td class="opt">操作<span class="caret"></span><div style="display: none;">' +
                        '<a href="javascript:void(0);" class="ope-xz" data-remark="' + $('#add-beizhu').val() + '" data-minwei="' + $('#add-minWei').val() + '" data-len="' + $('#add-len').val() + '" data-wid="' + $('#add-wid').val() + '" data-hei="' + $('#add-hei').val() + '" data-wei="' + $('#add-zl').val() + '" data-danger="' + ($('#add-danger').prop('checked') ? 1 : 0) + '">限制</a>' +
                        '<a href="javascript:void(0);" class="ope-bz">比重</a></div></td></tr></tbody>';
                });
                if (tg == '') {
                    if ($('.table-container tr[data-tg="null"]').length == 0) {
                        $('.table-container thead').after('<tbody data-each=0><tr class="hide"><td colspan="13"></td></tr></tbody><tbody data-each=0><tr class="hide" data-tg="null"></tr></tbody>');
                    }
                    $('tr[data-tg="null"]').parents('tbody').before(str);
                } else {
                    if ($('.table-container tr[data-tg="' + tg + '"]').length == 0) {
                        $('.table-container table').append('<tbody data-each="0"><tr><td colspan="13">' + tg + '</td></tr></tbody><tbody data-each="0"><tr class="hide" data-tg="' + tg + '"></tr></tbody>');
                    }
                    $('tr[data-tg="' + tg + '"]').parents('tbody').before(str);
                }
                $('.white-back').addClass('dp-n');
                $('.add-part').addClass('dp-n');
            } else {
                Modal.setAlert('最小价格为' + minP + '，每个等级的价格必须>=最小价格 / 等级重量！');
            }
        });
        //删除
        $(document).on('click', '.delete-sg', function () {
            $(this).parent().remove();
        });
    };
    //批量修改
    var update = function () {
        $(document).on('click', '#multi-update', function () {
            updateData = [];
            var ele = $('.single-info:checked');
            var str = '';
            if (ele.length > 0) {
                ele.each(function () {
                    var tb = $(this).parents('tbody');
                    updateData.push(tb.index());
                    str += '<span>' + tb.find('.name').val() + '</span>'
                });
                $('.multi-update tbody').html('<tr> <td class="first"><span class="weeks txt-input"><span class="week active" data-num="1">一</span><span class="week active" data-num="2">二</span><span class="week active" data-num="3">三</span><span class="week active" data-num="4">四</span><span class="week active" data-num="5">五</span><span class="week active" data-num="6">六</span><span class="week active" data-num="7">日</span></span></td> <td><input class="method select" type="text" value="飞机" readonly=""> <ul class="dp-n se-part"> <li>飞机</li> <li>卡车</li> </ul> </td><td> / </td> <td><input value="' + minP + '" class="min weight" type="text"></td> <td><input class="45 weight" data-200="0" data-300="0" data-500="0" type="text"></td> <td><input class="100 weight" data-200="0" data-300="0" data-500="0" type="text"></td> <td><input class="300 weight" data-200="0" data-300="0" data-500="0" type="text"></td> <td><input class="500 weight" data-200="0" data-300="0" data-500="0" type="text"></td> <td><input class="1000 weight" data-200="0" data-300="0" data-500="0" type="text"></td><td><input type="text" class="myc"></td><td><input type="text" class="scc"></td></tr>');
                $('.up-end').html(str);
                $('.white-back').removeClass('dp-n');
                $('.update-part').removeClass('dp-n');
            }
        });
        $(document).on('click', '#ensure-update', function () {
            var dt = [];
            var pass2 = true;
            var ele = $('.multi-update');

            var pass = true;

            var eleTr = ele.find('tbody').find('tr');
            //eleTr.each(function () {
            //    var _this = $(this);
            //    if (_this.find('td').length > 1) {
            //        var min = parseFloat($(this).find('.min').val());
            //        if (!min || min < minP) {
            //            pass = false;
            //            $(this).find('.min').addClass('warm');
            //            Modal.setAlert('最小价格为' + minP);
            //        } else {
            //            $(this).find('.min').removeClass('warm');
            //            if (parseFloat(_this.find('.45').val()) && parseFloat(_this.find('.45').val()) >= (min / 45)) {
            //                _this.find('.45').removeClass('warm');
            //            } else {
            //                _this.find('.45').addClass('warm');
            //                pass = false;
            //            }
            //            if (parseFloat(_this.find('.100').val()) && parseFloat(_this.find('.100').val()) >= (min / 100)) {
            //                _this.find('.100').removeClass('warm');
            //            } else {
            //                _this.find('.100').addClass('warm');
            //                pass = false;
            //            }
            //            if (parseFloat(_this.find('.300').val()) && parseFloat(_this.find('.300').val()) >= (min / 300)) {
            //                _this.find('.300').removeClass('warm');
            //            } else {
            //                _this.find('.300').addClass('warm');
            //                pass = false;
            //            }
            //            if (parseFloat(_this.find('.500').val()) && parseFloat(_this.find('.500').val()) >= (min / 500)) {
            //                _this.find('.500').removeClass('warm');
            //            } else {
            //                _this.find('.500').addClass('warm');
            //                pass = false;
            //            }
            //            if (parseFloat(_this.find('.1000').val()) && parseFloat(_this.find('.1000').val()) >= (min / 1000)) {
            //                _this.find('.1000').removeClass('warm');
            //            } else {
            //                _this.find('.1000').addClass('warm');
            //                pass = false;
            //            }
            //        }
            //    }
            //});

            if (pass) {
                ele.find('.week.active').each(function () {
                    dt.push($(this).data('num'));
                });
                ele.find('.weight').each(function () {
                    if (!$(this).val()) {
                        pass2 = false;
                        $(this).addClass('warm');
                    } else {
                        $(this).removeClass('warm');
                    }
                });
                if (pass2) {
                    var data = {
                        dt: dt
                        , method: ele.find('.method').val()
                        , min: ele.find('.min').val()
                        , 45: ele.find('.45').val()
                        , 100: ele.find('.100').val()
                        , 300: ele.find('.300').val()
                        , 500: ele.find('.500').val()
                        , 1000: ele.find('.1000').val()
                        , myc: ele.find('.myc').val()
                        , scc: ele.find('.scc').val()
                    };
                    for (var i = 0; i < updateData.length; i++) {
                        var oTr = $('.table-container tbody').eq(updateData[i] - 1).find('tr[data-bz="1"]');
                        oTr.find('.method').val(data.method).end()
                            .find('.min').val(data['min']).end()
                            .find('.45').val(data['45']).end()
                            .find('.100').val(data['100']).end()
                            .find('.300').val(data['300']).end()
                            .find('.500').val(data['500']).end()
                            .find('.1000').val(data['1000']).end()
                            .find('.myc').val(data['myc']).end()
                            .find('.scc').val(data['scc']).end();

                        oTr.find('.ope-xz').data('len', $('#up-len').val());
                        oTr.find('.ope-xz').data('wid', $('#up-wid').val());
                        oTr.find('.ope-xz').data('hei', $('#up-hei').val());
                        oTr.find('.ope-xz').data('wei', $('#up-zl').val());
                        oTr.find('.ope-xz').data('minwei', $('#up-minWei').val());
                        oTr.find('.ope-xz').data('remark', $('#up-beizhu').val());
                        oTr.find('.ope-xz').data('danger', $('#up-danger').prop('checked') ? 1 : 0);

                        if (data['state'] == '已下架') {
                            $('.table-container tbody').eq(updateData[i] - 1).addClass('bg-r');
                            $('.table-container tbody').eq(updateData[i] - 1).data('state', 0);
                        } else {
                            $('.table-container tbody').eq(updateData[i] - 1).removeClass('bg-r');
                            $('.table-container tbody').eq(updateData[i] - 1).data('state', 1);
                        }
                        oTr.find('.week').each(function () {
                            if (data.dt.indexOf($(this).data('num')) >= 0) {
                                $(this).addClass('active');
                            } else {
                                $(this).removeClass('active');
                            }
                        });
                    }
                    $('.white-back').addClass('dp-n');
                    $('.update-part').addClass('dp-n');
                }
            } else {
                Modal.setAlert('最小价格为' + minP + '，每个等级的价格必须>=最小价格 / 等级重量！');
            }
        });
    };
    //航空公司
    var companyInit = function () {
        Data.companyList(function (json) {
            var str = '';
            if (json && 'resCode' in json && json.resCode == 0) {
                if ('sList' in json.resBody && json.resBody.sList instanceof Array && json.resBody.sList.length > 0) {
                    var arr = json.resBody.sList;
                    for (var a in arr) {
                        if (arr.hasOwnProperty(a)) {
                            var d = arr[a];
                            var inner = '', iArr = d.deptAirports || [];
                            for (var i = 0; i < iArr.length; i++) {
                                inner += iArr[i].airportCode + (i == iArr.length - 1 ? '' : ',');
                            }
                            var none = "this.style.display='none';document.getElementById('i" + a + "').style.display='block';";
                            str += '<div data-min="' + (d.minPrice || 200) + '" data-company="' + inner + '" class="sel-btn" data-id="' + d.airCompanyCode + '" data-name="' + d.airCompanyName + '">' +
                                ' <img src="/images/airline/' + d.airCompanyCode + '.png" class="dp-b circle" onerror="' + none + '"/> ' +
                                '<p id="i' + (a) + '" class="dp-n">' + d.airCompanyCode + '</p>' +
                                '<span class="dp-b text">' + d.airCompanyCode + '</span> </div>';
                        }
                    }
                    $('.list-cout').html('<strong>选择航空公司</strong> 已有 ' + arr.length + ' 家航空公司');
                } else {
                    str += '<div class="wrong">暂无航空公司，<a href="/airline/company">请添加！</a></div>';
                    $('.list-cout').html('<strong>选择航空公司</strong> 已有 0 家航空公司');
                }
            } else {
                str += '<div class="wrong">请求出错，请刷新重试！</div>';
                $('.list-cout').html('<strong>选择航空公司</strong> 已有 0 家航空公司');
            }
            $('.airports').find('.companys').html(str);
        });
    };
    //设置比重
    var setBz = function () {
        var opt = [];
        $(document).on('click', '.ope-bz', function () {
            opt = [];
            var ele = $(this).parents('tbody');
            opt.push(ele.index());
            $('.bz-lv').removeClass('active');
            ele.find('tr').each(function () {
                if ($(this).data('bz') != 1) {
                    $('.bz-lv[data-bz="' + $(this).data('bz') + '"]').addClass('active');
                }
            });
            $('.white-back').removeClass('dp-n');
            $('.sg-set-bz').removeClass('dp-n');
        });
        $(document).on('click', '#batch-bz', function () {
            opt = [];
            var ele = $('.single-info:checked').parents('tbody');
            ele.each(function () {
                opt.push($(this).index());
            });
            if (opt.length > 0) {
                $('.bz-lv').removeClass('active');
                $('.white-back').removeClass('dp-n');
                $('.sg-set-bz').removeClass('dp-n');
            }
        });
        $(document).on('click', '#ensure-sg-set-bz', function () {
            var arr = [];
            for (var o = 0; o < opt.length; o++) {
                var str = '';
                var tr = $('.table-container tbody').eq(opt[o] - 1).find('tr[data-bz="1"]');
                tr.siblings().remove();
                var data = {
                    min: parseFloat(tr.find('.min').val())
                    , 45: parseFloat(tr.find('.45').val())
                    , 100: parseFloat(tr.find('.100').val())
                    , 300: parseFloat(tr.find('.300').val())
                    , 500: parseFloat(tr.find('.500').val())
                    , 1000: parseFloat(tr.find('.1000').val())
                };
                $('.bz-lv.active').each(function () {
                    var bz = $(this).data('bz')
                        , p = parseFloat($('#bz-' + $(this).data('bz')).find('option:selected').val());
                    str += '<tr data-bz="' + bz + '"><td></td><td></td><td></td><td></td>' +
                        '<td><input class="bz weight" type="text" value="' + bz + '" readonly=""></td>' +
                        '<td><input class="min weight" type="text" value="' + (data['min']) + '"></td>' +
                        '<td><input class="45 weight" type="text" value="' + (data['45'] - p) + '"></td>' +
                        '<td><input class="100 weight" type="text" value="' + (data['100'] - p) + '"></td>' +
                        '<td><input class="300 weight" type="text" value="' + (data['300'] - p) + '"></td>' +
                        '<td><input class="500 weight" type="text" value="' + (data['500'] - p) + '"></td>' +
                        '<td><input class="1000 weight" type="text" value="' + (data['1000'] - p) + '"></td>' +
                        '<td></td><td></td></tr>'

                });
                tr.after(str);
            }
            $('.white-back').addClass('dp-n');
            $('.sg-set-bz').addClass('dp-n');
        });
    };
    //设置限制
    var setLimit = function () {
        var sgLimit = [];
        $(document).on('click', '.ope-xz', function () {
            sgLimit = [];
            sgLimit.push($(this).parents('tbody').index());
            $('.sg-limit-part').find('input').val('');
            $('.sg-limit-part').find('.main-info').html('已选择航线：' + $(this).parents('tbody').find('.name').val());
            $('#sg-len').val($(this).data('len'));
            $('#sg-wid').val($(this).data('wid'));
            $('#sg-hei').val($(this).data('hei'));
            $('#sg-zl').val($(this).data('wei'));
            $('#sg-minWei').val($(this).data('minwei'));
            $('#sg-beizhu').val($(this).data('remark'));
            $('#sg-danger').prop('checked', $(this).data('danger') == '1');
            $('.white-back').removeClass('dp-n');
            $('.sg-limit-part').removeClass('dp-n');
        });
        $(document).on('click', '#ensure-sg-limit', function () {
            var ele = $('.table-container tbody').eq(sgLimit[0] - 1).find('.ope-xz');
            ele.data('len', $('#sg-len').val());
            ele.data('wid', $('#sg-wid').val());
            ele.data('hei', $('#sg-hei').val());
            ele.data('wei', $('#sg-zl').val());
            ele.data('minwei', $('#sg-minWei').val());
            ele.data('remark', $('#sg-beizhu').val());
            ele.data('danger', $('#sg-danger').prop('checked') ? 1 : 0);
            $('.white-back').addClass('dp-n');
            $('.sg-limit-part').addClass('dp-n');
        });
    };
    var run = function () {
        //function notFound(t) {
        //    $(t).hide();
        //    $(t).siblings('p').show();
        //}
        listener();
        select();
        table();
        publish();
        multi();
        companyInit();
        update();
        setBz();
        setLimit();
    };
    return {
        run: run
    }
}());
module.exports.Listener = Listener;
},{"../../general/function":4,"../../general/modal":6,"./data":1}],4:[function(require,module,exports){
/**
 * Created by zrz on 2016/2/26.
 * @version 1.0.0 created 通用性功能方法
 */

'use strict';

var Fun = (function () {
    var _timeOut = 100000;//请求超时时间为10s
    /**
     * 封装ajax
     * @param option
     * {
     *      url:"请求的地址"
     *      ,method:"请求的方法"
     *      ,async:"是否并发"
     *      ,data:"发送的数据"
     *      ,success:"成功时回调"
     *      ,error:"失败/超时时回调"
     *      ,timeout:"超时时间"
     *      ,complete:"完成后的回调"
     * }
     */
    var ajax = function (option) {
        //ajax开始时应显示“加载信息框”
        Modal.showLoading();
        $.ajax({
            url: option.url
            , type: "type" in option && option.type || "GET"
            , timeout: option.timeout || _timeOut
            , data: "data" in option && option.data || {}
            , dataType: "json"
            , async: ("async" in option && option.async) ? true : false
            , success: function (json) {
                if ("status" in json && json.status > 0 && "data" in json) {
                    if ("success" in option) {
                        option.success(json.data);
                    } else {
                        Modal.setAlert("无success方法!");
                    }
                } else if ("error" in option && option.error instanceof Function) {
                    option.error(json);
                } else {
                    Modal.setAlert('操作失败!');
                }
            }, error: function (xhr) {//404或者超时
                if ("error" in option && option.error instanceof Function) {
                    //提示用户错误信息
                    Modal.showLoading(false);
                    Modal.setAlert("连接服务器失败，状态：" + (xhr.status || -1) + ",信息：" + (xhr.statusText || "-"));
                    option.error(xhr.status, xhr.statusText);//回调请求的状态和错误信息
                }
            }, complete: function (xhr, type) {
                //关闭“加载信息框”
                Modal.showLoading(false);
                if ("complete" in option && option.complete instanceof Function) {
                    option.complete(xhr, type);//回调请求的xhr信息和类型
                }
            }
        });
    };
    //全选和单选的绑定
    var setCheckboxListener = function (allCheck, radioChecks) {
        //筛选单选按钮组
        var radioValueEles = $(radioChecks);
        //点击全选时，同组按钮被同步
        $(document).delegate(allCheck, "click", function () {
            if (radioValueEles && radioValueEles.length > 0) {
                for (var _r = 0; _r < radioValueEles.length; _r++) {
                    radioValueEles[_r].checked = $(this).is(":checked");
                }
            }
        });
        //点击单选按钮时，
        $(document).delegate(radioChecks, "click", function () {
            $(allCheck)[0].checked = $(radioChecks + ":checked").length == $(radioChecks).length;
        });
    };
    var url = (function () {
        var get = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURI(r[2]);
            return null;
        };
        /**
         * 根据参数列表长度进行判断，兼容IE9
         * @returns {string}
         */
        var set = function () {
            if (arguments.length === 1 && typeof arguments[0] === 'object') {//一个对象，使用key标记value
                var obj = arguments[0]
                    , search = location.search;
                for (var o in obj) {
                    if (obj.hasOwnProperty(o)) {
                        search = changeURLKeyValue(search, o, obj[o]);
                    }
                }
                if ('pushState' in history) {
                    history.pushState(null, document.title, search);
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, search);//返回重新构造后search串
                }
            } else if (arguments.length === 2) {//key+value
                var key = arguments[0]
                    , value = arguments[1];
                if ('pushState' in history) {
                    history.pushState(null, document.title, changeURLKeyValue(location.toString(), key, value));
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, changeURLKeyValue(location.search, key, value));//返回重新构造后search串
                }
            }
            function changeURLKeyValue(url, arg, arg_val) {
                var pattern = arg + '=([^&]*)';
                var replaceText = arg + '=' + arg_val;
                if (url.match(pattern)) {
                    var tmp = '/(' + arg + '=)([^&]*)/gi';
                    tmp = url.replace(eval(tmp), replaceText);
                    return tmp;
                } else {
                    if (url.match('[\?]')) {
                        return url + '&' + replaceText;
                    } else {
                        return url + '?' + replaceText;
                    }
                }
            }
        };
        return {
            get: get
            , set: set
        }
    }());
    var formatImage=function (path, size, ele) {
        if(path instanceof  Array && path.length>0){
            path = path[0];
        }
        var IMAGE_SIZE = {
            original: {
                path: "",
                size: ""
            },
            xlarge: {
                path: "_xlarge",
                size: "660*660"
            },
            large: {
                path: "_large",
                size: "420*420"
            },
            middle: {
                path: "_middle",
                size: "300*300"
            },
            small: {
                path: "_small",
                size: "240*240"
            },
            little: {
                path: "_little",
                size: "120*120"
            },
            micro: {
                path: "_micro",
                size: "60*60"
            }
        };
        size = IMAGE_SIZE[size || "middle"] || IMAGE_SIZE.middle;
        var pathTemp = /\.\w+?$/.exec(path);
        if (!pathTemp) {
            path += size.path;
        } else {
            path = (path.substr(0, pathTemp.index || path.length)) + size.path + pathTemp[0];
        }
        if (ele && ele.attr) {
            ele.attr("src", path);
        }
        return path;
    };
    return {
        ajax: ajax
        , getTimtout: _timeOut
        , setCheckboxListener: setCheckboxListener
        , url: url
        , formatImage: formatImage
    }
}());

exports.ajax = Fun.ajax;
exports.getTimeout = Fun.getTimtout;
exports.setCheckboxListener = Fun.setCheckboxListener;
exports.url = Fun.url;
exports.formatImage = Fun.formatImage;

},{}],5:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/23.
 */
'use strict';
var Modal = require('./modal');
var general = (function () {
    var run = function () {
        //时间格式化
        Date.prototype.Format = function (fmt) { //author: Jeremyyy
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        };

        //修改密码
        $(document).on('click', '#change-pwd', function () {
            $('.change-back').removeClass('dp-n');
            $('.change-pwd').removeClass('dp-n');
        });
        //关闭修改密码
        $(document).on('click', '.close-pwd', function () {
            $('.change-back').addClass('dp-n');
            $('.change-pwd').addClass('dp-n');
        });
        $(document).on('click', '#ensure-pwd', function () {
            if ($('#new-password').val() != $('#ensure-password').val()) {
                $('#ensure-password').addClass('warm');
            } else {
                $('#ensure-password').removeClass('warm');
                var data = {
                    "agentMemberId": 0,
                    "oldPwd": $('#password').val(),
                    "pwd": $('#new-password').val(),
                    "pwdConfirm": $('#ensure-password').val()
                };
                $.ajax({
                    url: '/api/account/changePwd'
                    , type: 'post'
                    , data: data
                    , dataType: 'json'
                    , timeout: 100000
                    , success: function (json) {
                        if (json && 'resCode' in json && json.resCode == 0) {
                            Modal.setAlert('修改成功！', null, function () {
                                $('.change-back').addClass('dp-n');
                                $('.change-pwd').addClass('dp-n');
                            });
                        } else {
                            Modal.setAlert(json.resMsg || '修改失败，请重试！');
                        }
                    }
                });
            }
        });
    };
    return {
        run: run
    }
}());
module.exports.general = general;
},{"./modal":6}],6:[function(require,module,exports){
/**
 * Created by zrz on 2016/2/24.
 * @version 1.0.0 created
 */

'use strict';

//构造信息框主体
var Modal = (function () {
    //构造原始类
    function M(m) {
        this.s = m.s;//是否显示
        this.id = m.id;
    }

    //构造标准show方法，用于继承
    M.prototype.show = function () {
        var ele = document.getElementById(this.id);
        if (ele) {
            if (this.s && !isShow()) {//显示当前隐藏
                ele.className = ele.className.replace("dp-n", "");
            } else if (!this.s && isShow()) {//隐藏当前显示
                ele.className += " dp-n";
            }
            //去除两边的空格
            ele.className = String(ele.className).trim();
        }
        function isShow() {//是否已显示，无class时显示
            return ele.className.split("dp-n").length == 1;
        }
    };

    //加载信息框
    var loading = (function () {
        //初始化生成加载信息框
        var init = function () {
            if (!document.getElementById("loading_modal_element")) {
                $('body').append('<div id="loading_modal_element" class="loading-modal-body dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="loading-modal-image"></div>' +
                    '<div class="loading-modal-text">' +
                    '<h2>玩命加载中……</h2>' +
                    '</div></div>');
            }
            return false;
        };
        //显示、隐藏信息框
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;//无参数显示信息框
            var m = new M({id: "loading_modal_element", s: s});
            m.show();
        };
        return {
            init: init
            , show: show
        }
    }());
    //弹出信息框
    var alert = (function () {
        var init = function () {
            if (!document.getElementById("alert_modal_element")) {
                $('body').append('<div id="alert_modal_element" class="alert-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="alert-modal-content">' +
                    '<div class="alert-modal-body"><span class="alert-modal-text"></span></div>' +
                    '<div class="alert-modal-footer"><button id="alert_modal_close" class="alert-modal-button">关闭</button></div>' +
                    '</div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "alert_modal_element", s: s});
            m.show();
        };
        /**
         * 设置弹出信息框
         * @param msg       显示的信息，支持html
         * @param sed       倒计时关闭时间，单位：second
         * @param callback  关闭触发回调函数
         */
        var set = function (msg, sed, callback) {
            var ele = document.getElementById("alert_modal_element");
            if (msg) {
                if (typeof msg === 'object') {//应对后端返回提示时使用Object封装
                    msg = JSON.stringify(msg);
                }
                if(ele){
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }else{
                    init();
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }
                show();
            }
            if (sed > 0) {
                setTimeout(function () {
                    show(false);
                }, 1000 * sed);
            }//无关闭时间或者关闭时间为0，不自动关闭
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#alert_modal_close").on("click", function () {
                if (callback && callback instanceof Function) {
                    callback();
                }
                show(false);
                //阻止事件继续传递
                return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //选择信息框
    var confirm = (function () {
        var init = function () {
            if (!document.getElementById("confirm_modal_element")) {
                $('body').append('<div id="confirm_modal_element" class="confirm-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="confirm-modal-content">' +
                    '<div id="confirm_modal_header" class="confirm-modal-header dp-n"></div>' +
                    '<div class="confirm-modal-body"><span id="confirm_modal_text" class="confirm-modal-text"></span></div>' +
                    '<div class="confirm-modal-footer">' +
                    '<div class="footer-button-success"><button class="confirm-modal-button  modal-success" data-confirm="success">确认</button></div>' +
                    '<div class="footer-button-false"><button class="confirm-modal-button" data-confirm="error">取消</button></div>' +
                    '</div></div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "confirm_modal_element", s: s});
            m.show();
        };
        /**
         * 设置选择信息框的内容
         * @param option    配置
         * {
         *      title:"头部显示的信息"
         *      ,text:"显示的提示信息"
         *      ,success:"点击成功后的回调"
         *      ,error:"点击失败后的回调"
         *      ,complete:"点击按钮后的整体回调"
         * }
         */
        var bar = 0;
        var set = function (option) {
            if (!option) {
                return false;
            }
            if ("title" in option && option.title.length > 0) {//有头部，则显示头部
                document.getElementById("confirm_modal_header").innerHTML = option.title;
            }
            if ("text" in option && option.text.length > 0) {//有内容，则显示整个选择信息框
                document.getElementById("confirm_modal_text").innerHTML = option.text;
            }
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#confirm_modal_element").find(".confirm-modal-button").off("click").on("click", function () {
                //fixme .off("click")用于防止多次触发<--很玄学，我也不知道为什么，但是请不要修改。
                var atr = $(this).attr("data-confirm");//选择的按钮
                bar++;
                if (option && atr in option && option[atr] instanceof Function) {
                    option[atr]();
                }
                if (option && "complete" in option && option.complete instanceof Function) {
                    option.complete();//若有完成函数，则执行
                } else {//否则，关闭选择框
                    show(false);
                }
                //阻止事件继续传递
                //return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //覆盖层
    var cover = (function () {
        var init = function () {
            if (!document.getElementById("cover_modal_element")) {
                $('body').append('<div id="cover_modal_element" class="cover-modal-element dp-n"></div>');
            }
            return false;
        };
        var hide = function () {
            document.getElementById("cover_modal_element").style.display = "none";
        };
        var show = function () {
            document.getElementById("cover_modal_element").style.display = "block";
        };
        return {
            init: init
            , show: show
            , hide: hide
        }
    }());
    return {
        initLoading: loading.init
        , showLoading: loading.show

        , initAlert: alert.init
        , showAlert: alert.show
        , setAlert: alert.set

        , initConfirm: confirm.init
        , setConfirm: confirm.set
        , showConfirm: confirm.show
        , initCover: cover.init
    }
}());

//页面加载完毕后生成四个自定义模态框
setTimeout(function () {
    //页面加载时生成一个覆盖层
    Modal.initCover();
    //页面加载时生成一个加载信息框
    Modal.initLoading();
    //页面加载时生成一个弹出信息框
    Modal.initAlert();
    //页面加载时生成一个选择信息框
    Modal.initConfirm();
}, 100);


//抛出上层调用
exports.showLoading = Modal.showLoading;
exports.setAlert = Modal.setAlert;
exports.showAlert = Modal.showAlert;
exports.setConfirm = Modal.setConfirm;
exports.showConfirm = Modal.showConfirm;
},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6L252bS92Ni4yLjAvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImRhdGEuanMiLCJpbmRleC5qcyIsImxpc3RlbmVyLmpzIiwiLi4vLi4vZ2VuZXJhbC9mdW5jdGlvbi5qcyIsIi4uLy4uL2dlbmVyYWwvZ2VuZXJhbC5qcyIsIi4uLy4uL2dlbmVyYWwvbW9kYWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNweUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDak1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcclxuICogQ3JlYXRlZCBieSBBdXNlciBvbiAyMDE2LzEyLzYuXHJcbiAqL1xyXG5cInVzZSBzdHJpY3RcIjtcclxudmFyIERhdGEgPSAoZnVuY3Rpb24gKCkge1xyXG4gIHZhciByb290ID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICQuYWpheCh7XHJcbiAgICAgIHVybDogJy9hcGkvYWlybGluZS9tYW5hZ2Uvcm9vdCdcclxuICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfTtcclxuICB2YXIgYWRkID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICQuYWpheCh7XHJcbiAgICAgIHVybDogJy9hcGkvYWlybGluZS9tYW5hZ2UvYWRkJ1xyXG4gICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9O1xyXG4gIHZhciB0cmVlID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICQuYWpheCh7XHJcbiAgICAgIHVybDogJy9hcGkvYWlybGluZS9tYW5hZ2UvdHJlZSdcclxuICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfTtcclxuICB2YXIgZGVsID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICQuYWpheCh7XHJcbiAgICAgIHVybDogJy9hcGkvYWlybGluZS9tYW5hZ2UvZGVsJ1xyXG4gICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9O1xyXG4gIHZhciBkZXRhaWwgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgJC5hamF4KHtcclxuICAgICAgdXJsOiAnL2FwaS9haXJsaW5lL21hbmFnZS9kZXRhaWwnXHJcbiAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcbiAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICB1cmw6ICcvYXBpL2FpcmxpbmUvbWFuYWdlL3VwZGF0ZSdcclxuICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfTtcclxuICB2YXIgcHVibGlzaCA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICB1cmw6ICcvYXBpL2FpcmxpbmUvbWFuYWdlL3B1Ymxpc2gnXHJcbiAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcbiAgdmFyIGdldE5hbWUgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgJC5hamF4KHtcclxuICAgICAgdXJsOiAnL2FwaS9haXJsaW5lL21hbmFnZS9nZXROYW1lJ1xyXG4gICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9O1xyXG4gIHZhciBjb21wYW55TGlzdCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICB1cmw6ICcvYXBpL2FpcmxpbmUvY29tcGFueS9saXN0J1xyXG4gICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcbiAgcmV0dXJuIHtcclxuICAgIGFkZDogYWRkXHJcbiAgICAsIHRyZWU6IHRyZWVcclxuICAgICwgcm9vdDogcm9vdFxyXG4gICAgLCBkZWw6IGRlbFxyXG4gICAgLCBkZXRhaWw6IGRldGFpbFxyXG4gICAgLCB1cGRhdGU6IHVwZGF0ZVxyXG4gICAgLCBwdWJsaXNoOiBwdWJsaXNoXHJcbiAgICAsIGdldE5hbWU6IGdldE5hbWVcclxuICAgICwgY29tcGFueUxpc3Q6IGNvbXBhbnlMaXN0XHJcbiAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cy5EYXRhID0gRGF0YTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNy8xLzQuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBMaXN0ZW5lciA9IHJlcXVpcmUoJy4vbGlzdGVuZXInKS5MaXN0ZW5lcjtcclxudmFyIGdlbmVyYWwgPSByZXF1aXJlKCcuLi8uLi9nZW5lcmFsL2dlbmVyYWwnKS5nZW5lcmFsO1xyXG5nZW5lcmFsLnJ1bigpO1xyXG5MaXN0ZW5lci5ydW4oKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNy8xLzUuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBEYXRhID0gcmVxdWlyZSgnLi9kYXRhJykuRGF0YVxyXG4gICAgLCB1cmwgPSByZXF1aXJlKCcuLi8uLi9nZW5lcmFsL2Z1bmN0aW9uJykudXJsXHJcbiAgICAsIE1vZGFsID0gcmVxdWlyZSgnLi4vLi4vZ2VuZXJhbC9tb2RhbCcpO1xyXG52YXIgTGlzdGVuZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgLy/mnIDlsI/ku7fmoLxcclxuICAgIHZhciBtaW5QID0gMDtcclxuICAgIHZhciBsaW5lcyA9IHt9XHJcbiAgICAgICAgLCBkZWxBcnIgPSB7fVxyXG4gICAgICAgICwgcm9hZCA9IFtdO1xyXG4gICAgdmFyIHVwZGF0ZURhdGEgPSBbXTtcclxuICAgIHZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmJ6LWx2JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI28tc2onLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJy5zaW5nbGUtaW5mbzpjaGVja2VkJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZWxlID0gJCh0aGlzKS5wYXJlbnRzKCd0Ym9keScpO1xyXG4gICAgICAgICAgICAgICAgZWxlLnJlbW92ZUNsYXNzKCdiZy1yJyk7XHJcbiAgICAgICAgICAgICAgICBlbGUuZGF0YSgnc3RhdGUnLCAxKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNyZWNvbW1lbmQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJy5zaW5nbGUtaW5mbzpjaGVja2VkJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZWxlID0gJCh0aGlzKS5wYXJlbnRzKCd0Ym9keScpO1xyXG4gICAgICAgICAgICAgICAgZWxlLmZpbmQoJy5uYW1lJykucGFyZW50KCkuYXBwZW5kKCc8aSBjbGFzcz1cInR1aWppYW5cIj48L2k+Jyk7XHJcbiAgICAgICAgICAgICAgICBlbGUuZGF0YSgncmVjb21tZW5kJywgMSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjY2FuY2VsLXJlY29tbWVuZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLnNpbmdsZS1pbmZvOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlbGUgPSAkKHRoaXMpLnBhcmVudHMoJ3Rib2R5Jyk7XHJcbiAgICAgICAgICAgICAgICBlbGUuZmluZCgnLnR1aWppYW4nKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIGVsZS5kYXRhKCdyZWNvbW1lbmQnLCAwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNvLXhqJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcuc2luZ2xlLWluZm86Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsZSA9ICQodGhpcykucGFyZW50cygndGJvZHknKTtcclxuICAgICAgICAgICAgICAgIGVsZS5hZGRDbGFzcygnYmctcicpO1xyXG4gICAgICAgICAgICAgICAgZWxlLmRhdGEoJ3N0YXRlJywgMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWVudGVyJywgJ3RkLm9wdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKCdkaXYnKS5zaG93KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ21vdXNlbGVhdmUnLCAndGQub3B0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoJ2RpdicpLmhpZGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+mhtumDqOWIhuexu+mAieS4rVxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2VsLWJ0bicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbWluUCA9IHBhcnNlSW50KCQodGhpcykuZGF0YSgnbWluJykpO1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgICQoJyNjb21faWQnKS5kYXRhKCdpZCcsICQodGhpcykuZGF0YSgnaWQnKSkuaHRtbCgkKHRoaXMpLmRhdGEoJ25hbWUnKSk7XHJcbiAgICAgICAgICAgICQoJy5yaWdodCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5uZXctYWwnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcjc3RhcnQnKS5hZGRDbGFzcygnc2VsZWN0Jyk7XHJcbiAgICAgICAgICAgIHVybC5zZXQoJ2NvZGUnLCAkKHRoaXMpLmRhdGEoJ2lkJykpO1xyXG4gICAgICAgICAgICB2YXIgYXJyID0gJCh0aGlzKS5kYXRhKCdjb21wYW55Jykuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChpID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcjc3RhcnQnKS52YWwoYXJyW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0ciArPSAnPGxpPicgKyBhcnJbaV0gKyAnPC9saT4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICQoJyNzdGFydCcpLnNpYmxpbmdzKCd1bCcpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgY2xlYXIodHJ1ZSk7XHJcbiAgICAgICAgICAgIGluaXRUcmVlKCQodGhpcykuZGF0YSgnaWQnKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/mt7vliqDoiKrnur9cclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmFkZC1saW5lJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjbGVhcihmYWxzZSk7XHJcbiAgICAgICAgICAgIHZhciBlbGUgPSAkKCcjc2F2ZScpO1xyXG4gICAgICAgICAgICBlbGUuZGF0YSgnaW5kZXgnLCAwKTtcclxuICAgICAgICAgICAgZWxlLmRhdGEoJ2lkJywgMCk7XHJcbiAgICAgICAgICAgICQoJyNzdGFydCcpLmFkZENsYXNzKCdzZWxlY3QnKTtcclxuICAgICAgICAgICAgJCgnLnJpZ2h0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+S/neWtmOaWsOiIque6v1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjc2F2ZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHByaWNlID0gW107XHJcbiAgICAgICAgICAgIHZhciBwYXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIHNhdmUgPSAkKHRoaXMpXHJcbiAgICAgICAgICAgICAgICAsIGVsZSA9ICQoJy50YWJsZS1jb250YWluZXIgdGJvZHlbZGF0YS1lYWNoPVwiMVwiXScpO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXhFbGUgPSAkKCcuc2hvdy1kZXRhaWwuYWN0aXZlJykubGVuZ3RoID4gMCA/IHBhcnNlSW50KCQoJy5zaG93LWRldGFpbC5hY3RpdmUnKS5kYXRhKCdpbmRleCcpKSA6IDE7XHJcbiAgICAgICAgICAgIGlmIChpbmRleEVsZSA8IDQpIHtcclxuICAgICAgICAgICAgICAgIC8vZWxlLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgdmFyIHRyID0gJCh0aGlzKS5maW5kKCd0cicpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgdHIuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICB2YXIgbWluID0gcGFyc2VGbG9hdCgkKHRoaXMpLmZpbmQoJy5taW4nKS52YWwoKSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgaWYgKCFtaW4gfHwgbWluIDwgbWluUCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICQodGhpcykuZmluZCgnLm1pbicpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgJCh0aGlzKS5maW5kKCcubWluJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjQ1JykudmFsKCkpICYmIHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjQ1JykudmFsKCkpID49IChtaW4gLyA0NSkpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy40NScpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuNDUnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy4xMDAnKS52YWwoKSkgJiYgcGFyc2VGbG9hdChfdGhpcy5maW5kKCcuMTAwJykudmFsKCkpID49IChtaW4gLyAxMDApKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuMTAwJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy4xMDAnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy4zMDAnKS52YWwoKSkgJiYgcGFyc2VGbG9hdChfdGhpcy5maW5kKCcuMzAwJykudmFsKCkpID49IChtaW4gLyAzMDApKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuMzAwJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy4zMDAnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy41MDAnKS52YWwoKSkgJiYgcGFyc2VGbG9hdChfdGhpcy5maW5kKCcuNTAwJykudmFsKCkpID49IChtaW4gLyA1MDApKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuNTAwJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy41MDAnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy4xMDAwJykudmFsKCkpICYmIHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjEwMDAnKS52YWwoKSkgPj0gKG1pbiAvIDEwMDApKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuMTAwMCcpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuMTAwMCcpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICB9KTtcclxuICAgICAgICAgICAgICAgIC8vfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8v6YeN5paw5re75Yqg6Iiq57q/XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhdmUuZGF0YSgnaW5kZXgnKSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdEYXRhID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YS5yb290KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbXBhbnlJZFwiOiAxMDAwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFpckNvbXBhbnlDb2RlXCI6ICQoJyNjb21faWQnKS5kYXRhKCdpZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGVwdFBvcnRDb2RlXCI6ICQoJyNzdGFydCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicmVtYXJrc1wiOiAkKCcjcmVtYXJrJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGlnaHREYXkgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy53ZWVrJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaWdodERheS5wdXNoKHBhcnNlSW50KCQodGhpcykuZGF0YSgnbnVtJykpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCd0cicpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiYmJiYiA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2UucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BvcnRpb246IHBhcnNlSW50KGJiYmJiLmRhdGEoJ2J6JykpIHx8IDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBtaW46IGJiYmJiLmZpbmQoJy5taW4nKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIHBvbGljeToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNDU6IGJiYmJiLmZpbmQoJy40NScpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIDEwMDogYmJiYmIuZmluZCgnLjEwMCcpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIDMwMDogYmJiYmIuZmluZCgnLjMwMCcpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIDUwMDogYmJiYmIuZmluZCgnLjUwMCcpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIDEwMDA6IGJiYmJiLmZpbmQoJy4xMDAwJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFnID0gX3RoaXMuZmluZCgnLnNpbmdsZS1pbmZvJykuZGF0YSgndGFnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlSWQ6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFueUlkOiAxMDAwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFRhZzogdGFnICYmIHRhZyAhPSAwID8gdGFnIDogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlyQ29tcGFueUNvZGU6ICQoJyNjb21faWQnKS5kYXRhKCdpZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcHRQb3J0Q29kZTogJCgnI3N0YXJ0JykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzdFBvcnRDb2RlOiBfdGhpcy5maW5kKCcubmFtZScpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaWdodERheTogZmxpZ2h0RGF5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zTW9kZTogX3RoaXMuZmluZCgnLm1ldGhvZCcpLnZhbCgpICE9ICfljaHovaYnID8gMSA6IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlyd2F5UHJpY2U6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF0ZTogcHJpY2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkU3RhcnQ6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlyd2F5TGltaXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogX3RoaXMuZmluZCgnLm9wZS14eicpLmRhdGEoJ2hlaScpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCI6IF90aGlzLmZpbmQoJy5vcGUteHonKS5kYXRhKCd3aWQnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsZW5ndGhcIjogX3RoaXMuZmluZCgnLm9wZS14eicpLmRhdGEoJ2xlbicpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1pbmJ1bGtcIjogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhidWxrXCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG90YWxCdWxrXCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWluV2VpZ2h0XCI6IF90aGlzLmZpbmQoJy5vcGUteHonKS5kYXRhKCdtaW53ZWknKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhXZWlnaHRcIjogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwaWVjZVdlaWdodFwiOiBfdGhpcy5maW5kKCcub3BlLXh6JykuZGF0YSgnd2VpJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGltdFByb2R1Y3RzXCI6IFwic3RyaW5nXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGFuZ2Vyb3VzR29vZHNcIjogX3RoaXMuZmluZCgnLm9wZS14eicpLmRhdGEoJ2RhbmdlcicpID09IDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkRW5kOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFya3M6IF90aGlzLmZpbmQoJy5vcGUteHonKS5kYXRhKCdyZW1hcmsnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlU3RhdGU6IF90aGlzLmRhdGEoJ3N0YXRlJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIb3Q6IF90aGlzLmRhdGEoJ3JlY29tbWVuZCcpID09IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTVlDX0ZlZTogX3RoaXMuZmluZCgnLm15YycpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNDQ19GZWU6IF90aGlzLmZpbmQoJy5zY2MnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlOiBqc29uLnJlc0JvZHkubm9kZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkTm9kZXM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUR0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmeUR0OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RGF0YS5wdXNoKGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YS5hZGQoe2RhdGE6IEpTT04uc3RyaW5naWZ5KG5ld0RhdGEpfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+a3u+WKoOaIkOWKn++8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0VHJlZSh1cmwuZ2V0KCdjb2RlJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn5re75Yqg5aSx6LSl77yM6K+36YeN6K+V77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfmt7vliqDlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2F2ZS5kYXRhKCdpbmRleCcpID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFkZCA9IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIHVwZGF0ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGUuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaWdodERheSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2UgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy53ZWVrJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsaWdodERheS5wdXNoKHBhcnNlSW50KCQodGhpcykuZGF0YSgnbnVtJykpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJ3RyJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFhYWFhYSA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2UucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BvcnRpb246IHBhcnNlSW50KGFhYWFhYS5kYXRhKCdieicpKSB8fCAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgbWluOiBhYWFhYWEuZmluZCgnLm1pbicpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgcG9saWN5OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA0NTogYWFhYWFhLmZpbmQoJy40NScpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIDEwMDogYWFhYWFhLmZpbmQoJy4xMDAnKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAzMDA6IGFhYWFhYS5maW5kKCcuMzAwJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgNTAwOiBhYWFhYWEuZmluZCgnLjUwMCcpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIDEwMDA6IGFhYWFhYS5maW5kKCcuMTAwMCcpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBfdGhpcy5maW5kKCcuc2luZ2xlLWluZm8nKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhZyA9IF90aGlzLmZpbmQoJy5zaW5nbGUtaW5mbycpLmRhdGEoJ3RhZycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkOiBpZCA9PSAwID8gJycgOiBpZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYW55SWQ6IDEwMDAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwVGFnOiB0YWcgJiYgdGFnICE9IDAgPyB0YWcgOiAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaXJDb21wYW55Q29kZTogJCgnI2NvbV9pZCcpLmRhdGEoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwdFBvcnRDb2RlOiBzYXZlLmRhdGEoJ29yaScpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc3RQb3J0Q29kZTogX3RoaXMuZmluZCgnLm5hbWUnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGlnaHREYXk6IGZsaWdodERheSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc01vZGU6IF90aGlzLmZpbmQoJy5tZXRob2QnKS52YWwoKSAhPSAn5Y2h6L2mJyA/IDEgOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpcndheVByaWNlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGU6IHByaWNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZFN0YXJ0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkRW5kOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpcndheUxpbWl0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IF90aGlzLmZpbmQoJy5vcGUteHonKS5kYXRhKCdoZWknKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiBfdGhpcy5maW5kKCcub3BlLXh6JykuZGF0YSgnd2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGVuZ3RoXCI6IF90aGlzLmZpbmQoJy5vcGUteHonKS5kYXRhKCdsZW4nKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtaW5idWxrXCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWF4YnVsa1wiOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvdGFsQnVsa1wiOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1pbldlaWdodFwiOiBfdGhpcy5maW5kKCcub3BlLXh6JykuZGF0YSgnbWlud2VpJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWF4V2VpZ2h0XCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGllY2VXZWlnaHRcIjogX3RoaXMuZmluZCgnLm9wZS14eicpLmRhdGEoJ3dlaScpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxpbXRQcm9kdWN0c1wiOiBcInN0cmluZ1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhbmdlcm91c0dvb2RzXCI6IF90aGlzLmZpbmQoJy5vcGUteHonKS5kYXRhKCdkYW5nZXInKSA9PSAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1hcmtzOiBfdGhpcy5maW5kKCcub3BlLXh6JykuZGF0YSgncmVtYXJrJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVN0YXRlOiBfdGhpcy5kYXRhKCdzdGF0ZScpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzSG90OiBfdGhpcy5kYXRhKCdyZWNvbW1lbmQnKSA9PSAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1ZQ19GZWU6IF90aGlzLmZpbmQoJy5teWMnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTQ0NfRmVlOiBfdGhpcy5maW5kKCcuc2NjJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZTogc2F2ZS5kYXRhKCdpZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkTm9kZXM6IGlkID09IDAgPyBbXSA6IGxpbmVzW2lkXS5jaGlsZE5vZGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUR0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmeUR0OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmZpbmQoJy5zaW5nbGUtaW5mbycpLmRhdGEoJ2lkJykgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZC5wdXNoKGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUucHVzaChkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/orrDlvZXlpKrlpJrvvIzotoXov4fkuIDlrprplb/luqbmnI3liqHlmajnq6/kvJrmiqXigJwoNDEzKSBSZXF1ZXN0IEVudGl0eSBUb28gTGFyZ2Uu4oCdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aLhuWIhuiusOW9leS4iuS8oO+8jOavj+asoTEw5p2hXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWRkLmxlbmd0aCA+IDEwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4PTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yQ291bnQgPSAwLHN1Y2Vzc0NvdW50PTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NDb3VudCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvdGFsWEhDb3VudD0gIGFkZC5sZW5ndGglMTAgJiYgYWRkLmxlbmd0aC8xMCsxIHx8IGFkZC5sZW5ndGgvMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFkZFBhcnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFkZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRQYXJ0LnB1c2goYWRkW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXg+MTAgfHwgaSA9PWFkZC5sZW5ndGgtMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhLmFkZCh7ZGF0YTogSlNPTi5zdHJpbmdpZnkoYWRkUGFydCl9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Vzc0NvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihwcm9jZXNzQ291bnQgPT1wYXJzZUludCh0b3RhbFhIQ291bnQpICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnJvckNvdW50ID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmt7vliqDmiJDlip/vvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRUcmVlKHVybC5nZXQoJ2NvZGUnKSwgcm9hZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VjZXNzQ291bnQgPiAwKU1vZGFsLnNldEFsZXJ0KCfpg6jliIboiKrnur/mt7vliqDlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgIE1vZGFsLnNldEFsZXJ0KCfmt7vliqDlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFBhcnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEuYWRkKHtkYXRhOiBKU09OLnN0cmluZ2lmeShhZGQpfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfmt7vliqDmiJDlip/vvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRUcmVlKHVybC5nZXQoJ2NvZGUnKSwgcm9hZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn5re75Yqg5aSx6LSl77yM6K+36YeN6K+V77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v6K6w5b2V5aSq5aSa77yM6LaF6L+H5LiA5a6a6ZW/5bqm5pyN5Yqh5Zmo56uv5Lya5oql4oCcKDQxMykgUmVxdWVzdCBFbnRpdHkgVG9vIExhcmdlLuKAnVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mi4bliIborrDlvZXkuIrkvKDvvIzmr4/mrKExMOadoVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVwZGF0ZS5sZW5ndGggPiAxMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleD0wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvckNvdW50ID0gMCxzdWNlc3NDb3VudD0wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzQ291bnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbFhIQ291bnQ9ICB1cGRhdGUubGVuZ3RoJTEwICYmIHVwZGF0ZS5sZW5ndGgvMTArMSB8fCB1cGRhdGUubGVuZ3RoLzEwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlUGFydCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdXBkYXRlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBhcnQucHVzaCh1cGRhdGVbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRleD09MTAgfHwgaSA9PXVwZGF0ZS5sZW5ndGgtMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhLnVwZGF0ZSh7ZGF0YTogSlNPTi5zdHJpbmdpZnkodXBkYXRlUGFydCl9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Vzc0NvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocHJvY2Vzc0NvdW50ID09cGFyc2VJbnQodG90YWxYSENvdW50KSApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlcnJvckNvdW50ID09MCl7ICBNb2RhbC5zZXRBbGVydCggJ+abtOaWsOaIkOWKn++8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXIoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdFRyZWUodXJsLmdldCgnY29kZScpLCByb2FkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN1Y2Vzc0NvdW50ID4gMClNb2RhbC5zZXRBbGVydCggJ+mDqOWIhuiIque6v+abtOaWsOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAgTW9kYWwuc2V0QWxlcnQoICfmm7TmlrDlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg9MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBhcnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhLnVwZGF0ZSh7ZGF0YTogSlNPTi5zdHJpbmdpZnkodXBkYXRlKX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn5pu05paw5oiQ5Yqf77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhcihmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0VHJlZSh1cmwuZ2V0KCdjb2RlJyksIHJvYWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+abtOaWsOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmnIDlsI/ku7fmoLzkuLonICsgbWluUCArICfvvIzmr4/kuKrnrYnnuqfnmoTku7fmoLzlv4Xpobs+PeacgOWwj+S7t+agvCAvIOetiee6p+mHjemHj++8gScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+iIque6v+S4rei9rOacgOWkmuWbm+asoScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/liKDpmaToiKrnur9cclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmRlbGV0ZS1saW5lJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgaWQgPSAkKCcuYWlyLXRyZWUnKS5maW5kKCcuc2hvdy1kZXRhaWwuYWN0aXZlJykuZGF0YSgnaWQnKSB8fCAnJztcclxuICAgICAgICAgICAgaWYgKGlkKSB7XHJcbiAgICAgICAgICAgICAgICBkZWxBcnIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdDogW2lkXVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICQoJy5kZWwtcGFydCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+W3puS+p+iIque6v+mAieaLqVxyXG4gICAgICAgICQoJy5sZWZ0Jykub24oJ2NsaWNrJywgJy5zaG93LWRldGFpbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLnJpZ2h0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnLmxlZnQnKS5maW5kKCcuc2hvdy1kZXRhaWwnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAkKCcjc2F2ZScpLmRhdGEoJ2luZGV4JywgMSk7XHJcbiAgICAgICAgICAgICQoJyNzYXZlJykuZGF0YSgnaWQnLCAkKHRoaXMpLmRhdGEoJ2lkJykpO1xyXG4gICAgICAgICAgICBjbGVhcihudWxsKTtcclxuICAgICAgICAgICAgLy/ph43nva7ot6/lvoRcclxuICAgICAgICAgICAgcm9hZCA9IFtdO1xyXG4gICAgICAgICAgICBnZXRSb2FkKCQoJy5zaG93LWRldGFpbC5hY3RpdmUnKSk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgaWQ6ICQodGhpcykuZGF0YSgnaWQnKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBEYXRhLmRldGFpbChkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDAgJiYganNvbi5yZXNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGluZXMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoanNvbi5yZXNCb2R5LmNoaWxkTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSBqc29uLnJlc0JvZHkuY2hpbGRMaXN0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjIGluIGNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRyZW4uaGFzT3duUHJvcGVydHkoYykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBkIGluIGNoaWxkcmVuW2NdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbltjXS5oYXNPd25Qcm9wZXJ0eShkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR0ID0gY2hpbGRyZW5bY11bZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lc1tkdC5ub2RlSWRdID0gZHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsbChqc29uLnJlc0JvZHkpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfojrflj5bor6bmg4XlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/liKDpmaTmoYblhbPpl61cclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNsb3NlLWJ0bicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcuc2hvdy1wYXJ0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+ehruiupOWIoOmZpFxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZW5zdXJlLWRlbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcuc2hvdy1wYXJ0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgZGVsKGRlbEFycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/liLfmlrDoioLngrnmoJFcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3JlZnJlc2gtdHJlZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaW5pdFRyZWUodXJsLmdldCgnY29kZScpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+WtkOiKgueCueaKmOWPoCbmiZPlvIBcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLm9wZW4taWNvbicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoJy5nZXQtc2l6ZScpLnNpYmxpbmdzKCd1bCcpLnRvZ2dsZSgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdjbG9zZS1pY29uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/orr7nva7liIbljLpcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3NldC1ncm91cCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCQoJy5zaW5nbGUtaW5mbzpjaGVja2VkJykubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgJCgnI2lwLWdyb3VwJykudmFsKCcnKTtcclxuICAgICAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICQoJy5ncm91cC1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8v56Gu6K6k5YiG5Yy6XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNncm91cC1lbnN1cmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGUgPSAkKCcuc2luZ2xlLWluZm86Y2hlY2tlZCcpO1xyXG4gICAgICAgICAgICBpZiAoZWxlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciB0YWcgPSAkKCcjaXAtZ3JvdXAnKS52YWwoKSB8fCAnbnVsbCc7XHJcbiAgICAgICAgICAgICAgICBpZiAoJCgndHJbZGF0YS10Zz1cIicgKyB0YWcgKyAnXCJdJykubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcudGFibGUtY29udGFpbmVyJykuZmluZCgndGFibGUnKS5hcHBlbmQoJzx0Ym9keSBkYXRhLWVhY2g9XCIwXCI+PHRyIGNsYXNzPVwiXCI+PHRkIGNvbHNwYW49XCIxM1wiPicgKyB0YWcgKyAnPC90ZD48L3RyPjwvdGJvZHk+PHRib2R5IGRhdGEtZWFjaD1cIjBcIj48dHIgY2xhc3M9XCJoaWRlXCIgZGF0YS10Zz1cIicgKyB0YWcgKyAnXCI+PC90cj48L3Rib2R5PicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxlLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZGF0YSgndGFnJywgdGFnKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCd0cltkYXRhLXRnPVwiJyArIHRhZyArICdcIl0nKS5wYXJlbnRzKCd0Ym9keScpLmJlZm9yZSgkKHRoaXMpLnBhcmVudHMoJ3Rib2R5JykpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcuZ3JvdXAtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqICDloavlhYXoiKrnqIvkv6Hmga9cclxuICAgICAqICBAcGFyYW0gZGF0YSBvYmplY3Qg5L+h5oGv5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHZhciBmaWxsID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB2YXIgZWxlID0gJCgnI3N0YXJ0JylcclxuICAgICAgICAgICAgLCBzdHIgPSAnPHRoZWFkPiA8dHI+IDx0ZCBjbGFzcz1cInRoLXNtYWxsXCI+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwic2VsLWFsbFwiLz48L3RkPiA8dGQgY2xhc3M9XCJ0aC1taWRcIj7mnLrlnLrlkI3np7A8L3RkPiA8dGQgY2xhc3M9XCJ0aC1iaWdcIj7lpLTnqIvoiKrnj608L3RkPiA8dGQ+5Lit6L2s5pa55byPPC90ZD48dGQ+5q+U6YeNPC90ZD48dGQ+TUlOPC90ZD4gPHRkPjQ1S0c8L3RkPiA8dGQ+MTAwS0c8L3RkPiA8dGQ+MzAwS0c8L3RkPiA8dGQ+NTAwS0c8L3RkPiA8dGQ+MTAwMEtHPC90ZD4gPHRkPk1ZQzwvdGQ+PHRkPlNDQzwvdGQ+IDx0ZCBjbGFzcz1cInRoLW1pZFwiPuaTjeS9nDwvdGQ+IDwvdHI+IDwvdGhlYWQ+J1xyXG4gICAgICAgICAgICAsIGFyciA9IGRhdGEuY2hpbGRMaXN0O1xyXG4gICAgICAgIGVsZS52YWwoZGF0YS5jdXJyZW50LmRlc3RQb3J0Q29kZSk7XHJcbiAgICAgICAgZWxlLnJlbW92ZUNsYXNzKCdzZWxlY3QnKTtcclxuICAgICAgICAkKCcjc2F2ZScpLmRhdGEoJ29yaScsIGRhdGEuY3VycmVudC5kZXB0UG9ydENvZGUpO1xyXG4gICAgICAgICQoJyNyZW1hcmsnKS52YWwoZGF0YS5jdXJyZW50LnJlbWFya3MpO1xyXG4gICAgICAgIHZhciBoZFRyID0gJycsIG90aGVyVGQgPSAnJztcclxuICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5uZXIgPSAnJztcclxuICAgICAgICAgICAgICAgIHZhciBoZElubmVyID0gJyc7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBsIGluIGFyclthXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcnJbYV0uaGFzT3duUHJvcGVydHkobCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhcnJbYV1bbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhID09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZElubmVyICs9IHNldFRyKGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXIgKz0gc2V0VHIoZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYSA9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhkVHIgKz0gJzx0Ym9keSBkYXRhLWVhY2g9XCIwXCI+PHRyIGNsYXNzPVwiJyArIChhID09ICcnID8gJyBoaWRlJyA6ICcnKSArICdcIj48dGQgY29sc3Bhbj1cIjEzXCI+JyArIGEgKyAnPC90ZD48L3RyPjwvdGJvZHk+JyArIGhkSW5uZXIgKyAnPHRib2R5IGRhdGEtZWFjaD1cIjBcIj48dHIgY2xhc3M9XCJoaWRlXCIgZGF0YS10Zz1cIicgKyAoYSA9PSAnJyA/ICdudWxsJyA6IGEpICsgJ1wiPjwvdHI+PC90Ym9keT4nO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBvdGhlclRkICs9ICc8dGJvZHkgZGF0YS1lYWNoPVwiMFwiPjx0ciBjbGFzcz1cIicgKyAoYSA9PSAnJyA/ICcgaGlkZScgOiAnJykgKyAnXCI+PHRkIGNvbHNwYW49XCIxM1wiPicgKyBhICsgJzwvdGQ+PC90cj48L3Rib2R5PicgKyBpbm5lciArICc8dGJvZHkgZGF0YS1lYWNoPVwiMFwiPjx0ciBjbGFzcz1cImhpZGVcIiBkYXRhLXRnPVwiJyArIChhID09ICcnID8gJ251bGwnIDogYSkgKyAnXCI+PC90cj48L3Rib2R5Pic7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc3RyICs9IGhkVHIgKyBvdGhlclRkO1xyXG4gICAgICAgICQoJy50YWJsZS1jb250YWluZXIgdGFibGUnKS5odG1sKHN0cik7XHJcbiAgICAgICAgZnVuY3Rpb24gc2V0VHIoZCkge1xyXG4gICAgICAgICAgICB2YXIgZmxpZ2h0RGF5ID0gZC5mbGlnaHREYXkgfHwgW107XHJcbiAgICAgICAgICAgIHZhciBzdHIgPSAnJztcclxuICAgICAgICAgICAgaWYgKGRbJ2FpcndheVByaWNlJ11bJ3JhdGUnXS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gZFsnYWlyd2F5UHJpY2UnXVsncmF0ZSddO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IDE7IGEgPCBhcnIubGVuZ3RoOyBhKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzx0ciBkYXRhLWJ6PVwiJyArIGFyclthXS5wcm9wb3J0aW9uICsgJ1wiPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cImJ6IHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgYXJyW2FdLnByb3BvcnRpb24gKyAnXCIgcmVhZG9ubHk9XCJcIj48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIm1pbiB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIGFyclthXS5taW4gKyAnXCI+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCI0NSB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIGFyclthXS5wb2xpY3lbJzQ1J10gKyAnXCI+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCIxMDAgd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyBhcnJbYV0ucG9saWN5WycxMDAnXSArICdcIj48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjMwMCB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIGFyclthXS5wb2xpY3lbJzMwMCddICsgJ1wiPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwiNTAwIHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgYXJyW2FdLnBvbGljeVsnNTAwJ10gKyAnXCI+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCIxMDAwIHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgYXJyW2FdLnBvbGljeVsnMTAwMCddICsgJ1wiPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8dGQ+PC90ZD48dGQ+PC90ZD48dGQ+PC90ZD48L3RyPic7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICByZXR1cm4gJzx0Ym9keSBkYXRhLWVhY2g9XCIxXCIgY2xhc3M9XCInICsgKGQubm9kZVN0YXRlID09IDEgPyAnJyA6ICdiZy1yJykgKyAnXCIgZGF0YS1zdGF0ZT1cIicgKyBkLm5vZGVTdGF0ZSArICdcIiBkYXRhLXJlY29tbWVuZD1cIicgKyAoZC5pc0hvdCA/ICcxJyA6ICcwJykgKyAnXCI+PHRyIGRhdGEtYno9XCIxXCI+ICcgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2xhc3M9XCJzaW5nbGUtaW5mb1wiIGRhdGEtdGFnPVwiJyArIGQuZ3JvdXBUYWcgKyAnXCIgZGF0YS1pZD1cIicgKyBkLm5vZGVJZCArICdcIi8+PC90ZD4gJyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIm5hbWVcIiB0eXBlPVwidGV4dFwiIGRhdGEtdmFsPVwiJyArIGQuZGVzdFBvcnRDb2RlICsgJ1wiIHZhbHVlPVwiJyArIGQuZGVzdFBvcnRDb2RlICsgJ1wiLz4gPHVsIGNsYXNzPVwiZ2V0LW5hbWVcIj48L3VsPicgKyAoZC5pc0hvdCA/ICc8aSBjbGFzcz1cInR1aWppYW5cIj48L2k+JyA6ICcnKSArICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZCBjbGFzcz1cImZpcnN0XCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrcyB0eHQtaW5wdXRcIj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIndlZWsnICsgKGZsaWdodERheS5pbmRleE9mKDEpID49IDAgPyAnIGFjdGl2ZScgOiAnJykgKyAnXCIgZGF0YS1udW09XCIxXCI+5LiAPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwid2VlaycgKyAoZmxpZ2h0RGF5LmluZGV4T2YoMikgPj0gMCA/ICcgYWN0aXZlJyA6ICcnKSArICdcIiBkYXRhLW51bT1cIjJcIj7kuow8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrJyArIChmbGlnaHREYXkuaW5kZXhPZigzKSA+PSAwID8gJyBhY3RpdmUnIDogJycpICsgJ1wiIGRhdGEtbnVtPVwiM1wiPuS4iTwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIndlZWsnICsgKGZsaWdodERheS5pbmRleE9mKDQpID49IDAgPyAnIGFjdGl2ZScgOiAnJykgKyAnXCIgZGF0YS1udW09XCI0XCI+5ZubPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwid2VlaycgKyAoZmxpZ2h0RGF5LmluZGV4T2YoNSkgPj0gMCA/ICcgYWN0aXZlJyA6ICcnKSArICdcIiBkYXRhLW51bT1cIjVcIj7kupQ8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrJyArIChmbGlnaHREYXkuaW5kZXhPZig2KSA+PSAwID8gJyBhY3RpdmUnIDogJycpICsgJ1wiIGRhdGEtbnVtPVwiNlwiPuWFrTwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIndlZWsnICsgKGZsaWdodERheS5pbmRleE9mKDcpID49IDAgPyAnIGFjdGl2ZScgOiAnJykgKyAnXCIgZGF0YS1udW09XCI3XCI+5pelPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAgICAgJzwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCJtZXRob2Qgc2VsZWN0XCIgdHlwZT1cInRleHRcIiByZWFkb25seSB2YWx1ZT1cIicgKyAoZC50cmFuc01vZGUgPT0gMSA/ICfpo57mnLonIDogJ+WNoei9picpICsgJ1wiLz48dWwgY2xhc3M9XCJkcC1uIHNlLXBhcnRcIj4gPGxpPumjnuacujwvbGk+IDxsaT7ljaHovaY8L2xpPiA8L3VsPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cImJ6IHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCIvXCIgcmVhZG9ubHkvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIm1pbiB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkWydhaXJ3YXlQcmljZSddWydyYXRlJ11bMF1bJ21pbiddIHx8ICcnKSArICdcIi8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwiNDUgd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyAoZFsnYWlyd2F5UHJpY2UnXVsncmF0ZSddWzBdWydwb2xpY3knXVsnNDUnXSB8fCAnJykgKyAnXCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjEwMCB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkWydhaXJ3YXlQcmljZSddWydyYXRlJ11bMF1bJ3BvbGljeSddWycxMDAnXSB8fCAnJykgKyAnXCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjMwMCB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkWydhaXJ3YXlQcmljZSddWydyYXRlJ11bMF1bJ3BvbGljeSddWyczMDAnXSB8fCAnJykgKyAnXCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjUwMCB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkWydhaXJ3YXlQcmljZSddWydyYXRlJ11bMF1bJ3BvbGljeSddWyc1MDAnXSB8fCAnJykgKyAnXCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjEwMDAgd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyAoZFsnYWlyd2F5UHJpY2UnXVsncmF0ZSddWzBdWydwb2xpY3knXVsnMTAwMCddIHx8ICcnKSArICdcIi8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwibXljIHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgKGQuTVlDX0ZlZSB8fCAnMCcpICsgJ1wiLz48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCJzY2Mgd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyAoZC5TQ0NfRmVlIHx8ICcwJykgKyAnXCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwib3B0XCI+5pON5L2cPHNwYW4gY2xhc3M9XCJjYXJldFwiPjwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8ZGl2PjxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJvcGUteHpcIiBkYXRhLXJlbWFyaz1cIicgKyBkLnJlbWFya3MgKyAnXCIgZGF0YS1taW53ZWk9XCInICsgKGQuYWlyd2F5TGltaXQgPyBkLmFpcndheUxpbWl0Lm1pbldlaWdodCA6ICcnKSArICdcIiBkYXRhLWxlbj1cIicgKyAoZC5haXJ3YXlMaW1pdCA/IGQuYWlyd2F5TGltaXQubGVuZ3RoIDogJycpICsgJ1wiIGRhdGEtd2lkPVwiJyArIChkLmFpcndheUxpbWl0ID8gZC5haXJ3YXlMaW1pdC53aWR0aCA6ICcnKSArICdcIiBkYXRhLWhlaT1cIicgKyAoZC5haXJ3YXlMaW1pdCA/IGQuYWlyd2F5TGltaXQuaGVpZ2h0IDogJycpICsgJ1wiIGRhdGEtd2VpPVwiJyArIChkLmFpcndheUxpbWl0ID8gZC5haXJ3YXlMaW1pdC5waWVjZVdlaWdodCA6ICcnKSArICdcIiBkYXRhLWRhbmdlcj1cIicgKyAoZC5haXJ3YXlMaW1pdCA/IChkLmFpcndheUxpbWl0LmRhbmdlcm91c0dvb2RzID8gMSA6IDApIDogMCkgKyAnXCI+6ZmQ5Yi2PC9hPicgK1xyXG4gICAgICAgICAgICAgICAgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJvcGUtYnpcIj7mr5Tph408L2E+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPC90ZD48L3RyPicgKyBzdHIgKyAnPC90Ym9keT4nO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqICDliJ3lp4vljJbnlYzpnaJcclxuICAgICAqICBAcGFyYW0gbGVmdCBib29sZWFuIOWIoOmZpOW3puS+p+WIl+ihqFxyXG4gICAgICovXHJcbiAgICB2YXIgY2xlYXIgPSBmdW5jdGlvbiAobGVmdCkge1xyXG4gICAgICAgIGlmIChsZWZ0KSB7XHJcbiAgICAgICAgICAgICQoJy5haXItdHJlZScpLmh0bWwoJycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcudGFibGUtY29udGFpbmVyIC53ZWVrJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICQoJyNzdGFydCcpLnZhbCgkKCcjc3RhcnQnKS5zaWJsaW5ncygndWwnKS5maW5kKCdsaTpmaXJzdC1jaGlsZCcpLnRleHQoKSB8fCAnJyk7XHJcbiAgICAgICAgJCgnI21ldGhvZCcpLnZhbCgn6aOe5py6Jyk7XHJcbiAgICAgICAgJCgnI3JlbWFyaycpLnZhbCgnJyk7XHJcbiAgICAgICAgJCgnLnRhYmxlLWNvbnRhaW5lciB0Ym9keScpLmh0bWwoJycpO1xyXG4gICAgfTtcclxuICAgIC8v6Ieq5a6a5LmJc2VsZWN05YWD57Sg5LqL5Lu2XHJcbiAgICB2YXIgc2VsZWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2VsZWN0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcuc2UtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQodGhpcykuc2libGluZ3MoJy5zZS1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNlLXBhcnQgbGknLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnaW5wdXQnKS52YWwoJCh0aGlzKS5odG1sKCkpO1xyXG4gICAgICAgICAgICBpZiAoJCh0aGlzKS5odG1sKCkgPT0gJ+W3suS4i+aeticpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnaW5wdXQnKS5hZGRDbGFzcygnYmctcicpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCd1bCcpLnNpYmxpbmdzKCdpbnB1dCcpLnJlbW92ZUNsYXNzKCdiZy1yJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCd1bCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQoZS50YXJnZXQpO1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5zZWxlY3QsLnNlLXBhcnQgbGknKS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgJCgnLnNlLXBhcnQnKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy/oh6rlrprkuYl0YWJsZeS6i+S7tlxyXG4gICAgdmFyIHRhYmxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGFibGXmt7vliqDmlrDmnaHnm65cclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2FkZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGVsZSA9ICc8dGJvZHkgZGF0YS1lYWNoPVwiMVwiIGRhdGEtc3RhdGU9XCIxXCI+PHRyIGRhdGEtYno9XCIxXCI+ICcgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2xhc3M9XCJzaW5nbGUtaW5mb1wiIGRhdGEtaWQ9XCIwXCIgZGF0YS10YWc9XCJcIi8+PC90ZD4gJyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIm5hbWVcIiB0eXBlPVwidGV4dFwiIGRhdGEtdmFsPVwiXCIvPjx1bCBjbGFzcz1cImdldC1uYW1lXCI+PC91bD48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZCBjbGFzcz1cImZpcnN0XCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrcyB0eHQtaW5wdXRcIj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIndlZWsgYWN0aXZlXCIgZGF0YS1udW09XCIxXCI+5LiAPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwid2VlayBhY3RpdmVcIiBkYXRhLW51bT1cIjJcIj7kuow8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrIGFjdGl2ZVwiIGRhdGEtbnVtPVwiM1wiPuS4iTwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIndlZWsgYWN0aXZlXCIgZGF0YS1udW09XCI0XCI+5ZubPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwid2VlayBhY3RpdmVcIiBkYXRhLW51bT1cIjVcIj7kupQ8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrIGFjdGl2ZVwiIGRhdGEtbnVtPVwiNlwiPuWFrTwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIndlZWsgYWN0aXZlXCIgZGF0YS1udW09XCI3XCI+5pelPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAgICAgJzwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCJtZXRob2Qgc2VsZWN0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIumjnuaculwiIHJlYWRvbmx5Lz48dWwgY2xhc3M9XCJkcC1uIHNlLXBhcnRcIj4gPGxpPumjnuacujwvbGk+IDxsaT7ljaHovaY8L2xpPiA8L3VsPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cImJ6IHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCIvXCIgcmVhZG9ubHkvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIm1pbiB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIG1pblAgKyAnXCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjQ1IHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjEwMCB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiLz48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCIzMDAgd2VpZ2h0XCIgdHlwZT1cInRleHRcIi8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwiNTAwIHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjEwMDAgd2VpZ2h0XCIgdHlwZT1cInRleHRcIi8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwibXljXCIgdHlwZT1cInRleHRcIi8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwic2NjXCIgdHlwZT1cInRleHRcIi8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJvcHRcIj7mk43kvZw8c3BhbiBjbGFzcz1cImNhcmV0XCI+PC9zcGFuPjxkaXYgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPjxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJvcGUteHpcIiBkYXRhLXJlbWFyaz1cIlwiIGRhdGEtbWlud2VpPVwiXCIgZGF0YS1sZW49XCJcIiBkYXRhLXdpZD1cIlwiIGRhdGEtaGVpPVwiXCIgZGF0YS13ZWk9XCJcIiBkYXRhLWRhbmdlcj1cIjBcIj7pmZDliLY8L2E+PGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cIm9wZS1ielwiPuavlOmHjTwvYT48L2Rpdj48L3RkPjwvdHI+PC90Ym9keT4nO1xyXG4gICAgICAgICAgICBpZiAoJCgnLnRhYmxlLWNvbnRhaW5lciB0cltkYXRhLXRnPVwibnVsbFwiXScpLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcudGFibGUtY29udGFpbmVyIHRoZWFkJykuYWZ0ZXIoJzx0Ym9keSBkYXRhLWVhY2g9XCIwXCI+PHRyIGNsYXNzPVwiaGlkZVwiPjx0ZCBjb2xzcGFuPVwiMTNcIj48L3RkPjwvdHI+PC90Ym9keT48dGJvZHkgZGF0YS1lYWNoPVwiMFwiPjx0ciBjbGFzcz1cImhpZGVcIiBkYXRhLXRnPVwibnVsbFwiPjwvdHI+PC90Ym9keT4nKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICQoJ3RyW2RhdGEtdGc9XCJudWxsXCJdJykucGFyZW50cygndGJvZHknKS5iZWZvcmUoZWxlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL3RhYmxl5Yig6Zmk5oyJ6ZKuXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNyZW1vdmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcclxuICAgICAgICAgICAgJCgnLnNpbmdsZS1pbmZvJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5wcm9wKCdjaGVja2VkJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5kYXRhKCdpZCcpICE9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2goJCh0aGlzKS5kYXRhKCdpZCcpKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3Rib2R5JykucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBkZWxBcnIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdDogYXJyXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgJCgnLmRlbC1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkKCcuc2VsLWFsbCcpLnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy90YWJsZeWFqOmAieaMiemSrlxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2VsLWFsbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLnNpbmdsZS1pbmZvJykucHJvcCgnY2hlY2tlZCcsICQodGhpcykucHJvcCgnY2hlY2tlZCcpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+iIquePreaXpeacn+mAieaLqVxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcud2VlaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/ojrflj5bmnLrlnLrlkI3np7BcclxuICAgICAgICAkKGRvY3VtZW50KS5vbigna2V5dXAnLCAnaW5wdXQubmFtZScsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9ICQodGhpcylcclxuICAgICAgICAgICAgICAgICwgdWwgPSBfdGhpcy5zaWJsaW5ncygnLmdldC1uYW1lJyk7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHVsLmZpbmQoJy5hY3RpdmUnKS5pbmRleCgpIHx8IDBcclxuICAgICAgICAgICAgICAgICwgbGVuID0gdWwuY2hpbGRyZW4oKS5sZW5ndGg7XHJcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHsvL+Wbnui9pumUrlxyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB1bC5jaGlsZHJlbignLmFjdGl2ZScpLmRhdGEoJ3ZhbCcpIHx8IHVsLmZpbmQoJ2xpOmZpcnN0LWNoaWxkJykuZGF0YSgndmFsJykgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnZhbChkYXRhKTtcclxuICAgICAgICAgICAgICAgICQodGhpcykuZGF0YSgndmFsJywgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB1bC5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDM4KSB7Ly/kuIrplK5cclxuICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kZXggPT0gMCA/IGxlbiAtIDEgOiBpbmRleCAtIDE7XHJcbiAgICAgICAgICAgICAgICB1bC5maW5kKCdsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykuZXEoaW5kZXgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT0gNDApIHsvL+S4i+mUrlxyXG4gICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCA9PSBsZW4gLSAxID8gMCA6IGluZGV4ICsgMTtcclxuICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgdWwuZmluZCgnbGknKS5lcShpbmRleCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICB9IGVsc2Ugey8v5q2j5bi46L6T5YWlXHJcbiAgICAgICAgICAgICAgICBEYXRhLmdldE5hbWUoe2tleTogX3RoaXMudmFsKCl9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNCb2R5JyBpbiBqc29uICYmIGpzb24ucmVzQm9keSBpbnN0YW5jZW9mIEFycmF5ICYmIGpzb24ucmVzQm9keS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSAnJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBib2R5ID0ganNvbi5yZXNCb2R5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBiIGluIGJvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChib2R5Lmhhc093blByb3BlcnR5KGIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBib2R5W2JdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPGxpIGRhdGEtdmFsPVwiJyArIGQuYWlycG9ydENvZGUgKyAnXCIgY2xhc3M9XCInICsgKGIgPT0gMCA/ICdhY3RpdmUnIDogJycpICsgJ1wiPicgKyBkLmRpc3BsYXlOYW1lICsgJzwvbGk+J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVsLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWwuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy9pbnB1dOWkseWOu+eEpueCuVxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdibHVyJywgJ2lucHV0Lm5hbWUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB1bCA9ICQodGhpcykuc2libGluZ3MoJy5nZXQtbmFtZScpO1xyXG4gICAgICAgICAgICBpZiAodWwuY3NzKCdkaXNwbGF5JykgPT0gJ2Jsb2NrJyAmJiB1bC5jaGlsZHJlbigpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdWwuY2hpbGRyZW4oJy5hY3RpdmUnKS5kYXRhKCd2YWwnKSB8fCB1bC5maW5kKCdsaTpmaXJzdC1jaGlsZCcpLmRhdGEoJ3ZhbCcpIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS52YWwoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ3ZhbCcsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgdWwuaGlkZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy9saeWFg+e0oOaCrOa1ruiOt+W+l+eEpueCuVxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWVudGVyICcsICcuZ2V0LW5hbWUgbGknLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogIOaehOW7uuW3puS+p2RvbeagkVxyXG4gICAgICogIEBwYXJhbSBkYXRhIG9iamVjdCDoiKrnur/oioLngrnmoJFcclxuICAgICAqICBAcGFyYW0gYXJyIGFycmF5IOmcgOimgeaYvuekuueahOiIque6v1xyXG4gICAgICogIEBwYXJhbSBvcGVuIGJvb2xlYW4g5piv5ZCm6buY6K6k5pi+56S6XHJcbiAgICAgKi9cclxuICAgIHZhciBidWlsZFRyZWUgPSBmdW5jdGlvbiAoZGF0YSwgYXJyLCBvcGVuLCBmaXJzdCwgaW5kZXgpIHtcclxuICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgdmFyIGkgPSBpbmRleCA/IGluZGV4ICsgMSA6IDE7XHJcbiAgICAgICAgZm9yICh2YXIgZCBpbiBkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmhhc093blByb3BlcnR5KGQpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSBkYXRhW2RdWydjaGlsZE5vZGVzJ11cclxuICAgICAgICAgICAgICAgICAgICAsIG5hbWUgPSBkYXRhW2RdWydhaXJwb3J0Q29kZSddXHJcbiAgICAgICAgICAgICAgICAgICAgLCBpZCA9IGRhdGFbZF1bJ25vZGVJZCddXHJcbiAgICAgICAgICAgICAgICAgICAgLCBkZWVwID0gZGF0YVtkXVsnbm9kZURlcHRoJ10gPyBwYXJzZUludChkYXRhW2RdWydub2RlRGVwdGgnXSkgKyAxIDogaTtcclxuICAgICAgICAgICAgICAgIHN0ciArPSAnPHVsJyArIChvcGVuID8gJyBzdHlsZT1cImRpc3BsYXk6IGJsb2NrO1wiJyA6ICcnKSArICc+PGxpPjxzcGFuIGNsYXNzPVwiZ2V0LXNpemVcIj4nICsgKGNoaWxkLmxlbmd0aCA+IDAgPyAnPHNwYW4gY2xhc3M9XCJvcGVuLWljb24nICsgKGFyci5pbmRleE9mKGlkKSA+PSAwID8gJyBjbG9zZS1pY29uJyA6ICcnKSArICdcIiBkYXRhLWlkPVwiJyArIGlkICsgJ1wiPjwvc3Bhbj4nIDogJycpICsgJzwvc3Bhbj48ZGl2IGRhdGEtaW5kZXg9XCInICsgZGVlcCArICdcIiBjbGFzcz1cInNob3ctZGV0YWlsXCIgZGF0YS1pZD1cIicgKyBpZCArICdcIj48c3BhbiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICcgKyAoZGF0YVtkXVsnbm9kZVN0YXRlJ10gPyAnJyA6ICcjY2NjOycpICsgJ1wiIGNsYXNzPVwiJyArIChmaXJzdCA/ICdzdGFydCcgOiAnZW5kJykgKyAnXCI+J1xyXG4gICAgICAgICAgICAgICAgICAgICsgKGZpcnN0ID8gJ+i1tycgOiAn55uuJykgKyAnPC9zcGFuPjxzcGFuIGNsYXNzPVwiZS1uYW1lXCI+JyArIG5hbWUgKyAnPC9zcGFuPjwvZGl2PicgKyAoY2hpbGQubGVuZ3RoID4gMCA/IGJ1aWxkVHJlZShjaGlsZCwgYXJyLCBhcnIuaW5kZXhPZihpZCkgPj0gMCA/IDEgOiAwLCBmYWxzZSwgaSkgOiAnJykgKyAnPC9saT48L3VsPic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqICDojrflj5blt6bkvqfoioLngrnmoJFcclxuICAgICAqICBAcGFyYW0gY29kZSBzdHJpbmcg6Iiq56m65YWs5Y+45Luj56CBXHJcbiAgICAgKiAgQHBhcmFtIGFyciBzdHJpbmcg5piv5ZCm6ZyA6KaB5pi+56S66Lev5b6EXHJcbiAgICAgKi9cclxuICAgIHZhciBpbml0VHJlZSA9IGZ1bmN0aW9uIChjb2RlLCBhcnIpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgY2lkOiAxMDAwMFxyXG4gICAgICAgICAgICAsIGNvZGU6IGNvZGVcclxuICAgICAgICB9O1xyXG4gICAgICAgIERhdGEudHJlZShkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCdub2RlVHJlZScgaW4ganNvbi5yZXNCb2R5ICYmIGpzb24ucmVzQm9keS5ub2RlVHJlZS5sZW5ndGggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5haXItdHJlZScpLmh0bWwoYnVpbGRUcmVlKGpzb24ucmVzQm9keS5ub2RlVHJlZSwgYXJyICYmIGFyciBpbnN0YW5jZW9mIEFycmF5ID8gYXJyIDogW10sIG51bGwsIHRydWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v5Yig6ZmkXHJcbiAgICB2YXIgZGVsID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBEYXRhLmRlbChkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+WIoOmZpOaIkOWKnyEnKTtcclxuICAgICAgICAgICAgICAgIGNsZWFyKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHZhciBhcnIgPSBkYXRhLmxpc3Q7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcnIuaGFzT3duUHJvcGVydHkoYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhcnJbYV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5zaG93LWRldGFpbFtkYXRhLWlkPVwiJyArIGQgKyAnXCJdJykucGFyZW50cygndGJvZHknKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn5Yig6Zmk5aSx6LSl77yM6K+36YeN6K+V77yBJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfTtcclxuICAgIC8v6I635Y+W6Lev5b6EXHJcbiAgICB2YXIgZ2V0Um9hZCA9IGZ1bmN0aW9uIChlbGUpIHtcclxuICAgICAgICBpZiAoZWxlLmRhdGEoJ2lkJykpIHtcclxuICAgICAgICAgICAgcm9hZC5wdXNoKGVsZS5kYXRhKCdpZCcpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGVsZS5wYXJlbnQoKS5wYXJlbnQoKS5zaWJsaW5ncygnLnNob3ctZGV0YWlsJykubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBnZXRSb2FkKGVsZS5wYXJlbnQoKS5wYXJlbnQoKS5zaWJsaW5ncygnLnNob3ctZGV0YWlsJykpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy/lj5HluINcclxuICAgIHZhciBwdWJsaXNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcucHVibGlzaC1idG4nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJyNzZWwtdGltZScpLmRhdGV0aW1lcGlja2VyKHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdDogJ3l5eXktbW0tZGQnLC8v5pel5pyf55qE5qC85byPXHJcbiAgICAgICAgICAgICAgICBzdGFydERhdGU6IG5ldyBEYXRlKCksLy/pgInmi6nlmajnmoTlvIDlp4vml6XmnJ9cclxuICAgICAgICAgICAgICAgIGF1dG9jbG9zZTogdHJ1ZSwvL+aXpeacn+mAieaLqeWujOaIkOWQjuaYr+WQpuWFs+mXremAieaLqeahhlxyXG4gICAgICAgICAgICAgICAgYm9vdGNzc1ZlcjogMywvL+aYvuekuuWQkeW3puWQkeWPs+eahOeureWktFxyXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2U6ICd6aC1DTicsLy/or63oqIBcclxuICAgICAgICAgICAgICAgIG1pblZpZXc6IFwibW9udGhcIiwvL+ihqOekuuaXpeacn+mAieaLqeeahOacgOWwj+iMg+WbtO+8jOm7mOiupOaYr2hvdXJcclxuICAgICAgICAgICAgICAgIGluaXRpYWxEYXRlOiBuZXcgRGF0ZShuZXcgRGF0ZSgpLmdldFRpbWUoKSArICg3ICogMjQgKiA2MCAqIDYwICogMTAwMCkpLy/pu5jorqTpgInkuK3ml7bpl7RcclxuICAgICAgICAgICAgfSkub24oJ2NoYW5nZURhdGUnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gbmV3IERhdGUoZS5kYXRlKS5Gb3JtYXQoJ3l5eXktTU0tZGQnKTtcclxuICAgICAgICAgICAgICAgICQoJyNleHBpcmVEYXRlJykudmFsKHZhbHVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICQoJyNleHBpcmVEYXRlJykudmFsKG5ldyBEYXRlKG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgKDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKSkuRm9ybWF0KCd5eXl5LU1NLWRkJykpO1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5wdWJsaXNoLXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZW5zdXJlLXB1Ymxpc2gnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgXCJhaXJDb21wYW55Q29kZVwiOiB1cmwuZ2V0KCdjb2RlJyksXHJcbiAgICAgICAgICAgICAgICBcImV4cGlyZURhdGVcIjogJCgnI2V4cGlyZURhdGUnKS52YWwoKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBEYXRhLnB1Ymxpc2goZGF0YSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+WPkeW4g+aIkOWKn++8gScsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICflj5HluIPlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy/mibnph4/mt7vliqBcclxuICAgIHZhciBtdWx0aSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+aYvuekuuaJuemHj+a3u+WKoFxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjbXVsdGktYWRkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJzx0cj4gPHRkIGNsYXNzPVwiZmlyc3RcIj48c3BhbiBjbGFzcz1cIndlZWtzIHR4dC1pbnB1dFwiPjxzcGFuIGNsYXNzPVwid2VlayBhY3RpdmVcIiBkYXRhLW51bT1cIjFcIj7kuIA8L3NwYW4+PHNwYW4gY2xhc3M9XCJ3ZWVrIGFjdGl2ZVwiIGRhdGEtbnVtPVwiMlwiPuS6jDwvc3Bhbj48c3BhbiBjbGFzcz1cIndlZWsgYWN0aXZlXCIgZGF0YS1udW09XCIzXCI+5LiJPC9zcGFuPjxzcGFuIGNsYXNzPVwid2VlayBhY3RpdmVcIiBkYXRhLW51bT1cIjRcIj7lm5s8L3NwYW4+PHNwYW4gY2xhc3M9XCJ3ZWVrIGFjdGl2ZVwiIGRhdGEtbnVtPVwiNVwiPuS6lDwvc3Bhbj48c3BhbiBjbGFzcz1cIndlZWsgYWN0aXZlXCIgZGF0YS1udW09XCI2XCI+5YWtPC9zcGFuPjxzcGFuIGNsYXNzPVwid2VlayBhY3RpdmVcIiBkYXRhLW51bT1cIjdcIj7ml6U8L3NwYW4+PC9zcGFuPjwvdGQ+IDx0ZD48aW5wdXQgY2xhc3M9XCJtZXRob2Qgc2VsZWN0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIumjnuaculwiIHJlYWRvbmx5PVwiXCI+IDx1bCBjbGFzcz1cImRwLW4gc2UtcGFydFwiPiA8bGk+6aOe5py6PC9saT4gPGxpPuWNoei9pjwvbGk+IDwvdWw+IDwvdGQ+IDx0ZD4gLyA8L3RkPiA8dGQ+PGlucHV0IGNsYXNzPVwibWluIHdlaWdodFwiIHZhbHVlPVwiJyArIChtaW5QIHx8IDIwMCkgKyAnXCIgdHlwZT1cInRleHRcIj48L3RkPjx0ZD48aW5wdXQgY2xhc3M9XCI0NSB3ZWlnaHRcIiBkYXRhLTIwMD1cIjBcIiBkYXRhLTMwMD1cIjBcIiBkYXRhLTUwMD1cIjBcIiB0eXBlPVwidGV4dFwiPjwvdGQ+IDx0ZD48aW5wdXQgY2xhc3M9XCIxMDAgd2VpZ2h0XCIgZGF0YS0yMDA9XCIwXCIgZGF0YS0zMDA9XCIwXCIgZGF0YS01MDA9XCIwXCIgdHlwZT1cInRleHRcIj48L3RkPiA8dGQ+PGlucHV0IGNsYXNzPVwiMzAwIHdlaWdodFwiIGRhdGEtMjAwPVwiMFwiIGRhdGEtMzAwPVwiMFwiIGRhdGEtNTAwPVwiMFwiIHR5cGU9XCJ0ZXh0XCI+PC90ZD4gPHRkPjxpbnB1dCBjbGFzcz1cIjUwMCB3ZWlnaHRcIiBkYXRhLTIwMD1cIjBcIiBkYXRhLTMwMD1cIjBcIiBkYXRhLTUwMD1cIjBcIiB0eXBlPVwidGV4dFwiPjwvdGQ+IDx0ZD48aW5wdXQgY2xhc3M9XCIxMDAwIHdlaWdodFwiIGRhdGEtMjAwPVwiMFwiIGRhdGEtMzAwPVwiMFwiIGRhdGEtNTAwPVwiMFwiIHR5cGU9XCJ0ZXh0XCI+PC90ZD48dGQ+PGlucHV0IGNsYXNzPVwibXljXCIgdHlwZT1cInRleHRcIj48L3RkPjx0ZD48aW5wdXQgY2xhc3M9XCJzY2NcIiB0eXBlPVwidGV4dFwiPjwvdGQ+PC90cj4nO1xyXG4gICAgICAgICAgICAkKCcudGlwcycpLmhpZGUoKTtcclxuICAgICAgICAgICAgJCgnI2lucHV0LXRhZycpLnZhbCgnJyk7XHJcbiAgICAgICAgICAgICQoJy5jcmVhdGUtYm9keScpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAkKCcubXVsdGktYWRkIHRib2R5JykuaHRtbChzdHIpO1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5hZGQtcGFydCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/ojrflj5bmnLrlnLrlkI3np7BcclxuICAgICAgICAkKGRvY3VtZW50KS5vbigna2V5dXAnLCAnaW5wdXQjY3JlYXRlLWVuZCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICQoJy50aXBzJykuaGlkZSgpO1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpXHJcbiAgICAgICAgICAgICAgICAsIHVsID0gX3RoaXMuc2libGluZ3MoJy5nZXQtbmFtZScpO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSB1bC5maW5kKCcuYWN0aXZlJykuaW5kZXgoKSB8fCAwXHJcbiAgICAgICAgICAgICAgICAsIGxlbiA9IHVsLmNoaWxkcmVuKCkubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7Ly/lm57ovabplK5cclxuICAgICAgICAgICAgICAgIF90aGlzLnZhbCgnJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHVsLmNoaWxkcmVuKCcuYWN0aXZlJykuZGF0YSgndmFsJykgfHwgdWwuZmluZCgnbGk6Zmlyc3QtY2hpbGQnKS5kYXRhKCd2YWwnKSB8fCAnJztcclxuICAgICAgICAgICAgICAgIHZhciBzdHIgPSAnPGRpdiBjbGFzcz1cInNnLWFkZFwiIGRhdGEtdmFsPVwiJyArIGRhdGEgKyAnXCI+JyArIGRhdGEgKyAnPHNwYW4gY2xhc3M9XCJkZWxldGUtc2dcIj5YPC9zcGFuPiA8L2Rpdj4nO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEgJiYgJCgnLmNyZWF0ZS1ib2R5JykuY2hpbGRyZW4oKS5sZW5ndGggPj0gMjApIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcudGlwcycpLmh0bWwoJ+avj+asoeacgOWkmua3u+WKoDIw5p2hJykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhICYmICQoJy5zZy1hZGRbZGF0YS12YWw9XCInICsgZGF0YSArICdcIl0nKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnRpcHMnKS5odG1sKCfor6Xnm67nmoTlnLDlt7LlrZjlnKgnKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdWwuaHRtbCgnJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcuY3JlYXRlLWJvZHknKS5hcHBlbmQoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICB1bC5odG1sKCcnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHVsLmhpZGUoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT0gMzgpIHsvL+S4iumUrlxyXG4gICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCA9PSAwID8gbGVuIC0gMSA6IGluZGV4IC0gMTtcclxuICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgdWwuZmluZCgnbGknKS5lcShpbmRleCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSA0MCkgey8v5LiL6ZSuXHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IGluZGV4ID09IGxlbiAtIDEgPyAwIDogaW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgdWwuZmluZCgnbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB1bC5maW5kKCdsaScpLmVxKGluZGV4KS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7Ly/mraPluLjovpPlhaVcclxuICAgICAgICAgICAgICAgIERhdGEuZ2V0TmFtZSh7a2V5OiBfdGhpcy52YWwoKX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0JvZHknIGluIGpzb24gJiYganNvbi5yZXNCb2R5IGluc3RhbmNlb2YgQXJyYXkgJiYganNvbi5yZXNCb2R5Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICcnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGJvZHkgPSBqc29uLnJlc0JvZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGIgaW4gYm9keSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvZHkuaGFzT3duUHJvcGVydHkoYikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGJvZHlbYl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8bGkgZGF0YS12YWw9XCInICsgZC5haXJwb3J0Q29kZSArICdcIiBjbGFzcz1cIicgKyAoYiA9PSAwID8gJ2FjdGl2ZScgOiAnJykgKyAnXCI+JyArIGQuZGlzcGxheU5hbWUgKyAnPC9saT4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdWwuaHRtbChzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1bC5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvL2lucHV05aSx5Y6754Sm54K5XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2JsdXInLCAnaW5wdXQjY3JlYXRlLWVuZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS52YWwoJycpO1xyXG4gICAgICAgICAgICB2YXIgdWwgPSAkKHRoaXMpLnNpYmxpbmdzKCcuZ2V0LW5hbWUnKTtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB1bC5jaGlsZHJlbignLmFjdGl2ZScpLmRhdGEoJ3ZhbCcpIHx8IHVsLmZpbmQoJ2xpOmZpcnN0LWNoaWxkJykuZGF0YSgndmFsJykgfHwgJyc7XHJcbiAgICAgICAgICAgIHZhciBzdHIgPSAnPGRpdiBjbGFzcz1cInNnLWFkZFwiIGRhdGEtdmFsPVwiJyArIGRhdGEgKyAnXCI+JyArIGRhdGEgKyAnPHNwYW4gY2xhc3M9XCJkZWxldGUtc2dcIj5YPC9zcGFuPiA8L2Rpdj4nO1xyXG4gICAgICAgICAgICBpZiAoZGF0YSAmJiAkKCcuY3JlYXRlLWJvZHknKS5jaGlsZHJlbigpLmxlbmd0aCA+PSAyMCkge1xyXG4gICAgICAgICAgICAgICAgJCgnLnRpcHMnKS5odG1sKCfmr4/mrKHmnIDlpJrmt7vliqAyMOadoScpLnNob3coKTtcclxuICAgICAgICAgICAgICAgIHVsLmh0bWwoJycpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEgJiYgJCgnLnNnLWFkZFtkYXRhLXZhbD1cIicgKyBkYXRhICsgJ1wiXScpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICQoJy50aXBzJykuaHRtbCgn6K+l55uu55qE5Zyw5bey5a2Y5ZyoJykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgdWwuaHRtbCgnJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJCgnLmNyZWF0ZS1ib2R5JykuYXBwZW5kKHN0cik7XHJcbiAgICAgICAgICAgICAgICB1bC5odG1sKCcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB1bC5oaWRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/noa7lrprmt7vliqBcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2Vuc3VyZS1hZGQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBzdHIgPSAnJ1xyXG4gICAgICAgICAgICAgICAgLCBmbGlnaHREYXkgPSBbXTtcclxuICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy5tdWx0aS1hZGQnKTtcclxuICAgICAgICAgICAgdmFyIHRnID0gJCgnI2lucHV0LXRhZycpLnZhbCgpO1xyXG4gICAgICAgICAgICB2YXIgcGFzcyA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB2YXIgZWxlVHIgPSBlbGUuZmluZCgndGJvZHknKS5maW5kKCd0cicpO1xyXG4gICAgICAgICAgICAvL2VsZVRyLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyAgICB2YXIgX3RoaXMgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICAvLyAgICBpZiAoX3RoaXMuZmluZCgndGQnKS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICB2YXIgbWluID0gcGFyc2VGbG9hdCgkKHRoaXMpLmZpbmQoJy5taW4nKS52YWwoKSk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICBpZiAoIW1pbiB8fCBtaW4gPCBtaW5QKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICQodGhpcykuZmluZCgnLm1pbicpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+acgOWwj+S7t+agvOS4uicgKyBtaW5QKTtcclxuICAgICAgICAgICAgLy8gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgJCh0aGlzKS5maW5kKCcubWluJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICBpZiAocGFyc2VGbG9hdChfdGhpcy5maW5kKCcuNDUnKS52YWwoKSkgJiYgcGFyc2VGbG9hdChfdGhpcy5maW5kKCcuNDUnKS52YWwoKSkgPj0gKG1pbiAvIDQ1KSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuNDUnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy40NScpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjEwMCcpLnZhbCgpKSAmJiBwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy4xMDAnKS52YWwoKSkgPj0gKG1pbiAvIDEwMCkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgX3RoaXMuZmluZCgnLjEwMCcpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgX3RoaXMuZmluZCgnLjEwMCcpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjMwMCcpLnZhbCgpKSAmJiBwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy4zMDAnKS52YWwoKSkgPj0gKG1pbiAvIDMwMCkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgX3RoaXMuZmluZCgnLjMwMCcpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgX3RoaXMuZmluZCgnLjMwMCcpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjUwMCcpLnZhbCgpKSAmJiBwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy41MDAnKS52YWwoKSkgPj0gKG1pbiAvIDUwMCkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgX3RoaXMuZmluZCgnLjUwMCcpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgX3RoaXMuZmluZCgnLjUwMCcpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjEwMDAnKS52YWwoKSkgJiYgcGFyc2VGbG9hdChfdGhpcy5maW5kKCcuMTAwMCcpLnZhbCgpKSA+PSAobWluIC8gMTAwMCkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgX3RoaXMuZmluZCgnLjEwMDAnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy4xMDAwJykuYWRkQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAgICAgLy8gICAgfVxyXG4gICAgICAgICAgICAvL30pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBhc3MpIHtcclxuICAgICAgICAgICAgICAgIGVsZS5maW5kKCcud2VlaycpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbGlnaHREYXkucHVzaChwYXJzZUludCgkKHRoaXMpLmRhdGEoJ251bScpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKCcuc2ctYWRkJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgY29kZTogJCh0aGlzKS5kYXRhKCd2YWwnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIHRhZzogdGdcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCBmbGlnaHREYXk6IGZsaWdodERheVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIHR5cGU6IGVsZS5maW5kKCcubWV0aG9kJykudmFsKCkgPT0gJ+mjnuacuicgPyAxIDogMlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIG1pbjogZWxlLmZpbmQoJy5taW4nKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIDQ1OiBlbGUuZmluZCgnLjQ1JykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCAxMDA6IGVsZS5maW5kKCcuMTAwJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCAzMDA6IGVsZS5maW5kKCcuMzAwJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCA1MDA6IGVsZS5maW5kKCcuNTAwJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCAxMDAwOiBlbGUuZmluZCgnLjEwMDAnKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIG15YzogZWxlLmZpbmQoJy5teWMnKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIHNjYzogZWxlLmZpbmQoJy5zY2MnKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIHN0YXRlOiAxXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzx0Ym9keSBkYXRhLWVhY2g9XCIxXCIgZGF0YS1zdGF0ZT1cIjFcIj48dHI+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkIGRhdGEtYno9XCIxXCI+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwic2luZ2xlLWluZm9cIiBkYXRhLXRhZz1cIicgKyBkLnRhZyArICdcIiBkYXRhLWlkPVwiJyArIGQuaWQgKyAnXCIvPjwvdGQ+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIm5hbWVcIiB0eXBlPVwidGV4dFwiIGRhdGEtdmFsPVwiJyArIGQuY29kZSArICdcIiB2YWx1ZT1cIicgKyBkLmNvZGUgKyAnXCIvPiA8dWwgY2xhc3M9XCJnZXQtbmFtZVwiPjwvdWw+IDwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJmaXJzdFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrcyB0eHQtaW5wdXRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwid2VlaycgKyAoZmxpZ2h0RGF5LmluZGV4T2YoMSkgPj0gMCA/ICcgYWN0aXZlJyA6ICcnKSArICdcIiBkYXRhLW51bT1cIjFcIj7kuIA8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIndlZWsnICsgKGZsaWdodERheS5pbmRleE9mKDIpID49IDAgPyAnIGFjdGl2ZScgOiAnJykgKyAnXCIgZGF0YS1udW09XCIyXCI+5LqMPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrJyArIChmbGlnaHREYXkuaW5kZXhPZigzKSA+PSAwID8gJyBhY3RpdmUnIDogJycpICsgJ1wiIGRhdGEtbnVtPVwiM1wiPuS4iTwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwid2VlaycgKyAoZmxpZ2h0RGF5LmluZGV4T2YoNCkgPj0gMCA/ICcgYWN0aXZlJyA6ICcnKSArICdcIiBkYXRhLW51bT1cIjRcIj7lm5s8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIndlZWsnICsgKGZsaWdodERheS5pbmRleE9mKDUpID49IDAgPyAnIGFjdGl2ZScgOiAnJykgKyAnXCIgZGF0YS1udW09XCI1XCI+5LqUPC9zcGFuPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ3ZWVrJyArIChmbGlnaHREYXkuaW5kZXhPZig2KSA+PSAwID8gJyBhY3RpdmUnIDogJycpICsgJ1wiIGRhdGEtbnVtPVwiNlwiPuWFrTwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwid2VlaycgKyAoZmxpZ2h0RGF5LmluZGV4T2YoNykgPj0gMCA/ICcgYWN0aXZlJyA6ICcnKSArICdcIiBkYXRhLW51bT1cIjdcIj7ml6U8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIm1ldGhvZCBzZWxlY3RcIiB0eXBlPVwidGV4dFwiIHJlYWRvbmx5IHZhbHVlPVwiJyArIChkLnR5cGUgPT0gMSA/ICfpo57mnLonIDogJ+WNoei9picpICsgJ1wiLz48dWwgY2xhc3M9XCJkcC1uIHNlLXBhcnRcIj4gPGxpPumjnuacujwvbGk+IDxsaT7ljaHovaY8L2xpPiA8L3VsPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwiYnogd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIi9cIiByZWFkb25seS8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCJtaW4gd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyAoZFsnbWluJ10gfHwgJycpICsgJ1wiLz48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjQ1IHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgKGRbJzQ1J10gfHwgJycpICsgJ1wiLz48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjEwMCB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkWycxMDAnXSB8fCAnJykgKyAnXCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwiMzAwIHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgKGRbJzMwMCddIHx8ICcnKSArICdcIi8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCI1MDAgd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyAoZFsnNTAwJ10gfHwgJycpICsgJ1wiLz48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjEwMDAgd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyAoZFsnMTAwMCddIHx8ICcnKSArICdcIi8+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCJteWMgd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyAoZFsnbXljJ10gfHwgJycpICsgJ1wiLz48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cInNjYyB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkWydzY2MnXSB8fCAnJykgKyAnXCIvPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJvcHRcIj7mk43kvZw8c3BhbiBjbGFzcz1cImNhcmV0XCI+PC9zcGFuPjxkaXYgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cIm9wZS14elwiIGRhdGEtcmVtYXJrPVwiJyArICQoJyNhZGQtYmVpemh1JykudmFsKCkgKyAnXCIgZGF0YS1taW53ZWk9XCInICsgJCgnI2FkZC1taW5XZWknKS52YWwoKSArICdcIiBkYXRhLWxlbj1cIicgKyAkKCcjYWRkLWxlbicpLnZhbCgpICsgJ1wiIGRhdGEtd2lkPVwiJyArICQoJyNhZGQtd2lkJykudmFsKCkgKyAnXCIgZGF0YS1oZWk9XCInICsgJCgnI2FkZC1oZWknKS52YWwoKSArICdcIiBkYXRhLXdlaT1cIicgKyAkKCcjYWRkLXpsJykudmFsKCkgKyAnXCIgZGF0YS1kYW5nZXI9XCInICsgKCQoJyNhZGQtZGFuZ2VyJykucHJvcCgnY2hlY2tlZCcpID8gMSA6IDApICsgJ1wiPumZkOWItjwvYT4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJvcGUtYnpcIj7mr5Tph408L2E+PC9kaXY+PC90ZD48L3RyPjwvdGJvZHk+JztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRnID09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoJy50YWJsZS1jb250YWluZXIgdHJbZGF0YS10Zz1cIm51bGxcIl0nKS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcudGFibGUtY29udGFpbmVyIHRoZWFkJykuYWZ0ZXIoJzx0Ym9keSBkYXRhLWVhY2g9MD48dHIgY2xhc3M9XCJoaWRlXCI+PHRkIGNvbHNwYW49XCIxM1wiPjwvdGQ+PC90cj48L3Rib2R5Pjx0Ym9keSBkYXRhLWVhY2g9MD48dHIgY2xhc3M9XCJoaWRlXCIgZGF0YS10Zz1cIm51bGxcIj48L3RyPjwvdGJvZHk+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICQoJ3RyW2RhdGEtdGc9XCJudWxsXCJdJykucGFyZW50cygndGJvZHknKS5iZWZvcmUoc3RyKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoJy50YWJsZS1jb250YWluZXIgdHJbZGF0YS10Zz1cIicgKyB0ZyArICdcIl0nKS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcudGFibGUtY29udGFpbmVyIHRhYmxlJykuYXBwZW5kKCc8dGJvZHkgZGF0YS1lYWNoPVwiMFwiPjx0cj48dGQgY29sc3Bhbj1cIjEzXCI+JyArIHRnICsgJzwvdGQ+PC90cj48L3Rib2R5Pjx0Ym9keSBkYXRhLWVhY2g9XCIwXCI+PHRyIGNsYXNzPVwiaGlkZVwiIGRhdGEtdGc9XCInICsgdGcgKyAnXCI+PC90cj48L3Rib2R5PicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkKCd0cltkYXRhLXRnPVwiJyArIHRnICsgJ1wiXScpLnBhcmVudHMoJ3Rib2R5JykuYmVmb3JlKHN0cik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcuYWRkLXBhcnQnKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+acgOWwj+S7t+agvOS4uicgKyBtaW5QICsgJ++8jOavj+S4quetiee6p+eahOS7t+agvOW/hemhuz495pyA5bCP5Lu35qC8IC8g562J57qn6YeN6YeP77yBJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+WIoOmZpFxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZGVsZXRlLXNnJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnJlbW92ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v5om56YeP5L+u5pS5XHJcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjbXVsdGktdXBkYXRlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB1cGRhdGVEYXRhID0gW107XHJcbiAgICAgICAgICAgIHZhciBlbGUgPSAkKCcuc2luZ2xlLWluZm86Y2hlY2tlZCcpO1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChlbGUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZWxlLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0YiA9ICQodGhpcykucGFyZW50cygndGJvZHknKTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVEYXRhLnB1c2godGIuaW5kZXgoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8c3Bhbj4nICsgdGIuZmluZCgnLm5hbWUnKS52YWwoKSArICc8L3NwYW4+J1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKCcubXVsdGktdXBkYXRlIHRib2R5JykuaHRtbCgnPHRyPiA8dGQgY2xhc3M9XCJmaXJzdFwiPjxzcGFuIGNsYXNzPVwid2Vla3MgdHh0LWlucHV0XCI+PHNwYW4gY2xhc3M9XCJ3ZWVrIGFjdGl2ZVwiIGRhdGEtbnVtPVwiMVwiPuS4gDwvc3Bhbj48c3BhbiBjbGFzcz1cIndlZWsgYWN0aXZlXCIgZGF0YS1udW09XCIyXCI+5LqMPC9zcGFuPjxzcGFuIGNsYXNzPVwid2VlayBhY3RpdmVcIiBkYXRhLW51bT1cIjNcIj7kuIk8L3NwYW4+PHNwYW4gY2xhc3M9XCJ3ZWVrIGFjdGl2ZVwiIGRhdGEtbnVtPVwiNFwiPuWbmzwvc3Bhbj48c3BhbiBjbGFzcz1cIndlZWsgYWN0aXZlXCIgZGF0YS1udW09XCI1XCI+5LqUPC9zcGFuPjxzcGFuIGNsYXNzPVwid2VlayBhY3RpdmVcIiBkYXRhLW51bT1cIjZcIj7lha08L3NwYW4+PHNwYW4gY2xhc3M9XCJ3ZWVrIGFjdGl2ZVwiIGRhdGEtbnVtPVwiN1wiPuaXpTwvc3Bhbj48L3NwYW4+PC90ZD4gPHRkPjxpbnB1dCBjbGFzcz1cIm1ldGhvZCBzZWxlY3RcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwi6aOe5py6XCIgcmVhZG9ubHk9XCJcIj4gPHVsIGNsYXNzPVwiZHAtbiBzZS1wYXJ0XCI+IDxsaT7po57mnLo8L2xpPiA8bGk+5Y2h6L2mPC9saT4gPC91bD4gPC90ZD48dGQ+IC8gPC90ZD4gPHRkPjxpbnB1dCB2YWx1ZT1cIicgKyBtaW5QICsgJ1wiIGNsYXNzPVwibWluIHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCI+PC90ZD4gPHRkPjxpbnB1dCBjbGFzcz1cIjQ1IHdlaWdodFwiIGRhdGEtMjAwPVwiMFwiIGRhdGEtMzAwPVwiMFwiIGRhdGEtNTAwPVwiMFwiIHR5cGU9XCJ0ZXh0XCI+PC90ZD4gPHRkPjxpbnB1dCBjbGFzcz1cIjEwMCB3ZWlnaHRcIiBkYXRhLTIwMD1cIjBcIiBkYXRhLTMwMD1cIjBcIiBkYXRhLTUwMD1cIjBcIiB0eXBlPVwidGV4dFwiPjwvdGQ+IDx0ZD48aW5wdXQgY2xhc3M9XCIzMDAgd2VpZ2h0XCIgZGF0YS0yMDA9XCIwXCIgZGF0YS0zMDA9XCIwXCIgZGF0YS01MDA9XCIwXCIgdHlwZT1cInRleHRcIj48L3RkPiA8dGQ+PGlucHV0IGNsYXNzPVwiNTAwIHdlaWdodFwiIGRhdGEtMjAwPVwiMFwiIGRhdGEtMzAwPVwiMFwiIGRhdGEtNTAwPVwiMFwiIHR5cGU9XCJ0ZXh0XCI+PC90ZD4gPHRkPjxpbnB1dCBjbGFzcz1cIjEwMDAgd2VpZ2h0XCIgZGF0YS0yMDA9XCIwXCIgZGF0YS0zMDA9XCIwXCIgZGF0YS01MDA9XCIwXCIgdHlwZT1cInRleHRcIj48L3RkPjx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cIm15Y1wiPjwvdGQ+PHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwic2NjXCI+PC90ZD48L3RyPicpO1xyXG4gICAgICAgICAgICAgICAgJCgnLnVwLWVuZCcpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICQoJy51cGRhdGUtcGFydCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2Vuc3VyZS11cGRhdGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkdCA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgcGFzczIgPSB0cnVlO1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLm11bHRpLXVwZGF0ZScpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHBhc3MgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgdmFyIGVsZVRyID0gZWxlLmZpbmQoJ3Rib2R5JykuZmluZCgndHInKTtcclxuICAgICAgICAgICAgLy9lbGVUci5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gICAgdmFyIF90aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgLy8gICAgaWYgKF90aGlzLmZpbmQoJ3RkJykubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgdmFyIG1pbiA9IHBhcnNlRmxvYXQoJCh0aGlzKS5maW5kKCcubWluJykudmFsKCkpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgaWYgKCFtaW4gfHwgbWluIDwgbWluUCkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5taW4nKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmnIDlsI/ku7fmoLzkuLonICsgbWluUCk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICQodGhpcykuZmluZCgnLm1pbicpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjQ1JykudmFsKCkpICYmIHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjQ1JykudmFsKCkpID49IChtaW4gLyA0NSkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgX3RoaXMuZmluZCgnLjQ1JykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuNDUnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy4xMDAnKS52YWwoKSkgJiYgcGFyc2VGbG9hdChfdGhpcy5maW5kKCcuMTAwJykudmFsKCkpID49IChtaW4gLyAxMDApKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy4xMDAnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy4xMDAnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy4zMDAnKS52YWwoKSkgJiYgcGFyc2VGbG9hdChfdGhpcy5maW5kKCcuMzAwJykudmFsKCkpID49IChtaW4gLyAzMDApKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy4zMDAnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy4zMDAnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy41MDAnKS52YWwoKSkgJiYgcGFyc2VGbG9hdChfdGhpcy5maW5kKCcuNTAwJykudmFsKCkpID49IChtaW4gLyA1MDApKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy41MDAnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy41MDAnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KF90aGlzLmZpbmQoJy4xMDAwJykudmFsKCkpICYmIHBhcnNlRmxvYXQoX3RoaXMuZmluZCgnLjEwMDAnKS52YWwoKSkgPj0gKG1pbiAvIDEwMDApKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJy4xMDAwJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBfdGhpcy5maW5kKCcuMTAwMCcpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgIH1cclxuICAgICAgICAgICAgLy99KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChwYXNzKSB7XHJcbiAgICAgICAgICAgICAgICBlbGUuZmluZCgnLndlZWsuYWN0aXZlJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHQucHVzaCgkKHRoaXMpLmRhdGEoJ251bScpKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZWxlLmZpbmQoJy53ZWlnaHQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISQodGhpcykudmFsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFzczIgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChwYXNzMikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkdDogZHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCBtZXRob2Q6IGVsZS5maW5kKCcubWV0aG9kJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCBtaW46IGVsZS5maW5kKCcubWluJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCA0NTogZWxlLmZpbmQoJy40NScpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgMTAwOiBlbGUuZmluZCgnLjEwMCcpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgMzAwOiBlbGUuZmluZCgnLjMwMCcpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgNTAwOiBlbGUuZmluZCgnLjUwMCcpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgMTAwMDogZWxlLmZpbmQoJy4xMDAwJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCBteWM6IGVsZS5maW5kKCcubXljJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCBzY2M6IGVsZS5maW5kKCcuc2NjJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdXBkYXRlRGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb1RyID0gJCgnLnRhYmxlLWNvbnRhaW5lciB0Ym9keScpLmVxKHVwZGF0ZURhdGFbaV0gLSAxKS5maW5kKCd0cltkYXRhLWJ6PVwiMVwiXScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvVHIuZmluZCgnLm1ldGhvZCcpLnZhbChkYXRhLm1ldGhvZCkuZW5kKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcubWluJykudmFsKGRhdGFbJ21pbiddKS5lbmQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy40NScpLnZhbChkYXRhWyc0NSddKS5lbmQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy4xMDAnKS52YWwoZGF0YVsnMTAwJ10pLmVuZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZCgnLjMwMCcpLnZhbChkYXRhWyczMDAnXSkuZW5kKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcuNTAwJykudmFsKGRhdGFbJzUwMCddKS5lbmQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy4xMDAwJykudmFsKGRhdGFbJzEwMDAnXSkuZW5kKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcubXljJykudmFsKGRhdGFbJ215YyddKS5lbmQoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5zY2MnKS52YWwoZGF0YVsnc2NjJ10pLmVuZCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgb1RyLmZpbmQoJy5vcGUteHonKS5kYXRhKCdsZW4nLCAkKCcjdXAtbGVuJykudmFsKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvVHIuZmluZCgnLm9wZS14eicpLmRhdGEoJ3dpZCcsICQoJyN1cC13aWQnKS52YWwoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9Uci5maW5kKCcub3BlLXh6JykuZGF0YSgnaGVpJywgJCgnI3VwLWhlaScpLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb1RyLmZpbmQoJy5vcGUteHonKS5kYXRhKCd3ZWknLCAkKCcjdXAtemwnKS52YWwoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9Uci5maW5kKCcub3BlLXh6JykuZGF0YSgnbWlud2VpJywgJCgnI3VwLW1pbldlaScpLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb1RyLmZpbmQoJy5vcGUteHonKS5kYXRhKCdyZW1hcmsnLCAkKCcjdXAtYmVpemh1JykudmFsKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvVHIuZmluZCgnLm9wZS14eicpLmRhdGEoJ2RhbmdlcicsICQoJyN1cC1kYW5nZXInKS5wcm9wKCdjaGVja2VkJykgPyAxIDogMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVsnc3RhdGUnXSA9PSAn5bey5LiL5p62Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnRhYmxlLWNvbnRhaW5lciB0Ym9keScpLmVxKHVwZGF0ZURhdGFbaV0gLSAxKS5hZGRDbGFzcygnYmctcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnRhYmxlLWNvbnRhaW5lciB0Ym9keScpLmVxKHVwZGF0ZURhdGFbaV0gLSAxKS5kYXRhKCdzdGF0ZScsIDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnRhYmxlLWNvbnRhaW5lciB0Ym9keScpLmVxKHVwZGF0ZURhdGFbaV0gLSAxKS5yZW1vdmVDbGFzcygnYmctcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnRhYmxlLWNvbnRhaW5lciB0Ym9keScpLmVxKHVwZGF0ZURhdGFbaV0gLSAxKS5kYXRhKCdzdGF0ZScsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9Uci5maW5kKCcud2VlaycpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZHQuaW5kZXhPZigkKHRoaXMpLmRhdGEoJ251bScpKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy51cGRhdGUtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5pyA5bCP5Lu35qC85Li6JyArIG1pblAgKyAn77yM5q+P5Liq562J57qn55qE5Lu35qC85b+F6aG7Pj3mnIDlsI/ku7fmoLwgLyDnrYnnuqfph43ph4/vvIEnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v6Iiq56m65YWs5Y+4XHJcbiAgICB2YXIgY29tcGFueUluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgRGF0YS5jb21wYW55TGlzdChmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJ3NMaXN0JyBpbiBqc29uLnJlc0JvZHkgJiYganNvbi5yZXNCb2R5LnNMaXN0IGluc3RhbmNlb2YgQXJyYXkgJiYganNvbi5yZXNCb2R5LnNMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXJyID0ganNvbi5yZXNCb2R5LnNMaXN0O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgaW4gYXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnIuaGFzT3duUHJvcGVydHkoYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYXJyW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlubmVyID0gJycsIGlBcnIgPSBkLmRlcHRBaXJwb3J0cyB8fCBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaUFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyICs9IGlBcnJbaV0uYWlycG9ydENvZGUgKyAoaSA9PSBpQXJyLmxlbmd0aCAtIDEgPyAnJyA6ICcsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm9uZSA9IFwidGhpcy5zdHlsZS5kaXNwbGF5PSdub25lJztkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaVwiICsgYSArIFwiJykuc3R5bGUuZGlzcGxheT0nYmxvY2snO1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGRhdGEtbWluPVwiJyArIChkLm1pblByaWNlIHx8IDIwMCkgKyAnXCIgZGF0YS1jb21wYW55PVwiJyArIGlubmVyICsgJ1wiIGNsYXNzPVwic2VsLWJ0blwiIGRhdGEtaWQ9XCInICsgZC5haXJDb21wYW55Q29kZSArICdcIiBkYXRhLW5hbWU9XCInICsgZC5haXJDb21wYW55TmFtZSArICdcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIDxpbWcgc3JjPVwiL2ltYWdlcy9haXJsaW5lLycgKyBkLmFpckNvbXBhbnlDb2RlICsgJy5wbmdcIiBjbGFzcz1cImRwLWIgY2lyY2xlXCIgb25lcnJvcj1cIicgKyBub25lICsgJ1wiLz4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxwIGlkPVwiaScgKyAoYSkgKyAnXCIgY2xhc3M9XCJkcC1uXCI+JyArIGQuYWlyQ29tcGFueUNvZGUgKyAnPC9wPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImRwLWIgdGV4dFwiPicgKyBkLmFpckNvbXBhbnlDb2RlICsgJzwvc3Bhbj4gPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkKCcubGlzdC1jb3V0JykuaHRtbCgnPHN0cm9uZz7pgInmi6noiKrnqbrlhazlj7g8L3N0cm9uZz4g5bey5pyJICcgKyBhcnIubGVuZ3RoICsgJyDlrrboiKrnqbrlhazlj7gnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPVwid3JvbmdcIj7mmoLml6DoiKrnqbrlhazlj7jvvIw8YSBocmVmPVwiL2FpcmxpbmUvY29tcGFueVwiPuivt+a3u+WKoO+8gTwvYT48L2Rpdj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5saXN0LWNvdXQnKS5odG1sKCc8c3Ryb25nPumAieaLqeiIquepuuWFrOWPuDwvc3Ryb25nPiDlt7LmnIkgMCDlrrboiKrnqbrlhazlj7gnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cIndyb25nXCI+6K+35rGC5Ye66ZSZ77yM6K+35Yi35paw6YeN6K+V77yBPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICQoJy5saXN0LWNvdXQnKS5odG1sKCc8c3Ryb25nPumAieaLqeiIquepuuWFrOWPuDwvc3Ryb25nPiDlt7LmnIkgMCDlrrboiKrnqbrlhazlj7gnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkKCcuYWlycG9ydHMnKS5maW5kKCcuY29tcGFueXMnKS5odG1sKHN0cik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy/orr7nva7mr5Tph41cclxuICAgIHZhciBzZXRCeiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgb3B0ID0gW107XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5vcGUtYnonLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG9wdCA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCh0aGlzKS5wYXJlbnRzKCd0Ym9keScpO1xyXG4gICAgICAgICAgICBvcHQucHVzaChlbGUuaW5kZXgoKSk7XHJcbiAgICAgICAgICAgICQoJy5iei1sdicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJ3RyJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5kYXRhKCdieicpICE9IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcuYnotbHZbZGF0YS1iej1cIicgKyAkKHRoaXMpLmRhdGEoJ2J6JykgKyAnXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcuc2ctc2V0LWJ6JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2JhdGNoLWJ6JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBvcHQgPSBbXTtcclxuICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy5zaW5nbGUtaW5mbzpjaGVja2VkJykucGFyZW50cygndGJvZHknKTtcclxuICAgICAgICAgICAgZWxlLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgb3B0LnB1c2goJCh0aGlzKS5pbmRleCgpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChvcHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgJCgnLmJ6LWx2JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgJCgnLnNnLXNldC1ieicpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2Vuc3VyZS1zZy1zZXQtYnonLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgbyA9IDA7IG8gPCBvcHQubGVuZ3RoOyBvKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHIgPSAnJztcclxuICAgICAgICAgICAgICAgIHZhciB0ciA9ICQoJy50YWJsZS1jb250YWluZXIgdGJvZHknKS5lcShvcHRbb10gLSAxKS5maW5kKCd0cltkYXRhLWJ6PVwiMVwiXScpO1xyXG4gICAgICAgICAgICAgICAgdHIuc2libGluZ3MoKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIG1pbjogcGFyc2VGbG9hdCh0ci5maW5kKCcubWluJykudmFsKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgLCA0NTogcGFyc2VGbG9hdCh0ci5maW5kKCcuNDUnKS52YWwoKSlcclxuICAgICAgICAgICAgICAgICAgICAsIDEwMDogcGFyc2VGbG9hdCh0ci5maW5kKCcuMTAwJykudmFsKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgLCAzMDA6IHBhcnNlRmxvYXQodHIuZmluZCgnLjMwMCcpLnZhbCgpKVxyXG4gICAgICAgICAgICAgICAgICAgICwgNTAwOiBwYXJzZUZsb2F0KHRyLmZpbmQoJy41MDAnKS52YWwoKSlcclxuICAgICAgICAgICAgICAgICAgICAsIDEwMDA6IHBhcnNlRmxvYXQodHIuZmluZCgnLjEwMDAnKS52YWwoKSlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAkKCcuYnotbHYuYWN0aXZlJykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJ6ID0gJCh0aGlzKS5kYXRhKCdieicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgcCA9IHBhcnNlRmxvYXQoJCgnI2J6LScgKyAkKHRoaXMpLmRhdGEoJ2J6JykpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzx0ciBkYXRhLWJ6PVwiJyArIGJ6ICsgJ1wiPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPjx0ZD48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cImJ6IHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgYnogKyAnXCIgcmVhZG9ubHk9XCJcIj48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIm1pbiB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkYXRhWydtaW4nXSkgKyAnXCI+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCI0NSB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkYXRhWyc0NSddIC0gcCkgKyAnXCI+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCIxMDAgd2VpZ2h0XCIgdHlwZT1cInRleHRcIiB2YWx1ZT1cIicgKyAoZGF0YVsnMTAwJ10gLSBwKSArICdcIj48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCBjbGFzcz1cIjMwMCB3ZWlnaHRcIiB0eXBlPVwidGV4dFwiIHZhbHVlPVwiJyArIChkYXRhWyczMDAnXSAtIHApICsgJ1wiPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IGNsYXNzPVwiNTAwIHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgKGRhdGFbJzUwMCddIC0gcCkgKyAnXCI+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48aW5wdXQgY2xhc3M9XCIxMDAwIHdlaWdodFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCInICsgKGRhdGFbJzEwMDAnXSAtIHApICsgJ1wiPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8dGQ+PC90ZD48dGQ+PC90ZD48L3RyPidcclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRyLmFmdGVyKHN0cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcuc2ctc2V0LWJ6JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvL+iuvue9rumZkOWItlxyXG4gICAgdmFyIHNldExpbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzZ0xpbWl0ID0gW107XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5vcGUteHonLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNnTGltaXQgPSBbXTtcclxuICAgICAgICAgICAgc2dMaW1pdC5wdXNoKCQodGhpcykucGFyZW50cygndGJvZHknKS5pbmRleCgpKTtcclxuICAgICAgICAgICAgJCgnLnNnLWxpbWl0LXBhcnQnKS5maW5kKCdpbnB1dCcpLnZhbCgnJyk7XHJcbiAgICAgICAgICAgICQoJy5zZy1saW1pdC1wYXJ0JykuZmluZCgnLm1haW4taW5mbycpLmh0bWwoJ+W3sumAieaLqeiIque6v++8micgKyAkKHRoaXMpLnBhcmVudHMoJ3Rib2R5JykuZmluZCgnLm5hbWUnKS52YWwoKSk7XHJcbiAgICAgICAgICAgICQoJyNzZy1sZW4nKS52YWwoJCh0aGlzKS5kYXRhKCdsZW4nKSk7XHJcbiAgICAgICAgICAgICQoJyNzZy13aWQnKS52YWwoJCh0aGlzKS5kYXRhKCd3aWQnKSk7XHJcbiAgICAgICAgICAgICQoJyNzZy1oZWknKS52YWwoJCh0aGlzKS5kYXRhKCdoZWknKSk7XHJcbiAgICAgICAgICAgICQoJyNzZy16bCcpLnZhbCgkKHRoaXMpLmRhdGEoJ3dlaScpKTtcclxuICAgICAgICAgICAgJCgnI3NnLW1pbldlaScpLnZhbCgkKHRoaXMpLmRhdGEoJ21pbndlaScpKTtcclxuICAgICAgICAgICAgJCgnI3NnLWJlaXpodScpLnZhbCgkKHRoaXMpLmRhdGEoJ3JlbWFyaycpKTtcclxuICAgICAgICAgICAgJCgnI3NnLWRhbmdlcicpLnByb3AoJ2NoZWNrZWQnLCAkKHRoaXMpLmRhdGEoJ2RhbmdlcicpID09ICcxJyk7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnLnNnLWxpbWl0LXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZW5zdXJlLXNnLWxpbWl0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLnRhYmxlLWNvbnRhaW5lciB0Ym9keScpLmVxKHNnTGltaXRbMF0gLSAxKS5maW5kKCcub3BlLXh6Jyk7XHJcbiAgICAgICAgICAgIGVsZS5kYXRhKCdsZW4nLCAkKCcjc2ctbGVuJykudmFsKCkpO1xyXG4gICAgICAgICAgICBlbGUuZGF0YSgnd2lkJywgJCgnI3NnLXdpZCcpLnZhbCgpKTtcclxuICAgICAgICAgICAgZWxlLmRhdGEoJ2hlaScsICQoJyNzZy1oZWknKS52YWwoKSk7XHJcbiAgICAgICAgICAgIGVsZS5kYXRhKCd3ZWknLCAkKCcjc2ctemwnKS52YWwoKSk7XHJcbiAgICAgICAgICAgIGVsZS5kYXRhKCdtaW53ZWknLCAkKCcjc2ctbWluV2VpJykudmFsKCkpO1xyXG4gICAgICAgICAgICBlbGUuZGF0YSgncmVtYXJrJywgJCgnI3NnLWJlaXpodScpLnZhbCgpKTtcclxuICAgICAgICAgICAgZWxlLmRhdGEoJ2RhbmdlcicsICQoJyNzZy1kYW5nZXInKS5wcm9wKCdjaGVja2VkJykgPyAxIDogMCk7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnLnNnLWxpbWl0LXBhcnQnKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy9mdW5jdGlvbiBub3RGb3VuZCh0KSB7XHJcbiAgICAgICAgLy8gICAgJCh0KS5oaWRlKCk7XHJcbiAgICAgICAgLy8gICAgJCh0KS5zaWJsaW5ncygncCcpLnNob3coKTtcclxuICAgICAgICAvL31cclxuICAgICAgICBsaXN0ZW5lcigpO1xyXG4gICAgICAgIHNlbGVjdCgpO1xyXG4gICAgICAgIHRhYmxlKCk7XHJcbiAgICAgICAgcHVibGlzaCgpO1xyXG4gICAgICAgIG11bHRpKCk7XHJcbiAgICAgICAgY29tcGFueUluaXQoKTtcclxuICAgICAgICB1cGRhdGUoKTtcclxuICAgICAgICBzZXRCeigpO1xyXG4gICAgICAgIHNldExpbWl0KCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBydW46IHJ1blxyXG4gICAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cy5MaXN0ZW5lciA9IExpc3RlbmVyOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHpyeiBvbiAyMDE2LzIvMjYuXHJcbiAqIEB2ZXJzaW9uIDEuMC4wIGNyZWF0ZWQg6YCa55So5oCn5Yqf6IO95pa55rOVXHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxudmFyIEZ1biA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgX3RpbWVPdXQgPSAxMDAwMDA7Ly/or7fmsYLotoXml7bml7bpl7TkuLoxMHNcclxuICAgIC8qKlxyXG4gICAgICog5bCB6KOFYWpheFxyXG4gICAgICogQHBhcmFtIG9wdGlvblxyXG4gICAgICoge1xyXG4gICAgICogICAgICB1cmw6XCLor7fmsYLnmoTlnLDlnYBcIlxyXG4gICAgICogICAgICAsbWV0aG9kOlwi6K+35rGC55qE5pa55rOVXCJcclxuICAgICAqICAgICAgLGFzeW5jOlwi5piv5ZCm5bm25Y+RXCJcclxuICAgICAqICAgICAgLGRhdGE6XCLlj5HpgIHnmoTmlbDmja5cIlxyXG4gICAgICogICAgICAsc3VjY2VzczpcIuaIkOWKn+aXtuWbnuiwg1wiXHJcbiAgICAgKiAgICAgICxlcnJvcjpcIuWksei0pS/otoXml7bml7blm57osINcIlxyXG4gICAgICogICAgICAsdGltZW91dDpcIui2heaXtuaXtumXtFwiXHJcbiAgICAgKiAgICAgICxjb21wbGV0ZTpcIuWujOaIkOWQjueahOWbnuiwg1wiXHJcbiAgICAgKiB9XHJcbiAgICAgKi9cclxuICAgIHZhciBhamF4ID0gZnVuY3Rpb24gKG9wdGlvbikge1xyXG4gICAgICAgIC8vYWpheOW8gOWni+aXtuW6lOaYvuekuuKAnOWKoOi9veS/oeaBr+ahhuKAnVxyXG4gICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBvcHRpb24udXJsXHJcbiAgICAgICAgICAgICwgdHlwZTogXCJ0eXBlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi50eXBlIHx8IFwiR0VUXCJcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiBvcHRpb24udGltZW91dCB8fCBfdGltZU91dFxyXG4gICAgICAgICAgICAsIGRhdGE6IFwiZGF0YVwiIGluIG9wdGlvbiAmJiBvcHRpb24uZGF0YSB8fCB7fVxyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgICAgICAsIGFzeW5jOiAoXCJhc3luY1wiIGluIG9wdGlvbiAmJiBvcHRpb24uYXN5bmMpID8gdHJ1ZSA6IGZhbHNlXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChcInN0YXR1c1wiIGluIGpzb24gJiYganNvbi5zdGF0dXMgPiAwICYmIFwiZGF0YVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJzdWNjZXNzXCIgaW4gb3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbi5zdWNjZXNzKGpzb24uZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoXCLml6BzdWNjZXNz5pa55rOVIVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiZXJyb3JcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmVycm9yIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uZXJyb3IoanNvbik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmk43kvZzlpLHotKUhJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGVycm9yOiBmdW5jdGlvbiAoeGhyKSB7Ly80MDTmiJbogIXotoXml7ZcclxuICAgICAgICAgICAgICAgIGlmIChcImVycm9yXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5lcnJvciBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/mj5DnpLrnlKjmiLfplJnor6/kv6Hmga9cclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoXCLov57mjqXmnI3liqHlmajlpLHotKXvvIznirbmgIHvvJpcIiArICh4aHIuc3RhdHVzIHx8IC0xKSArIFwiLOS/oeaBr++8mlwiICsgKHhoci5zdGF0dXNUZXh0IHx8IFwiLVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmVycm9yKHhoci5zdGF0dXMsIHhoci5zdGF0dXNUZXh0KTsvL+Wbnuiwg+ivt+axgueahOeKtuaAgeWSjOmUmeivr+S/oeaBr1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKHhociwgdHlwZSkge1xyXG4gICAgICAgICAgICAgICAgLy/lhbPpl63igJzliqDovb3kv6Hmga/moYbigJ1cclxuICAgICAgICAgICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChcImNvbXBsZXRlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5jb21wbGV0ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmNvbXBsZXRlKHhociwgdHlwZSk7Ly/lm57osIPor7fmsYLnmoR4aHLkv6Hmga/lkoznsbvlnotcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v5YWo6YCJ5ZKM5Y2V6YCJ55qE57uR5a6aXHJcbiAgICB2YXIgc2V0Q2hlY2tib3hMaXN0ZW5lciA9IGZ1bmN0aW9uIChhbGxDaGVjaywgcmFkaW9DaGVja3MpIHtcclxuICAgICAgICAvL+etm+mAieWNlemAieaMiemSrue7hFxyXG4gICAgICAgIHZhciByYWRpb1ZhbHVlRWxlcyA9ICQocmFkaW9DaGVja3MpO1xyXG4gICAgICAgIC8v54K55Ye75YWo6YCJ5pe277yM5ZCM57uE5oyJ6ZKu6KKr5ZCM5q2lXHJcbiAgICAgICAgJChkb2N1bWVudCkuZGVsZWdhdGUoYWxsQ2hlY2ssIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAocmFkaW9WYWx1ZUVsZXMgJiYgcmFkaW9WYWx1ZUVsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX3IgPSAwOyBfciA8IHJhZGlvVmFsdWVFbGVzLmxlbmd0aDsgX3IrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJhZGlvVmFsdWVFbGVzW19yXS5jaGVja2VkID0gJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/ngrnlh7vljZXpgInmjInpkq7ml7bvvIxcclxuICAgICAgICAkKGRvY3VtZW50KS5kZWxlZ2F0ZShyYWRpb0NoZWNrcywgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoYWxsQ2hlY2spWzBdLmNoZWNrZWQgPSAkKHJhZGlvQ2hlY2tzICsgXCI6Y2hlY2tlZFwiKS5sZW5ndGggPT0gJChyYWRpb0NoZWNrcykubGVuZ3RoO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB1cmwgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBnZXQgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChcIihefCYpXCIgKyBuYW1lICsgXCI9KFteJl0qKSgmfCQpXCIsIFwiaVwiKTtcclxuICAgICAgICAgICAgdmFyIHIgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxKS5tYXRjaChyZWcpO1xyXG4gICAgICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gZGVjb2RlVVJJKHJbMl0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOagueaNruWPguaVsOWIl+ihqOmVv+W6pui/m+ihjOWIpOaWre+8jOWFvOWuuUlFOVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ29iamVjdCcpIHsvL+S4gOS4quWvueixoe+8jOS9v+eUqGtleeagh+iusHZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gYXJndW1lbnRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgLCBzZWFyY2ggPSBsb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBvIGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkobykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoID0gY2hhbmdlVVJMS2V5VmFsdWUoc2VhcmNoLCBvLCBvYmpbb10pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgncHVzaFN0YXRlJyBpbiBoaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgZG9jdW1lbnQudGl0bGUsIHNlYXJjaCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCdwdXNoU3RhdGUnIGluIEhpc3RvcnkpIHsvL2llOSDkuI3mlK/mjIFwdXNoU3RhdGXmlrnms5UsamF2YXNjcmlwdC5lanPkuK3mt7vliqBoaXN0b3J5Lmpz5a6M5oiQaHRtbDTlr7lwdXNoU3RhdGXnmoTmlK/mjIFcclxuICAgICAgICAgICAgICAgICAgICBIaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBzZWFyY2gpOy8v6L+U5Zue6YeN5paw5p6E6YCg5ZCOc2VhcmNo5LiyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgey8va2V5K3ZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gYXJndW1lbnRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgLCB2YWx1ZSA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgICAgICAgIGlmICgncHVzaFN0YXRlJyBpbiBoaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgZG9jdW1lbnQudGl0bGUsIGNoYW5nZVVSTEtleVZhbHVlKGxvY2F0aW9uLnRvU3RyaW5nKCksIGtleSwgdmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJ3B1c2hTdGF0ZScgaW4gSGlzdG9yeSkgey8vaWU5IOS4jeaUr+aMgXB1c2hTdGF0ZeaWueazlSxqYXZhc2NyaXB0LmVqc+S4rea3u+WKoGhpc3RvcnkuanPlrozmiJBodG1sNOWvuXB1c2hTdGF0ZeeahOaUr+aMgVxyXG4gICAgICAgICAgICAgICAgICAgIEhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIGNoYW5nZVVSTEtleVZhbHVlKGxvY2F0aW9uLnNlYXJjaCwga2V5LCB2YWx1ZSkpOy8v6L+U5Zue6YeN5paw5p6E6YCg5ZCOc2VhcmNo5LiyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gY2hhbmdlVVJMS2V5VmFsdWUodXJsLCBhcmcsIGFyZ192YWwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gYXJnICsgJz0oW14mXSopJztcclxuICAgICAgICAgICAgICAgIHZhciByZXBsYWNlVGV4dCA9IGFyZyArICc9JyArIGFyZ192YWw7XHJcbiAgICAgICAgICAgICAgICBpZiAodXJsLm1hdGNoKHBhdHRlcm4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9ICcvKCcgKyBhcmcgKyAnPSkoW14mXSopL2dpJztcclxuICAgICAgICAgICAgICAgICAgICB0bXAgPSB1cmwucmVwbGFjZShldmFsKHRtcCksIHJlcGxhY2VUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG1wO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodXJsLm1hdGNoKCdbXFw/XScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwgKyAnJicgKyByZXBsYWNlVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJsICsgJz8nICsgcmVwbGFjZVRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXQ6IGdldFxyXG4gICAgICAgICAgICAsIHNldDogc2V0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIHZhciBmb3JtYXRJbWFnZT1mdW5jdGlvbiAocGF0aCwgc2l6ZSwgZWxlKSB7XHJcbiAgICAgICAgaWYocGF0aCBpbnN0YW5jZW9mICBBcnJheSAmJiBwYXRoLmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgcGF0aCA9IHBhdGhbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBJTUFHRV9TSVpFID0ge1xyXG4gICAgICAgICAgICBvcmlnaW5hbDoge1xyXG4gICAgICAgICAgICAgICAgcGF0aDogXCJcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgeGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl94bGFyZ2VcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiNjYwKjY2MFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9sYXJnZVwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI0MjAqNDIwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWlkZGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWRkbGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMzAwKjMwMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNtYWxsOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9zbWFsbFwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCIyNDAqMjQwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGl0dGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9saXR0bGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMTIwKjEyMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1pY3JvOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWNyb1wiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI2MCo2MFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHNpemUgPSBJTUFHRV9TSVpFW3NpemUgfHwgXCJtaWRkbGVcIl0gfHwgSU1BR0VfU0laRS5taWRkbGU7XHJcbiAgICAgICAgdmFyIHBhdGhUZW1wID0gL1xcLlxcdys/JC8uZXhlYyhwYXRoKTtcclxuICAgICAgICBpZiAoIXBhdGhUZW1wKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gc2l6ZS5wYXRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhdGggPSAocGF0aC5zdWJzdHIoMCwgcGF0aFRlbXAuaW5kZXggfHwgcGF0aC5sZW5ndGgpKSArIHNpemUucGF0aCArIHBhdGhUZW1wWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZWxlICYmIGVsZS5hdHRyKSB7XHJcbiAgICAgICAgICAgIGVsZS5hdHRyKFwic3JjXCIsIHBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGFqYXg6IGFqYXhcclxuICAgICAgICAsIGdldFRpbXRvdXQ6IF90aW1lT3V0XHJcbiAgICAgICAgLCBzZXRDaGVja2JveExpc3RlbmVyOiBzZXRDaGVja2JveExpc3RlbmVyXHJcbiAgICAgICAgLCB1cmw6IHVybFxyXG4gICAgICAgICwgZm9ybWF0SW1hZ2U6IGZvcm1hdEltYWdlXHJcbiAgICB9XHJcbn0oKSk7XHJcblxyXG5leHBvcnRzLmFqYXggPSBGdW4uYWpheDtcclxuZXhwb3J0cy5nZXRUaW1lb3V0ID0gRnVuLmdldFRpbXRvdXQ7XHJcbmV4cG9ydHMuc2V0Q2hlY2tib3hMaXN0ZW5lciA9IEZ1bi5zZXRDaGVja2JveExpc3RlbmVyO1xyXG5leHBvcnRzLnVybCA9IEZ1bi51cmw7XHJcbmV4cG9ydHMuZm9ybWF0SW1hZ2UgPSBGdW4uZm9ybWF0SW1hZ2U7XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEplcmVteSBvbiAyMDE3LzEvMjMuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBNb2RhbCA9IHJlcXVpcmUoJy4vbW9kYWwnKTtcclxudmFyIGdlbmVyYWwgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+aXtumXtOagvOW8j+WMllxyXG4gICAgICAgIERhdGUucHJvdG90eXBlLkZvcm1hdCA9IGZ1bmN0aW9uIChmbXQpIHsgLy9hdXRob3I6IEplcmVteXl5XHJcbiAgICAgICAgICAgIHZhciBvID0ge1xyXG4gICAgICAgICAgICAgICAgXCJNK1wiOiB0aGlzLmdldE1vbnRoKCkgKyAxLCAvL+aciOS7vVxyXG4gICAgICAgICAgICAgICAgXCJkK1wiOiB0aGlzLmdldERhdGUoKSwgLy/ml6VcclxuICAgICAgICAgICAgICAgIFwiaCtcIjogdGhpcy5nZXRIb3VycygpLCAvL+Wwj+aXtlxyXG4gICAgICAgICAgICAgICAgXCJtK1wiOiB0aGlzLmdldE1pbnV0ZXMoKSwgLy/liIZcclxuICAgICAgICAgICAgICAgIFwicytcIjogdGhpcy5nZXRTZWNvbmRzKCksIC8v56eSXHJcbiAgICAgICAgICAgICAgICBcInErXCI6IE1hdGguZmxvb3IoKHRoaXMuZ2V0TW9udGgoKSArIDMpIC8gMyksIC8v5a2j5bqmXHJcbiAgICAgICAgICAgICAgICBcIlNcIjogdGhpcy5nZXRNaWxsaXNlY29uZHMoKSAvL+avq+enklxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoLyh5KykvLnRlc3QoZm10KSkgZm10ID0gZm10LnJlcGxhY2UoUmVnRXhwLiQxLCAodGhpcy5nZXRGdWxsWWVhcigpICsgXCJcIikuc3Vic3RyKDQgLSBSZWdFeHAuJDEubGVuZ3RoKSk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gbylcclxuICAgICAgICAgICAgICAgIGlmIChuZXcgUmVnRXhwKFwiKFwiICsgayArIFwiKVwiKS50ZXN0KGZtdCkpIGZtdCA9IGZtdC5yZXBsYWNlKFJlZ0V4cC4kMSwgKFJlZ0V4cC4kMS5sZW5ndGggPT0gMSkgPyAob1trXSkgOiAoKFwiMDBcIiArIG9ba10pLnN1YnN0cigoXCJcIiArIG9ba10pLmxlbmd0aCkpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZtdDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvL+S/ruaUueWvhueggVxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjY2hhbmdlLXB3ZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLmNoYW5nZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnLmNoYW5nZS1wd2QnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8v5YWz6Zet5L+u5pS55a+G56CBXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5jbG9zZS1wd2QnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJy5jaGFuZ2UtYmFjaycpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5jaGFuZ2UtcHdkJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2Vuc3VyZS1wd2QnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkKCcjbmV3LXBhc3N3b3JkJykudmFsKCkgIT0gJCgnI2Vuc3VyZS1wYXNzd29yZCcpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcjZW5zdXJlLXBhc3N3b3JkJykuYWRkQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQoJyNlbnN1cmUtcGFzc3dvcmQnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJhZ2VudE1lbWJlcklkXCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJvbGRQd2RcIjogJCgnI3Bhc3N3b3JkJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwd2RcIjogJCgnI25ldy1wYXNzd29yZCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwicHdkQ29uZmlybVwiOiAkKCcjZW5zdXJlLXBhc3N3b3JkJykudmFsKClcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWNjb3VudC9jaGFuZ2VQd2QnXHJcbiAgICAgICAgICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfkv67mlLnmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLmNoYW5nZS1iYWNrJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuY2hhbmdlLXB3ZCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfkv67mlLnlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBydW46IHJ1blxyXG4gICAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cy5nZW5lcmFsID0gZ2VuZXJhbDsiLCIvKipcclxuICogQ3JlYXRlZCBieSB6cnogb24gMjAxNi8yLzI0LlxyXG4gKiBAdmVyc2lvbiAxLjAuMCBjcmVhdGVkXHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuLy/mnoTpgKDkv6Hmga/moYbkuLvkvZNcclxudmFyIE1vZGFsID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8v5p6E6YCg5Y6f5aeL57G7XHJcbiAgICBmdW5jdGlvbiBNKG0pIHtcclxuICAgICAgICB0aGlzLnMgPSBtLnM7Ly/mmK/lkKbmmL7npLpcclxuICAgICAgICB0aGlzLmlkID0gbS5pZDtcclxuICAgIH1cclxuXHJcbiAgICAvL+aehOmAoOagh+WHhnNob3fmlrnms5XvvIznlKjkuo7nu6fmib9cclxuICAgIE0ucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGVsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuaWQpO1xyXG4gICAgICAgIGlmIChlbGUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucyAmJiAhaXNTaG93KCkpIHsvL+aYvuekuuW9k+WJjemakOiXj1xyXG4gICAgICAgICAgICAgICAgZWxlLmNsYXNzTmFtZSA9IGVsZS5jbGFzc05hbWUucmVwbGFjZShcImRwLW5cIiwgXCJcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMucyAmJiBpc1Nob3coKSkgey8v6ZqQ6JeP5b2T5YmN5pi+56S6XHJcbiAgICAgICAgICAgICAgICBlbGUuY2xhc3NOYW1lICs9IFwiIGRwLW5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+WOu+mZpOS4pOi+ueeahOepuuagvFxyXG4gICAgICAgICAgICBlbGUuY2xhc3NOYW1lID0gU3RyaW5nKGVsZS5jbGFzc05hbWUpLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gaXNTaG93KCkgey8v5piv5ZCm5bey5pi+56S677yM5pegY2xhc3Pml7bmmL7npLpcclxuICAgICAgICAgICAgcmV0dXJuIGVsZS5jbGFzc05hbWUuc3BsaXQoXCJkcC1uXCIpLmxlbmd0aCA9PSAxO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy/liqDovb3kv6Hmga/moYZcclxuICAgIHZhciBsb2FkaW5nID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+WIneWni+WMlueUn+aIkOWKoOi9veS/oeaBr+ahhlxyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGluZ19tb2RhbF9lbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwibG9hZGluZ19tb2RhbF9lbGVtZW50XCIgY2xhc3M9XCJsb2FkaW5nLW1vZGFsLWJvZHkgZHAtblwiPjxkaXYgY2xhc3M9XCJjb3Zlcl9tb2RhbF9lbGVtZW50XCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJsb2FkaW5nLW1vZGFsLWltYWdlXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJsb2FkaW5nLW1vZGFsLXRleHRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGgyPueOqeWRveWKoOi9veS4reKApuKApjwvaDI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8v5pi+56S644CB6ZqQ6JeP5L+h5oGv5qGGXHJcbiAgICAgICAgdmFyIHNob3cgPSBmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICBzID0gdHlwZW9mIHMgPT0gXCJ1bmRlZmluZWRcIiA/IHRydWUgOiBzOy8v5peg5Y+C5pWw5pi+56S65L+h5oGv5qGGXHJcbiAgICAgICAgICAgIHZhciBtID0gbmV3IE0oe2lkOiBcImxvYWRpbmdfbW9kYWxfZWxlbWVudFwiLCBzOiBzfSk7XHJcbiAgICAgICAgICAgIG0uc2hvdygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICAsIHNob3c6IHNob3dcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgLy/lvLnlh7rkv6Hmga/moYZcclxuICAgIHZhciBhbGVydCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbGVydF9tb2RhbF9lbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwiYWxlcnRfbW9kYWxfZWxlbWVudFwiIGNsYXNzPVwiYWxlcnQtbW9kYWwtZWxlbWVudCBkcC1uXCI+PGRpdiBjbGFzcz1cImNvdmVyX21vZGFsX2VsZW1lbnRcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFsZXJ0LW1vZGFsLWNvbnRlbnRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFsZXJ0LW1vZGFsLWJvZHlcIj48c3BhbiBjbGFzcz1cImFsZXJ0LW1vZGFsLXRleHRcIj48L3NwYW4+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbGVydC1tb2RhbC1mb290ZXJcIj48YnV0dG9uIGlkPVwiYWxlcnRfbW9kYWxfY2xvc2VcIiBjbGFzcz1cImFsZXJ0LW1vZGFsLWJ1dHRvblwiPuWFs+mXrTwvYnV0dG9uPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgIHMgPSB0eXBlb2YgcyA9PSBcInVuZGVmaW5lZFwiID8gdHJ1ZSA6IHM7XHJcbiAgICAgICAgICAgIHZhciBtID0gbmV3IE0oe2lkOiBcImFsZXJ0X21vZGFsX2VsZW1lbnRcIiwgczogc30pO1xyXG4gICAgICAgICAgICBtLnNob3coKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiuvue9ruW8ueWHuuS/oeaBr+ahhlxyXG4gICAgICAgICAqIEBwYXJhbSBtc2cgICAgICAg5pi+56S655qE5L+h5oGv77yM5pSv5oyBaHRtbFxyXG4gICAgICAgICAqIEBwYXJhbSBzZWQgICAgICAg5YCS6K6h5pe25YWz6Zet5pe26Ze077yM5Y2V5L2N77yac2Vjb25kXHJcbiAgICAgICAgICogQHBhcmFtIGNhbGxiYWNrICDlhbPpl63op6blj5Hlm57osIPlh73mlbBcclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgc2V0ID0gZnVuY3Rpb24gKG1zZywgc2VkLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbGVydF9tb2RhbF9lbGVtZW50XCIpO1xyXG4gICAgICAgICAgICBpZiAobXNnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1zZyA9PT0gJ29iamVjdCcpIHsvL+W6lOWvueWQjuerr+i/lOWbnuaPkOekuuaXtuS9v+eUqE9iamVjdOWwgeijhVxyXG4gICAgICAgICAgICAgICAgICAgIG1zZyA9IEpTT04uc3RyaW5naWZ5KG1zZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihlbGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYWxlcnQtbW9kYWwtdGV4dFwiKVswXS5pbm5lckhUTUwgPSBtc2c7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJhbGVydC1tb2RhbC10ZXh0XCIpWzBdLmlubmVySFRNTCA9IG1zZztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNob3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc2VkID4gMCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9LCAxMDAwICogc2VkKTtcclxuICAgICAgICAgICAgfS8v5peg5YWz6Zet5pe26Ze05oiW6ICF5YWz6Zet5pe26Ze05Li6MO+8jOS4jeiHquWKqOWFs+mXrVxyXG4gICAgICAgICAgICAvL2ZpeG1lIOS6i+S7tuebkeWQrOeahGll5YW85a655oCnXHJcbiAgICAgICAgICAgIC8v5YWz6Zet5oyJ6ZKu55qE5LqL5Lu25L6m5ZCsXHJcbiAgICAgICAgICAgICQoXCIjYWxlcnRfbW9kYWxfY2xvc2VcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIC8v6Zi75q2i5LqL5Lu257un57ut5Lyg6YCSXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICAsIHNob3c6IHNob3dcclxuICAgICAgICAgICAgLCBzZXQ6IHNldFxyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICAvL+mAieaLqeS/oeaBr+ahhlxyXG4gICAgdmFyIGNvbmZpcm0gPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybV9tb2RhbF9lbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwiY29uZmlybV9tb2RhbF9lbGVtZW50XCIgY2xhc3M9XCJjb25maXJtLW1vZGFsLWVsZW1lbnQgZHAtblwiPjxkaXYgY2xhc3M9XCJjb3Zlcl9tb2RhbF9lbGVtZW50XCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb25maXJtLW1vZGFsLWNvbnRlbnRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBpZD1cImNvbmZpcm1fbW9kYWxfaGVhZGVyXCIgY2xhc3M9XCJjb25maXJtLW1vZGFsLWhlYWRlciBkcC1uXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb25maXJtLW1vZGFsLWJvZHlcIj48c3BhbiBpZD1cImNvbmZpcm1fbW9kYWxfdGV4dFwiIGNsYXNzPVwiY29uZmlybS1tb2RhbC10ZXh0XCI+PC9zcGFuPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29uZmlybS1tb2RhbC1mb290ZXJcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvb3Rlci1idXR0b24tc3VjY2Vzc1wiPjxidXR0b24gY2xhc3M9XCJjb25maXJtLW1vZGFsLWJ1dHRvbiAgbW9kYWwtc3VjY2Vzc1wiIGRhdGEtY29uZmlybT1cInN1Y2Nlc3NcIj7noa7orqQ8L2J1dHRvbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvb3Rlci1idXR0b24tZmFsc2VcIj48YnV0dG9uIGNsYXNzPVwiY29uZmlybS1tb2RhbC1idXR0b25cIiBkYXRhLWNvbmZpcm09XCJlcnJvclwiPuWPlua2iDwvYnV0dG9uPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj48L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgIHMgPSB0eXBlb2YgcyA9PSBcInVuZGVmaW5lZFwiID8gdHJ1ZSA6IHM7XHJcbiAgICAgICAgICAgIHZhciBtID0gbmV3IE0oe2lkOiBcImNvbmZpcm1fbW9kYWxfZWxlbWVudFwiLCBzOiBzfSk7XHJcbiAgICAgICAgICAgIG0uc2hvdygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6K6+572u6YCJ5oup5L+h5oGv5qGG55qE5YaF5a65XHJcbiAgICAgICAgICogQHBhcmFtIG9wdGlvbiAgICDphY3nva5cclxuICAgICAgICAgKiB7XHJcbiAgICAgICAgICogICAgICB0aXRsZTpcIuWktOmDqOaYvuekuueahOS/oeaBr1wiXHJcbiAgICAgICAgICogICAgICAsdGV4dDpcIuaYvuekuueahOaPkOekuuS/oeaBr1wiXHJcbiAgICAgICAgICogICAgICAsc3VjY2VzczpcIueCueWHu+aIkOWKn+WQjueahOWbnuiwg1wiXHJcbiAgICAgICAgICogICAgICAsZXJyb3I6XCLngrnlh7vlpLHotKXlkI7nmoTlm57osINcIlxyXG4gICAgICAgICAqICAgICAgLGNvbXBsZXRlOlwi54K55Ye75oyJ6ZKu5ZCO55qE5pW05L2T5Zue6LCDXCJcclxuICAgICAgICAgKiB9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIGJhciA9IDA7XHJcbiAgICAgICAgdmFyIHNldCA9IGZ1bmN0aW9uIChvcHRpb24pIHtcclxuICAgICAgICAgICAgaWYgKCFvcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoXCJ0aXRsZVwiIGluIG9wdGlvbiAmJiBvcHRpb24udGl0bGUubGVuZ3RoID4gMCkgey8v5pyJ5aS06YOo77yM5YiZ5pi+56S65aS06YOoXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1fbW9kYWxfaGVhZGVyXCIpLmlubmVySFRNTCA9IG9wdGlvbi50aXRsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoXCJ0ZXh0XCIgaW4gb3B0aW9uICYmIG9wdGlvbi50ZXh0Lmxlbmd0aCA+IDApIHsvL+acieWGheWuue+8jOWImeaYvuekuuaVtOS4qumAieaLqeS/oeaBr+ahhlxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtX21vZGFsX3RleHRcIikuaW5uZXJIVE1MID0gb3B0aW9uLnRleHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9maXhtZSDkuovku7bnm5HlkKznmoRpZeWFvOWuueaAp1xyXG4gICAgICAgICAgICAvL+WFs+mXreaMiemSrueahOS6i+S7tuS+puWQrFxyXG4gICAgICAgICAgICAkKFwiI2NvbmZpcm1fbW9kYWxfZWxlbWVudFwiKS5maW5kKFwiLmNvbmZpcm0tbW9kYWwtYnV0dG9uXCIpLm9mZihcImNsaWNrXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy9maXhtZSAub2ZmKFwiY2xpY2tcIinnlKjkuo7pmLLmraLlpJrmrKHop6blj5E8LS3lvojnjoTlrabvvIzmiJHkuZ/kuI3nn6XpgZPkuLrku4DkuYjvvIzkvYbmmK/or7fkuI3opoHkv67mlLnjgIJcclxuICAgICAgICAgICAgICAgIHZhciBhdHIgPSAkKHRoaXMpLmF0dHIoXCJkYXRhLWNvbmZpcm1cIik7Ly/pgInmi6nnmoTmjInpkq5cclxuICAgICAgICAgICAgICAgIGJhcisrO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbiAmJiBhdHIgaW4gb3B0aW9uICYmIG9wdGlvblthdHJdIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25bYXRyXSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbiAmJiBcImNvbXBsZXRlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5jb21wbGV0ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmNvbXBsZXRlKCk7Ly/oi6XmnInlrozmiJDlh73mlbDvvIzliJnmiafooYxcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7Ly/lkKbliJnvvIzlhbPpl63pgInmi6nmoYZcclxuICAgICAgICAgICAgICAgICAgICBzaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8v6Zi75q2i5LqL5Lu257un57ut5Lyg6YCSXHJcbiAgICAgICAgICAgICAgICAvL3JldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0XHJcbiAgICAgICAgICAgICwgc2hvdzogc2hvd1xyXG4gICAgICAgICAgICAsIHNldDogc2V0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIC8v6KaG55uW5bGCXHJcbiAgICB2YXIgY292ZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY292ZXJfbW9kYWxfZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD1cImNvdmVyX21vZGFsX2VsZW1lbnRcIiBjbGFzcz1cImNvdmVyLW1vZGFsLWVsZW1lbnQgZHAtblwiPjwvZGl2PicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBoaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvdmVyX21vZGFsX2VsZW1lbnRcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY292ZXJfbW9kYWxfZWxlbWVudFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICAsIHNob3c6IHNob3dcclxuICAgICAgICAgICAgLCBoaWRlOiBoaWRlXHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaW5pdExvYWRpbmc6IGxvYWRpbmcuaW5pdFxyXG4gICAgICAgICwgc2hvd0xvYWRpbmc6IGxvYWRpbmcuc2hvd1xyXG5cclxuICAgICAgICAsIGluaXRBbGVydDogYWxlcnQuaW5pdFxyXG4gICAgICAgICwgc2hvd0FsZXJ0OiBhbGVydC5zaG93XHJcbiAgICAgICAgLCBzZXRBbGVydDogYWxlcnQuc2V0XHJcblxyXG4gICAgICAgICwgaW5pdENvbmZpcm06IGNvbmZpcm0uaW5pdFxyXG4gICAgICAgICwgc2V0Q29uZmlybTogY29uZmlybS5zZXRcclxuICAgICAgICAsIHNob3dDb25maXJtOiBjb25maXJtLnNob3dcclxuICAgICAgICAsIGluaXRDb3ZlcjogY292ZXIuaW5pdFxyXG4gICAgfVxyXG59KCkpO1xyXG5cclxuLy/pobXpnaLliqDovb3lrozmr5XlkI7nlJ/miJDlm5vkuKroh6rlrprkuYnmqKHmgIHmoYZcclxuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAvL+mhtemdouWKoOi9veaXtueUn+aIkOS4gOS4quimhuebluWxglxyXG4gICAgTW9kYWwuaW5pdENvdmVyKCk7XHJcbiAgICAvL+mhtemdouWKoOi9veaXtueUn+aIkOS4gOS4quWKoOi9veS/oeaBr+ahhlxyXG4gICAgTW9kYWwuaW5pdExvYWRpbmcoKTtcclxuICAgIC8v6aG16Z2i5Yqg6L295pe255Sf5oiQ5LiA5Liq5by55Ye65L+h5oGv5qGGXHJcbiAgICBNb2RhbC5pbml0QWxlcnQoKTtcclxuICAgIC8v6aG16Z2i5Yqg6L295pe255Sf5oiQ5LiA5Liq6YCJ5oup5L+h5oGv5qGGXHJcbiAgICBNb2RhbC5pbml0Q29uZmlybSgpO1xyXG59LCAxMDApO1xyXG5cclxuXHJcbi8v5oqb5Ye65LiK5bGC6LCD55SoXHJcbmV4cG9ydHMuc2hvd0xvYWRpbmcgPSBNb2RhbC5zaG93TG9hZGluZztcclxuZXhwb3J0cy5zZXRBbGVydCA9IE1vZGFsLnNldEFsZXJ0O1xyXG5leHBvcnRzLnNob3dBbGVydCA9IE1vZGFsLnNob3dBbGVydDtcclxuZXhwb3J0cy5zZXRDb25maXJtID0gTW9kYWwuc2V0Q29uZmlybTtcclxuZXhwb3J0cy5zaG93Q29uZmlybSA9IE1vZGFsLnNob3dDb25maXJtOyJdfQ==
