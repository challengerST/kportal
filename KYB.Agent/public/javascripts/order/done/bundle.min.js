(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/24.
 */
"use strict";

(function ($) {
  /**
   * 生成分页器
   * @param ele 需要添加分页器的元素
   * @param offset 偏移量，即从第data-offset开始
   * @param length 总记录条数
   * @param showPages 分页器显示的页数，超过则隐藏多余的页
   * @param rows 每页显示的记录条数
   */
  $.burster = function (ele, offset, length, showPages, rows) {
    offset = offset ? parseInt(offset) : 0;
    //将分页器装入table中
    if (length && length > offset) {
      var pageHtml = ""
        , ass = ""//清空需要装入的html
        , beforePages = Math.ceil(offset / rows)//需要显示的前页数/当前页
        , afterPages = Math.ceil((length - offset ) / rows)//需要显示的后页数
        , pages = Math.ceil(length / rows) //总页数
        , k = 0;
      //alert("总页数" + pages + " 前页数 " + beforePages + " 后页数 " + afterPages);
      //若页数小于showPages页，则全部显示
      if (pages >= 0 && pages <= showPages) {
        for (k = 0; k < pages; k++) {
          if (k == beforePages) {
            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
          } else {
            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
          }
        }
      } else if (pages > showPages) {//总页数大于showPages页
        if (beforePages <= Math.ceil(showPages / 2) && afterPages > showPages + 1) {
          for (k = 0; k < showPages; k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages <= Math.ceil(showPages / 2) && afterPages == showPages + 1) {
          for (k = 0; k < showPages - 1; k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages <= Math.ceil(showPages / 2) && afterPages <= showPages) {
          for (k = 0; k < showPages - 1; k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > Math.ceil(showPages / 2) && beforePages <= showPages && afterPages > showPages) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > showPages && afterPages > showPages) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > Math.ceil(showPages / 2) && beforePages <= pages && afterPages <= showPages && afterPages > Math.ceil(showPages / 2) + 1) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > pages && afterPages <= showPages && afterPages > Math.ceil(showPages / 2) + 1) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
          pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
        } else if (beforePages > Math.ceil(showPages / 2) && afterPages <= Math.ceil(showPages / 2) + 1) {
          pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
          for (k = beforePages - Math.ceil(showPages / 2) + 1; k < pages; k++) {
            if (k == beforePages) {
              pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
            } else {
              pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
            }
          }
        }
      }
      //判断"首页"和"末页"是否可点击
      var firstPage, lastPage;
      if (offset == 0) {//此时首页无法点击
        firstPage = '<li class="disabled"><a class="pages" data-offset="0">首页</a></li>';
        lastPage = '<li><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '" >末页</a></li>';
      } else if ((offset + rows) >= length) {//此时末页无法点击
        firstPage = '<li><a class="pages" data-offset="0">首页</a></li>';
        lastPage = '<li class="disabled"><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '">末页</a></li>';
      } else {
        firstPage = '<li><a class="pages" data-offset="0">首页</a></li>';
        lastPage = '<li><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '">末页</a></li>';
      }
      //判断"上一页"和"下一页"是否存在
      var upPage, downPage;
      if (offset == 0 || (offset < rows && (offset % rows != 0))) {
        upPage = "<li class='disabled'><a class='pages' func='previous' data-offset='" + parseInt(offset) + "' >上页</a></li>"
      } else {
        upPage = "<li><a class='pages' func='previous' data-offset='" + (parseInt(offset) - parseInt(rows)) + "' >上页</a></li>";
      }
      if (offset >= (length - rows)) {
        downPage = "<li class='disabled'><a class='pages' func='next' data-offset='" + parseInt(offset) + "'>下页</a></li>"
      } else {
        downPage = "<li><a class='pages' func='next' data-offset='" + parseInt(parseInt(offset) + parseInt(rows)) + "'>下页</a></li>"
      }
      if (pages != 1) {
        //分页部分
        ass += "<div id='pager' class='pager-info'>" +
        "<h6 id='result' class='pager-record'>共有<span>" + length + "</span>条记录</h6>" +
        "<ul class='pagination'>" + firstPage + upPage + pageHtml + downPage + lastPage + "</ul></div>";
        //table中注入拼装的记录
        ele.html(ass);
      } else {
        ele.html('');
      }
    }
  }
}(jQuery));
},{}],2:[function(require,module,exports){
/**
 * Created by zrz on 2016/2/26.
 * @version 1.0.0 created 通用性功能方法
 */

'use strict';

var Fun = (function () {
    var _timeOut = 100000;//请求超时时间为10s
    /**
     * 封装ajax
     * @param option
     * {
     *      url:"请求的地址"
     *      ,method:"请求的方法"
     *      ,async:"是否并发"
     *      ,data:"发送的数据"
     *      ,success:"成功时回调"
     *      ,error:"失败/超时时回调"
     *      ,timeout:"超时时间"
     *      ,complete:"完成后的回调"
     * }
     */
    var ajax = function (option) {
        //ajax开始时应显示“加载信息框”
        Modal.showLoading();
        $.ajax({
            url: option.url
            , type: "type" in option && option.type || "GET"
            , timeout: option.timeout || _timeOut
            , data: "data" in option && option.data || {}
            , dataType: "json"
            , async: ("async" in option && option.async) ? true : false
            , success: function (json) {
                if ("status" in json && json.status > 0 && "data" in json) {
                    if ("success" in option) {
                        option.success(json.data);
                    } else {
                        Modal.setAlert("无success方法!");
                    }
                } else if ("error" in option && option.error instanceof Function) {
                    option.error(json);
                } else {
                    Modal.setAlert('操作失败!');
                }
            }, error: function (xhr) {//404或者超时
                if ("error" in option && option.error instanceof Function) {
                    //提示用户错误信息
                    Modal.showLoading(false);
                    Modal.setAlert("连接服务器失败，状态：" + (xhr.status || -1) + ",信息：" + (xhr.statusText || "-"));
                    option.error(xhr.status, xhr.statusText);//回调请求的状态和错误信息
                }
            }, complete: function (xhr, type) {
                //关闭“加载信息框”
                Modal.showLoading(false);
                if ("complete" in option && option.complete instanceof Function) {
                    option.complete(xhr, type);//回调请求的xhr信息和类型
                }
            }
        });
    };
    //全选和单选的绑定
    var setCheckboxListener = function (allCheck, radioChecks) {
        //筛选单选按钮组
        var radioValueEles = $(radioChecks);
        //点击全选时，同组按钮被同步
        $(document).delegate(allCheck, "click", function () {
            if (radioValueEles && radioValueEles.length > 0) {
                for (var _r = 0; _r < radioValueEles.length; _r++) {
                    radioValueEles[_r].checked = $(this).is(":checked");
                }
            }
        });
        //点击单选按钮时，
        $(document).delegate(radioChecks, "click", function () {
            $(allCheck)[0].checked = $(radioChecks + ":checked").length == $(radioChecks).length;
        });
    };
    var url = (function () {
        var get = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURI(r[2]);
            return null;
        };
        /**
         * 根据参数列表长度进行判断，兼容IE9
         * @returns {string}
         */
        var set = function () {
            if (arguments.length === 1 && typeof arguments[0] === 'object') {//一个对象，使用key标记value
                var obj = arguments[0]
                    , search = location.search;
                for (var o in obj) {
                    if (obj.hasOwnProperty(o)) {
                        search = changeURLKeyValue(search, o, obj[o]);
                    }
                }
                if ('pushState' in history) {
                    history.pushState(null, document.title, search);
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, search);//返回重新构造后search串
                }
            } else if (arguments.length === 2) {//key+value
                var key = arguments[0]
                    , value = arguments[1];
                if ('pushState' in history) {
                    history.pushState(null, document.title, changeURLKeyValue(location.toString(), key, value));
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, changeURLKeyValue(location.search, key, value));//返回重新构造后search串
                }
            }
            function changeURLKeyValue(url, arg, arg_val) {
                var pattern = arg + '=([^&]*)';
                var replaceText = arg + '=' + arg_val;
                if (url.match(pattern)) {
                    var tmp = '/(' + arg + '=)([^&]*)/gi';
                    tmp = url.replace(eval(tmp), replaceText);
                    return tmp;
                } else {
                    if (url.match('[\?]')) {
                        return url + '&' + replaceText;
                    } else {
                        return url + '?' + replaceText;
                    }
                }
            }
        };
        return {
            get: get
            , set: set
        }
    }());

    var formatImage=function (path, size, ele) {
        if(path instanceof  Array && path.length>0){
            path = path[0];
        }
        var IMAGE_SIZE = {
            original: {
                path: "",
                size: ""
            },
            xlarge: {
                path: "_xlarge",
                size: "660*660"
            },
            large: {
                path: "_large",
                size: "420*420"
            },
            middle: {
                path: "_middle",
                size: "300*300"
            },
            small: {
                path: "_small",
                size: "240*240"
            },
            little: {
                path: "_little",
                size: "120*120"
            },
            micro: {
                path: "_micro",
                size: "60*60"
            }
        };
        size = IMAGE_SIZE[size || "middle"] || IMAGE_SIZE.middle;
        var pathTemp = /\.\w+?$/.exec(path);
        if (!pathTemp) {
            path += size.path;
        } else {
            path = (path.substr(0, pathTemp.index || path.length)) + size.path + pathTemp[0];
        }
        if (ele && ele.attr) {
            ele.attr("src", path);
        }
        return path;
    };
    //金额格式化小数点2位
    var format = (function () {
        var formatamount = function(_value){
            return parseFloat(_value).toFixed(2);
        };
        //体积格式化小数点2位
        var formatvolume = function(_value){
            return parseFloat(_value).toFixed(3);
        };
        //重量格式化小数点2位
        var formatweight = function(_value){
            return parseFloat(_value).toFixed(3);
        };
        return {
            formatamount: formatamount
            , formatvolume: formatvolume
            , formatweight: formatweight
        }
    }());
    return {
        ajax: ajax
        , getTimtout: _timeOut
        , setCheckboxListener: setCheckboxListener
        , url: url
        , formatImage: formatImage
        , format: format
    }
}());

exports.ajax = Fun.ajax;
exports.getTimeout = Fun.getTimtout;
exports.setCheckboxListener = Fun.setCheckboxListener;
exports.url = Fun.url;
exports.formatImage = Fun.formatImage;
exports.format = Fun.format;

},{}],3:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/23.
 */
'use strict';
var Modal = require('./modal');
var general = (function () {
    var run = function () {
        //时间格式化
        Date.prototype.Format = function (fmt) { //author: Jeremyyy
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        };

        //修改密码
        $(document).on('click', '#change-pwd', function () {
            $('.change-back').removeClass('dp-n');
            $('.change-pwd').removeClass('dp-n');
        });
        //关闭修改密码
        $(document).on('click', '.close-pwd', function () {
            $('.change-back').addClass('dp-n');
            $('.change-pwd').addClass('dp-n');
        });
        $(document).on('click', '#ensure-pwd', function () {
            if ($('#new-password').val() != $('#ensure-password').val()) {
                $('#ensure-password').addClass('warm');
            } else {
                $('#ensure-password').removeClass('warm');
                var data = {
                    "agentMemberId": 0,
                    "oldPwd": $('#password').val(),
                    "pwd": $('#new-password').val(),
                    "pwdConfirm": $('#ensure-password').val()
                };
                $.ajax({
                    url: '/api/account/changePwd'
                    , type: 'post'
                    , data: data
                    , dataType: 'json'
                    , timeout: 100000
                    , success: function (json) {
                        if (json && 'resCode' in json && json.resCode == 0) {
                            Modal.setAlert('修改成功！', null, function () {
                                $('.change-back').addClass('dp-n');
                                $('.change-pwd').addClass('dp-n');
                            });
                        } else {
                            Modal.setAlert(json.resMsg || '修改失败，请重试！');
                        }
                    }
                });
            }
        });
    };
    return {
        run: run
    }
}());
module.exports.general = general;
},{"./modal":4}],4:[function(require,module,exports){
/**
 * Created by zrz on 2016/2/24.
 * @version 1.0.0 created
 */

'use strict';

//构造信息框主体
var Modal = (function () {
    //构造原始类
    function M(m) {
        this.s = m.s;//是否显示
        this.id = m.id;
    }

    //构造标准show方法，用于继承
    M.prototype.show = function () {
        var ele = document.getElementById(this.id);
        if (ele) {
            if (this.s && !isShow()) {//显示当前隐藏
                ele.className = ele.className.replace("dp-n", "");
            } else if (!this.s && isShow()) {//隐藏当前显示
                ele.className += " dp-n";
            }
            //去除两边的空格
            ele.className = String(ele.className).trim();
        }
        function isShow() {//是否已显示，无class时显示
            return ele.className.split("dp-n").length == 1;
        }
    };

    //加载信息框
    var loading = (function () {
        //初始化生成加载信息框
        var init = function () {
            if (!document.getElementById("loading_modal_element")) {
                $('body').append('<div id="loading_modal_element" class="loading-modal-body dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="loading-modal-image"></div>' +
                    '<div class="loading-modal-text">' +
                    '<h2>玩命加载中……</h2>' +
                    '</div></div>');
            }
            return false;
        };
        //显示、隐藏信息框
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;//无参数显示信息框
            var m = new M({id: "loading_modal_element", s: s});
            m.show();
        };
        return {
            init: init
            , show: show
        }
    }());
    //弹出信息框
    var alert = (function () {
        var init = function () {
            if (!document.getElementById("alert_modal_element")) {
                $('body').append('<div id="alert_modal_element" class="alert-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="alert-modal-content">' +
                    '<div class="alert-modal-body"><span class="alert-modal-text"></span></div>' +
                    '<div class="alert-modal-footer"><button id="alert_modal_close" class="alert-modal-button">关闭</button></div>' +
                    '</div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "alert_modal_element", s: s});
            m.show();
        };
        /**
         * 设置弹出信息框
         * @param msg       显示的信息，支持html
         * @param sed       倒计时关闭时间，单位：second
         * @param callback  关闭触发回调函数
         */
        var set = function (msg, sed, callback) {
            var ele = document.getElementById("alert_modal_element");
            if (msg) {
                if (typeof msg === 'object') {//应对后端返回提示时使用Object封装
                    msg = JSON.stringify(msg);
                }
                if(ele){
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }else{
                    init();
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }
                show();
            }
            if (sed > 0) {
                setTimeout(function () {
                    show(false);
                }, 1000 * sed);
            }//无关闭时间或者关闭时间为0，不自动关闭
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#alert_modal_close").on("click", function () {
                if (callback && callback instanceof Function) {
                    callback();
                }
                show(false);
                //阻止事件继续传递
                return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //选择信息框
    var confirm = (function () {
        var init = function () {
            if (!document.getElementById("confirm_modal_element")) {
                $('body').append('<div id="confirm_modal_element" class="confirm-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="confirm-modal-content">' +
                    '<div id="confirm_modal_header" class="confirm-modal-header dp-n"></div>' +
                    '<div class="confirm-modal-body"><span id="confirm_modal_text" class="confirm-modal-text"></span></div>' +
                    '<div class="confirm-modal-footer">' +
                    '<div class="footer-button-success"><button class="confirm-modal-button  modal-success" data-confirm="success">确认</button></div>' +
                    '<div class="footer-button-false"><button class="confirm-modal-button" data-confirm="error">取消</button></div>' +
                    '</div></div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "confirm_modal_element", s: s});
            m.show();
        };
        /**
         * 设置选择信息框的内容
         * @param option    配置
         * {
         *      title:"头部显示的信息"
         *      ,text:"显示的提示信息"
         *      ,success:"点击成功后的回调"
         *      ,error:"点击失败后的回调"
         *      ,complete:"点击按钮后的整体回调"
         * }
         */
        var bar = 0;
        var set = function (option) {
            if (!option) {
                return false;
            }
            if ("title" in option && option.title.length > 0) {//有头部，则显示头部
                document.getElementById("confirm_modal_header").innerHTML = option.title;
            }
            if ("text" in option && option.text.length > 0) {//有内容，则显示整个选择信息框
                document.getElementById("confirm_modal_text").innerHTML = option.text;
            }
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#confirm_modal_element").find(".confirm-modal-button").off("click").on("click", function () {
                //fixme .off("click")用于防止多次触发<--很玄学，我也不知道为什么，但是请不要修改。
                var atr = $(this).attr("data-confirm");//选择的按钮
                bar++;
                if (option && atr in option && option[atr] instanceof Function) {
                    option[atr]();
                }
                if (option && "complete" in option && option.complete instanceof Function) {
                    option.complete();//若有完成函数，则执行
                } else {//否则，关闭选择框
                    show(false);
                }
                //阻止事件继续传递
                //return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //覆盖层
    var cover = (function () {
        var init = function () {
            if (!document.getElementById("cover_modal_element")) {
                $('body').append('<div id="cover_modal_element" class="cover-modal-element dp-n"></div>');
            }
            return false;
        };
        var hide = function () {
            document.getElementById("cover_modal_element").style.display = "none";
        };
        var show = function () {
            document.getElementById("cover_modal_element").style.display = "block";
        };
        return {
            init: init
            , show: show
            , hide: hide
        }
    }());
    return {
        initLoading: loading.init
        , showLoading: loading.show

        , initAlert: alert.init
        , showAlert: alert.show
        , setAlert: alert.set

        , initConfirm: confirm.init
        , setConfirm: confirm.set
        , showConfirm: confirm.show
        , initCover: cover.init
    }
}());

//页面加载完毕后生成四个自定义模态框
setTimeout(function () {
    //页面加载时生成一个覆盖层
    Modal.initCover();
    //页面加载时生成一个加载信息框
    Modal.initLoading();
    //页面加载时生成一个弹出信息框
    Modal.initAlert();
    //页面加载时生成一个选择信息框
    Modal.initConfirm();
}, 100);


//抛出上层调用
exports.showLoading = Modal.showLoading;
exports.setAlert = Modal.setAlert;
exports.showAlert = Modal.showAlert;
exports.setConfirm = Modal.setConfirm;
exports.showConfirm = Modal.showConfirm;
},{}],5:[function(require,module,exports){
/**
 * Created by Auser on 2016/12/6.
 */
"use strict";
var Data = (function () {
    var list = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/done/list'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var priceList = function (callback) {
        var _data = {};
        $.ajax({
            url: '/api/airline/price/list'
            , type: 'post'
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var createCharge = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/done/createCharge'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var expenseDetail = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/tickets/expense/detail'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var ensure = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/tickets/expense/ensure'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var transfer = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/staff/list/transfer'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var opList = function (callback) {
        var _data = {};
        $.ajax({
            url: '/api/staff/list/opList'
            , type: 'post'
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var exPrice = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/tickets/expense/exPrice'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var log = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/pending/log'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var ys = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/underway/ys'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    return {
        list: list
        , priceList: priceList
        , createCharge: createCharge
        , expenseDetail: expenseDetail
        , ensure: ensure
        , opList: opList
        , transfer: transfer
        , exPrice: exPrice
        , log: log
        ,ys:ys
    }
}());
module.exports.Data = Data;
},{}],6:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/2/6.
 */
'use strict';
var myformat = require('../../general/function').format;
var Dom = (function () {
    var list = function (json, param) {
        var str = '';
        str += '<thead> <tr> <td><input type="checkbox" id="check-all"></td><td>订单号</td> <td colspan="2">订单信息</td> <td colspan="4">航线信息</td> <td colspan="5">货物信息</td> <td colspan="2">价格（CNY）</td> </tr> </thead>';
        if (json && json.resCode == 0 && 'resBody' in json && json.resBody && 'sList' in json.resBody && json.resBody.sList instanceof Array) {
            if (json.resBody.sList.length > 0) {
                var arr = json.resBody.sList;
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        str += render(arr[a]);
                    }
                }
                $.burster($(".outer-page"), param.offset || 0, json.resBody.totalCount || 0, 5, param.limit || 20);
                $('.list-cout').html('共为您找到 ' + json.resBody.totalCount + ' 条结果');
            } else {
                str = '<tr class="wrong"><td colspan="9">暂无订单信息，请添加！</td></tr>';
                $('.outer-page').html('');
                $('.list-cout').html('共为您找到 0 条结果');
            }
        } else {
            str = '<tr class="wrong"><td colspan="9">请求失败，<a href="">请重试！</a></td></tr>';
            $('.outer-page').html('');
            $('.list-cout').html('共为您找到 0 条结果');
        }
        function render(d) {
            var c = d.company || {}
                , o = d.order || {}
                , m = d.member || {}
                , type;
            switch (o.orderChannel) {
                case 1:
                    type = '自助订舱';
                    break;
                case 2:
                    type = '快速订舱';
                    break;
                case 3:
                    type = '后台下单';
                    break;
                case 6:
                    type = '拼货订单';
                    break;
                default:
                    type = '自助订舱';
                    break;
            }

            return '<tbody><tr><td class="short-td" colspan="14"></td></tr></tbody><tbody class="data-tbd"> <tr>  <td rowspan="2" style="padding: 0 10px;"><input data-id="' + o.orderId + '" type="checkbox" name="list-sg"></td> <td class="' + (o.orderType == 1 ? 'bg-p' : (o.allowClearence ? 'bg-q' : 'bg-y')) + '">' + (o.orderType == 1 ? '月结' : '票结') + (d.agent ? (d.agent.name ? '&nbsp;&nbsp;&nbsp;&nbsp;' + d.agent.name : '&nbsp;&nbsp;&nbsp;&nbsp;/') : '&nbsp;&nbsp;&nbsp;&nbsp;/') + '</td>' +
                ' <td class="bg-g">客户公司</td> ' +
                '<td class="bg-g">委托时间/方式</td> <td class="bg-g">起始港</td>' +
                ' <td class="bg-g">目的港</td> <td class="bg-g">航空公司</td> ' +
                '<td class="bg-g">起飞时间</td> <td class="bg-g">数量（PCS）</td> <td class="bg-g">重量（KGS）</td>' +
                ' <td class="bg-g">体积（CBM）</td> <td class="bg-g">品名</td> <td class="bg-g">单价（CNY）</td> ' +
                '<td rowspan="2" class="font-r">' + o.airwayFee + '</td> <td class="opt-td" rowspan="2" data-jcbh="' + o.warehouseEntryNum + '" data-khmc="' + (c.companyName || '/') + '" data-lxr="' + (m.memberName || '/') + '">' +
                '<a class="show-opt" href="javascript:void(0);">操作 <span class="caret"></span></a><div class="opt-part dp-n">' +
                (o.chargeFinish ? '<a href="javascript:void(0);" class="show-detail" data-id="' + o.orderId + '">查看</a>' : '<a href="javascript:void(0);" class="show-zd" data-id="' + o.orderId + '">结算</a>') +

                '<a href="javascript:void(0);" class="show-ys" data-id="' + o.orderId + '">运输</a>'+'<a href="javascript:void(0);" class="show-log" data-id="' + o.orderId + '">操作日志</a>'+
                '</div></td> </tr> ' +
                '<tr> <td><a href="/order/detail?tp=done&id=' + o.orderId + '">' + o.orderNum + '</a></td><td>' + (c.companyName || '/') + '</td> <td>' + new Date(o.createDt.replace(/-/g, "/")).Format('yyyy-MM-dd hh:mm') + ' <br/> ' + type + '</td> <td>' + (o.deptCode || '/') + '</td>' +
                ' <td>' + (o.destCode || '/') + '</td> <td>' + (o.airCompanyCode || '/') + '</td> ' +
                '<td>' + new Date(o.flightDate.replace(/-/g, "/")).Format('yyyy-MM-dd') + '</td> <td>' + (o['cargo'].cargoCount || '/') + '</td> ' +
                '<td>' + (o['cargo'].cargoWeight || '/') + '</td> <td>' + (myformat.formatvolume(o['cargo'].cargoSize) || '/') + '</td>' +
                ' <td><div class="tw" title="'+o['cargo'].cargoName+'">' + (o['cargo'].cargoName || '/') + '</div></td> <td>' + o.chargingPrice + '</td> </tr> </tbody>';
        }

        $('.outer-tb').html(str);
    };
    var renderTr = function (json) {
        var str = ''
            , result = "";
        if (json && 'list' in json && json.list instanceof Array) {
            var list = json.list;
            if (list.length > 0) {
                for (var l in list) {
                    if (list.hasOwnProperty(l)) {
                        var d = list[l];
                        str += render(d, parseInt(l) + 1);
                    }
                }
                result += '<tr> <td></td> <td>总计</td> ' +
                    '<td>' + json.totalCount + '</td> <td>' + myformat.formatvolume(json.totalSize) + '</td> <td>' + myformat.formatweight(json.totalWeight) + '</td>' +
                    ' <td></td> <td>' + json.totalDamage + '</td> <td>' + json.totalDamp + '</td> <td>' + json.totalTransform + '</td> <td>' + json.totalOther +
                    '</td> <td></td> </tr>';
            } else {
                str = '<tr><td colspan="10" class="long-td">暂无进仓数据，请添加！</td></tr>';
            }
        } else {
            str = '<tr><td colspan="10" class="long-td">请求出错，请重试！</td></tr>';
        }
        $('.ensure-data-tb').find('tbody').html(str);
        $('.ensure-data-tb').find('tfoot').html(result);
        function render(d, index) {
            var type;
            switch (d.packageType) {
                case 1:
                    type = '纸箱';
                    break;
                case 2:
                    type = '木箱';
                    break;
                case 3:
                    type = '卷';
                    break;
                case 4:
                    type = '托盘';
                    break;
                default:
                    type = '纸箱';
                    break;
            }
            return '<tr> <td>' + index + '</td> <td>' + new Date(d.createDt.replace(/-/g, "/")).Format('yyyy-MM-dd hh:mm') + '</td>' +
                ' <td>' + d.storageCount + '</td> <td>' +  myformat.formatvolume(d.storageSize) + '</td> <td>' +  myformat.formatweight(d.storageWeight) + '</td>' +
                ' <td>' + type + '</td> <td>' + d.damageCount + '</td> <td>' + d.dampCount + '</td>' +
                ' <td>' + d.transformCount + '</td> <td>' + d.otherCount + '</td> <td>' + d.storageRemark + '</td> </tr>';
        }
    };
    var innerList = function (json, param) {
        var str = '';
        if (json && json.resCode == 0 && 'resBody' in json && json.resBody && 'sList' in json.resBody && json.resBody.sList instanceof Array) {
            if (json.resBody.sList.length > 0) {
                var arr = json.resBody.sList;
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        str += render(arr[a]);
                    }
                }
                $.burster($(".inner-page"), param.offset || 0, json.resBody.totalCount || 0, 5, param.limit || 20);
            } else {
                str = '<tr class="wrong"><td colspan="9">暂无搜索信息！</td></tr>';
                $('.inner-page').html('');
            }
        } else {
            str = '<tr class="wrong"><td colspan="9">请求失败，<a href="">请重试！</a></td></tr>';
            $('.inner-page').html('');
        }
        function render(d) {
            var str = '';
            for (var t in d.transPort) {
                if (d.transPort.hasOwnProperty(t)) {
                    var s = d.transPort[t];
                    str += s.portCode + (t == d.transPort.length - 1 ? '' : ' -> ');
                }
            }
            return ' <tr> <td><input type="radio" name="i-sg" data-id="' + d.airwayId + '"/></td> ' +
                '<td>' + d.airCompanyCode + '</td> <td>' + str + '</td> <td>' + d.airwayPrice.rate[0].policy['45'] + '</td> ' +
                '<td>' + d.airwayPrice.rate[0].policy['100'] + '</td> <td>' + d.airwayPrice.rate[0].policy['300'] + '</td>' +
                ' <td>' + d.airwayPrice.rate[0].policy['500'] + '</td> <td>' + d.airwayPrice.rate[0].policy['1000'] + '</td>'

        }

        $('.search-tb').find('tbody').html(str);
    };
    var calExpense = function(){
        var priceTotal = 0,totalCount= 0,totalAmount=0;
        $('.zd-part .zd-tb').find('tr.data').each(function () {
            var dj = parseFloat($(this).find('.ip-dj').val())
                , zl = parseFloat($(this).find('.ip-zl').val());
            priceTotal +=dj;
            totalCount +=zl;
            totalAmount +=dj*zl;
        });
        $('.zd-part .zd-tb').find('tr.tr-total').find('.total-price').html(priceTotal);
        $('.zd-part .zd-tb').find('tr.tr-total').find('.total-count').html(totalCount);
        $('.zd-part .zd-tb').find('tr.tr-total').find('.total-amount').html(totalAmount);
    }

    return {
        list: list
        , renderTr: renderTr
        , innerList: innerList
        ,calExpense : calExpense
    }
}());
module.exports.Dom = Dom;
},{"../../general/function":2}],7:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/2/6.
 */
'use strict';
'use strict';
var Listener = require('./listener').Listener;
var general = require('../../general/general').general;
general.run();
Listener.run();
},{"../../general/general":3,"./listener":8}],8:[function(require,module,exports){
/**
 * Created by Jeremy on 2017/1/5.
 */
'use strict';
require('../../general/burster');
var url = require('../../general/function').url
    ,myformat = require('../../general/function').format
    , Modal = require('../../general/modal');
var Data = require('./data').Data
    , Dom = require('./dom').Dom;
var Listener = (function () {
    var WPrice = []//仓库费用
        , DPrice = [];//报关费用
    var defaultPrice = {}
        , stopgap = {};
    var doneList = {};
    var operateId;
    var process = {};
    var listener = function () {
        $(document).on('mouseenter', '.opt-td', function () {
            $(this).children('.opt-part').fadeIn(200);
        });
        $(document).on('mouseleave', '.opt-td', function () {
            $(this).children('.opt-part').fadeOut(200);
        });
        $(document).on('click', '.sel-type p', function () {
            $(this).addClass('active');
            $(this).siblings().removeClass('active');
            $('.' + $(this).data('tar')).show();
            $('.' + $(this).data('tar')).siblings().hide();
        });
        $(document).on('click', '#check-all', function () {
            $('input[type="checkbox"][name="list-sg"]').prop('checked', $(this).prop('checked'));
        });
        $(document).on('click', '.outer-page .pages', function () {
            url.set('offset', $(this).data('offset'));
            init();
        });
        $(document).on('click', '#search', function () {
            url.set('offset', 0);
            init();
        });
        $(document).on('click', '.close-btn', function () {
            $('.alert-part').addClass('dp-n');
            $('.white-back').addClass('dp-n');
        });
        $(document).on('click', '.show-detail', function () {
            Data.expenseDetail({id: $(this).data('id')}, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    var ele = $('.qr-part')
                        , o = json.resBody;
                    stopgap = json.resBody;
                    var type = '', str = '';
                    switch (o.entryCargo.cargoType) {
                        case 1:
                            type = '普货';
                            break;
                        case 2:
                            type = '木箱';
                            break;
                        case 3:
                            type = '卷';
                            break;
                        case 4:
                            type = '托盘';
                            break;
                    }
                    var channel = '';
                    switch (o.orderChannel) {
                        case 1:
                            channel = '自助订舱';
                            break;
                        case 2:
                            channel = '快速订舱';
                            break;
                        case 3:
                            channel = '后台下单';
                            break;
                        case 6:
                            channel = '拼货订单';
                            break;
                        default:
                            channel = '自助订舱';
                            break;
                    }
                    //if (o.appealComment) {
                    //    $('#refuse-reason').val(o.appealComment || '/').show();
                    //} else {
                    //    $('#refuse-reason').hide();
                    //}
                    $('#refuse-reason').val(o.appealComment || '/');
                    $('.ddh').html(o.orderNum || '/');
                    $('.kh').html(o.companyName || '/');
                    $('.ddqd').html(channel || '/');
                    $('.qsg').html(o.deptPortCode || '/');
                    $('.mdg').html(o.destPortCode || '/');
                    $('.hkgs').html(o.airCompanyCode || '/');
                    $('.qfrq').html(o.airlineTime ? new Date(o.airlineTime).Format('yyyy-MM-dd') : '/');
                    $('.hbh').html(o.airlineInfo || '/');
                    $('.pm').html(o.entryCargo.cargoName || '/');
                    $('.pm').attr("title",o.entryCargo.cargoName || '/');
                    $('.lx').html(type || '/');
                    $('.wtbg').html(o.entryCargo.isBulkyCargo ? '是' : '否');
                    $('.js').html(o.entryCargo.cargoCount + '件');
                    $('.tj').html(myformat.formatvolume(o.entryCargo.cargoSize) + 'm³');
                    $('.zl').html(o.entryCargo.cargoWeight + 'KG（计费重量：' + o.entryCargo.chargingWeight + 'KG）');
                    var priceTotal = 0,totalCount= 0,totalAmount=0;
                    for (var s in o.serviceFeeList) {
                        if (o.serviceFeeList.hasOwnProperty(s)  && o.serviceFeeList[s].itemName !='报关费') {
                            var d = o.serviceFeeList[s];
                            str += '<tr class="data"> <td><input type="text" class="fymt" readonly value="' + d.itemName + '"/>' +
                                '</td> <td><input type="text" class="ip-dj" value="' + d.itemPrice + '"/>' +
                                '</td> <td><input type="text" class="ip-zl" value="' + d.itemCount + '"/>' +
                                '</td> <td><input type="text" class="ttp" readonly value="' + d.itemTotal + '"/>' +
                                '</td> </tr>';
                            priceTotal +=d.itemPrice;
                            totalCount +=d.itemCount;
                            totalAmount +=d.itemTotal;
                        }
                    }
                    //str += '<tr class="tr-add"> <td></td> <td></td> <td></td> <td></td> <td><span class="glyphicon glyphicon-plus"></span></td> </tr>';
                    str += '<tr class="tr-total"> <td>总计</td> <td  class="total-price">' + priceTotal + '</td> <td class="total-count">' + totalCount + '</td> <td class="total-amount">' + totalAmount + '</td>  </tr>';
                    var wStr = '<tr><td colspan="3">暂无费用</td></tr>', dStr = '<tr><td colspan="3">暂无费用</td></tr>';
                    var arrW = o.wareHouseFeeList || []
                        , arrD = o.declareFeeList || [];
                    for (var w = 0; w < arrW.length; w++) {
                        var d1 = arrW[w];
                        if (w == 0) {
                            wStr = '';
                        }
                        wStr += '<tr class="data"><td><input type="text" class="fymt" readonly value="' + d1.itemName + '"/></td><td><input type="text" class="ex-je" value="' + d1.itemTotal + '"></td>' +
                            '</tr>'
                    }
                    for (var dd = 0; dd < arrD.length; dd++) {
                        var d2 = arrD[dd];
                        if (dd == 0) {
                            dStr = '';
                        }
                        dStr += '<tr class="data"><td><input type="text" class="fymt" readonly value="' + d2.itemName + '"/></td><td><input type="text" class="ex-je" value="' + d2.itemTotal + '"></td>' +
                            '</tr>'
                    }

                    ele.find('.zd-tb').find('tbody').html(str);
                    ele.find('.zd-ckfy').find('tbody').html(wStr);
                    ele.find('.zd-bgfy').find('tbody').html(dStr);
                    if (o.chargeState == 1 || o.chargeState == 3) {
                        $('#ensure-charge').hide();
                    } else {
                        $('#ensure-charge').show();
                    }
                    $('.zd-fyqd').show();
                    $('.zd-ex').hide();
                    $('.sel-type p').removeClass('active');
                    $('p[data-tar="zd-fyqd"]').addClass('active');
                    ele.removeClass('dp-n');
                    $('.white-back').removeClass('dp-n');
                } else {
                    Modal.setAlert(json.resMsg || '获取详情失败，请重试');
                }
            });
        });
        $(document).on('click', '#ensure-charge', function () {
            var data = {
                "orderId": stopgap.orderId,
                "chargeState": 1
            };
            Data.ensure(data, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    Modal.setAlert(json.resMsg || '确认成功！', null, function () {
                        location.reload();
                    });
                } else {
                    Modal.setAlert(json.resMsg || '确认失败，请重试！');
                }
            });
        });
        $(document).on('click', '#transfer', function () {
            var arr = [];
            $('input[name="list-sg"]:checked').each(function () {
                arr.push($(this).data('id'));
            });
            if (arr.length > 0) {
                $('.white-back').removeClass('dp-n');
                $('.transfer-part').removeClass('dp-n');
            }
        });
        $(document).on('click', '#accept-transfer', function () {
            var arr = [];
            var mId;
            $('input[name="list-sg"]:checked').each(function () {
                arr.push($(this).data('id'));
            });
            mId = $('#czy').find('option:selected').val();
            if (arr.length > 0 && mId) {
                var data = {
                    "orderIds": arr,
                    "companyId": 0,
                    "memberFrom": 0,
                    "memberTo": mId,
                    "requireMeberId": 0
                };
                Data.transfer(data, function (json) {
                    if (json && 'resCode' in json && json.resCode == 0) {
                        Modal.setAlert('转移成功！', null, function () {
                            location.reload();
                        });
                    } else {
                        Modal.setAlert(json.resMsg || '转移失败，请重试！');
                    }
                });
            }
        });
        $(document).on('click', '.show-log', function () {
            Data.log({id: $(this).data('id')}, function (json) {
                if (json && 'resBody' in json && json.resBody instanceof Array) {
                    var str = '';
                    var arr = json.resBody;
                    if (arr.length > 0) {
                        for (var a in arr) {
                            if (arr.hasOwnProperty(a)) {
                                var type = '';
                                var d = arr[a];
                                switch (d.operatorType) {
                                    case 1:
                                        type = '客户';
                                        break;
                                    case 2:
                                        type = '货代';
                                        break;
                                    case 3:
                                        type = '报关行';
                                        break;
                                }
                                str += '<tr><td>' + (new Date(d.createDt).Format('yyyy-MM-dd hh:mm')) + '</td><td>' + d.orderNum + '</td>' +
                                    '<td>' + type + '</td><td>' + d.operatorId + '</td><td class="long">' + d.remark + '</td></tr>'
                            }
                        }
                    } else {
                        str = '<tr><td colspan="5">暂无操作日志</td></tr>'
                    }
                    $('.log-part').find('tbody').html(str);
                    $('.log-part').removeClass('dp-n');
                    $('.white-back').removeClass('dp-n');
                } else {
                    Modal.setAlert(json.resMsg || '获取失败，请重试');
                }
            });
        });
        $(document).on('click', '.show-ys', function () {
            init();
            operateId = $(this).data('id');
            var d = doneList[operateId];
            var ele = $('.ys-part');
            var jczt = '', dczt = '';
            console.log(d);
            switch (d.order.bookingState) {
                case 0:
                    dczt = '未订舱';
                    break;
                case 1:
                    dczt = '已订舱';
                    break;
                case -1:
                    dczt = '订舱失败';
                    break;
                case 2:
                    dczt = '已改配';
                    break;
            }
            switch (d.order.entryState) {
                case 0:
                    jczt = '待进仓';
                    break;
                case 1:
                    jczt = '已进仓';
                    break;
                case 2:
                    jczt = '已确认';
                    break;
            }
            ele.find('.ddh').html(d.order.orderNum);
            ele.find('.qsg').html(d.order.deptCode);
            ele.find('.mdg').html(d.order.destCode);
            ele.find('.hkgs').html(d.order.airCompanyCode);
            ele.find('.qfrq').html(new Date(d.order.flightDate.replace(/-/g, "/")).Format('yyyy-MM-dd'));
            ele.find('.jczt').html(jczt);
            ele.find('.dczt').html(dczt);
            $('.white-back').removeClass('dp-n');
            ele.removeClass('dp-n');
        });
        $(document).on('click', '#ys-ensure', function () {
            var data = {
                "orderId": operateId,
                "state": $('#c-yszt').find('option:selected').val()
            };
            Data.ys(data, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    Modal.setAlert(json.resMsg || '更新成功！', null, function () {
                        location.reload();
                    });
                } else {
                    Modal.setAlert(json.resMsg || '更新失败，请重试！')
                }
            });
        });
    };
    var init = function () {
        var data = {
            offset: url.get('offset') || 0,
            limit: url.get('limit') || 10,
            "deptCode": $('#start').val(),
            "destCode": $('#end').val(),
            "number": $('#order-num').val()
        };
        Data.list(data, function (json) {
            Dom.list(json, data);
            var dt = {};
            if (json && 'resCode' in json && json.resCode == 0 && json.resBody && json.resBody.sList.length > 0) {
                var list = json.resBody.sList;
                for (var l in list) {
                    if (list.hasOwnProperty(l)) {
                        var d = list[l];
                        dt[d.order.orderId] = d;
                    }
                }
            }
            doneList = dt;
        });
    };
    var zdTable = function () {
        $(document).on('click', '.show-zd', function () {
            stopgap = doneList[$(this).data('id')] || null;
            if (stopgap) {
                var ele = $('.zd-part')
                    , c = stopgap.company
                    , o = stopgap.order;
                var type = '', str = '';
                var channel = '';
                switch (o.orderChannel) {
                    case 1:
                        channel = '自助订舱';
                        break;
                    case 2:
                        channel = '快速订舱';
                        break;
                    case 3:
                        channel = '后台下单';
                        break;
                    case 6:
                        channel = '拼货订单';
                        break;
                    default:
                        channel = '自助订舱';
                        break;
                }
                switch (o.cargo.cargoType) {
                    case 1:
                        type = '普货';
                        break;
                    case 2:
                        type = '木箱';
                        break;
                    case 3:
                        type = '卷';
                        break;
                    case 4:
                        type = '托盘';
                        break;
                }
                $('.ddh').html(o.orderNum || '/');
                $('.kh').html(c.companyName || '/');
                $('.ddqd').html(channel || '/');
                $('.qsg').html(o.deptCode || '/');
                $('.mdg').html(o.destCode || '/');
                $('.hkgs').html(o.airCompanyCode || '/');
                $('.qfrq').html(o.flightDate ? new Date(o.flightDate).Format('yyyy-MM-dd') : '/');
                $('.hbh').html(o.airlineInfo || '/');
                $('.pm').html(o.cargo.cargoName || '/');
                $('.pm').attr("title",o.cargo.cargoName || '/');
                $('.lx').html(type || '/');
                $('.wtbg').html(o.cargo.isBulkyCargo ? '是' : '否');
                $('.js').html(o.cargo.cargoCount + 'PCS');
                $('.tj').html( myformat.formatvolume(o.cargo.cargoSize) + 'CBM');
                $('.zl').html( myformat.formatweight(o.cargo.cargoWeight) + 'KGS（计费重量：' + o.cargo.chargingWeight + 'KGS）');
                str += '<tr class="data"> <td><input type="text" class="fymt" readonly value="空运费"/>' +
                    '</td> <td><input type="text" class="ip-dj" value="' + o.chargingPrice + '"/>' +
                    '</td> <td><input type="text" class="ip-zl" value="' + o.chargingWeight + '"/>' +
                    '</td> <td><input type="text" class="ttp" readonly value="' + o.chargingPrice * o.chargingWeight + '"/>' +
                    '</td> <td><span class="glyphicon glyphicon-remove"></span></td></tr>';
                var priceTotal = o.chargingPrice,totalCount= o.chargingWeight,totalAmount=o.chargingPrice * o.chargingWeight ;
                for (var s in o.serviceFeeList) {
                    if (o.serviceFeeList.hasOwnProperty(s) && o.serviceFeeList[s].itemName !='报关费') {
                        var d = o.serviceFeeList[s];
                        str += '<tr class="data"> <td><input type="text" class="fymt" readonly value="' + d.itemName + '"/>' +
                            '</td> <td><input type="text" class="ip-dj" value="' + d.itemPrice + '"/>' +
                            '</td> <td><input type="text" class="ip-zl" value="' + d.itemCount + '"/>' +
                            '</td> <td><input type="text" class="ttp" readonly value="' + d.itemTotal + '"/>' +
                            '</td> <td><span class="glyphicon glyphicon-remove"></span></td></tr>';
                        priceTotal +=d.itemPrice;
                        totalCount +=d.itemCount;
                        totalAmount +=d.itemTotal;
                    }
                }
                str += '<tr class="tr-add"> <td></td> <td></td> <td></td> <td></td> <td><span class="glyphicon glyphicon-plus fyqd-add"></span></td> </tr>';
                str += '<tr class="tr-total"> <td>总计</td> <td  class="total-price">' + priceTotal + '</td> <td class="total-count">' + totalCount + '</td> <td class="total-amount">' + totalAmount + '</td> <td></td> </tr>';
                var wStr = '', dStr = '';
                var arrW = o.wareHouseFeeList || []
                    , arrD = o.declareFeeList || [];
                for (var w = 0; w < arrW.length; w++) {
                    var d1 = arrW[w];
                    if (w == 0) {
                        wStr = '';
                    }
                    wStr += '<tr class="data"><td><input type="text" class="fymt" readonly value="' + d1.itemName + '"/></td><td><input type="text" class="ex-je" value="' + d1.itemTotal + '"></td>' +
                        '<td><span class="glyphicon glyphicon-remove"></span></td></tr>'
                }
                wStr += '<tr class="tr-add"> <td></td> <td></td> <td><span class="glyphicon glyphicon-plus w-add"></span></td> </tr>';
                for (var dd = 0; dd < arrD.length; dd++) {
                    var d2 = arrD[dd];
                    if (dd == 0) {
                        dStr = '';
                    }
                    dStr += '<tr class="data"><td><input type="text" class="fymt" readonly value="' + d2.itemName + '"/></td><td><input type="text" class="ex-je" value="' + d2.itemTotal + '"></td>' +
                        '<td><span class="glyphicon glyphicon-remove"></span></td></tr>'
                }
                dStr += '<tr class="tr-add"><td></td> <td></td> <td><span class="glyphicon glyphicon-plus d-add"></span></td> </tr>';

                ele.find('.zd-tb').find('tbody').html(str);
                ele.find('.zd-ckfy').find('tbody').html(wStr);
                ele.find('.zd-bgfy').find('tbody').html(dStr);
                $('.zd-fyqd').show();
                $('.zd-ex').hide();
                $('.sel-type p').removeClass('active');
                $('p[data-tar="zd-fyqd"]').addClass('active');
                ele.removeClass('dp-n');
                $('.white-back').removeClass('dp-n');
            }
        });
        $(document).on('click', '.fymt.choose', function () {
            $('.se-part').addClass('dp-n');
            $(this).siblings('.se-part').removeClass('dp-n');
        });

        $(document).on('click', '.se-part li', function () {
            var dj = parseFloat($(this).data('dj'))
                , zl = parseFloat($(this).data('zl'))
                , ele = $(this).parents('tr.data');
            ele.find('.ip-dj').val(dj);
            ele.find('.ip-zl').val(zl);
            ele.find('.ttp').val(dj * zl);
            $(this).parents('ul').siblings('input').val($(this).html());
            $(this).parents('ul').addClass('dp-n');
            ele.find('.fymt').removeClass('choose');
            ele.find('.se-part').remove();
        });
        $(document).on('click', function (e) {
            var target = $(e.target);
            if (target.closest('.fymt.choose,.se-part li').length == 0) {
                $('.se-part').addClass('dp-n');
            }
        });
        $(document).on('keyup', '.ip-zl,.ip-dj', function () {
            $(this).val($(this).val().replace(/[^\d.]/g, ""))
        });
        $(document).on('blur', '.ip-zl,.ip-dj', function () {
            var v = $(this).val() || 0;
            $(this).val(parseFloat(v));
            var ele = $(this).parents('tr.data');
            var dj = parseFloat(ele.find('.ip-dj').val())
                , zl = parseFloat(ele.find('.ip-zl').val());
            ele.find('.ttp').val(dj * zl);
            Dom.calExpense();
        });
        $(document).on('click', '.glyphicon-remove', function () {
            $(this).parents('tr.data').remove();
            Dom.calExpense();
        });
        $(document).on('click', '.fyqd-add', function () {
            var exist = [], arr = [], str = '', ul = '';
            //获取已存在的项目
            $('.zd-tb').find('.fymt').each(function () {
                exist.push($(this).val());
            });
            //计算可添加的项目
            for (var d in defaultPrice) {
                if (defaultPrice.hasOwnProperty(d)) {
                    if (exist.indexOf(d) < 0) {
                        arr.push(defaultPrice[d]);
                    }
                }
            }
            if (arr.length > 0) {
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        var sg = arr[a];
                        ul += '<li data-dj="' + sg.itemPrice + '" data-zl="' + sg.itemUnit + '">' + sg.itemName + '</li>';
                    }
                }
                str += '<tr class="data"> <td><input type="text" class="fymt choose" readonly value="请选择费用名称"/> ' +
                    '<ul class="se-part dp-n">' + ul + '</ul> ' +
                    '</td> <td><input type="text" class="ip-dj" value="0"/>' +
                    '</td> <td><input type="text" class="ip-zl" value="0"/></td> ' +
                    '<td><input type="text" class="ttp" readonly value="0"/></td> <td><span class="glyphicon glyphicon-remove"></span></td> </tr>';
                $('.zd-tb').find('.tr-add').before(str);
            }
        });
        $(document).on('click', '.w-add', function () {
            var exist = [], arr = [], str = '', ul = '';
            //获取已存在的项目
            $('.zd-ckfy').find('.fymt').each(function () {
                exist.push($(this).val());
            });
            //计算可添加的项目
            for (var d in WPrice) {
                if (WPrice.hasOwnProperty(d)) {
                    if (exist.indexOf(WPrice[d]) < 0) {
                        arr.push(WPrice[d]);
                    }
                }
            }
            if (arr.length > 0) {
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        var sg = arr[a];
                        ul += '<li>' + sg + '</li>';
                    }
                }
                str += '<tr class="data"> <td><input type="text" class="fymt choose" readonly value="请选择费用名称"/> ' +
                    '<ul class="se-part dp-n">' + ul + '</ul> ' +
                    '<td><input type="text" class="ex-je" value="0"/></td> <td><span class="glyphicon glyphicon-remove"></span></td> </tr>';
                $('.zd-ckfy').find('.tr-add').before(str);
            }
        });
        $(document).on('click', '.d-add', function () {
            var exist = [], arr = [], str = '', ul = '';
            //获取已存在的项目
            $('.zd-bgfy').find('.fymt').each(function () {
                exist.push($(this).val());
            });
            //计算可添加的项目
            for (var d in DPrice) {
                if (DPrice.hasOwnProperty(d)) {
                    if (exist.indexOf(DPrice[d]) < 0) {
                        arr.push(DPrice[d]);
                    }
                }
            }
            if (arr.length > 0) {
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        var sg = arr[a];
                        ul += '<li>' + sg + '</li>';
                    }
                }
                str += '<tr class="data"> <td><input type="text" class="fymt choose" readonly value="请选择费用名称"/> ' +
                    '<ul class="se-part dp-n">' + ul + '</ul> ' +
                    '<td><input type="text" class="ex-je" value="0"/></td> <td><span class="glyphicon glyphicon-remove"></span></td> </tr>';
                $('.zd-bgfy').find('.tr-add').before(str);
            }
        });
        $(document).on('click', '#zd-ensure', function () {
            var arr = [], w = [], d = [], total = 0;
            $('.zd-part .zd-tb').find('tr.data').each(function () {
                if ($(this).find('.fymt').val() != '请选择费用名称') {
                    arr.push({
                        "itemName": $(this).find('.fymt').val(),
                        "itemPrice": parseFloat($(this).find('.ip-dj').val()),
                        "itemUnit": 1,
                        "itemCount": parseFloat($(this).find('.ip-zl').val()),
                        "itemTotal": parseFloat($(this).find('.ttp').val())
                    });
                    total += parseFloat($(this).find('.ttp').val());
                }
            });
            $('.zd-part .zd-ckfy').find('tr.data').each(function () {
                if ($(this).find('.fymt').val() != '请选择费用名称') {
                    w.push({
                        "itemName": $(this).find('.fymt').val(),
                        "itemPrice": $(this).find('.ex-je').val(),
                        "chargeExFeeType": 1,
                        "itemCount": 1,
                        "wareHouseId": 0,
                        "declareCompanyId": 0,
                        "createDt": new Date(),
                        "itemTotal": $(this).find('.ex-je').val()
                    });
                }
            });
            $('.zd-part .zd-bgfy').find('tr.data').each(function () {
                if ($(this).find('.fymt').val() != '请选择费用名称') {
                    d.push({
                        "itemName": $(this).find('.fymt').val(),
                        "itemPrice": $(this).find('.ex-je').val(),
                        "chargeExFeeType": 2,
                        "itemCount": 1,
                        "wareHouseId": 0,
                        "declareCompanyId": 0,
                        "createDt": new Date(),
                        "itemTotal": $(this).find('.ex-je').val()
                    });
                }
            });
            if (arr.length > 0) {
                var data = {
                    "orderId": stopgap.order.orderId,
                    "serviceFeeList": arr,
                    "orderChargingTotal": total,
                    "chargeState": 0,
                    "wareHouseFeeList": w,
                    "declareFeeList": d,
                    "orderHasFee": $('#wfy').prop('checked')
                };
                Data.createCharge(data, function (json) {
                    if (json && 'resCode' in json && json.resCode == 0) {
                        Modal.setAlert(json.resMsg || '制单成功！', null, function () {
                            location.reload();
                        });
                    } else {
                        Modal.setAlert(json.resMsg || '制单失败，请重试！');
                    }
                });
            }
        });
    };
    var priceInit = function () {
        Data.priceList(function (json) {
            if (json && 'resCode' in json && json.resCode == 0 && json.resBody && json.resBody.sList) {
                var arr = json.resBody.sList;
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        var d = arr[a];
                        if (d.expenseDefault) {
                            for (var e in d.expenseTemplate) {
                                if (d.expenseTemplate.hasOwnProperty(e)) {
                                    var dt = d.expenseTemplate[e];
                                    defaultPrice[dt.itemName] = dt;
                                }
                            }
                            break;
                        }
                    }
                }
            }
        });
    };
    var opInit = function () {
        Data.opList(function (json) {
            var option = '';
            if (json && 'resCode' in json && json.resCode == 0 && json.resBody.length > 0) {
                var arr = json.resBody || [];
                for (var a = 0; a < arr.length; a++) {
                    option += '<option value="' + arr[a].memberId + '">' + arr[a].name + '</option>'
                }
                $('#czy').html(option);
            } else {
                option = '暂无操作员，请添加！';
                $('.transfer-part').find('.dp-tb').html(option);
            }
        });
    };
    var exPriceInit = function () {
        Data.exPrice({id: 2}, function (json) {
            if (json && 'resCode' in json && json.resCode == 0) {
                DPrice = json.resBody || [];
            }
        });
        Data.exPrice({id: 1}, function (json) {
            if (json && 'resCode' in json && json.resCode == 0) {
                WPrice = json.resBody || [];
            }
        });
    };
    var run = function () {
        listener();
        init();
        zdTable();
        priceInit();
        opInit();
        exPriceInit();
    };
    return {
        run: run
    }
}());
module.exports.Listener = Listener;
},{"../../general/burster":1,"../../general/function":2,"../../general/modal":4,"./data":5,"./dom":6}]},{},[7])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL252bS92Ni4yLjAvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi4uLy4uL2dlbmVyYWwvYnVyc3Rlci5qcyIsIi4uLy4uL2dlbmVyYWwvZnVuY3Rpb24uanMiLCIuLi8uLi9nZW5lcmFsL2dlbmVyYWwuanMiLCIuLi8uLi9nZW5lcmFsL21vZGFsLmpzIiwiZGF0YS5qcyIsImRvbS5qcyIsImluZGV4LmpzIiwibGlzdGVuZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNi8xMS8yNC5cclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uICgkKSB7XHJcbiAgLyoqXHJcbiAgICog55Sf5oiQ5YiG6aG15ZmoXHJcbiAgICogQHBhcmFtIGVsZSDpnIDopoHmt7vliqDliIbpobXlmajnmoTlhYPntKBcclxuICAgKiBAcGFyYW0gb2Zmc2V0IOWBj+enu+mHj++8jOWNs+S7juesrGRhdGEtb2Zmc2V05byA5aeLXHJcbiAgICogQHBhcmFtIGxlbmd0aCDmgLvorrDlvZXmnaHmlbBcclxuICAgKiBAcGFyYW0gc2hvd1BhZ2VzIOWIhumhteWZqOaYvuekuueahOmhteaVsO+8jOi2hei/h+WImemakOiXj+WkmuS9meeahOmhtVxyXG4gICAqIEBwYXJhbSByb3dzIOavj+mhteaYvuekuueahOiusOW9leadoeaVsFxyXG4gICAqL1xyXG4gICQuYnVyc3RlciA9IGZ1bmN0aW9uIChlbGUsIG9mZnNldCwgbGVuZ3RoLCBzaG93UGFnZXMsIHJvd3MpIHtcclxuICAgIG9mZnNldCA9IG9mZnNldCA/IHBhcnNlSW50KG9mZnNldCkgOiAwO1xyXG4gICAgLy/lsIbliIbpobXlmajoo4XlhaV0YWJsZeS4rVxyXG4gICAgaWYgKGxlbmd0aCAmJiBsZW5ndGggPiBvZmZzZXQpIHtcclxuICAgICAgdmFyIHBhZ2VIdG1sID0gXCJcIlxyXG4gICAgICAgICwgYXNzID0gXCJcIi8v5riF56m66ZyA6KaB6KOF5YWl55qEaHRtbFxyXG4gICAgICAgICwgYmVmb3JlUGFnZXMgPSBNYXRoLmNlaWwob2Zmc2V0IC8gcm93cykvL+mcgOimgeaYvuekuueahOWJjemhteaVsC/lvZPliY3pobVcclxuICAgICAgICAsIGFmdGVyUGFnZXMgPSBNYXRoLmNlaWwoKGxlbmd0aCAtIG9mZnNldCApIC8gcm93cykvL+mcgOimgeaYvuekuueahOWQjumhteaVsFxyXG4gICAgICAgICwgcGFnZXMgPSBNYXRoLmNlaWwobGVuZ3RoIC8gcm93cykgLy/mgLvpobXmlbBcclxuICAgICAgICAsIGsgPSAwO1xyXG4gICAgICAvL2FsZXJ0KFwi5oC76aG15pWwXCIgKyBwYWdlcyArIFwiIOWJjemhteaVsCBcIiArIGJlZm9yZVBhZ2VzICsgXCIg5ZCO6aG15pWwIFwiICsgYWZ0ZXJQYWdlcyk7XHJcbiAgICAgIC8v6Iul6aG15pWw5bCP5LqOc2hvd1BhZ2Vz6aG177yM5YiZ5YWo6YOo5pi+56S6XHJcbiAgICAgIGlmIChwYWdlcyA+PSAwICYmIHBhZ2VzIDw9IHNob3dQYWdlcykge1xyXG4gICAgICAgIGZvciAoayA9IDA7IGsgPCBwYWdlczsgaysrKSB7XHJcbiAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaSBjbGFzcz0nYWN0aXZlJyA+PGE+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChwYWdlcyA+IHNob3dQYWdlcykgey8v5oC76aG15pWw5aSn5LqOc2hvd1BhZ2Vz6aG1XHJcbiAgICAgICAgaWYgKGJlZm9yZVBhZ2VzIDw9IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBhZnRlclBhZ2VzID4gc2hvd1BhZ2VzICsgMSkge1xyXG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IHNob3dQYWdlczsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA8PSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgJiYgYWZ0ZXJQYWdlcyA9PSBzaG93UGFnZXMgKyAxKSB7XHJcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgc2hvd1BhZ2VzIC0gMTsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA8PSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgJiYgYWZ0ZXJQYWdlcyA8PSBzaG93UGFnZXMpIHtcclxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBzaG93UGFnZXMgLSAxOyBrKyspIHtcclxuICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaSBjbGFzcz0nYWN0aXZlJyA+PGE+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoKHBhZ2VzIC0gMSkgKiByb3dzKSArIFwiJz4uLi5cIiArIHBhZ2VzICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZVBhZ2VzID4gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICYmIGJlZm9yZVBhZ2VzIDw9IHNob3dQYWdlcyAmJiBhZnRlclBhZ2VzID4gc2hvd1BhZ2VzKSB7XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICBmb3IgKGsgPSBiZWZvcmVQYWdlcyAtIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDE7IGsgPCBiZWZvcmVQYWdlcyArIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKTsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IHNob3dQYWdlcyAmJiBhZnRlclBhZ2VzID4gc2hvd1BhZ2VzKSB7XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICBmb3IgKGsgPSBiZWZvcmVQYWdlcyAtIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDE7IGsgPCBiZWZvcmVQYWdlcyArIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKTsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBiZWZvcmVQYWdlcyA8PSBwYWdlcyAmJiBhZnRlclBhZ2VzIDw9IHNob3dQYWdlcyAmJiBhZnRlclBhZ2VzID4gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICsgMSkge1xyXG4gICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nMCc+MS4uLjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgYmVmb3JlUGFnZXMgKyBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMik7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPiBwYWdlcyAmJiBhZnRlclBhZ2VzIDw9IHNob3dQYWdlcyAmJiBhZnRlclBhZ2VzID4gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICsgMSkge1xyXG4gICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nMCc+MS4uLjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgYmVmb3JlUGFnZXMgKyBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMik7IGsrKykge1xyXG4gICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPiBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgJiYgYWZ0ZXJQYWdlcyA8PSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxKSB7XHJcbiAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICBmb3IgKGsgPSBiZWZvcmVQYWdlcyAtIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDE7IGsgPCBwYWdlczsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy/liKTmlq1cIummlumhtVwi5ZKMXCLmnKvpobVcIuaYr+WQpuWPr+eCueWHu1xyXG4gICAgICB2YXIgZmlyc3RQYWdlLCBsYXN0UGFnZTtcclxuICAgICAgaWYgKG9mZnNldCA9PSAwKSB7Ly/mraTml7bpppbpobXml6Dms5Xngrnlh7tcclxuICAgICAgICBmaXJzdFBhZ2UgPSAnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48YSBjbGFzcz1cInBhZ2VzXCIgZGF0YS1vZmZzZXQ9XCIwXCI+6aaW6aG1PC9hPjwvbGk+JztcclxuICAgICAgICBsYXN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiJyArIHBhcnNlSW50KHBhcnNlSW50KChsZW5ndGggJSByb3dzID09IDAgPyAobGVuZ3RoIC0gMSkgOiBsZW5ndGgpIC8gcm93cykgKiByb3dzKSArICdcIiA+5pyr6aG1PC9hPjwvbGk+JztcclxuICAgICAgfSBlbHNlIGlmICgob2Zmc2V0ICsgcm93cykgPj0gbGVuZ3RoKSB7Ly/mraTml7bmnKvpobXml6Dms5Xngrnlh7tcclxuICAgICAgICBmaXJzdFBhZ2UgPSAnPGxpPjxhIGNsYXNzPVwicGFnZXNcIiBkYXRhLW9mZnNldD1cIjBcIj7pppbpobU8L2E+PC9saT4nO1xyXG4gICAgICAgIGxhc3RQYWdlID0gJzxsaSBjbGFzcz1cImRpc2FibGVkXCI+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiJyArIHBhcnNlSW50KHBhcnNlSW50KChsZW5ndGggJSByb3dzID09IDAgPyAobGVuZ3RoIC0gMSkgOiBsZW5ndGgpIC8gcm93cykgKiByb3dzKSArICdcIj7mnKvpobU8L2E+PC9saT4nO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZpcnN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiMFwiPummlumhtTwvYT48L2xpPic7XHJcbiAgICAgICAgbGFzdFBhZ2UgPSAnPGxpPjxhIGNsYXNzPVwicGFnZXNcIiBkYXRhLW9mZnNldD1cIicgKyBwYXJzZUludChwYXJzZUludCgobGVuZ3RoICUgcm93cyA9PSAwID8gKGxlbmd0aCAtIDEpIDogbGVuZ3RoKSAvIHJvd3MpICogcm93cykgKyAnXCI+5pyr6aG1PC9hPjwvbGk+JztcclxuICAgICAgfVxyXG4gICAgICAvL+WIpOaWrVwi5LiK5LiA6aG1XCLlkoxcIuS4i+S4gOmhtVwi5piv5ZCm5a2Y5ZyoXHJcbiAgICAgIHZhciB1cFBhZ2UsIGRvd25QYWdlO1xyXG4gICAgICBpZiAob2Zmc2V0ID09IDAgfHwgKG9mZnNldCA8IHJvd3MgJiYgKG9mZnNldCAlIHJvd3MgIT0gMCkpKSB7XHJcbiAgICAgICAgdXBQYWdlID0gXCI8bGkgY2xhc3M9J2Rpc2FibGVkJz48YSBjbGFzcz0ncGFnZXMnIGZ1bmM9J3ByZXZpb3VzJyBkYXRhLW9mZnNldD0nXCIgKyBwYXJzZUludChvZmZzZXQpICsgXCInID7kuIrpobU8L2E+PC9saT5cIlxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHVwUGFnZSA9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZnVuYz0ncHJldmlvdXMnIGRhdGEtb2Zmc2V0PSdcIiArIChwYXJzZUludChvZmZzZXQpIC0gcGFyc2VJbnQocm93cykpICsgXCInID7kuIrpobU8L2E+PC9saT5cIjtcclxuICAgICAgfVxyXG4gICAgICBpZiAob2Zmc2V0ID49IChsZW5ndGggLSByb3dzKSkge1xyXG4gICAgICAgIGRvd25QYWdlID0gXCI8bGkgY2xhc3M9J2Rpc2FibGVkJz48YSBjbGFzcz0ncGFnZXMnIGZ1bmM9J25leHQnIGRhdGEtb2Zmc2V0PSdcIiArIHBhcnNlSW50KG9mZnNldCkgKyBcIic+5LiL6aG1PC9hPjwvbGk+XCJcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBkb3duUGFnZSA9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZnVuYz0nbmV4dCcgZGF0YS1vZmZzZXQ9J1wiICsgcGFyc2VJbnQocGFyc2VJbnQob2Zmc2V0KSArIHBhcnNlSW50KHJvd3MpKSArIFwiJz7kuIvpobU8L2E+PC9saT5cIlxyXG4gICAgICB9XHJcbiAgICAgIGlmIChwYWdlcyAhPSAxKSB7XHJcbiAgICAgICAgLy/liIbpobXpg6jliIZcclxuICAgICAgICBhc3MgKz0gXCI8ZGl2IGlkPSdwYWdlcicgY2xhc3M9J3BhZ2VyLWluZm8nPlwiICtcclxuICAgICAgICBcIjxoNiBpZD0ncmVzdWx0JyBjbGFzcz0ncGFnZXItcmVjb3JkJz7lhbHmnIk8c3Bhbj5cIiArIGxlbmd0aCArIFwiPC9zcGFuPuadoeiusOW9lTwvaDY+XCIgK1xyXG4gICAgICAgIFwiPHVsIGNsYXNzPSdwYWdpbmF0aW9uJz5cIiArIGZpcnN0UGFnZSArIHVwUGFnZSArIHBhZ2VIdG1sICsgZG93blBhZ2UgKyBsYXN0UGFnZSArIFwiPC91bD48L2Rpdj5cIjtcclxuICAgICAgICAvL3RhYmxl5Lit5rOo5YWl5ou86KOF55qE6K6w5b2VXHJcbiAgICAgICAgZWxlLmh0bWwoYXNzKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBlbGUuaHRtbCgnJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn0oalF1ZXJ5KSk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgenJ6IG9uIDIwMTYvMi8yNi5cclxuICogQHZlcnNpb24gMS4wLjAgY3JlYXRlZCDpgJrnlKjmgKflip/og73mlrnms5VcclxuICovXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG52YXIgRnVuID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBfdGltZU91dCA9IDEwMDAwMDsvL+ivt+axgui2heaXtuaXtumXtOS4ujEwc1xyXG4gICAgLyoqXHJcbiAgICAgKiDlsIHoo4VhamF4XHJcbiAgICAgKiBAcGFyYW0gb3B0aW9uXHJcbiAgICAgKiB7XHJcbiAgICAgKiAgICAgIHVybDpcIuivt+axgueahOWcsOWdgFwiXHJcbiAgICAgKiAgICAgICxtZXRob2Q6XCLor7fmsYLnmoTmlrnms5VcIlxyXG4gICAgICogICAgICAsYXN5bmM6XCLmmK/lkKblubblj5FcIlxyXG4gICAgICogICAgICAsZGF0YTpcIuWPkemAgeeahOaVsOaNrlwiXHJcbiAgICAgKiAgICAgICxzdWNjZXNzOlwi5oiQ5Yqf5pe25Zue6LCDXCJcclxuICAgICAqICAgICAgLGVycm9yOlwi5aSx6LSlL+i2heaXtuaXtuWbnuiwg1wiXHJcbiAgICAgKiAgICAgICx0aW1lb3V0Olwi6LaF5pe25pe26Ze0XCJcclxuICAgICAqICAgICAgLGNvbXBsZXRlOlwi5a6M5oiQ5ZCO55qE5Zue6LCDXCJcclxuICAgICAqIH1cclxuICAgICAqL1xyXG4gICAgdmFyIGFqYXggPSBmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgLy9hamF45byA5aeL5pe25bqU5pi+56S64oCc5Yqg6L295L+h5oGv5qGG4oCdXHJcbiAgICAgICAgTW9kYWwuc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IG9wdGlvbi51cmxcclxuICAgICAgICAgICAgLCB0eXBlOiBcInR5cGVcIiBpbiBvcHRpb24gJiYgb3B0aW9uLnR5cGUgfHwgXCJHRVRcIlxyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IG9wdGlvbi50aW1lb3V0IHx8IF90aW1lT3V0XHJcbiAgICAgICAgICAgICwgZGF0YTogXCJkYXRhXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5kYXRhIHx8IHt9XHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6IFwianNvblwiXHJcbiAgICAgICAgICAgICwgYXN5bmM6IChcImFzeW5jXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5hc3luYykgPyB0cnVlIDogZmFsc2VcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKFwic3RhdHVzXCIgaW4ganNvbiAmJiBqc29uLnN0YXR1cyA+IDAgJiYgXCJkYXRhXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN1Y2Nlc3NcIiBpbiBvcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLnN1Y2Nlc3MoanNvbi5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChcIuaXoHN1Y2Nlc3Pmlrnms5UhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJlcnJvclwiIGluIG9wdGlvbiAmJiBvcHRpb24uZXJyb3IgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbi5lcnJvcihqc29uKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aTjeS9nOWksei0pSEnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZXJyb3I6IGZ1bmN0aW9uICh4aHIpIHsvLzQwNOaIluiAhei2heaXtlxyXG4gICAgICAgICAgICAgICAgaWYgKFwiZXJyb3JcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmVycm9yIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+aPkOekuueUqOaIt+mUmeivr+S/oeaBr1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChcIui/nuaOpeacjeWKoeWZqOWksei0pe+8jOeKtuaAge+8mlwiICsgKHhoci5zdGF0dXMgfHwgLTEpICsgXCIs5L+h5oGv77yaXCIgKyAoeGhyLnN0YXR1c1RleHQgfHwgXCItXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uZXJyb3IoeGhyLnN0YXR1cywgeGhyLnN0YXR1c1RleHQpOy8v5Zue6LCD6K+35rGC55qE54q25oCB5ZKM6ZSZ6K+v5L+h5oGvXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoeGhyLCB0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAvL+WFs+mXreKAnOWKoOi9veS/oeaBr+ahhuKAnVxyXG4gICAgICAgICAgICAgICAgTW9kYWwuc2hvd0xvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKFwiY29tcGxldGVcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmNvbXBsZXRlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uY29tcGxldGUoeGhyLCB0eXBlKTsvL+Wbnuiwg+ivt+axgueahHhocuS/oeaBr+WSjOexu+Wei1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy/lhajpgInlkozljZXpgInnmoTnu5HlrppcclxuICAgIHZhciBzZXRDaGVja2JveExpc3RlbmVyID0gZnVuY3Rpb24gKGFsbENoZWNrLCByYWRpb0NoZWNrcykge1xyXG4gICAgICAgIC8v562b6YCJ5Y2V6YCJ5oyJ6ZKu57uEXHJcbiAgICAgICAgdmFyIHJhZGlvVmFsdWVFbGVzID0gJChyYWRpb0NoZWNrcyk7XHJcbiAgICAgICAgLy/ngrnlh7vlhajpgInml7bvvIzlkIznu4TmjInpkq7ooqvlkIzmraVcclxuICAgICAgICAkKGRvY3VtZW50KS5kZWxlZ2F0ZShhbGxDaGVjaywgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChyYWRpb1ZhbHVlRWxlcyAmJiByYWRpb1ZhbHVlRWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfciA9IDA7IF9yIDwgcmFkaW9WYWx1ZUVsZXMubGVuZ3RoOyBfcisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmFkaW9WYWx1ZUVsZXNbX3JdLmNoZWNrZWQgPSAkKHRoaXMpLmlzKFwiOmNoZWNrZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+eCueWHu+WNlemAieaMiemSruaXtu+8jFxyXG4gICAgICAgICQoZG9jdW1lbnQpLmRlbGVnYXRlKHJhZGlvQ2hlY2tzLCBcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJChhbGxDaGVjaylbMF0uY2hlY2tlZCA9ICQocmFkaW9DaGVja3MgKyBcIjpjaGVja2VkXCIpLmxlbmd0aCA9PSAkKHJhZGlvQ2hlY2tzKS5sZW5ndGg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHVybCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKFwiKF58JilcIiArIG5hbWUgKyBcIj0oW14mXSopKCZ8JClcIiwgXCJpXCIpO1xyXG4gICAgICAgICAgICB2YXIgciA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEpLm1hdGNoKHJlZyk7XHJcbiAgICAgICAgICAgIGlmIChyICE9IG51bGwpIHJldHVybiBkZWNvZGVVUkkoclsyXSk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5qC55o2u5Y+C5pWw5YiX6KGo6ZW/5bqm6L+b6KGM5Yik5pat77yM5YW85a65SUU5XHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0Jykgey8v5LiA5Liq5a+56LGh77yM5L2/55Soa2V55qCH6K6wdmFsdWVcclxuICAgICAgICAgICAgICAgIHZhciBvYmogPSBhcmd1bWVudHNbMF1cclxuICAgICAgICAgICAgICAgICAgICAsIHNlYXJjaCA9IGxvY2F0aW9uLnNlYXJjaDtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG8gaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2ggPSBjaGFuZ2VVUkxLZXlWYWx1ZShzZWFyY2gsIG8sIG9ialtvXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCdwdXNoU3RhdGUnIGluIGhpc3RvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBkb2N1bWVudC50aXRsZSwgc2VhcmNoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJ3B1c2hTdGF0ZScgaW4gSGlzdG9yeSkgey8vaWU5IOS4jeaUr+aMgXB1c2hTdGF0ZeaWueazlSxqYXZhc2NyaXB0LmVqc+S4rea3u+WKoGhpc3RvcnkuanPlrozmiJBodG1sNOWvuXB1c2hTdGF0ZeeahOaUr+aMgVxyXG4gICAgICAgICAgICAgICAgICAgIEhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIHNlYXJjaCk7Ly/ov5Tlm57ph43mlrDmnoTpgKDlkI5zZWFyY2jkuLJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7Ly9rZXkrdmFsdWVcclxuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBhcmd1bWVudHNbMF1cclxuICAgICAgICAgICAgICAgICAgICAsIHZhbHVlID0gYXJndW1lbnRzWzFdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCdwdXNoU3RhdGUnIGluIGhpc3RvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBkb2N1bWVudC50aXRsZSwgY2hhbmdlVVJMS2V5VmFsdWUobG9jYXRpb24udG9TdHJpbmcoKSwga2V5LCB2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgncHVzaFN0YXRlJyBpbiBIaXN0b3J5KSB7Ly9pZTkg5LiN5pSv5oyBcHVzaFN0YXRl5pa55rOVLGphdmFzY3JpcHQuZWpz5Lit5re75YqgaGlzdG9yeS5qc+WujOaIkGh0bWw05a+5cHVzaFN0YXRl55qE5pSv5oyBXHJcbiAgICAgICAgICAgICAgICAgICAgSGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgY2hhbmdlVVJMS2V5VmFsdWUobG9jYXRpb24uc2VhcmNoLCBrZXksIHZhbHVlKSk7Ly/ov5Tlm57ph43mlrDmnoTpgKDlkI5zZWFyY2jkuLJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBjaGFuZ2VVUkxLZXlWYWx1ZSh1cmwsIGFyZywgYXJnX3ZhbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBhcmcgKyAnPShbXiZdKiknO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcGxhY2VUZXh0ID0gYXJnICsgJz0nICsgYXJnX3ZhbDtcclxuICAgICAgICAgICAgICAgIGlmICh1cmwubWF0Y2gocGF0dGVybikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gJy8oJyArIGFyZyArICc9KShbXiZdKikvZ2knO1xyXG4gICAgICAgICAgICAgICAgICAgIHRtcCA9IHVybC5yZXBsYWNlKGV2YWwodG1wKSwgcmVwbGFjZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0bXA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1cmwubWF0Y2goJ1tcXD9dJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybCArICcmJyArIHJlcGxhY2VUZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwgKyAnPycgKyByZXBsYWNlVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldDogZ2V0XHJcbiAgICAgICAgICAgICwgc2V0OiBzZXRcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG5cclxuICAgIHZhciBmb3JtYXRJbWFnZT1mdW5jdGlvbiAocGF0aCwgc2l6ZSwgZWxlKSB7XHJcbiAgICAgICAgaWYocGF0aCBpbnN0YW5jZW9mICBBcnJheSAmJiBwYXRoLmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgcGF0aCA9IHBhdGhbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBJTUFHRV9TSVpFID0ge1xyXG4gICAgICAgICAgICBvcmlnaW5hbDoge1xyXG4gICAgICAgICAgICAgICAgcGF0aDogXCJcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgeGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl94bGFyZ2VcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiNjYwKjY2MFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9sYXJnZVwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI0MjAqNDIwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWlkZGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWRkbGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMzAwKjMwMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNtYWxsOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9zbWFsbFwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCIyNDAqMjQwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGl0dGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9saXR0bGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMTIwKjEyMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1pY3JvOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWNyb1wiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI2MCo2MFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHNpemUgPSBJTUFHRV9TSVpFW3NpemUgfHwgXCJtaWRkbGVcIl0gfHwgSU1BR0VfU0laRS5taWRkbGU7XHJcbiAgICAgICAgdmFyIHBhdGhUZW1wID0gL1xcLlxcdys/JC8uZXhlYyhwYXRoKTtcclxuICAgICAgICBpZiAoIXBhdGhUZW1wKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gc2l6ZS5wYXRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhdGggPSAocGF0aC5zdWJzdHIoMCwgcGF0aFRlbXAuaW5kZXggfHwgcGF0aC5sZW5ndGgpKSArIHNpemUucGF0aCArIHBhdGhUZW1wWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZWxlICYmIGVsZS5hdHRyKSB7XHJcbiAgICAgICAgICAgIGVsZS5hdHRyKFwic3JjXCIsIHBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07XHJcbiAgICAvL+mHkemineagvOW8j+WMluWwj+aVsOeCuTLkvY1cclxuICAgIHZhciBmb3JtYXQgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmb3JtYXRhbW91bnQgPSBmdW5jdGlvbihfdmFsdWUpe1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChfdmFsdWUpLnRvRml4ZWQoMik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvL+S9k+enr+agvOW8j+WMluWwj+aVsOeCuTLkvY1cclxuICAgICAgICB2YXIgZm9ybWF0dm9sdW1lID0gZnVuY3Rpb24oX3ZhbHVlKXtcclxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoX3ZhbHVlKS50b0ZpeGVkKDMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy/ph43ph4/moLzlvI/ljJblsI/mlbDngrky5L2NXHJcbiAgICAgICAgdmFyIGZvcm1hdHdlaWdodCA9IGZ1bmN0aW9uKF92YWx1ZSl7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KF92YWx1ZSkudG9GaXhlZCgzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGZvcm1hdGFtb3VudDogZm9ybWF0YW1vdW50XHJcbiAgICAgICAgICAgICwgZm9ybWF0dm9sdW1lOiBmb3JtYXR2b2x1bWVcclxuICAgICAgICAgICAgLCBmb3JtYXR3ZWlnaHQ6IGZvcm1hdHdlaWdodFxyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGFqYXg6IGFqYXhcclxuICAgICAgICAsIGdldFRpbXRvdXQ6IF90aW1lT3V0XHJcbiAgICAgICAgLCBzZXRDaGVja2JveExpc3RlbmVyOiBzZXRDaGVja2JveExpc3RlbmVyXHJcbiAgICAgICAgLCB1cmw6IHVybFxyXG4gICAgICAgICwgZm9ybWF0SW1hZ2U6IGZvcm1hdEltYWdlXHJcbiAgICAgICAgLCBmb3JtYXQ6IGZvcm1hdFxyXG4gICAgfVxyXG59KCkpO1xyXG5cclxuZXhwb3J0cy5hamF4ID0gRnVuLmFqYXg7XHJcbmV4cG9ydHMuZ2V0VGltZW91dCA9IEZ1bi5nZXRUaW10b3V0O1xyXG5leHBvcnRzLnNldENoZWNrYm94TGlzdGVuZXIgPSBGdW4uc2V0Q2hlY2tib3hMaXN0ZW5lcjtcclxuZXhwb3J0cy51cmwgPSBGdW4udXJsO1xyXG5leHBvcnRzLmZvcm1hdEltYWdlID0gRnVuLmZvcm1hdEltYWdlO1xyXG5leHBvcnRzLmZvcm1hdCA9IEZ1bi5mb3JtYXQ7XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEplcmVteSBvbiAyMDE3LzEvMjMuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBNb2RhbCA9IHJlcXVpcmUoJy4vbW9kYWwnKTtcclxudmFyIGdlbmVyYWwgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+aXtumXtOagvOW8j+WMllxyXG4gICAgICAgIERhdGUucHJvdG90eXBlLkZvcm1hdCA9IGZ1bmN0aW9uIChmbXQpIHsgLy9hdXRob3I6IEplcmVteXl5XHJcbiAgICAgICAgICAgIHZhciBvID0ge1xyXG4gICAgICAgICAgICAgICAgXCJNK1wiOiB0aGlzLmdldE1vbnRoKCkgKyAxLCAvL+aciOS7vVxyXG4gICAgICAgICAgICAgICAgXCJkK1wiOiB0aGlzLmdldERhdGUoKSwgLy/ml6VcclxuICAgICAgICAgICAgICAgIFwiaCtcIjogdGhpcy5nZXRIb3VycygpLCAvL+Wwj+aXtlxyXG4gICAgICAgICAgICAgICAgXCJtK1wiOiB0aGlzLmdldE1pbnV0ZXMoKSwgLy/liIZcclxuICAgICAgICAgICAgICAgIFwicytcIjogdGhpcy5nZXRTZWNvbmRzKCksIC8v56eSXHJcbiAgICAgICAgICAgICAgICBcInErXCI6IE1hdGguZmxvb3IoKHRoaXMuZ2V0TW9udGgoKSArIDMpIC8gMyksIC8v5a2j5bqmXHJcbiAgICAgICAgICAgICAgICBcIlNcIjogdGhpcy5nZXRNaWxsaXNlY29uZHMoKSAvL+avq+enklxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoLyh5KykvLnRlc3QoZm10KSkgZm10ID0gZm10LnJlcGxhY2UoUmVnRXhwLiQxLCAodGhpcy5nZXRGdWxsWWVhcigpICsgXCJcIikuc3Vic3RyKDQgLSBSZWdFeHAuJDEubGVuZ3RoKSk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gbylcclxuICAgICAgICAgICAgICAgIGlmIChuZXcgUmVnRXhwKFwiKFwiICsgayArIFwiKVwiKS50ZXN0KGZtdCkpIGZtdCA9IGZtdC5yZXBsYWNlKFJlZ0V4cC4kMSwgKFJlZ0V4cC4kMS5sZW5ndGggPT0gMSkgPyAob1trXSkgOiAoKFwiMDBcIiArIG9ba10pLnN1YnN0cigoXCJcIiArIG9ba10pLmxlbmd0aCkpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZtdDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvL+S/ruaUueWvhueggVxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjY2hhbmdlLXB3ZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLmNoYW5nZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnLmNoYW5nZS1wd2QnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8v5YWz6Zet5L+u5pS55a+G56CBXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5jbG9zZS1wd2QnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJy5jaGFuZ2UtYmFjaycpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5jaGFuZ2UtcHdkJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2Vuc3VyZS1wd2QnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkKCcjbmV3LXBhc3N3b3JkJykudmFsKCkgIT0gJCgnI2Vuc3VyZS1wYXNzd29yZCcpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcjZW5zdXJlLXBhc3N3b3JkJykuYWRkQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQoJyNlbnN1cmUtcGFzc3dvcmQnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJhZ2VudE1lbWJlcklkXCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJvbGRQd2RcIjogJCgnI3Bhc3N3b3JkJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwd2RcIjogJCgnI25ldy1wYXNzd29yZCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwicHdkQ29uZmlybVwiOiAkKCcjZW5zdXJlLXBhc3N3b3JkJykudmFsKClcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hcGkvYWNjb3VudC9jaGFuZ2VQd2QnXHJcbiAgICAgICAgICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfkv67mlLnmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLmNoYW5nZS1iYWNrJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuY2hhbmdlLXB3ZCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfkv67mlLnlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBydW46IHJ1blxyXG4gICAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cy5nZW5lcmFsID0gZ2VuZXJhbDsiLCIvKipcclxuICogQ3JlYXRlZCBieSB6cnogb24gMjAxNi8yLzI0LlxyXG4gKiBAdmVyc2lvbiAxLjAuMCBjcmVhdGVkXHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuLy/mnoTpgKDkv6Hmga/moYbkuLvkvZNcclxudmFyIE1vZGFsID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8v5p6E6YCg5Y6f5aeL57G7XHJcbiAgICBmdW5jdGlvbiBNKG0pIHtcclxuICAgICAgICB0aGlzLnMgPSBtLnM7Ly/mmK/lkKbmmL7npLpcclxuICAgICAgICB0aGlzLmlkID0gbS5pZDtcclxuICAgIH1cclxuXHJcbiAgICAvL+aehOmAoOagh+WHhnNob3fmlrnms5XvvIznlKjkuo7nu6fmib9cclxuICAgIE0ucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGVsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuaWQpO1xyXG4gICAgICAgIGlmIChlbGUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucyAmJiAhaXNTaG93KCkpIHsvL+aYvuekuuW9k+WJjemakOiXj1xyXG4gICAgICAgICAgICAgICAgZWxlLmNsYXNzTmFtZSA9IGVsZS5jbGFzc05hbWUucmVwbGFjZShcImRwLW5cIiwgXCJcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMucyAmJiBpc1Nob3coKSkgey8v6ZqQ6JeP5b2T5YmN5pi+56S6XHJcbiAgICAgICAgICAgICAgICBlbGUuY2xhc3NOYW1lICs9IFwiIGRwLW5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+WOu+mZpOS4pOi+ueeahOepuuagvFxyXG4gICAgICAgICAgICBlbGUuY2xhc3NOYW1lID0gU3RyaW5nKGVsZS5jbGFzc05hbWUpLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gaXNTaG93KCkgey8v5piv5ZCm5bey5pi+56S677yM5pegY2xhc3Pml7bmmL7npLpcclxuICAgICAgICAgICAgcmV0dXJuIGVsZS5jbGFzc05hbWUuc3BsaXQoXCJkcC1uXCIpLmxlbmd0aCA9PSAxO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy/liqDovb3kv6Hmga/moYZcclxuICAgIHZhciBsb2FkaW5nID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+WIneWni+WMlueUn+aIkOWKoOi9veS/oeaBr+ahhlxyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGluZ19tb2RhbF9lbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwibG9hZGluZ19tb2RhbF9lbGVtZW50XCIgY2xhc3M9XCJsb2FkaW5nLW1vZGFsLWJvZHkgZHAtblwiPjxkaXYgY2xhc3M9XCJjb3Zlcl9tb2RhbF9lbGVtZW50XCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJsb2FkaW5nLW1vZGFsLWltYWdlXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJsb2FkaW5nLW1vZGFsLXRleHRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGgyPueOqeWRveWKoOi9veS4reKApuKApjwvaDI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8v5pi+56S644CB6ZqQ6JeP5L+h5oGv5qGGXHJcbiAgICAgICAgdmFyIHNob3cgPSBmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICBzID0gdHlwZW9mIHMgPT0gXCJ1bmRlZmluZWRcIiA/IHRydWUgOiBzOy8v5peg5Y+C5pWw5pi+56S65L+h5oGv5qGGXHJcbiAgICAgICAgICAgIHZhciBtID0gbmV3IE0oe2lkOiBcImxvYWRpbmdfbW9kYWxfZWxlbWVudFwiLCBzOiBzfSk7XHJcbiAgICAgICAgICAgIG0uc2hvdygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICAsIHNob3c6IHNob3dcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgLy/lvLnlh7rkv6Hmga/moYZcclxuICAgIHZhciBhbGVydCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbGVydF9tb2RhbF9lbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwiYWxlcnRfbW9kYWxfZWxlbWVudFwiIGNsYXNzPVwiYWxlcnQtbW9kYWwtZWxlbWVudCBkcC1uXCI+PGRpdiBjbGFzcz1cImNvdmVyX21vZGFsX2VsZW1lbnRcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFsZXJ0LW1vZGFsLWNvbnRlbnRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFsZXJ0LW1vZGFsLWJvZHlcIj48c3BhbiBjbGFzcz1cImFsZXJ0LW1vZGFsLXRleHRcIj48L3NwYW4+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbGVydC1tb2RhbC1mb290ZXJcIj48YnV0dG9uIGlkPVwiYWxlcnRfbW9kYWxfY2xvc2VcIiBjbGFzcz1cImFsZXJ0LW1vZGFsLWJ1dHRvblwiPuWFs+mXrTwvYnV0dG9uPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgIHMgPSB0eXBlb2YgcyA9PSBcInVuZGVmaW5lZFwiID8gdHJ1ZSA6IHM7XHJcbiAgICAgICAgICAgIHZhciBtID0gbmV3IE0oe2lkOiBcImFsZXJ0X21vZGFsX2VsZW1lbnRcIiwgczogc30pO1xyXG4gICAgICAgICAgICBtLnNob3coKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiuvue9ruW8ueWHuuS/oeaBr+ahhlxyXG4gICAgICAgICAqIEBwYXJhbSBtc2cgICAgICAg5pi+56S655qE5L+h5oGv77yM5pSv5oyBaHRtbFxyXG4gICAgICAgICAqIEBwYXJhbSBzZWQgICAgICAg5YCS6K6h5pe25YWz6Zet5pe26Ze077yM5Y2V5L2N77yac2Vjb25kXHJcbiAgICAgICAgICogQHBhcmFtIGNhbGxiYWNrICDlhbPpl63op6blj5Hlm57osIPlh73mlbBcclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgc2V0ID0gZnVuY3Rpb24gKG1zZywgc2VkLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbGVydF9tb2RhbF9lbGVtZW50XCIpO1xyXG4gICAgICAgICAgICBpZiAobXNnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1zZyA9PT0gJ29iamVjdCcpIHsvL+W6lOWvueWQjuerr+i/lOWbnuaPkOekuuaXtuS9v+eUqE9iamVjdOWwgeijhVxyXG4gICAgICAgICAgICAgICAgICAgIG1zZyA9IEpTT04uc3RyaW5naWZ5KG1zZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihlbGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYWxlcnQtbW9kYWwtdGV4dFwiKVswXS5pbm5lckhUTUwgPSBtc2c7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJhbGVydC1tb2RhbC10ZXh0XCIpWzBdLmlubmVySFRNTCA9IG1zZztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNob3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc2VkID4gMCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9LCAxMDAwICogc2VkKTtcclxuICAgICAgICAgICAgfS8v5peg5YWz6Zet5pe26Ze05oiW6ICF5YWz6Zet5pe26Ze05Li6MO+8jOS4jeiHquWKqOWFs+mXrVxyXG4gICAgICAgICAgICAvL2ZpeG1lIOS6i+S7tuebkeWQrOeahGll5YW85a655oCnXHJcbiAgICAgICAgICAgIC8v5YWz6Zet5oyJ6ZKu55qE5LqL5Lu25L6m5ZCsXHJcbiAgICAgICAgICAgICQoXCIjYWxlcnRfbW9kYWxfY2xvc2VcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIC8v6Zi75q2i5LqL5Lu257un57ut5Lyg6YCSXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICAsIHNob3c6IHNob3dcclxuICAgICAgICAgICAgLCBzZXQ6IHNldFxyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICAvL+mAieaLqeS/oeaBr+ahhlxyXG4gICAgdmFyIGNvbmZpcm0gPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybV9tb2RhbF9lbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwiY29uZmlybV9tb2RhbF9lbGVtZW50XCIgY2xhc3M9XCJjb25maXJtLW1vZGFsLWVsZW1lbnQgZHAtblwiPjxkaXYgY2xhc3M9XCJjb3Zlcl9tb2RhbF9lbGVtZW50XCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb25maXJtLW1vZGFsLWNvbnRlbnRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBpZD1cImNvbmZpcm1fbW9kYWxfaGVhZGVyXCIgY2xhc3M9XCJjb25maXJtLW1vZGFsLWhlYWRlciBkcC1uXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb25maXJtLW1vZGFsLWJvZHlcIj48c3BhbiBpZD1cImNvbmZpcm1fbW9kYWxfdGV4dFwiIGNsYXNzPVwiY29uZmlybS1tb2RhbC10ZXh0XCI+PC9zcGFuPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29uZmlybS1tb2RhbC1mb290ZXJcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvb3Rlci1idXR0b24tc3VjY2Vzc1wiPjxidXR0b24gY2xhc3M9XCJjb25maXJtLW1vZGFsLWJ1dHRvbiAgbW9kYWwtc3VjY2Vzc1wiIGRhdGEtY29uZmlybT1cInN1Y2Nlc3NcIj7noa7orqQ8L2J1dHRvbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvb3Rlci1idXR0b24tZmFsc2VcIj48YnV0dG9uIGNsYXNzPVwiY29uZmlybS1tb2RhbC1idXR0b25cIiBkYXRhLWNvbmZpcm09XCJlcnJvclwiPuWPlua2iDwvYnV0dG9uPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj48L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgIHMgPSB0eXBlb2YgcyA9PSBcInVuZGVmaW5lZFwiID8gdHJ1ZSA6IHM7XHJcbiAgICAgICAgICAgIHZhciBtID0gbmV3IE0oe2lkOiBcImNvbmZpcm1fbW9kYWxfZWxlbWVudFwiLCBzOiBzfSk7XHJcbiAgICAgICAgICAgIG0uc2hvdygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6K6+572u6YCJ5oup5L+h5oGv5qGG55qE5YaF5a65XHJcbiAgICAgICAgICogQHBhcmFtIG9wdGlvbiAgICDphY3nva5cclxuICAgICAgICAgKiB7XHJcbiAgICAgICAgICogICAgICB0aXRsZTpcIuWktOmDqOaYvuekuueahOS/oeaBr1wiXHJcbiAgICAgICAgICogICAgICAsdGV4dDpcIuaYvuekuueahOaPkOekuuS/oeaBr1wiXHJcbiAgICAgICAgICogICAgICAsc3VjY2VzczpcIueCueWHu+aIkOWKn+WQjueahOWbnuiwg1wiXHJcbiAgICAgICAgICogICAgICAsZXJyb3I6XCLngrnlh7vlpLHotKXlkI7nmoTlm57osINcIlxyXG4gICAgICAgICAqICAgICAgLGNvbXBsZXRlOlwi54K55Ye75oyJ6ZKu5ZCO55qE5pW05L2T5Zue6LCDXCJcclxuICAgICAgICAgKiB9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIGJhciA9IDA7XHJcbiAgICAgICAgdmFyIHNldCA9IGZ1bmN0aW9uIChvcHRpb24pIHtcclxuICAgICAgICAgICAgaWYgKCFvcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoXCJ0aXRsZVwiIGluIG9wdGlvbiAmJiBvcHRpb24udGl0bGUubGVuZ3RoID4gMCkgey8v5pyJ5aS06YOo77yM5YiZ5pi+56S65aS06YOoXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1fbW9kYWxfaGVhZGVyXCIpLmlubmVySFRNTCA9IG9wdGlvbi50aXRsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoXCJ0ZXh0XCIgaW4gb3B0aW9uICYmIG9wdGlvbi50ZXh0Lmxlbmd0aCA+IDApIHsvL+acieWGheWuue+8jOWImeaYvuekuuaVtOS4qumAieaLqeS/oeaBr+ahhlxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtX21vZGFsX3RleHRcIikuaW5uZXJIVE1MID0gb3B0aW9uLnRleHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9maXhtZSDkuovku7bnm5HlkKznmoRpZeWFvOWuueaAp1xyXG4gICAgICAgICAgICAvL+WFs+mXreaMiemSrueahOS6i+S7tuS+puWQrFxyXG4gICAgICAgICAgICAkKFwiI2NvbmZpcm1fbW9kYWxfZWxlbWVudFwiKS5maW5kKFwiLmNvbmZpcm0tbW9kYWwtYnV0dG9uXCIpLm9mZihcImNsaWNrXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy9maXhtZSAub2ZmKFwiY2xpY2tcIinnlKjkuo7pmLLmraLlpJrmrKHop6blj5E8LS3lvojnjoTlrabvvIzmiJHkuZ/kuI3nn6XpgZPkuLrku4DkuYjvvIzkvYbmmK/or7fkuI3opoHkv67mlLnjgIJcclxuICAgICAgICAgICAgICAgIHZhciBhdHIgPSAkKHRoaXMpLmF0dHIoXCJkYXRhLWNvbmZpcm1cIik7Ly/pgInmi6nnmoTmjInpkq5cclxuICAgICAgICAgICAgICAgIGJhcisrO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbiAmJiBhdHIgaW4gb3B0aW9uICYmIG9wdGlvblthdHJdIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25bYXRyXSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbiAmJiBcImNvbXBsZXRlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5jb21wbGV0ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmNvbXBsZXRlKCk7Ly/oi6XmnInlrozmiJDlh73mlbDvvIzliJnmiafooYxcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7Ly/lkKbliJnvvIzlhbPpl63pgInmi6nmoYZcclxuICAgICAgICAgICAgICAgICAgICBzaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8v6Zi75q2i5LqL5Lu257un57ut5Lyg6YCSXHJcbiAgICAgICAgICAgICAgICAvL3JldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0XHJcbiAgICAgICAgICAgICwgc2hvdzogc2hvd1xyXG4gICAgICAgICAgICAsIHNldDogc2V0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIC8v6KaG55uW5bGCXHJcbiAgICB2YXIgY292ZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY292ZXJfbW9kYWxfZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD1cImNvdmVyX21vZGFsX2VsZW1lbnRcIiBjbGFzcz1cImNvdmVyLW1vZGFsLWVsZW1lbnQgZHAtblwiPjwvZGl2PicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBoaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvdmVyX21vZGFsX2VsZW1lbnRcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY292ZXJfbW9kYWxfZWxlbWVudFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICAsIHNob3c6IHNob3dcclxuICAgICAgICAgICAgLCBoaWRlOiBoaWRlXHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaW5pdExvYWRpbmc6IGxvYWRpbmcuaW5pdFxyXG4gICAgICAgICwgc2hvd0xvYWRpbmc6IGxvYWRpbmcuc2hvd1xyXG5cclxuICAgICAgICAsIGluaXRBbGVydDogYWxlcnQuaW5pdFxyXG4gICAgICAgICwgc2hvd0FsZXJ0OiBhbGVydC5zaG93XHJcbiAgICAgICAgLCBzZXRBbGVydDogYWxlcnQuc2V0XHJcblxyXG4gICAgICAgICwgaW5pdENvbmZpcm06IGNvbmZpcm0uaW5pdFxyXG4gICAgICAgICwgc2V0Q29uZmlybTogY29uZmlybS5zZXRcclxuICAgICAgICAsIHNob3dDb25maXJtOiBjb25maXJtLnNob3dcclxuICAgICAgICAsIGluaXRDb3ZlcjogY292ZXIuaW5pdFxyXG4gICAgfVxyXG59KCkpO1xyXG5cclxuLy/pobXpnaLliqDovb3lrozmr5XlkI7nlJ/miJDlm5vkuKroh6rlrprkuYnmqKHmgIHmoYZcclxuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAvL+mhtemdouWKoOi9veaXtueUn+aIkOS4gOS4quimhuebluWxglxyXG4gICAgTW9kYWwuaW5pdENvdmVyKCk7XHJcbiAgICAvL+mhtemdouWKoOi9veaXtueUn+aIkOS4gOS4quWKoOi9veS/oeaBr+ahhlxyXG4gICAgTW9kYWwuaW5pdExvYWRpbmcoKTtcclxuICAgIC8v6aG16Z2i5Yqg6L295pe255Sf5oiQ5LiA5Liq5by55Ye65L+h5oGv5qGGXHJcbiAgICBNb2RhbC5pbml0QWxlcnQoKTtcclxuICAgIC8v6aG16Z2i5Yqg6L295pe255Sf5oiQ5LiA5Liq6YCJ5oup5L+h5oGv5qGGXHJcbiAgICBNb2RhbC5pbml0Q29uZmlybSgpO1xyXG59LCAxMDApO1xyXG5cclxuXHJcbi8v5oqb5Ye65LiK5bGC6LCD55SoXHJcbmV4cG9ydHMuc2hvd0xvYWRpbmcgPSBNb2RhbC5zaG93TG9hZGluZztcclxuZXhwb3J0cy5zZXRBbGVydCA9IE1vZGFsLnNldEFsZXJ0O1xyXG5leHBvcnRzLnNob3dBbGVydCA9IE1vZGFsLnNob3dBbGVydDtcclxuZXhwb3J0cy5zZXRDb25maXJtID0gTW9kYWwuc2V0Q29uZmlybTtcclxuZXhwb3J0cy5zaG93Q29uZmlybSA9IE1vZGFsLnNob3dDb25maXJtOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEF1c2VyIG9uIDIwMTYvMTIvNi5cclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG52YXIgRGF0YSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbGlzdCA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXIvZG9uZS9saXN0J1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBwcmljZUxpc3QgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL2FpcmxpbmUvcHJpY2UvbGlzdCdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBjcmVhdGVDaGFyZ2UgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVyL2RvbmUvY3JlYXRlQ2hhcmdlJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBleHBlbnNlRGV0YWlsID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS90aWNrZXRzL2V4cGVuc2UvZGV0YWlsJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBlbnN1cmUgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3RpY2tldHMvZXhwZW5zZS9lbnN1cmUnXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHRyYW5zZmVyID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9zdGFmZi9saXN0L3RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBvcExpc3QgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3N0YWZmL2xpc3Qvb3BMaXN0J1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIGV4UHJpY2UgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3RpY2tldHMvZXhwZW5zZS9leFByaWNlJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBsb2cgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVyL3BlbmRpbmcvbG9nJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB5cyA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXIvdW5kZXJ3YXkveXMnXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBsaXN0OiBsaXN0XHJcbiAgICAgICAgLCBwcmljZUxpc3Q6IHByaWNlTGlzdFxyXG4gICAgICAgICwgY3JlYXRlQ2hhcmdlOiBjcmVhdGVDaGFyZ2VcclxuICAgICAgICAsIGV4cGVuc2VEZXRhaWw6IGV4cGVuc2VEZXRhaWxcclxuICAgICAgICAsIGVuc3VyZTogZW5zdXJlXHJcbiAgICAgICAgLCBvcExpc3Q6IG9wTGlzdFxyXG4gICAgICAgICwgdHJhbnNmZXI6IHRyYW5zZmVyXHJcbiAgICAgICAgLCBleFByaWNlOiBleFByaWNlXHJcbiAgICAgICAgLCBsb2c6IGxvZ1xyXG4gICAgICAgICx5czp5c1xyXG4gICAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cy5EYXRhID0gRGF0YTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNy8yLzYuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBteWZvcm1hdCA9IHJlcXVpcmUoJy4uLy4uL2dlbmVyYWwvZnVuY3Rpb24nKS5mb3JtYXQ7XHJcbnZhciBEb20gPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGxpc3QgPSBmdW5jdGlvbiAoanNvbiwgcGFyYW0pIHtcclxuICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgc3RyICs9ICc8dGhlYWQ+IDx0cj4gPHRkPjxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cImNoZWNrLWFsbFwiPjwvdGQ+PHRkPuiuouWNleWPtzwvdGQ+IDx0ZCBjb2xzcGFuPVwiMlwiPuiuouWNleS/oeaBrzwvdGQ+IDx0ZCBjb2xzcGFuPVwiNFwiPuiIque6v+S/oeaBrzwvdGQ+IDx0ZCBjb2xzcGFuPVwiNVwiPui0p+eJqeS/oeaBrzwvdGQ+IDx0ZCBjb2xzcGFuPVwiMlwiPuS7t+agvO+8iENOWe+8iTwvdGQ+IDwvdHI+IDwvdGhlYWQ+JztcclxuICAgICAgICBpZiAoanNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCAmJiAncmVzQm9keScgaW4ganNvbiAmJiBqc29uLnJlc0JvZHkgJiYgJ3NMaXN0JyBpbiBqc29uLnJlc0JvZHkgJiYganNvbi5yZXNCb2R5LnNMaXN0IGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgaWYgKGpzb24ucmVzQm9keS5zTGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0ganNvbi5yZXNCb2R5LnNMaXN0O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSByZW5kZXIoYXJyW2FdKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkLmJ1cnN0ZXIoJChcIi5vdXRlci1wYWdlXCIpLCBwYXJhbS5vZmZzZXQgfHwgMCwganNvbi5yZXNCb2R5LnRvdGFsQ291bnQgfHwgMCwgNSwgcGFyYW0ubGltaXQgfHwgMjApO1xyXG4gICAgICAgICAgICAgICAgJCgnLmxpc3QtY291dCcpLmh0bWwoJ+WFseS4uuaCqOaJvuWIsCAnICsganNvbi5yZXNCb2R5LnRvdGFsQ291bnQgKyAnIOadoee7k+aenCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3RyID0gJzx0ciBjbGFzcz1cIndyb25nXCI+PHRkIGNvbHNwYW49XCI5XCI+5pqC5peg6K6i5Y2V5L+h5oGv77yM6K+35re75Yqg77yBPC90ZD48L3RyPic7XHJcbiAgICAgICAgICAgICAgICAkKCcub3V0ZXItcGFnZScpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAgICAgJCgnLmxpc3QtY291dCcpLmh0bWwoJ+WFseS4uuaCqOaJvuWIsCAwIOadoee7k+aenCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RyID0gJzx0ciBjbGFzcz1cIndyb25nXCI+PHRkIGNvbHNwYW49XCI5XCI+6K+35rGC5aSx6LSl77yMPGEgaHJlZj1cIlwiPuivt+mHjeivle+8gTwvYT48L3RkPjwvdHI+JztcclxuICAgICAgICAgICAgJCgnLm91dGVyLXBhZ2UnKS5odG1sKCcnKTtcclxuICAgICAgICAgICAgJCgnLmxpc3QtY291dCcpLmh0bWwoJ+WFseS4uuaCqOaJvuWIsCAwIOadoee7k+aenCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiByZW5kZXIoZCkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IGQuY29tcGFueSB8fCB7fVxyXG4gICAgICAgICAgICAgICAgLCBvID0gZC5vcmRlciB8fCB7fVxyXG4gICAgICAgICAgICAgICAgLCBtID0gZC5tZW1iZXIgfHwge31cclxuICAgICAgICAgICAgICAgICwgdHlwZTtcclxuICAgICAgICAgICAgc3dpdGNoIChvLm9yZGVyQ2hhbm5lbCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn6Ieq5Yqp6K6i6IixJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJ+W/q+mAn+iuouiIsSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICflkI7lj7DkuIvljZUnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn5ou86LSn6K6i5Y2VJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICfoh6rliqnorqLoiLEnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gJzx0Ym9keT48dHI+PHRkIGNsYXNzPVwic2hvcnQtdGRcIiBjb2xzcGFuPVwiMTRcIj48L3RkPjwvdHI+PC90Ym9keT48dGJvZHkgY2xhc3M9XCJkYXRhLXRiZFwiPiA8dHI+ICA8dGQgcm93c3Bhbj1cIjJcIiBzdHlsZT1cInBhZGRpbmc6IDAgMTBweDtcIj48aW5wdXQgZGF0YS1pZD1cIicgKyBvLm9yZGVySWQgKyAnXCIgdHlwZT1cImNoZWNrYm94XCIgbmFtZT1cImxpc3Qtc2dcIj48L3RkPiA8dGQgY2xhc3M9XCInICsgKG8ub3JkZXJUeXBlID09IDEgPyAnYmctcCcgOiAoby5hbGxvd0NsZWFyZW5jZSA/ICdiZy1xJyA6ICdiZy15JykpICsgJ1wiPicgKyAoby5vcmRlclR5cGUgPT0gMSA/ICfmnIjnu5MnIDogJ+elqOe7kycpICsgKGQuYWdlbnQgPyAoZC5hZ2VudC5uYW1lID8gJyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOycgKyBkLmFnZW50Lm5hbWUgOiAnJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7LycpIDogJyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOy8nKSArICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJyA8dGQgY2xhc3M9XCJiZy1nXCI+5a6i5oi35YWs5Y+4PC90ZD4gJyArXHJcbiAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiYmctZ1wiPuWnlOaJmOaXtumXtC/mlrnlvI88L3RkPiA8dGQgY2xhc3M9XCJiZy1nXCI+6LW35aeL5rivPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICcgPHRkIGNsYXNzPVwiYmctZ1wiPuebrueahOa4rzwvdGQ+IDx0ZCBjbGFzcz1cImJnLWdcIj7oiKrnqbrlhazlj7g8L3RkPiAnICtcclxuICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJiZy1nXCI+6LW36aOe5pe26Ze0PC90ZD4gPHRkIGNsYXNzPVwiYmctZ1wiPuaVsOmHj++8iFBDU++8iTwvdGQ+IDx0ZCBjbGFzcz1cImJnLWdcIj7ph43ph4/vvIhLR1PvvIk8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJyA8dGQgY2xhc3M9XCJiZy1nXCI+5L2T56ev77yIQ0JN77yJPC90ZD4gPHRkIGNsYXNzPVwiYmctZ1wiPuWTgeWQjTwvdGQ+IDx0ZCBjbGFzcz1cImJnLWdcIj7ljZXku7fvvIhDTlnvvIk8L3RkPiAnICtcclxuICAgICAgICAgICAgICAgICc8dGQgcm93c3Bhbj1cIjJcIiBjbGFzcz1cImZvbnQtclwiPicgKyBvLmFpcndheUZlZSArICc8L3RkPiA8dGQgY2xhc3M9XCJvcHQtdGRcIiByb3dzcGFuPVwiMlwiIGRhdGEtamNiaD1cIicgKyBvLndhcmVob3VzZUVudHJ5TnVtICsgJ1wiIGRhdGEta2htYz1cIicgKyAoYy5jb21wYW55TmFtZSB8fCAnLycpICsgJ1wiIGRhdGEtbHhyPVwiJyArIChtLm1lbWJlck5hbWUgfHwgJy8nKSArICdcIj4nICtcclxuICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cInNob3ctb3B0XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj7mk43kvZwgPHNwYW4gY2xhc3M9XCJjYXJldFwiPjwvc3Bhbj48L2E+PGRpdiBjbGFzcz1cIm9wdC1wYXJ0IGRwLW5cIj4nICtcclxuICAgICAgICAgICAgICAgIChvLmNoYXJnZUZpbmlzaCA/ICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwic2hvdy1kZXRhaWxcIiBkYXRhLWlkPVwiJyArIG8ub3JkZXJJZCArICdcIj7mn6XnnIs8L2E+JyA6ICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwic2hvdy16ZFwiIGRhdGEtaWQ9XCInICsgby5vcmRlcklkICsgJ1wiPue7k+eulzwvYT4nKSArXHJcblxyXG4gICAgICAgICAgICAgICAgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJzaG93LXlzXCIgZGF0YS1pZD1cIicgKyBvLm9yZGVySWQgKyAnXCI+6L+Q6L6TPC9hPicrJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJzaG93LWxvZ1wiIGRhdGEtaWQ9XCInICsgby5vcmRlcklkICsgJ1wiPuaTjeS9nOaXpeW/lzwvYT4nK1xyXG4gICAgICAgICAgICAgICAgJzwvZGl2PjwvdGQ+IDwvdHI+ICcgK1xyXG4gICAgICAgICAgICAgICAgJzx0cj4gPHRkPjxhIGhyZWY9XCIvb3JkZXIvZGV0YWlsP3RwPWRvbmUmaWQ9JyArIG8ub3JkZXJJZCArICdcIj4nICsgby5vcmRlck51bSArICc8L2E+PC90ZD48dGQ+JyArIChjLmNvbXBhbnlOYW1lIHx8ICcvJykgKyAnPC90ZD4gPHRkPicgKyBuZXcgRGF0ZShvLmNyZWF0ZUR0LnJlcGxhY2UoLy0vZywgXCIvXCIpKS5Gb3JtYXQoJ3l5eXktTU0tZGQgaGg6bW0nKSArICcgPGJyLz4gJyArIHR5cGUgKyAnPC90ZD4gPHRkPicgKyAoby5kZXB0Q29kZSB8fCAnLycpICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnIDx0ZD4nICsgKG8uZGVzdENvZGUgfHwgJy8nKSArICc8L3RkPiA8dGQ+JyArIChvLmFpckNvbXBhbnlDb2RlIHx8ICcvJykgKyAnPC90ZD4gJyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyBuZXcgRGF0ZShvLmZsaWdodERhdGUucmVwbGFjZSgvLS9nLCBcIi9cIikpLkZvcm1hdCgneXl5eS1NTS1kZCcpICsgJzwvdGQ+IDx0ZD4nICsgKG9bJ2NhcmdvJ10uY2FyZ29Db3VudCB8fCAnLycpICsgJzwvdGQ+ICcgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD4nICsgKG9bJ2NhcmdvJ10uY2FyZ29XZWlnaHQgfHwgJy8nKSArICc8L3RkPiA8dGQ+JyArIChteWZvcm1hdC5mb3JtYXR2b2x1bWUob1snY2FyZ28nXS5jYXJnb1NpemUpIHx8ICcvJykgKyAnPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICcgPHRkPjxkaXYgY2xhc3M9XCJ0d1wiIHRpdGxlPVwiJytvWydjYXJnbyddLmNhcmdvTmFtZSsnXCI+JyArIChvWydjYXJnbyddLmNhcmdvTmFtZSB8fCAnLycpICsgJzwvZGl2PjwvdGQ+IDx0ZD4nICsgby5jaGFyZ2luZ1ByaWNlICsgJzwvdGQ+IDwvdHI+IDwvdGJvZHk+JztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQoJy5vdXRlci10YicpLmh0bWwoc3RyKTtcclxuICAgIH07XHJcbiAgICB2YXIgcmVuZGVyVHIgPSBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgIHZhciBzdHIgPSAnJ1xyXG4gICAgICAgICAgICAsIHJlc3VsdCA9IFwiXCI7XHJcbiAgICAgICAgaWYgKGpzb24gJiYgJ2xpc3QnIGluIGpzb24gJiYganNvbi5saXN0IGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgdmFyIGxpc3QgPSBqc29uLmxpc3Q7XHJcbiAgICAgICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGwgaW4gbGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsaXN0Lmhhc093blByb3BlcnR5KGwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gbGlzdFtsXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IHJlbmRlcihkLCBwYXJzZUludChsKSArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnPHRyPiA8dGQ+PC90ZD4gPHRkPuaAu+iuoTwvdGQ+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8dGQ+JyArIGpzb24udG90YWxDb3VudCArICc8L3RkPiA8dGQ+JyArIG15Zm9ybWF0LmZvcm1hdHZvbHVtZShqc29uLnRvdGFsU2l6ZSkgKyAnPC90ZD4gPHRkPicgKyBteWZvcm1hdC5mb3JtYXR3ZWlnaHQoanNvbi50b3RhbFdlaWdodCkgKyAnPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAnIDx0ZD48L3RkPiA8dGQ+JyArIGpzb24udG90YWxEYW1hZ2UgKyAnPC90ZD4gPHRkPicgKyBqc29uLnRvdGFsRGFtcCArICc8L3RkPiA8dGQ+JyArIGpzb24udG90YWxUcmFuc2Zvcm0gKyAnPC90ZD4gPHRkPicgKyBqc29uLnRvdGFsT3RoZXIgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L3RkPiA8dGQ+PC90ZD4gPC90cj4nO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3RyID0gJzx0cj48dGQgY29sc3Bhbj1cIjEwXCIgY2xhc3M9XCJsb25nLXRkXCI+5pqC5peg6L+b5LuT5pWw5o2u77yM6K+35re75Yqg77yBPC90ZD48L3RyPic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdHIgPSAnPHRyPjx0ZCBjb2xzcGFuPVwiMTBcIiBjbGFzcz1cImxvbmctdGRcIj7or7fmsYLlh7rplJnvvIzor7fph43or5XvvIE8L3RkPjwvdHI+JztcclxuICAgICAgICB9XHJcbiAgICAgICAgJCgnLmVuc3VyZS1kYXRhLXRiJykuZmluZCgndGJvZHknKS5odG1sKHN0cik7XHJcbiAgICAgICAgJCgnLmVuc3VyZS1kYXRhLXRiJykuZmluZCgndGZvb3QnKS5odG1sKHJlc3VsdCk7XHJcbiAgICAgICAgZnVuY3Rpb24gcmVuZGVyKGQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciB0eXBlO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGQucGFja2FnZVR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJ+e6uOeusSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICfmnKjnrrEnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn5Y23JztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJ+aJmOebmCc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn57q4566xJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gJzx0cj4gPHRkPicgKyBpbmRleCArICc8L3RkPiA8dGQ+JyArIG5ldyBEYXRlKGQuY3JlYXRlRHQucmVwbGFjZSgvLS9nLCBcIi9cIikpLkZvcm1hdCgneXl5eS1NTS1kZCBoaDptbScpICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnIDx0ZD4nICsgZC5zdG9yYWdlQ291bnQgKyAnPC90ZD4gPHRkPicgKyAgbXlmb3JtYXQuZm9ybWF0dm9sdW1lKGQuc3RvcmFnZVNpemUpICsgJzwvdGQ+IDx0ZD4nICsgIG15Zm9ybWF0LmZvcm1hdHdlaWdodChkLnN0b3JhZ2VXZWlnaHQpICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnIDx0ZD4nICsgdHlwZSArICc8L3RkPiA8dGQ+JyArIGQuZGFtYWdlQ291bnQgKyAnPC90ZD4gPHRkPicgKyBkLmRhbXBDb3VudCArICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJyA8dGQ+JyArIGQudHJhbnNmb3JtQ291bnQgKyAnPC90ZD4gPHRkPicgKyBkLm90aGVyQ291bnQgKyAnPC90ZD4gPHRkPicgKyBkLnN0b3JhZ2VSZW1hcmsgKyAnPC90ZD4gPC90cj4nO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB2YXIgaW5uZXJMaXN0ID0gZnVuY3Rpb24gKGpzb24sIHBhcmFtKSB7XHJcbiAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgIGlmIChqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwICYmICdyZXNCb2R5JyBpbiBqc29uICYmIGpzb24ucmVzQm9keSAmJiAnc0xpc3QnIGluIGpzb24ucmVzQm9keSAmJiBqc29uLnJlc0JvZHkuc0xpc3QgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICBpZiAoanNvbi5yZXNCb2R5LnNMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBhcnIgPSBqc29uLnJlc0JvZHkuc0xpc3Q7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcnIuaGFzT3duUHJvcGVydHkoYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IHJlbmRlcihhcnJbYV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICQuYnVyc3RlcigkKFwiLmlubmVyLXBhZ2VcIiksIHBhcmFtLm9mZnNldCB8fCAwLCBqc29uLnJlc0JvZHkudG90YWxDb3VudCB8fCAwLCA1LCBwYXJhbS5saW1pdCB8fCAyMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzdHIgPSAnPHRyIGNsYXNzPVwid3JvbmdcIj48dGQgY29sc3Bhbj1cIjlcIj7mmoLml6DmkJzntKLkv6Hmga/vvIE8L3RkPjwvdHI+JztcclxuICAgICAgICAgICAgICAgICQoJy5pbm5lci1wYWdlJykuaHRtbCgnJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdHIgPSAnPHRyIGNsYXNzPVwid3JvbmdcIj48dGQgY29sc3Bhbj1cIjlcIj7or7fmsYLlpLHotKXvvIw8YSBocmVmPVwiXCI+6K+36YeN6K+V77yBPC9hPjwvdGQ+PC90cj4nO1xyXG4gICAgICAgICAgICAkKCcuaW5uZXItcGFnZScpLmh0bWwoJycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiByZW5kZXIoZCkge1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgIGZvciAodmFyIHQgaW4gZC50cmFuc1BvcnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkLnRyYW5zUG9ydC5oYXNPd25Qcm9wZXJ0eSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gZC50cmFuc1BvcnRbdF07XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9IHMucG9ydENvZGUgKyAodCA9PSBkLnRyYW5zUG9ydC5sZW5ndGggLSAxID8gJycgOiAnIC0+ICcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAnIDx0cj4gPHRkPjxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiaS1zZ1wiIGRhdGEtaWQ9XCInICsgZC5haXJ3YXlJZCArICdcIi8+PC90ZD4gJyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyBkLmFpckNvbXBhbnlDb2RlICsgJzwvdGQ+IDx0ZD4nICsgc3RyICsgJzwvdGQ+IDx0ZD4nICsgZC5haXJ3YXlQcmljZS5yYXRlWzBdLnBvbGljeVsnNDUnXSArICc8L3RkPiAnICtcclxuICAgICAgICAgICAgICAgICc8dGQ+JyArIGQuYWlyd2F5UHJpY2UucmF0ZVswXS5wb2xpY3lbJzEwMCddICsgJzwvdGQ+IDx0ZD4nICsgZC5haXJ3YXlQcmljZS5yYXRlWzBdLnBvbGljeVsnMzAwJ10gKyAnPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICcgPHRkPicgKyBkLmFpcndheVByaWNlLnJhdGVbMF0ucG9saWN5Wyc1MDAnXSArICc8L3RkPiA8dGQ+JyArIGQuYWlyd2F5UHJpY2UucmF0ZVswXS5wb2xpY3lbJzEwMDAnXSArICc8L3RkPidcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkKCcuc2VhcmNoLXRiJykuZmluZCgndGJvZHknKS5odG1sKHN0cik7XHJcbiAgICB9O1xyXG4gICAgdmFyIGNhbEV4cGVuc2UgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBwcmljZVRvdGFsID0gMCx0b3RhbENvdW50PSAwLHRvdGFsQW1vdW50PTA7XHJcbiAgICAgICAgJCgnLnpkLXBhcnQgLnpkLXRiJykuZmluZCgndHIuZGF0YScpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZGogPSBwYXJzZUZsb2F0KCQodGhpcykuZmluZCgnLmlwLWRqJykudmFsKCkpXHJcbiAgICAgICAgICAgICAgICAsIHpsID0gcGFyc2VGbG9hdCgkKHRoaXMpLmZpbmQoJy5pcC16bCcpLnZhbCgpKTtcclxuICAgICAgICAgICAgcHJpY2VUb3RhbCArPWRqO1xyXG4gICAgICAgICAgICB0b3RhbENvdW50ICs9emw7XHJcbiAgICAgICAgICAgIHRvdGFsQW1vdW50ICs9ZGoqemw7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJCgnLnpkLXBhcnQgLnpkLXRiJykuZmluZCgndHIudHItdG90YWwnKS5maW5kKCcudG90YWwtcHJpY2UnKS5odG1sKHByaWNlVG90YWwpO1xyXG4gICAgICAgICQoJy56ZC1wYXJ0IC56ZC10YicpLmZpbmQoJ3RyLnRyLXRvdGFsJykuZmluZCgnLnRvdGFsLWNvdW50JykuaHRtbCh0b3RhbENvdW50KTtcclxuICAgICAgICAkKCcuemQtcGFydCAuemQtdGInKS5maW5kKCd0ci50ci10b3RhbCcpLmZpbmQoJy50b3RhbC1hbW91bnQnKS5odG1sKHRvdGFsQW1vdW50KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGxpc3Q6IGxpc3RcclxuICAgICAgICAsIHJlbmRlclRyOiByZW5kZXJUclxyXG4gICAgICAgICwgaW5uZXJMaXN0OiBpbm5lckxpc3RcclxuICAgICAgICAsY2FsRXhwZW5zZSA6IGNhbEV4cGVuc2VcclxuICAgIH1cclxufSgpKTtcclxubW9kdWxlLmV4cG9ydHMuRG9tID0gRG9tOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEplcmVteSBvbiAyMDE3LzIvNi5cclxuICovXHJcbid1c2Ugc3RyaWN0JztcclxuJ3VzZSBzdHJpY3QnO1xyXG52YXIgTGlzdGVuZXIgPSByZXF1aXJlKCcuL2xpc3RlbmVyJykuTGlzdGVuZXI7XHJcbnZhciBnZW5lcmFsID0gcmVxdWlyZSgnLi4vLi4vZ2VuZXJhbC9nZW5lcmFsJykuZ2VuZXJhbDtcclxuZ2VuZXJhbC5ydW4oKTtcclxuTGlzdGVuZXIucnVuKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSmVyZW15IG9uIDIwMTcvMS81LlxyXG4gKi9cclxuJ3VzZSBzdHJpY3QnO1xyXG5yZXF1aXJlKCcuLi8uLi9nZW5lcmFsL2J1cnN0ZXInKTtcclxudmFyIHVybCA9IHJlcXVpcmUoJy4uLy4uL2dlbmVyYWwvZnVuY3Rpb24nKS51cmxcclxuICAgICxteWZvcm1hdCA9IHJlcXVpcmUoJy4uLy4uL2dlbmVyYWwvZnVuY3Rpb24nKS5mb3JtYXRcclxuICAgICwgTW9kYWwgPSByZXF1aXJlKCcuLi8uLi9nZW5lcmFsL21vZGFsJyk7XHJcbnZhciBEYXRhID0gcmVxdWlyZSgnLi9kYXRhJykuRGF0YVxyXG4gICAgLCBEb20gPSByZXF1aXJlKCcuL2RvbScpLkRvbTtcclxudmFyIExpc3RlbmVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBXUHJpY2UgPSBbXS8v5LuT5bqT6LS555SoXHJcbiAgICAgICAgLCBEUHJpY2UgPSBbXTsvL+aKpeWFs+i0ueeUqFxyXG4gICAgdmFyIGRlZmF1bHRQcmljZSA9IHt9XHJcbiAgICAgICAgLCBzdG9wZ2FwID0ge307XHJcbiAgICB2YXIgZG9uZUxpc3QgPSB7fTtcclxuICAgIHZhciBvcGVyYXRlSWQ7XHJcbiAgICB2YXIgcHJvY2VzcyA9IHt9O1xyXG4gICAgdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWVudGVyJywgJy5vcHQtdGQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuY2hpbGRyZW4oJy5vcHQtcGFydCcpLmZhZGVJbigyMDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWxlYXZlJywgJy5vcHQtdGQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuY2hpbGRyZW4oJy5vcHQtcGFydCcpLmZhZGVPdXQoMjAwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNlbC10eXBlIHAnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAkKCcuJyArICQodGhpcykuZGF0YSgndGFyJykpLnNob3coKTtcclxuICAgICAgICAgICAgJCgnLicgKyAkKHRoaXMpLmRhdGEoJ3RhcicpKS5zaWJsaW5ncygpLmhpZGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2NoZWNrLWFsbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdW25hbWU9XCJsaXN0LXNnXCJdJykucHJvcCgnY2hlY2tlZCcsICQodGhpcykucHJvcCgnY2hlY2tlZCcpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLm91dGVyLXBhZ2UgLnBhZ2VzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB1cmwuc2V0KCdvZmZzZXQnLCAkKHRoaXMpLmRhdGEoJ29mZnNldCcpKTtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjc2VhcmNoJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB1cmwuc2V0KCdvZmZzZXQnLCAwKTtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2xvc2UtYnRuJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcuYWxlcnQtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNob3ctZGV0YWlsJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBEYXRhLmV4cGVuc2VEZXRhaWwoe2lkOiAkKHRoaXMpLmRhdGEoJ2lkJyl9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlID0gJCgnLnFyLXBhcnQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIG8gPSBqc29uLnJlc0JvZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvcGdhcCA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9ICcnLCBzdHIgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG8uZW50cnlDYXJnby5jYXJnb1R5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICfmma7otKcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn5pyo566xJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gJ+WNtyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICfmiZjnm5gnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGFubmVsID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChvLm9yZGVyQ2hhbm5lbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsID0gJ+iHquWKqeiuouiIsSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbCA9ICflv6vpgJ/orqLoiLEnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWwgPSAn5ZCO5Y+w5LiL5Y2VJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsID0gJ+aLvOi0p+iuouWNlSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWwgPSAn6Ieq5Yqp6K6i6IixJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvL2lmIChvLmFwcGVhbENvbW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAkKCcjcmVmdXNlLXJlYXNvbicpLnZhbChvLmFwcGVhbENvbW1lbnQgfHwgJy8nKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy99IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICQoJyNyZWZ1c2UtcmVhc29uJykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAgICAgICAgICQoJyNyZWZ1c2UtcmVhc29uJykudmFsKG8uYXBwZWFsQ29tbWVudCB8fCAnLycpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5kZGgnKS5odG1sKG8ub3JkZXJOdW0gfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcua2gnKS5odG1sKG8uY29tcGFueU5hbWUgfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcuZGRxZCcpLmh0bWwoY2hhbm5lbCB8fCAnLycpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5xc2cnKS5odG1sKG8uZGVwdFBvcnRDb2RlIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLm1kZycpLmh0bWwoby5kZXN0UG9ydENvZGUgfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcuaGtncycpLmh0bWwoby5haXJDb21wYW55Q29kZSB8fCAnLycpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5xZnJxJykuaHRtbChvLmFpcmxpbmVUaW1lID8gbmV3IERhdGUoby5haXJsaW5lVGltZSkuRm9ybWF0KCd5eXl5LU1NLWRkJykgOiAnLycpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5oYmgnKS5odG1sKG8uYWlybGluZUluZm8gfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcucG0nKS5odG1sKG8uZW50cnlDYXJnby5jYXJnb05hbWUgfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcucG0nKS5hdHRyKFwidGl0bGVcIixvLmVudHJ5Q2FyZ28uY2FyZ29OYW1lIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmx4JykuaHRtbCh0eXBlIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnd0YmcnKS5odG1sKG8uZW50cnlDYXJnby5pc0J1bGt5Q2FyZ28gPyAn5pivJyA6ICflkKYnKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcuanMnKS5odG1sKG8uZW50cnlDYXJnby5jYXJnb0NvdW50ICsgJ+S7ticpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy50aicpLmh0bWwobXlmb3JtYXQuZm9ybWF0dm9sdW1lKG8uZW50cnlDYXJnby5jYXJnb1NpemUpICsgJ23CsycpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy56bCcpLmh0bWwoby5lbnRyeUNhcmdvLmNhcmdvV2VpZ2h0ICsgJ0tH77yI6K6h6LS56YeN6YeP77yaJyArIG8uZW50cnlDYXJnby5jaGFyZ2luZ1dlaWdodCArICdLR++8iScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmljZVRvdGFsID0gMCx0b3RhbENvdW50PSAwLHRvdGFsQW1vdW50PTA7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcyBpbiBvLnNlcnZpY2VGZWVMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvLnNlcnZpY2VGZWVMaXN0Lmhhc093blByb3BlcnR5KHMpICAmJiBvLnNlcnZpY2VGZWVMaXN0W3NdLml0ZW1OYW1lICE9J+aKpeWFs+i0uScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gby5zZXJ2aWNlRmVlTGlzdFtzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPHRyIGNsYXNzPVwiZGF0YVwiPiA8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJmeW10XCIgcmVhZG9ubHkgdmFsdWU9XCInICsgZC5pdGVtTmFtZSArICdcIi8+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvdGQ+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLWRqXCIgdmFsdWU9XCInICsgZC5pdGVtUHJpY2UgKyAnXCIvPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L3RkPiA8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJpcC16bFwiIHZhbHVlPVwiJyArIGQuaXRlbUNvdW50ICsgJ1wiLz4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC90ZD4gPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwidHRwXCIgcmVhZG9ubHkgdmFsdWU9XCInICsgZC5pdGVtVG90YWwgKyAnXCIvPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L3RkPiA8L3RyPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZVRvdGFsICs9ZC5pdGVtUHJpY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbENvdW50ICs9ZC5pdGVtQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEFtb3VudCArPWQuaXRlbVRvdGFsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vc3RyICs9ICc8dHIgY2xhc3M9XCJ0ci1hZGRcIj4gPHRkPjwvdGQ+IDx0ZD48L3RkPiA8dGQ+PC90ZD4gPHRkPjwvdGQ+IDx0ZD48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcGx1c1wiPjwvc3Bhbj48L3RkPiA8L3RyPic7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8dHIgY2xhc3M9XCJ0ci10b3RhbFwiPiA8dGQ+5oC76K6hPC90ZD4gPHRkICBjbGFzcz1cInRvdGFsLXByaWNlXCI+JyArIHByaWNlVG90YWwgKyAnPC90ZD4gPHRkIGNsYXNzPVwidG90YWwtY291bnRcIj4nICsgdG90YWxDb3VudCArICc8L3RkPiA8dGQgY2xhc3M9XCJ0b3RhbC1hbW91bnRcIj4nICsgdG90YWxBbW91bnQgKyAnPC90ZD4gIDwvdHI+JztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgd1N0ciA9ICc8dHI+PHRkIGNvbHNwYW49XCIzXCI+5pqC5peg6LS555SoPC90ZD48L3RyPicsIGRTdHIgPSAnPHRyPjx0ZCBjb2xzcGFuPVwiM1wiPuaaguaXoOi0ueeUqDwvdGQ+PC90cj4nO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhcnJXID0gby53YXJlSG91c2VGZWVMaXN0IHx8IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgYXJyRCA9IG8uZGVjbGFyZUZlZUxpc3QgfHwgW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgdyA9IDA7IHcgPCBhcnJXLmxlbmd0aDsgdysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkMSA9IGFycldbd107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3ID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdTdHIgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3U3RyICs9ICc8dHIgY2xhc3M9XCJkYXRhXCI+PHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZnltdFwiIHJlYWRvbmx5IHZhbHVlPVwiJyArIGQxLml0ZW1OYW1lICsgJ1wiLz48L3RkPjx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImV4LWplXCIgdmFsdWU9XCInICsgZDEuaXRlbVRvdGFsICsgJ1wiPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC90cj4nXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGRkID0gMDsgZGQgPCBhcnJELmxlbmd0aDsgZGQrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZDIgPSBhcnJEW2RkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRkID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRTdHIgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkU3RyICs9ICc8dHIgY2xhc3M9XCJkYXRhXCI+PHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZnltdFwiIHJlYWRvbmx5IHZhbHVlPVwiJyArIGQyLml0ZW1OYW1lICsgJ1wiLz48L3RkPjx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImV4LWplXCIgdmFsdWU9XCInICsgZDIuaXRlbVRvdGFsICsgJ1wiPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC90cj4nXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBlbGUuZmluZCgnLnpkLXRiJykuZmluZCgndGJvZHknKS5odG1sKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlLmZpbmQoJy56ZC1ja2Z5JykuZmluZCgndGJvZHknKS5odG1sKHdTdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZS5maW5kKCcuemQtYmdmeScpLmZpbmQoJ3Rib2R5JykuaHRtbChkU3RyKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoby5jaGFyZ2VTdGF0ZSA9PSAxIHx8IG8uY2hhcmdlU3RhdGUgPT0gMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjZW5zdXJlLWNoYXJnZScpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjZW5zdXJlLWNoYXJnZScpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnpkLWZ5cWQnKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnpkLWV4JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5zZWwtdHlwZSBwJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJ3BbZGF0YS10YXI9XCJ6ZC1meXFkXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+iOt+WPluivpuaDheWksei0pe+8jOivt+mHjeivlScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2Vuc3VyZS1jaGFyZ2UnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6IHN0b3BnYXAub3JkZXJJZCxcclxuICAgICAgICAgICAgICAgIFwiY2hhcmdlU3RhdGVcIjogMVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBEYXRhLmVuc3VyZShkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn56Gu6K6k5oiQ5Yqf77yBJywgbnVsbCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+ehruiupOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3RyYW5zZmVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJyID0gW107XHJcbiAgICAgICAgICAgICQoJ2lucHV0W25hbWU9XCJsaXN0LXNnXCJdOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGFyci5wdXNoKCQodGhpcykuZGF0YSgnaWQnKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICQoJy50cmFuc2Zlci1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjYWNjZXB0LXRyYW5zZmVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJyID0gW107XHJcbiAgICAgICAgICAgIHZhciBtSWQ7XHJcbiAgICAgICAgICAgICQoJ2lucHV0W25hbWU9XCJsaXN0LXNnXCJdOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGFyci5wdXNoKCQodGhpcykuZGF0YSgnaWQnKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBtSWQgPSAkKCcjY3p5JykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XHJcbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCAmJiBtSWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIFwib3JkZXJJZHNcIjogYXJyLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29tcGFueUlkXCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJtZW1iZXJGcm9tXCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJtZW1iZXJUb1wiOiBtSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJyZXF1aXJlTWViZXJJZFwiOiAwXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgRGF0YS50cmFuc2ZlcihkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfovaznp7vmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+i9rOenu+Wksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaG93LWxvZycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgRGF0YS5sb2coe2lkOiAkKHRoaXMpLmRhdGEoJ2lkJyl9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0JvZHknIGluIGpzb24gJiYganNvbi5yZXNCb2R5IGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFyciA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnIuaGFzT3duUHJvcGVydHkoYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYXJyW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZC5vcGVyYXRvclR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICflrqLmiLcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn6LSn5LujJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gJ+aKpeWFs+ihjCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8dHI+PHRkPicgKyAobmV3IERhdGUoZC5jcmVhdGVEdCkuRm9ybWF0KCd5eXl5LU1NLWRkIGhoOm1tJykpICsgJzwvdGQ+PHRkPicgKyBkLm9yZGVyTnVtICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8dGQ+JyArIHR5cGUgKyAnPC90ZD48dGQ+JyArIGQub3BlcmF0b3JJZCArICc8L3RkPjx0ZCBjbGFzcz1cImxvbmdcIj4nICsgZC5yZW1hcmsgKyAnPC90ZD48L3RyPidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciA9ICc8dHI+PHRkIGNvbHNwYW49XCI1XCI+5pqC5peg5pON5L2c5pel5b+XPC90ZD48L3RyPidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmxvZy1wYXJ0JykuZmluZCgndGJvZHknKS5odG1sKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmxvZy1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfojrflj5blpLHotKXvvIzor7fph43or5UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaG93LXlzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgICAgIG9wZXJhdGVJZCA9ICQodGhpcykuZGF0YSgnaWQnKTtcclxuICAgICAgICAgICAgdmFyIGQgPSBkb25lTGlzdFtvcGVyYXRlSWRdO1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLnlzLXBhcnQnKTtcclxuICAgICAgICAgICAgdmFyIGpjenQgPSAnJywgZGN6dCA9ICcnO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkKTtcclxuICAgICAgICAgICAgc3dpdGNoIChkLm9yZGVyLmJvb2tpbmdTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgIGRjenQgPSAn5pyq6K6i6IixJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICBkY3p0ID0gJ+W3suiuouiIsSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIC0xOlxyXG4gICAgICAgICAgICAgICAgICAgIGRjenQgPSAn6K6i6Iix5aSx6LSlJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICBkY3p0ID0gJ+W3suaUuemFjSc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3dpdGNoIChkLm9yZGVyLmVudHJ5U3RhdGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICBqY3p0ID0gJ+W+hei/m+S7kyc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgamN6dCA9ICflt7Lov5vku5MnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgIGpjenQgPSAn5bey56Gu6K6kJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmRkaCcpLmh0bWwoZC5vcmRlci5vcmRlck51bSk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcucXNnJykuaHRtbChkLm9yZGVyLmRlcHRDb2RlKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJy5tZGcnKS5odG1sKGQub3JkZXIuZGVzdENvZGUpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmhrZ3MnKS5odG1sKGQub3JkZXIuYWlyQ29tcGFueUNvZGUpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLnFmcnEnKS5odG1sKG5ldyBEYXRlKGQub3JkZXIuZmxpZ2h0RGF0ZS5yZXBsYWNlKC8tL2csIFwiL1wiKSkuRm9ybWF0KCd5eXl5LU1NLWRkJykpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmpjenQnKS5odG1sKGpjenQpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmRjenQnKS5odG1sKGRjenQpO1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgIGVsZS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjeXMtZW5zdXJlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIFwib3JkZXJJZFwiOiBvcGVyYXRlSWQsXHJcbiAgICAgICAgICAgICAgICBcInN0YXRlXCI6ICQoJyNjLXlzenQnKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS52YWwoKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBEYXRhLnlzKGRhdGEsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfmm7TmlrDmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn5pu05paw5aSx6LSl77yM6K+36YeN6K+V77yBJylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIG9mZnNldDogdXJsLmdldCgnb2Zmc2V0JykgfHwgMCxcclxuICAgICAgICAgICAgbGltaXQ6IHVybC5nZXQoJ2xpbWl0JykgfHwgMTAsXHJcbiAgICAgICAgICAgIFwiZGVwdENvZGVcIjogJCgnI3N0YXJ0JykudmFsKCksXHJcbiAgICAgICAgICAgIFwiZGVzdENvZGVcIjogJCgnI2VuZCcpLnZhbCgpLFxyXG4gICAgICAgICAgICBcIm51bWJlclwiOiAkKCcjb3JkZXItbnVtJykudmFsKClcclxuICAgICAgICB9O1xyXG4gICAgICAgIERhdGEubGlzdChkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICBEb20ubGlzdChqc29uLCBkYXRhKTtcclxuICAgICAgICAgICAgdmFyIGR0ID0ge307XHJcbiAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwICYmIGpzb24ucmVzQm9keSAmJiBqc29uLnJlc0JvZHkuc0xpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSBqc29uLnJlc0JvZHkuc0xpc3Q7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBsIGluIGxpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGlzdC5oYXNPd25Qcm9wZXJ0eShsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGxpc3RbbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGR0W2Qub3JkZXIub3JkZXJJZF0gPSBkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkb25lTGlzdCA9IGR0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB6ZFRhYmxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2hvdy16ZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc3RvcGdhcCA9IGRvbmVMaXN0WyQodGhpcykuZGF0YSgnaWQnKV0gfHwgbnVsbDtcclxuICAgICAgICAgICAgaWYgKHN0b3BnYXApIHtcclxuICAgICAgICAgICAgICAgIHZhciBlbGUgPSAkKCcuemQtcGFydCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLCBjID0gc3RvcGdhcC5jb21wYW55XHJcbiAgICAgICAgICAgICAgICAgICAgLCBvID0gc3RvcGdhcC5vcmRlcjtcclxuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gJycsIHN0ciA9ICcnO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoYW5uZWwgPSAnJztcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoby5vcmRlckNoYW5uZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWwgPSAn6Ieq5Yqp6K6i6IixJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsID0gJ+W/q+mAn+iuouiIsSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbCA9ICflkI7lj7DkuIvljZUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWwgPSAn5ou86LSn6K6i5Y2VJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbCA9ICfoh6rliqnorqLoiLEnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoby5jYXJnby5jYXJnb1R5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn5pmu6LSnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gJ+acqOeusSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICfljbcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAn5omY55uYJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkKCcuZGRoJykuaHRtbChvLm9yZGVyTnVtIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcua2gnKS5odG1sKGMuY29tcGFueU5hbWUgfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICQoJy5kZHFkJykuaHRtbChjaGFubmVsIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcucXNnJykuaHRtbChvLmRlcHRDb2RlIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcubWRnJykuaHRtbChvLmRlc3RDb2RlIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcuaGtncycpLmh0bWwoby5haXJDb21wYW55Q29kZSB8fCAnLycpO1xyXG4gICAgICAgICAgICAgICAgJCgnLnFmcnEnKS5odG1sKG8uZmxpZ2h0RGF0ZSA/IG5ldyBEYXRlKG8uZmxpZ2h0RGF0ZSkuRm9ybWF0KCd5eXl5LU1NLWRkJykgOiAnLycpO1xyXG4gICAgICAgICAgICAgICAgJCgnLmhiaCcpLmh0bWwoby5haXJsaW5lSW5mbyB8fCAnLycpO1xyXG4gICAgICAgICAgICAgICAgJCgnLnBtJykuaHRtbChvLmNhcmdvLmNhcmdvTmFtZSB8fCAnLycpO1xyXG4gICAgICAgICAgICAgICAgJCgnLnBtJykuYXR0cihcInRpdGxlXCIsby5jYXJnby5jYXJnb05hbWUgfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICQoJy5seCcpLmh0bWwodHlwZSB8fCAnLycpO1xyXG4gICAgICAgICAgICAgICAgJCgnLnd0YmcnKS5odG1sKG8uY2FyZ28uaXNCdWxreUNhcmdvID8gJ+aYrycgOiAn5ZCmJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcuanMnKS5odG1sKG8uY2FyZ28uY2FyZ29Db3VudCArICdQQ1MnKTtcclxuICAgICAgICAgICAgICAgICQoJy50aicpLmh0bWwoIG15Zm9ybWF0LmZvcm1hdHZvbHVtZShvLmNhcmdvLmNhcmdvU2l6ZSkgKyAnQ0JNJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcuemwnKS5odG1sKCBteWZvcm1hdC5mb3JtYXR3ZWlnaHQoby5jYXJnby5jYXJnb1dlaWdodCkgKyAnS0dT77yI6K6h6LS56YeN6YeP77yaJyArIG8uY2FyZ28uY2hhcmdpbmdXZWlnaHQgKyAnS0dT77yJJyk7XHJcbiAgICAgICAgICAgICAgICBzdHIgKz0gJzx0ciBjbGFzcz1cImRhdGFcIj4gPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZnltdFwiIHJlYWRvbmx5IHZhbHVlPVwi56m66L+Q6LS5XCIvPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L3RkPiA8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJpcC1kalwiIHZhbHVlPVwiJyArIG8uY2hhcmdpbmdQcmljZSArICdcIi8+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvdGQ+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLXpsXCIgdmFsdWU9XCInICsgby5jaGFyZ2luZ1dlaWdodCArICdcIi8+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvdGQ+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cInR0cFwiIHJlYWRvbmx5IHZhbHVlPVwiJyArIG8uY2hhcmdpbmdQcmljZSAqIG8uY2hhcmdpbmdXZWlnaHQgKyAnXCIvPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L3RkPiA8dGQ+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZVwiPjwvc3Bhbj48L3RkPjwvdHI+JztcclxuICAgICAgICAgICAgICAgIHZhciBwcmljZVRvdGFsID0gby5jaGFyZ2luZ1ByaWNlLHRvdGFsQ291bnQ9IG8uY2hhcmdpbmdXZWlnaHQsdG90YWxBbW91bnQ9by5jaGFyZ2luZ1ByaWNlICogby5jaGFyZ2luZ1dlaWdodCA7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBzIGluIG8uc2VydmljZUZlZUxpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoby5zZXJ2aWNlRmVlTGlzdC5oYXNPd25Qcm9wZXJ0eShzKSAmJiBvLnNlcnZpY2VGZWVMaXN0W3NdLml0ZW1OYW1lICE9J+aKpeWFs+i0uScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBvLnNlcnZpY2VGZWVMaXN0W3NdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzx0ciBjbGFzcz1cImRhdGFcIj4gPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZnltdFwiIHJlYWRvbmx5IHZhbHVlPVwiJyArIGQuaXRlbU5hbWUgKyAnXCIvPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvdGQ+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLWRqXCIgdmFsdWU9XCInICsgZC5pdGVtUHJpY2UgKyAnXCIvPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvdGQ+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLXpsXCIgdmFsdWU9XCInICsgZC5pdGVtQ291bnQgKyAnXCIvPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvdGQ+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cInR0cFwiIHJlYWRvbmx5IHZhbHVlPVwiJyArIGQuaXRlbVRvdGFsICsgJ1wiLz4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L3RkPiA8dGQ+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZVwiPjwvc3Bhbj48L3RkPjwvdHI+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2VUb3RhbCArPWQuaXRlbVByaWNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbENvdW50ICs9ZC5pdGVtQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQW1vdW50ICs9ZC5pdGVtVG90YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RyICs9ICc8dHIgY2xhc3M9XCJ0ci1hZGRcIj4gPHRkPjwvdGQ+IDx0ZD48L3RkPiA8dGQ+PC90ZD4gPHRkPjwvdGQ+IDx0ZD48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcGx1cyBmeXFkLWFkZFwiPjwvc3Bhbj48L3RkPiA8L3RyPic7XHJcbiAgICAgICAgICAgICAgICBzdHIgKz0gJzx0ciBjbGFzcz1cInRyLXRvdGFsXCI+IDx0ZD7mgLvorqE8L3RkPiA8dGQgIGNsYXNzPVwidG90YWwtcHJpY2VcIj4nICsgcHJpY2VUb3RhbCArICc8L3RkPiA8dGQgY2xhc3M9XCJ0b3RhbC1jb3VudFwiPicgKyB0b3RhbENvdW50ICsgJzwvdGQ+IDx0ZCBjbGFzcz1cInRvdGFsLWFtb3VudFwiPicgKyB0b3RhbEFtb3VudCArICc8L3RkPiA8dGQ+PC90ZD4gPC90cj4nO1xyXG4gICAgICAgICAgICAgICAgdmFyIHdTdHIgPSAnJywgZFN0ciA9ICcnO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyclcgPSBvLndhcmVIb3VzZUZlZUxpc3QgfHwgW11cclxuICAgICAgICAgICAgICAgICAgICAsIGFyckQgPSBvLmRlY2xhcmVGZWVMaXN0IHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdyA9IDA7IHcgPCBhcnJXLmxlbmd0aDsgdysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQxID0gYXJyV1t3XTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodyA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdTdHIgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgd1N0ciArPSAnPHRyIGNsYXNzPVwiZGF0YVwiPjx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZ5bXRcIiByZWFkb25seSB2YWx1ZT1cIicgKyBkMS5pdGVtTmFtZSArICdcIi8+PC90ZD48dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJleC1qZVwiIHZhbHVlPVwiJyArIGQxLml0ZW1Ub3RhbCArICdcIj48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHRkPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmVcIj48L3NwYW4+PC90ZD48L3RyPidcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHdTdHIgKz0gJzx0ciBjbGFzcz1cInRyLWFkZFwiPiA8dGQ+PC90ZD4gPHRkPjwvdGQ+IDx0ZD48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcGx1cyB3LWFkZFwiPjwvc3Bhbj48L3RkPiA8L3RyPic7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBkZCA9IDA7IGRkIDwgYXJyRC5sZW5ndGg7IGRkKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZDIgPSBhcnJEW2RkXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGQgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkU3RyID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGRTdHIgKz0gJzx0ciBjbGFzcz1cImRhdGFcIj48dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJmeW10XCIgcmVhZG9ubHkgdmFsdWU9XCInICsgZDIuaXRlbU5hbWUgKyAnXCIvPjwvdGQ+PHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZXgtamVcIiB2YWx1ZT1cIicgKyBkMi5pdGVtVG90YWwgKyAnXCI+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcmVtb3ZlXCI+PC9zcGFuPjwvdGQ+PC90cj4nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkU3RyICs9ICc8dHIgY2xhc3M9XCJ0ci1hZGRcIj48dGQ+PC90ZD4gPHRkPjwvdGQ+IDx0ZD48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcGx1cyBkLWFkZFwiPjwvc3Bhbj48L3RkPiA8L3RyPic7XHJcblxyXG4gICAgICAgICAgICAgICAgZWxlLmZpbmQoJy56ZC10YicpLmZpbmQoJ3Rib2R5JykuaHRtbChzdHIpO1xyXG4gICAgICAgICAgICAgICAgZWxlLmZpbmQoJy56ZC1ja2Z5JykuZmluZCgndGJvZHknKS5odG1sKHdTdHIpO1xyXG4gICAgICAgICAgICAgICAgZWxlLmZpbmQoJy56ZC1iZ2Z5JykuZmluZCgndGJvZHknKS5odG1sKGRTdHIpO1xyXG4gICAgICAgICAgICAgICAgJCgnLnpkLWZ5cWQnKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAkKCcuemQtZXgnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAkKCcuc2VsLXR5cGUgcCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICQoJ3BbZGF0YS10YXI9XCJ6ZC1meXFkXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgZWxlLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmZ5bXQuY2hvb3NlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcuc2UtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQodGhpcykuc2libGluZ3MoJy5zZS1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zZS1wYXJ0IGxpJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZGogPSBwYXJzZUZsb2F0KCQodGhpcykuZGF0YSgnZGonKSlcclxuICAgICAgICAgICAgICAgICwgemwgPSBwYXJzZUZsb2F0KCQodGhpcykuZGF0YSgnemwnKSlcclxuICAgICAgICAgICAgICAgICwgZWxlID0gJCh0aGlzKS5wYXJlbnRzKCd0ci5kYXRhJyk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcuaXAtZGonKS52YWwoZGopO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmlwLXpsJykudmFsKHpsKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJy50dHAnKS52YWwoZGogKiB6bCk7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnaW5wdXQnKS52YWwoJCh0aGlzKS5odG1sKCkpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3VsJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJy5meW10JykucmVtb3ZlQ2xhc3MoJ2Nob29zZScpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLnNlLXBhcnQnKS5yZW1vdmUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gJChlLnRhcmdldCk7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmZ5bXQuY2hvb3NlLC5zZS1wYXJ0IGxpJykubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICQoJy5zZS1wYXJ0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdrZXl1cCcsICcuaXAtemwsLmlwLWRqJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnZhbCgkKHRoaXMpLnZhbCgpLnJlcGxhY2UoL1teXFxkLl0vZywgXCJcIikpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2JsdXInLCAnLmlwLXpsLC5pcC1kaicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHYgPSAkKHRoaXMpLnZhbCgpIHx8IDA7XHJcbiAgICAgICAgICAgICQodGhpcykudmFsKHBhcnNlRmxvYXQodikpO1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCh0aGlzKS5wYXJlbnRzKCd0ci5kYXRhJyk7XHJcbiAgICAgICAgICAgIHZhciBkaiA9IHBhcnNlRmxvYXQoZWxlLmZpbmQoJy5pcC1kaicpLnZhbCgpKVxyXG4gICAgICAgICAgICAgICAgLCB6bCA9IHBhcnNlRmxvYXQoZWxlLmZpbmQoJy5pcC16bCcpLnZhbCgpKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJy50dHAnKS52YWwoZGogKiB6bCk7XHJcbiAgICAgICAgICAgIERvbS5jYWxFeHBlbnNlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5nbHlwaGljb24tcmVtb3ZlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3RyLmRhdGEnKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgRG9tLmNhbEV4cGVuc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmZ5cWQtYWRkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZXhpc3QgPSBbXSwgYXJyID0gW10sIHN0ciA9ICcnLCB1bCA9ICcnO1xyXG4gICAgICAgICAgICAvL+iOt+WPluW3suWtmOWcqOeahOmhueebrlxyXG4gICAgICAgICAgICAkKCcuemQtdGInKS5maW5kKCcuZnltdCcpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZXhpc3QucHVzaCgkKHRoaXMpLnZhbCgpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8v6K6h566X5Y+v5re75Yqg55qE6aG555uuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGQgaW4gZGVmYXVsdFByaWNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFByaWNlLmhhc093blByb3BlcnR5KGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0LmluZGV4T2YoZCkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKGRlZmF1bHRQcmljZVtkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZyA9IGFyclthXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWwgKz0gJzxsaSBkYXRhLWRqPVwiJyArIHNnLml0ZW1QcmljZSArICdcIiBkYXRhLXpsPVwiJyArIHNnLml0ZW1Vbml0ICsgJ1wiPicgKyBzZy5pdGVtTmFtZSArICc8L2xpPic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RyICs9ICc8dHIgY2xhc3M9XCJkYXRhXCI+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZ5bXQgY2hvb3NlXCIgcmVhZG9ubHkgdmFsdWU9XCLor7fpgInmi6notLnnlKjlkI3np7BcIi8+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8dWwgY2xhc3M9XCJzZS1wYXJ0IGRwLW5cIj4nICsgdWwgKyAnPC91bD4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvdGQ+IDx0ZD48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlwLWRqXCIgdmFsdWU9XCIwXCIvPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L3RkPiA8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJpcC16bFwiIHZhbHVlPVwiMFwiLz48L3RkPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAnPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwidHRwXCIgcmVhZG9ubHkgdmFsdWU9XCIwXCIvPjwvdGQ+IDx0ZD48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcmVtb3ZlXCI+PC9zcGFuPjwvdGQ+IDwvdHI+JztcclxuICAgICAgICAgICAgICAgICQoJy56ZC10YicpLmZpbmQoJy50ci1hZGQnKS5iZWZvcmUoc3RyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudy1hZGQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBleGlzdCA9IFtdLCBhcnIgPSBbXSwgc3RyID0gJycsIHVsID0gJyc7XHJcbiAgICAgICAgICAgIC8v6I635Y+W5bey5a2Y5Zyo55qE6aG555uuXHJcbiAgICAgICAgICAgICQoJy56ZC1ja2Z5JykuZmluZCgnLmZ5bXQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGV4aXN0LnB1c2goJCh0aGlzKS52YWwoKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL+iuoeeul+WPr+a3u+WKoOeahOmhueebrlxyXG4gICAgICAgICAgICBmb3IgKHZhciBkIGluIFdQcmljZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKFdQcmljZS5oYXNPd25Qcm9wZXJ0eShkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGlzdC5pbmRleE9mKFdQcmljZVtkXSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKFdQcmljZVtkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZyA9IGFyclthXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWwgKz0gJzxsaT4nICsgc2cgKyAnPC9saT4nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0ciArPSAnPHRyIGNsYXNzPVwiZGF0YVwiPiA8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJmeW10IGNob29zZVwiIHJlYWRvbmx5IHZhbHVlPVwi6K+36YCJ5oup6LS555So5ZCN56ewXCIvPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAnPHVsIGNsYXNzPVwic2UtcGFydCBkcC1uXCI+JyArIHVsICsgJzwvdWw+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJleC1qZVwiIHZhbHVlPVwiMFwiLz48L3RkPiA8dGQ+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZVwiPjwvc3Bhbj48L3RkPiA8L3RyPic7XHJcbiAgICAgICAgICAgICAgICAkKCcuemQtY2tmeScpLmZpbmQoJy50ci1hZGQnKS5iZWZvcmUoc3RyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZC1hZGQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBleGlzdCA9IFtdLCBhcnIgPSBbXSwgc3RyID0gJycsIHVsID0gJyc7XHJcbiAgICAgICAgICAgIC8v6I635Y+W5bey5a2Y5Zyo55qE6aG555uuXHJcbiAgICAgICAgICAgICQoJy56ZC1iZ2Z5JykuZmluZCgnLmZ5bXQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGV4aXN0LnB1c2goJCh0aGlzKS52YWwoKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL+iuoeeul+WPr+a3u+WKoOeahOmhueebrlxyXG4gICAgICAgICAgICBmb3IgKHZhciBkIGluIERQcmljZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKERQcmljZS5oYXNPd25Qcm9wZXJ0eShkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGlzdC5pbmRleE9mKERQcmljZVtkXSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKERQcmljZVtkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZyA9IGFyclthXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWwgKz0gJzxsaT4nICsgc2cgKyAnPC9saT4nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0ciArPSAnPHRyIGNsYXNzPVwiZGF0YVwiPiA8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJmeW10IGNob29zZVwiIHJlYWRvbmx5IHZhbHVlPVwi6K+36YCJ5oup6LS555So5ZCN56ewXCIvPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAnPHVsIGNsYXNzPVwic2UtcGFydCBkcC1uXCI+JyArIHVsICsgJzwvdWw+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8dGQ+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJleC1qZVwiIHZhbHVlPVwiMFwiLz48L3RkPiA8dGQ+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZVwiPjwvc3Bhbj48L3RkPiA8L3RyPic7XHJcbiAgICAgICAgICAgICAgICAkKCcuemQtYmdmeScpLmZpbmQoJy50ci1hZGQnKS5iZWZvcmUoc3RyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjemQtZW5zdXJlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJyID0gW10sIHcgPSBbXSwgZCA9IFtdLCB0b3RhbCA9IDA7XHJcbiAgICAgICAgICAgICQoJy56ZC1wYXJ0IC56ZC10YicpLmZpbmQoJ3RyLmRhdGEnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmZpbmQoJy5meW10JykudmFsKCkgIT0gJ+ivt+mAieaLqei0ueeUqOWQjeensCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBhcnIucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaXRlbU5hbWVcIjogJCh0aGlzKS5maW5kKCcuZnltdCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIml0ZW1QcmljZVwiOiBwYXJzZUZsb2F0KCQodGhpcykuZmluZCgnLmlwLWRqJykudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIml0ZW1Vbml0XCI6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaXRlbUNvdW50XCI6IHBhcnNlRmxvYXQoJCh0aGlzKS5maW5kKCcuaXAtemwnKS52YWwoKSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaXRlbVRvdGFsXCI6IHBhcnNlRmxvYXQoJCh0aGlzKS5maW5kKCcudHRwJykudmFsKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdG90YWwgKz0gcGFyc2VGbG9hdCgkKHRoaXMpLmZpbmQoJy50dHAnKS52YWwoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkKCcuemQtcGFydCAuemQtY2tmeScpLmZpbmQoJ3RyLmRhdGEnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmZpbmQoJy5meW10JykudmFsKCkgIT0gJ+ivt+mAieaLqei0ueeUqOWQjeensCcpIHtcclxuICAgICAgICAgICAgICAgICAgICB3LnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIml0ZW1OYW1lXCI6ICQodGhpcykuZmluZCgnLmZ5bXQnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpdGVtUHJpY2VcIjogJCh0aGlzKS5maW5kKCcuZXgtamUnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGFyZ2VFeEZlZVR5cGVcIjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpdGVtQ291bnRcIjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3YXJlSG91c2VJZFwiOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImRlY2xhcmVDb21wYW55SWRcIjogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVEdFwiOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIml0ZW1Ub3RhbFwiOiAkKHRoaXMpLmZpbmQoJy5leC1qZScpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkKCcuemQtcGFydCAuemQtYmdmeScpLmZpbmQoJ3RyLmRhdGEnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmZpbmQoJy5meW10JykudmFsKCkgIT0gJ+ivt+mAieaLqei0ueeUqOWQjeensCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBkLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIml0ZW1OYW1lXCI6ICQodGhpcykuZmluZCgnLmZ5bXQnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpdGVtUHJpY2VcIjogJCh0aGlzKS5maW5kKCcuZXgtamUnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGFyZ2VFeEZlZVR5cGVcIjogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpdGVtQ291bnRcIjogMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3YXJlSG91c2VJZFwiOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImRlY2xhcmVDb21wYW55SWRcIjogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVEdFwiOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIml0ZW1Ub3RhbFwiOiAkKHRoaXMpLmZpbmQoJy5leC1qZScpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIFwib3JkZXJJZFwiOiBzdG9wZ2FwLm9yZGVyLm9yZGVySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzZXJ2aWNlRmVlTGlzdFwiOiBhcnIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJvcmRlckNoYXJnaW5nVG90YWxcIjogdG90YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjaGFyZ2VTdGF0ZVwiOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIFwid2FyZUhvdXNlRmVlTGlzdFwiOiB3LFxyXG4gICAgICAgICAgICAgICAgICAgIFwiZGVjbGFyZUZlZUxpc3RcIjogZCxcclxuICAgICAgICAgICAgICAgICAgICBcIm9yZGVySGFzRmVlXCI6ICQoJyN3ZnknKS5wcm9wKCdjaGVja2VkJylcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBEYXRhLmNyZWF0ZUNoYXJnZShkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfliLbljZXmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+WItuWNleWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHByaWNlSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBEYXRhLnByaWNlTGlzdChmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCAmJiBqc29uLnJlc0JvZHkgJiYganNvbi5yZXNCb2R5LnNMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0ganNvbi5yZXNCb2R5LnNMaXN0O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYXJyW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5leHBlbnNlRGVmYXVsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZSBpbiBkLmV4cGVuc2VUZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmV4cGVuc2VUZW1wbGF0ZS5oYXNPd25Qcm9wZXJ0eShlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHQgPSBkLmV4cGVuc2VUZW1wbGF0ZVtlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFByaWNlW2R0Lml0ZW1OYW1lXSA9IGR0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIG9wSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBEYXRhLm9wTGlzdChmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9uID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwICYmIGpzb24ucmVzQm9keS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0ganNvbi5yZXNCb2R5IHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBhcnIubGVuZ3RoOyBhKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24gKz0gJzxvcHRpb24gdmFsdWU9XCInICsgYXJyW2FdLm1lbWJlcklkICsgJ1wiPicgKyBhcnJbYV0ubmFtZSArICc8L29wdGlvbj4nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkKCcjY3p5JykuaHRtbChvcHRpb24pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9uID0gJ+aaguaXoOaTjeS9nOWRmO+8jOivt+a3u+WKoO+8gSc7XHJcbiAgICAgICAgICAgICAgICAkKCcudHJhbnNmZXItcGFydCcpLmZpbmQoJy5kcC10YicpLmh0bWwob3B0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBleFByaWNlSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBEYXRhLmV4UHJpY2Uoe2lkOiAyfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgIERQcmljZSA9IGpzb24ucmVzQm9keSB8fCBbXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIERhdGEuZXhQcmljZSh7aWQ6IDF9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgV1ByaWNlID0ganNvbi5yZXNCb2R5IHx8IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsaXN0ZW5lcigpO1xyXG4gICAgICAgIGluaXQoKTtcclxuICAgICAgICB6ZFRhYmxlKCk7XHJcbiAgICAgICAgcHJpY2VJbml0KCk7XHJcbiAgICAgICAgb3BJbml0KCk7XHJcbiAgICAgICAgZXhQcmljZUluaXQoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJ1bjogcnVuXHJcbiAgICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzLkxpc3RlbmVyID0gTGlzdGVuZXI7Il19
