(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * Created by Auser on 2016/12/6.
 */
"use strict";
var Data = (function () {
    var extra = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/airline/extra'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var refuse = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/refuse'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var entry = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/entry'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var down = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/down/ossDown'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var up = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/down/ossUp'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var ossUpload = function (param, data, callback) {
        var _data = {};
        var formdata = new FormData();
        formdata.append("OSSAccessKeyId", param.AccessKeyId);
        formdata.append("policy", param.Policy);
        formdata.append("Signature", param.Signature);
        formdata.append("key", param.Keyname);
        formdata.append("Content-Disposition", "attachment;filename=\"" + data.name + "\"");
        formdata.append("file", data);
        $.ajax({
            url: param.UploadURL
            , data: formdata
            , processData: false
            , cache: false
            , async: false
            , contentType: false
            , type: 'post'
            , timeout: 100000
            , success: function () {
                _data = {
                    status: 1
                }
            }, error: function () {
                _data = {
                    status: -1
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var addFile = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/orderFile/add'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var removeFile = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/orderFile/remove'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var fileList = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/orderFile/list'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var getCode = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/airline/aircom'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var airport = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/airline/airport'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var gpSearch = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/gpSearch'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var submitChange = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/submitChange'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var personAdd = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/personAdd'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    //分单添加收发货人信息
    var subOrderpersonAdd = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/subOrderpersonAdd'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var contactList = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/receive'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var warehouse = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/detail'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var companyDetail = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/companyDetail'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var declareData = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/declareData'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var track = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/track'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var orderDetail = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/orderDetail'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    //费用数据引入
    var expenseTex = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/airline/expensetExmplate'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    //分单费用数据引入
    var zfexpenseTem = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/airline/zFexpenseTem'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var changeName = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/order/changeName'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    return {
        extra: extra
        , refuse: refuse
        , entry: entry
        , personAdd: personAdd
        , down: down
        , up: up
        , ossUpload: ossUpload
        , addFile: addFile
        , removeFile: removeFile
        , fileList: fileList
        , airport: airport
        , getCode: getCode
        , gpSearch: gpSearch
        , submitChange: submitChange
        , contactList: contactList
        , warehouse: warehouse
        , companyDetail: companyDetail
        , track: track
        , declareData: declareData
        , orderDetail: orderDetail
        , changeName: changeName
        , expenseTex: expenseTex
        ,zfexpenseTem:zfexpenseTem
    }
}());
module.exports.Data = Data;
},{}],2:[function(require,module,exports){
/**
 * Created by Auser on 2016/12/7.
 */
"use strict";
var Dom = (function () {
  var renderGp = function (data) {
    var str = '';
    if (data && 'resCode' in data && data.resCode == 0) {
      var json = data.resBody;
      if ('sList' in json && json.sList instanceof Array && json.sList.length > 0) {
        var list = json.sList;
        for (var l in list) {
          if (list.hasOwnProperty(l)) {
            var obj = list[l];
            str += render(obj);
          }
        }
        $('.gp-num').html('根据您的改配信息我们为您推荐 ' + list.length + ' 条航线，结果： ');
      } else {
        str = '<tr><td colspan="8">暂时没有您搜索的航线信息</td></tr>';
        $('.gp-num').html('根据您的改配信息我们为您推荐 0 条航线，结果： ');
      }
    } else {
      str = '<tr><td colspan="8">暂时没有您搜索的航线信息</td></tr>';
      $('.gp-num').html('根据您的改配信息我们为您推荐 0 条航线，结果： ');
    }
    $('.ctb-body tbody').html(str);
    function render(d) {
      var str = '';
      var arr = d.transPort || [];
      for (var a in arr) {
        if (arr.hasOwnProperty(a)) {
          str += arr[a].portCode + (a == arr.length - 1 ? '' : ' -> ')
        }
      }
      return '<tr> <td><input type="radio" name="gp-sg" data-id="' + d.airwayId + '"/></td> <td>' +
        ' <div class="port"> <span class="s">' + d.deptNode.portCode + '</span> <span>' + d.deptNode.portName + '</span>' +
        ' </div> <div class="logo"> <span class="top"></span> <span class="c">' + d.airCompanyCode + '</span> ' +
        '</div> <div class="port"> <span class="e">' + d.destNode.portCode + '</span> <span>' + d.destNode.portName + '</span> </div>' +
        ' </td> <td> <div class="lg"> ' + (str || '/') + '</div> <div class="days"> ' +
        '<span class="' + (d.flightDay.indexOf(1) >= 0 ? 'active' : '') + '">一</span> ' +
        '<span class="' + (d.flightDay.indexOf(2) >= 0 ? 'active' : '') + '">二</span> <span class="' + (d.flightDay.indexOf(3) >= 0 ? 'active' : '') + '">三</span> ' +
        '<span class="' + (d.flightDay.indexOf(4) >= 0 ? 'active' : '') + '">四</span> <span class="' + (d.flightDay.indexOf(5) >= 0 ? 'active' : '') + '">五</span> <span class="' + (d.flightDay.indexOf(6) >= 0 ? 'active' : '') + '">六</span>' +
        ' <span class="' + (d.flightDay.indexOf(7) >= 0 ? 'active' : '') + '">日</span> </div> </td>' +
        ' <td class="font-red">' + d.airwayPrice.rate[0].policy['45'] + '</td> <td class="font-red">' + d.airwayPrice.rate[0].policy['100'] + '</td>' +
        ' <td class="font-red">' + d.airwayPrice.rate[0].policy['300'] + '</td> <td class="font-red">' + d.airwayPrice.rate[0].policy['500'] + '</td> <td class="font-red">' + d.airwayPrice.rate[0].policy['1000'] + '</td> </tr>'
    }
  };
  var recommend = function (data) {
    var str = ''
      , num;
    if (data && 'resCode' in data && data.resCode == 0 && 'resBody' in data) {
      if ('list' in data.resBody && data.resBody.list instanceof Array && data.resBody.list.length > 0) {
        var list = data.resBody.list;
        for (var l in list) {
          if (list.hasOwnProperty(l)) {
            str += rend(list[l]);
          }
        }
        num = list.length;
      } else {
        str = '<tr class="wrong-msg"><td colspan="7">暂时没有本订单的推荐航线！</td></tr>';
        num = 0;
      }
    } else {
      str = '<tr class="wrong-msg"><td colspan="7">获取推荐航线失败，<a href="">请刷新重试</a>！</td></tr>';
      num = 0;
    }
    $('.rc-box').find('tbody').html(str);
    $('.rc-sum').html(num);
    function rend(d) {
      return '<tr><td>' + (d.AircompaName + d.FlightNo) + '</td>' +
        '<td>' + (d.OriginPort + d.OriginPortCode + '-' + d.Destport + d.DestportCode) + '</td>' +
        '<td>' + (d.IsDirect ? '直达' : '中转') + '</td>' +
        '<td>' + d.FlightTime + '</td>' +
        '<td>2016-08-12 12:30</td>' +
        '<td>CNY 20393.30</td>' +
        '<td><input type="radio" name="recommend"/></td></tr>'
    };
  };
  return {
    renderGp: renderGp
    , recommend: recommend
  }
}());
module.exports.Dom = Dom;
},{}],3:[function(require,module,exports){
/**
 * Created by Auser on 2016/12/2.
 */
"use strict";
require('../general').run();
require('./listener').run();
},{"../general":9,"./listener":4}],4:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/22.
 */
"use strict";
var Data = require('./data').Data
    , Dom = require('./dom').Dom;
var Modal = require('../frame/modal');
var url = require('../frame/function').url
    ,myformat = require('../frame/function').format;
require('../frame/burster');
//报价单数据
var Listener = (function () {
    var opeSid = '';
    var oId = $('#up-file').data('id');
    //待删除的元素
    var removeEle;
    //缓存删除内容
    var removeFile = {
        "orderId": oId,
        "keyName": 0
    };
    //现有航线&改配航线
    var now = {}, change = {};
    var listener = function () {
        $(document).on('click', '.reload', function () {
            location.reload();
        });
        $(document).on('click', '.close-btn', function () {
            $('.white-back').addClass('dp-n');
            $('.alert-part').addClass('dp-n');
        });
        $(document).on('click', '.show-change', function () {
            var ele = $('.change-part');
            ele.find('.gp-search input').each(function () {
                var v = $(this).data('v');
                $(this).val(v);
            });
            ele.find('.change-tb').addClass('dp-n');
            $('.white-back').removeClass('dp-n');
            ele.removeClass('dp-n');
        });
        $(document).on('click', '.show-dprice', function () {
            $('.white-back').removeClass('dp-n');
            $('.price-list').removeClass('dp-n');
        });
        $(document).on('click', '.show-other', function () {
            extraInit();
            $('.white-back').removeClass('dp-n');
            $('.other-list').removeClass('dp-n');
        });
        $(document).on('click', '.show-refuse', function () {
            $('.white-back').removeClass('dp-n');
            $('.refuse-part').removeClass('dp-n');
        });
        $(document).on('click', '.ensure-enter', function () {
            $('.white-back').removeClass('dp-n');
            $('.ensure-data').removeClass('dp-n');
        });
        $(document).on('click', 'a.rm', function () {
            removeFile['keyName'] = $(this).data('key');
            removeEle = $(this).parents('.up-part');
            $('.white-back').removeClass('dp-n');
            $('.remove-part').removeClass('dp-n');
        });
        $(document).on('click', 'a.rm-type', function () {
            removeFile['keyName'] = $(this).data('key');
            removeEle = $(this).parents('.add-type');
            $('.white-back').removeClass('dp-n');
            $('.remove-type-part').removeClass('dp-n');
        });
        $(document).on('click', 'a.dl', function () {
            var file = $(this).data('key');
            Data.down({file: file}, function (json) {
                if (json && 'resBody' in json) {
                    window.open(json.resBody);
                }
            });
        });
        $(document).on('click', '.dl-file', function () {
            var file = $(this).data('key');
            if (file != 0) {
                Data.down({file: file}, function (json) {
                    if (json && 'resBody' in json) {
                        window.open(json.resBody);
                    }
                });
            }
            //} else {
            //    Modal.setAlert('暂无' + $(this).find('.txt').html());
            //}
        });
        $(document).on('click', '#gp-s-btn', function () {
            var pass = true;
            $('.s-require').each(function () {
                if (!$(this).val()) {
                    $(this).addClass('warm');
                    pass = false;
                } else {
                    $(this).removeClass('warm');
                }
            });
            if (pass) {
                var data = {
                    "deptCode": $('#gp-start').val(),
                    "destCode": $('#gp-end').val(),
                    "flightDate": new Date($('#gp-time').val()),
                    "airCompanyCode": $('#gp-com').val(),
                    "transCount": 1,
                    "offset": 0,
                    "limit": 20
                };
                Data.gpSearch(data, function (json) {
                    Dom.renderGp(json);
                    $('.change-tb').removeClass('dp-n');
                });
            }
        });
        $(document).on('click', '#change-ensure', function () {
            change = null;
            now = {
                s: $('#gp-start').data('v')
                , e: $('#gp-end').data('v')
                , c: $('#gp-com').data('v')
                , d: $('#gp-time').data('v')
                , l: $('.hxlj').data('v')
            };
            var ele = $('input[name="gp-sg"]:checked');
            if (ele.length > 0 && ele.data('id')) {
                var tr = ele.parents('tr');
                change = {
                    s: tr.find('.s').text()
                    , e: tr.find('.e').text()
                    , c: tr.find('.c').text()
                    , d: $('#gp-time').val()
                    , l: tr.find('.lg').text()
                    , aid: tr.find('input[name="gp-sg"]').data('id')
                };
            }
            if (change) {
                $('.change-part').addClass('dp-n');
                var part = $('.ensure-change-part');
                part.find('.b-s').html(now.s);
                part.find('.b-e').html(now.e);
                part.find('.b-c').html(now.c);
                part.find('.b-d').html(now.d);
                part.find('.b-l').html(now.l);
                part.find('.a-s').html(change.s);
                part.find('.a-e').html(change.e);
                part.find('.a-c').html(change.c);
                part.find('.a-d').html(change.d);
                part.find('.a-l').html(change.l);
                part.removeClass('dp-n');
            }
        });
        $(document).on('click', '.close-btn-this', function () {
            $('.change-part').removeClass('dp-n');
            $('.ensure-change-part').addClass('dp-n');
        });
        $(document).on('click', '#submit-change', function () {
            var data = {
                "orderId": $(this).data('id'),
                "memberId": 0,
                "airwayId": change.aid,
                "flightDate": change.d
            };
            Data.submitChange(data, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    $('.ensure-change-part').addClass('dp-n');
                    $('.change-success').removeClass('dp-n');
                    var n = 3;
                    setInterval(function () {
                        if (n == 1) {
                            location.reload();
                        }
                        n--;
                        $('.left-seconds').html(n);
                    }, 1000);
                } else {
                    Modal.setAlert(json.resMsg || '改配失败，请重试！');
                }
            });
        });
        $(document).on('click', '.dl-price', function () {
            dlData['tzr'] = {
                name: fhr.contactName||''
                , address: fhr.contactAddress||''
                , tel: fhr.contactTel||''
            };
            dlData['btzr'] = {
                name: shr.contactName||''
                , address: shr.contactAddress||''
                , tel: shr.contactTel||''
            };
            //新添加通知人
            dlData['tzr'] = {
                name: tzr.contactName||''
                , address: tzr.contactAddress||''
                , tel: tzr.contactTel||''
            };
            $.ajax({
                url: '/api/down/bjd'
                , type: 'post'
                , data: {d: dlData, name: '报价单'}
                , dataType: 'json'
                , timeout: 100000
                , success: function (json) {
                    if ('status' in json && json.status == 1) {
                        window.open("/getImgCode/bjd");
                    }
                }
            });
        });
        $(document).on('click', '#dl-warehouse', function () {
            var code = '<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <title>Title</title> <style> * {margin: 0;padding: 0;}.container {width: 1200px;margin: 0 auto;padding: 20px 0;}.info {width: 50%;height: 30px;line-height: 30px;float: left;font-weight: 600;}.title {line-height: 50px;height: 50px;font-size: 20px;font-weight: 600;clear: both;}.time {height: 30px;line-height: 30px;text-align: right;}table {width: 100%;border-collapse: collapse;}td {height: 30px;text-align: center;border: 1px solid #ccc;}thead td {background: #666;color: #fff;} </style> </head> <body> <div class="container"> <p class="info">订单编号：' + $('.warehouse-tb').data('ddbh') + '<span></span></p> <p class="info">进仓编号：' + $('.warehouse-tb').data('jcbh') + '<span></span></p> <p class="info">客户名称：' + $('.warehouse-tb').data('khmc') + '<span></span></p> <p class="info">进仓状态：' + $('.warehouse-tb').data('jczt') + '<span></span></p> <p class="title">进仓明细</p> <table>' + $('.warehouse-tb').html() + '</table> <p class="time">导出时间：' + new Date().Format('yyyy-MM-dd') + '<span></span></p> </div> </body> </html>'
            $.ajax({
                url: '/api/down/pdf'
                , type: 'post'
                , data: {code: code, name: '进仓明细'}
                , dataType: 'json'
                , timeout: 100000
                , success: function (json) {
                    if ('status' in json && json.status == 1) {
                        window.open("/getImgCode/pdf");
                    }
                }
            });
        });
        $(document).on('click', '.dl-yld', function () {
            if (this.id =="main-yld") { //主单
                if ($('.yl-part').find('.dp-tb').find('.files').length == 0) {
                    $('.yl-part').find('.dp-tb').html('暂无预录单');
                }
            } else {
                if ($(this).find('.tmp').find('a').length == 0) {
                    $('.yl-part').find('.dp-tb').html('暂无预录单');
                } else {
                    $('.yl-part').find('.dp-tb').html($(this).find('.tmp').html());
                }
            }
            $('.white-back').removeClass('dp-n');
            $('.yl-part').removeClass('dp-n');
        });
    };

    //var extraInit = function () {
    //    var ele = $('.other-list');
    //    var data = {
    //        airCompanyCode: ele.data('id') || ''
    //    };
    //    Data.extra(data, function (json) {
    //        console.log(json);
    //        if (json && 'resCode' in json && json.resCode == 0) {
    //            var arr = json.resBody || []
    //                , str = '';
    //            for (var a in arr) {
    //                if (arr.hasOwnProperty(a)) {
    //                    var d = arr[a];
    //
    //                    str += '<tr><td>' + d.itemName + '</td><td>' + d.itemPrice + '</td><td>' + (d.itemRemark || '/') + '</td></tr>'
    //                }
    //            }
    //            ele.find('tbody').html(str);
    //        }
    //    });
    //};
    var submit = function () {
        $(document).on('click', '#refuse-ensure', function () {
            var ele = $(this);
            var id = $('input[name="reason"]:checked').prop('id');
            var txt = '';
            if (id == 'r5') {
                txt = $('#text-r4').val();
            } else {
                txt = $('#' + id).siblings('label').html();
            }
            var data = {
                "comment": txt,
                "orderId": ele.data('id')
            };
            Data.refuse(data, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    Modal.setAlert('取消成功！', null, function () {
                        location.reload();
                    });
                } else {
                    Modal.setAlert('取消失败，请重试！');
                }
            });
        });
        $(document).on('click', '#entry-ensure', function () {
            var data = {
                "memberId": 0,
                "orderId": $(this).data('id')
            };
            Data.entry(data, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    Modal.setAlert('确认成功！', null, function () {
                        location.reload();
                    });
                } else {
                    Modal.setAlert('确认失败，请重试！');
                }
            });
        });
        $(document).on('click', '#remove-ensure', function () {
            Data.removeFile(removeFile, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    removeEle.remove();
                    $('.white-back').addClass('dp-n');
                    $('.remove-part').addClass('dp-n');
                } else {
                    Modal.setAlert('删除失败，请重试！');
                }
            });
        });
        $(document).on('click', '#remove-type-ensure', function () {
            Data.removeFile(removeFile, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    removeEle.removeClass('active');
                    removeEle.find('.top').html('+');
                    var a = removeEle.find('.f-name');
                    a.html(a.data('name'));
                    removeEle.find('input').show();
                    $('.white-back').addClass('dp-n');
                    $('.remove-type-part').addClass('dp-n');
                } else {
                    Modal.setAlert('删除失败，请重试！');
                }
            });
        });
    };
    var upload = function () {
        $(document).on('change', '#up-file', function () {
            var arr = ['doc', 'docx', 'xls', 'xlsx', 'pdf', 'jpg', 'png', 'bmp'];
            var _this = $(this);
            var file = this.files[0]
                , size = this.files[0].size
                , name = this.files[0].name;
            var na = name.split('.');
            if (arr.indexOf(na[na.length - 1].toLowerCase()) >= 0) {
                if (size < 2097152) {
                    Data.up({"file": name}, function (json) {
                        var token;
                        if (json && 'resCode' in json && json.resCode == 0) {
                            token = json.resBody;
                        }
                        if (token) {
                            Data.ossUpload(token, file, function (data) {
                                if (data && 'status' in data && data.status > 0) {
                                    var d = {
                                        "orderId": _this.data('id'),
                                        "fileName": name,
                                        "fileComment": '',
                                        "keyName": token.Keyname
                                        , "fileType": 20
                                        , subNum: _this.data('sid') == 0 ? '' : _this.data('sid')
                                    };
                                    Data.addFile(d, function (json) {
                                        if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                                            var d = json.resBody;
                                            var str = '<div class="up-part"> <div class="top">' + d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> ' +
                                                '<a href="javascript:void(0);" class="rm" data-key="' + d.keyName + '"></a> ' +
                                                '</div> <a href="javascript:void(0);" class="dp-b">' + d.fileName + '</a> ' +
                                                '</div>';
                                            $('.upload').find('.add').before(str);
                                        } else {
                                            Modal.setAlert('上传失败！');
                                        }
                                    });
                                }
                            });
                        }
                    });
                } else {
                    Modal.setAlert('您上传的文件超过2M！请重新选择。');
                }
            } else {
                Modal.setAlert('文件格式支持.doc/.docx/.xls/.xlsx/.pdf/.jpg/.png/.bmp');
            }
        });
        $(document).on('change', '.up-type', function () {
            var arr = ['doc', 'docx', 'xls', 'xlsx', 'pdf', 'jpg', 'png', 'bmp'];
            var _this = $(this);
            var file = this.files[0]
                , size = this.files[0].size
                , name = this.files[0].name;
            var na = name.split('.');
            if (arr.indexOf(na[na.length - 1].toLowerCase()) >= 0) {
                if (size < 2097152) {
                    Data.up({"file": name}, function (json) {
                        var token;
                        if (json && 'resCode' in json && json.resCode == 0) {
                            token = json.resBody;
                        }
                        if (token) {
                            Data.ossUpload(token, file, function (data) {
                                if (data && 'status' in data && data.status > 0) {
                                    var d = {
                                        "orderId": _this.data('id'),
                                        "fileName": name,
                                        "fileComment": '',
                                        "keyName": token.Keyname
                                        , "fileType": _this.data('type')
                                    };
                                    Data.addFile(d, function (json) {
                                        if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                                            var d = json.resBody;
                                            var ele = _this.parents('.add-type');
                                            var str = d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> <a href="javascript:void(0);" class="rm-type" data-key="' + d.keyName + '"></a>'
                                            ele.addClass('active');
                                            ele.find('.top').html(str);
                                            ele.find('.f-name').html(d.fileName);
                                            ele.find('input').hide();
                                        } else {
                                            Modal.setAlert('上传失败！');
                                        }
                                    });
                                }
                            });
                        }
                    });
                } else {
                    Modal.setAlert('您上传的文件超过2M！请重新选择。');
                }
            } else {
                Modal.setAlert('文件格式支持.doc/.docx/.xls/.xlsx/.pdf/.jpg/.png/.bmp');
            }
        });
        $(document).on('change', '#up-file-fd', function () {
            var arr = ['doc', 'docx', 'xls', 'xlsx', 'pdf', 'jpg', 'png', 'bmp'];
            var _this = $(this);
            var file = this.files[0]
                , size = this.files[0].size
                , name = this.files[0].name;
            var na = name.split('.');
            if (arr.indexOf(na[na.length - 1].toLowerCase()) >= 0) {
                if (size < 2097152) {
                    Data.up({"file": name}, function (json) {
                        var token;
                        if (json && 'resCode' in json && json.resCode == 0) {
                            token = json.resBody;
                        }
                        if (token) {
                            Data.ossUpload(token, file, function (data) {
                                if (data && 'status' in data && data.status > 0) {
                                    var d = {
                                        "orderId": url.get('id'),
                                        "fileName": name,
                                        "fileComment": '',
                                        "keyName": token.Keyname
                                        , "fileType": 20
                                        , subNum: _this.data('sid') == 0 ? '' : _this.data('sid')
                                    };
                                    Data.addFile(d, function (json) {
                                        if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                                            var d = json.resBody;
                                            var str = '<div class="up-part"> <div class="top">' + d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> ' +
                                                '<a href="javascript:void(0);" class="rm" data-key="' + d.keyName + '"></a> ' +
                                                '</div> <a href="javascript:void(0);" class="dp-b">' + d.fileName + '</a> ' +
                                                '</div>';
                                            _this.parents('.ddfj-pub').find('.add').before(str);
                                        } else {
                                            Modal.setAlert('上传失败！');
                                        }
                                    });
                                }
                            });
                        }
                    });
                } else {
                    Modal.setAlert('您上传的文件超过2M！请重新选择。');
                }
            } else {
                Modal.setAlert('文件格式支持.doc/.docx/.xls/.xlsx/.pdf/.jpg/.png/.bmp');
            }
        });
    };
    var fileList = function () {
        Data.fileList({id: url.get('id'), sid: url.get('sid')}, function (json) {
            if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                var str = '';
                var arr = json.resBody;
                var data22 = 0;
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        var d = arr[a];
                        if (d.fileType == 20) {
                            str += '<div class="up-part"> <div class="top">' + d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> ' +
                                '<a href="javascript:void(0);" class="rm" data-key="' + d.keyName + '"></a> ' +
                                '</div> <a href="javascript:void(0);" class="dp-b">' + d.fileName + '</a> ' +
                                '</div>';
                        } else if (d.fileType == 22) {
                            data22 = 1;
                            $('.dl-file[data-type="' + d.fileType + '"]').data('key', d.keyName);
                        } else if (d.fileType == 21) {
                            var yld = '';
                            yld += '<div class="files"> <div class="top">' + arr[a].fileExtension.toUpperCase() + '<span class="glyphicon glyphicon-circle-arrow-down" data-key="' + arr[a].keyName + '"></span> </div> <a href="javascript:void(0);" class="dp-b">' + arr[a].fileName + '</a> </div>'
                            $('.yl-part').find('.dp-tb').append(yld);
                        } else {
                            var ele = $('.add-type[data-type=' + d.fileType + ']');
                            ele.addClass('active');
                            ele.find('input').hide();
                            ele.find('.top').html(d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> <a href="javascript:void(0);" class="rm-type" data-key="' + d.keyName + '"></a> ');
                            ele.find('.f-name').html(d.fileName);
                        }
                    }
                }
                if (data22 == 0) {
                    $('.dl[data-type="22"]').addClass('none-f');
                }
                $('.upload').find('.add').before(str);
            }
        });
    };
    var changeLine = function () {
        $('#gp-time').datetimepicker({
            format: 'yyyy-mm-dd',//日期的格式
            startDate: new Date($('#gp-time').val()),//选择器的开始日期
            autoclose: true,//日期选择完成后是否关闭选择框
            bootcssVer: 3,//显示向左向右的箭头
            language: 'zh-CN',//语言
            minView: "month"//表示日期选择的最小范围，默认是hour
        });
    };
    var airline = function () {
        $(document).on('blur', '#gp-end', function () {
            if (!$(this).prop('readonly')) {
                if (!$(this).prop('readonly')) {
                    var _this = $(this)
                        , ul = _this.siblings('.ajax-part');
                    var data = ul.children('.active').data('val') || ul.find('li:first-child').data('val') || '';
                    $(this).val(data);
                    $(this).data('val', data);
                    ul.hide();
                }
            }
        });
        $(document).on('keyup', '#gp-end', function (e) {
            if (!$(this).prop('readonly')) {
                var _this = $(this)
                    , ul = _this.siblings('.ajax-part');
                var index = ul.find('.active').index() || 0
                    , len = ul.children().length;
                if (e.keyCode == 13) {//回车键
                    var data = ul.children('.active').data('val') || ul.find('li:first-child').data('val') || '';
                    $(this).val(data);
                    $(this).data('val', data);
                    ul.hide();
                } else if (e.keyCode == 38) {//上键
                    index = index == 0 ? len - 1 : index - 1;
                    ul.find('li').removeClass('active');
                    ul.find('li').eq(index).addClass('active');
                } else if (e.keyCode == 40) {//下键
                    index = index == len - 1 ? 0 : index + 1;
                    ul.find('li').removeClass('active');
                    ul.find('li').eq(index).addClass('active');
                } else {//正常输入
                    Data.airport({key: _this.val()}, function (json) {
                        if (json && 'resBody' in json && json.resBody instanceof Array && json.resBody.length > 0) {
                            var str = ''
                                , body = json.resBody;
                            for (var b in body) {
                                if (body.hasOwnProperty(b)) {
                                    var d = body[b];
                                    str += '<li data-val="' + d.airportCode + '" class="' + (b == 0 ? 'active' : '') + '">' + d.displayName + '</li>'
                                }
                            }
                            ul.html(str);
                            ul.show();
                        }
                    });
                }
            }
        });
        $(document).on('mouseover', '.ajax-part li', function () {
            if (!$(this).prop('readonly')) {
                $(this).addClass('active');
                $(this).siblings().removeClass('active');
            }
        });
    };
    var getCompany = function () {
        //获取机场名称
        $(document).on('keyup', '#gp-com', function (e) {
            if (!$(this).prop('readonly')) {
                var _this = $(this)
                    , ul = _this.siblings('.ajax-part');
                var index = ul.find('.active').index() || 0
                    , len = ul.children().length;
                if (e.keyCode == 13) {//回车键
                    var data = ul.children('.active').data('val') || ul.find('li:first-child').data('val') || '';
                    $(this).val(data);
                    $(this).data('val', data);
                    ul.hide();
                } else if (e.keyCode == 38) {//上键
                    index = index == 0 ? len - 1 : index - 1;
                    ul.find('li').removeClass('active');
                    ul.find('li').eq(index).addClass('active');
                } else if (e.keyCode == 40) {//下键
                    index = index == len - 1 ? 0 : index + 1;
                    ul.find('li').removeClass('active');
                    ul.find('li').eq(index).addClass('active');
                } else {//正常输入
                    Data.getCode({key: _this.val()}, function (json) {
                        if (json && 'resBody' in json && json.resBody instanceof Array && json.resBody.length > 0) {
                            var str = ''
                                , body = json.resBody;
                            for (var b in body) {
                                if (body.hasOwnProperty(b)) {
                                    var d = body[b];
                                    str += '<li data-val="' + d.airlineCode + '" class="' + (b == 0 ? 'active' : '') + '">' + d.companyName + '</li>';
                                }
                            }
                            ul.html(str);
                            ul.show();
                        }
                    });
                }
            }
        });
        //input失去焦点
        $(document).on('blur', '#gp-com', function () {
            if (!$(this).prop('readonly')) {
                var ul = $(this).siblings('.ajax-part');
                var data = ul.children('.active').data('val') || ul.find('li:first-child').data('val') || '';
                $(this).val(data);
                $(this).data('val', data);
                ul.hide();
            }
        });
    };
    var contact = function () {
        var pb = {
            type: 1  //1为发货人操作，2为收货人操作，3为通知人
            , operate: 1  //1为新建操作，2为搜索操作
            , offset: 0  //搜索分页偏移量
            , limit: 5    //分页限制条数
            , data: {}  //缓存请求数据
        };
        $(document).on('click', '.close-c', function () {
            pb.offset = 0;
            $('.contact-modal').addClass('dp-n');
            $('.white-back').addClass('dp-n');
        });
        //收发货人信息编辑
        var sNm,sNc,sNn,sNe;
        //var spanText=function(obj,i){
        //    $('#s-name').val('');
        //    $('#s-dz').val('');
        //    $('#s-dh').val('');
        //    $('#s-person').val('');
        //    $('#s-mail').val('');
        //    $('#s-cz').val('');
        //    var parent=$(obj).parent().parent().find('span').eq(i).parent().clone();
        //    parent.find('span').remove();
        //    return parent.text();
        //    parent.remove();
        //};
        $(document).on('click', '.show-contact', function () {
            pb.type = $(this).data('t') == '收货人' ? 2 : 1;
            switch($(this).data('t')){
                case '收货人':
                    pb.type=2;
                    break;
                case '发货人':
                    pb.type=1;
                    break;
                case '通知人':
                    pb.type=3;
                    break;
            }
            opeSid = $(this).data('sid') || null;
            var ele = $('.contact-modal');
            var d;
            //var d = pb.type == 1 ? fhr : shr;
            switch(pb.type){
                case 1:
                    d=fhr;
                    break;
                case 2:
                    d=shr;
                    break;
                case 3:
                    d=tzr;
                    break;
                default:
                    break;
            }
            ele.find('.contact-page').html('');
            $('.ct-require').removeClass('warm');
            ele.find('.new').show();
            ele.find('.search').hide();
            ele.find('#save-contact').show();
            ele.find('#ensure-contact').hide();
            ele.find('#s-name').val(d.contactName || '');
            ele.find('#s-dz').val(d.contactAddress || '');
            ele.find('#s-person').val(d.contactPerson || '');
            ele.find('#s-dh').val(d.contactTel || '');
            ele.find('#s-mail').val(d.contactEmail || '');
            ele.find('#s-cz').val(d.contactFax || '');
            ele.find('.header').html($(this).data('t') + '设置<span class="close-c">X</span>');
            ele.find('.show-name').html($(this).data('t'));
            $('#c-name').val('');
            ele.find('tbody').html('<tr class="wrong"> <td colspan="5">请搜索</td> </tr>');
            ele.removeClass('dp-n');
            $('.white-back').removeClass('dp-n');
        });
        //收发货人信息编辑
        var sNm,sNc,sNn,sNe;
            //pb.type = $(this).data('t') == '收货人' ? 2 : 1;
            //$('#s-name').val('');
            //$('#s-dh').val('');
            //$('#s-person').val('');
            //$('#s-mail').val('');
            opeSid = $(this).data('sid') || null;
            var ele = $('.contact-modal');
        $(document).on('click', '.fd-top .show-contact', function () {
            switch($(this).data('t')){
                case '收货人':
                    pb.type=2;
                    sNm=$(this).parent().parent().find('.ocName').html();
                    sNc=$(this).parent().parent().find('.occp').html();
                    sNn=$(this).parent().parent().find('.ocTel').html();
                    sNe=$(this).parent().parent().find('.ocEmail').html();
                    break;
                case '发货人':
                    pb.type=1;
                    sNm=$(this).parent().parent().find('.osName').html();
                    sNc=$(this).parent().parent().find('.oscp').html();
                    sNn=$(this).parent().parent().find('.osTel').html();
                    sNe=$(this).parent().parent().find('.osEmail').html();
                    break;
                case '通知人':
                    pb.type=3;
                    sNm=$(this).parent().parent().find('.otName').html();
                    sNc=$(this).parent().parent().find('.otcp').html();
                    sNn=$(this).parent().parent().find('.otTel').html();
                    sNe=sNe=$(this).parent().parent().find('.otEmail').html();
                    break;
            };
            var sdz=$(this).data('dz') || '';
            var scz=$(this).data('fax') || '';
            ele.find('.contact-page').html('');
            $('.ct-require').removeClass('warm');
            ele.find('.new').show();
            ele.find('.search').hide();
            ele.find('#save-contact').show();
            ele.find('#ensure-contact').hide();
            ele.find('#s-name').val(sNm || '') ;
            ele.find('#s-dz').val(sdz || '');
            ele.find('#s-person').val(sNc || '');
            ele.find('#s-dh').val(sNn || '');
            ele.find('#s-mail').val(sNe || '');
            ele.find('#s-cz').val(scz || '');
            ele.find('.header').html($(this).data('t') + '设置<span class="close-c">X</span>');
            ele.find('.show-name').html($(this).data('t'));
            $('#c-name').val('');
            ele.find('tbody').html('<tr class="wrong"> <td colspan="5">请搜索</td> </tr>');
            ele.removeClass('dp-n');
            $('.white-back').removeClass('dp-n');

        });
        $(document).on('click', '.sel-tp span', function () {
            var ele = $('.contact-modal');
            pb.operate = $(this).data('tp');
            if (pb.operate == 1) {
                ele.find('.new').show();
                ele.find('#save-contact').show();
                ele.find('.search').hide();
                ele.find('#ensure-contact').hide();
            } else {
                ele.find('.new').hide();
                ele.find('#save-contact').hide();
                ele.find('.search').show();
                ele.find('#ensure-contact').show();
            }
        });
        //主单添加收发货人信息
        $(document).on('click', '#save-contact', function () {
            var ele = $('.contact-modal');
            var pass = true;
            $('.ct-require').each(function () {
                if ($(this).val()) {
                    $(this).removeClass('warm');
                } else {
                    $(this).addClass('warm');
                    pass = false;
                }
            });
            if (pass) {
                var data = {
                    "orderId": $(this).data('id'),
                    "memberId": 0,
                    "subNum": opeSid,
                    "contactType": pb.type,
                    "contactName": ele.find('#s-name').val(),
                    "contactAddress": ele.find('#s-dz').val(),
                    "contactPerson": ele.find('#s-person').val(),
                    "contactTel": ele.find('#s-dh').val(),
                    "contactFax": ele.find('#s-cz').val(),
                    "contactEmail": ele.find('#s-mail').val(),
                    "isSave": $('#s-save').prop('checked')
                };
                Data.personAdd(data, function (json) {
                    console.log(json);
                    if (json && 'resCode' in json && json.resCode == 0) {
                        Modal.setAlert('设置成功！', null, function () {
                            location.reload();
                        });
                    } else {
                        Modal.setAlert(json.resMsg || '设置失败，请重试！');
                    }
                });
            }
        });
        $(document).on('click', '#ensure-contact', function () {
            var id = $('input[name="c-sg"]:checked').data('id');
            if (id) {
                var d = pb.data[id];
                var ele = $('.contact-modal');
                var data = {
                    "orderId": $(this).data('id'),
                    "contactType": pb.type,
                    "subNum": opeSid,
                    "contactName": d.contactName,
                    "contactAddress": d.contactAddress,
                    "contactPerson": d.contactPerson,
                    "contactTel": d.contactTel,
                    "contactFax": d.contactFax,
                    "contactEmail": d.contactEmail,
                    "isSave": $('#s-save').prop('checked')
                };
                Data.personAdd(data, function (json) {
                    console.log(json);
                    if (json && 'resCode' in json && json.resCode == 0) {
                        Modal.setAlert('设置成功！', null, function () {
                            location.reload();
                        });
                    } else {
                        Modal.setAlert(json.resMsg || '设置失败，请重试！');
                    }
                });
            } else {
                Modal.setAlert('请选择一个收发货人！');
            }
        });
        $(document).on('click', '#search-p', function () {
            pb.offset = 0;
            cInit();
        });
        $(document).on('click', '.contact-page .pages', function () {
            pb.offset = $(this).data('offset');
            cInit();
        });
        var cInit = function () {
            var data = {
                tp: pb.type
                , key: $('#c-name').val()
                , offset: pb.offset
                , limit: pb.limit
            };
            Data.contactList(data, function (json) {
                var str = '';
                pb.data = {};
                if (json && 'resCode' in json && json.resCode == 0) {
                    var arr = json.resBody.sList;
                    if (arr.length > 0) {
                        for (var a in arr) {
                            if (arr.hasOwnProperty(a)) {
                                var d = arr[a];
                                pb.data[d.contactId] = d;
                                str += ' <tr> <td><input data-id="' + d.contactId + '" type="radio" name="c-sg"/></td>' +
                                    ' <td>' + d.contactName + '</td> <td>' + d.contactAddress + '</td> <td>' + d.contactPerson + '</td>' +
                                    ' <td>' + d.contactTel + '</td> </tr>';
                            }
                        }
                        $.burster($('.contact-page'), pb.offset || 0, json.resBody.totalCount, 5, pb.limit || 5);
                    } else {
                        str += '<tr class="wrong"> <td colspan="5">暂无收发货人，请添加！</td> </tr>';
                        $('.contact-page').html('');
                    }
                } else {
                    str += '<tr class="wrong"> <td colspan="5">请求出错，请重试！</td> </tr>';
                    $('.contact-page').html('');
                }
                $('.contact-modal').find('tbody').html(str);
            });
        };
    };
    console.log(dlData);
    var dlMap = function () {
        $(document).on('click', '#open_map', function () {
            Data.warehouse({id: $(this).data('id')}, function (json) {
                if (json && 'resCode' in json && json.resCode == 0) {
                    var d = json.resBody || {};
                    $('.w-name').html(d.warehouseName || '/');
                    $('.w-address').html(d.warehouseAddress || '/');
                    $('.w-tel').html(d.warehouseContact || '/' + '(电话：' + d.warehouseTel || '/' + '，传真：' + d.warehouseFax || '/' + ')');
                    Data.down({"file": d.warehouseMap}, function (body) {
                        if (body && 'resCode' in body && body.resCode == 0 && body.resBody) {
                            var ele = '<img alt="进仓地图" src="' + body.resBody + '"/>';
                            $('.map-main').html(ele);
                        }
                        $('#dl-map').click();
                        //$('.white-back').removeClass('dp-n');
                        //$('.map').removeClass('dp-n');
                    });
                }
            });
        });
        $(document).on('click', '#dl-map', function () {
            var ele = $('.dl-part').html();
            var str = '<!DOCTYPE html> <html lang="zh-CN"> <head> <meta charset="UTF-8"> <meta name="Generator" content="Jeremy"> <meta name="Author" content="Jeremy"> <meta name="Keywords" content=""> <meta name="Description" content=""> <title> 下载进仓地图 </title> <style>.body{width:1200px;margin:0 auto;}p{height:30px;line-height:30px;}p span{display:block;float:left;height:30px;line-height:30px;}.title{width:100px;text-align:left;}.map-main{height:600px;width:100%}img{height:100%;width:100%;} </style> </head> <body> <div class="body"> ' + ele + '</div> </body> </html>';
            $.ajax({
                url: '/api/down/pdf'
                , type: 'post'
                , data: {code: str, name: '进仓地图'}
                , dataType: 'json'
                , timeout: 100000
                , success: function (json) {
                    if ('status' in json && json.status == 1) {
                        window.open("/getImgCode/pdf");
                    }
                }
            });
        });
    };
    var dlBh = function () {
        var data = {
            agentCompanyId: 10000
            , airCompanyCode: dlData.hkgs
            , airportCode: dlData.qyg
        };
        Data.companyDetail(data, function (json) {
            var str = '';
            if (json && 'resBody' in json && json.resBody instanceof Array) {
                var arr = json.resBody;
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        str += '<div class="files"> <div class="top">' + arr[a].fileExtension.toUpperCase() + '<span class="glyphicon glyphicon-circle-arrow-down" data-key="' + arr[a].keyName + '"></span> </div> <a href="javascript:void(0);" class="dp-b">' + arr[a].fileName + '</a> </div>'
                    }
                }
            } else {
                str = '<div class="no-file">暂无保函！</div>'
            }
            $('.bh-part').find('.dp-tb').html(str);
        });
        $(document).on('click', '.dl-bh', function () {
            $('.white-back').removeClass('dp-n');
            $('.bh-part').removeClass('dp-n');
        });
        $(document).on('click', '.glyphicon-circle-arrow-down', function () {
            if ($(this).data('type') == 'yld') {
                location.href = '/vip/order/detail/yld?id=' + $(this).data('key');
            } else if ($(this).data('type') == 'ckd') {
                location.href = '/vip/order/detail/ckd?id=' + $(this).data('key');
            } else {
                var file = $(this).data('key');
                Data.down({file: file}, function (json) {
                    if (json && 'resBody' in json) {
                        window.open(json.resBody);
                    }
                });
            }
        });
    };
    var trackInit = function () {
        var str = '';
        var id = $('#ydh').data('no');
        if (id != 0) {
            Data.track({id: id}, function (json) {
                if (json && 'resBody' in json && json.resBody) {
                    var b = json.resBody;
                    if ('trackList' in b && b.trackList instanceof Array && b.trackList.length > 0) {
                        var arr = b.trackList;
                        for (var a in arr) {
                            if (arr.hasOwnProperty(a)) {
                                var d = arr[a];
                                str += '<tr><td>' + d.itemDate + '</td><td>' + d.itemLocation + '</td>' +
                                    '<td>' + d.itemCode + '</td><td>' + d.itemDescription + '</td>' +
                                    '<td>' + d.cargoCount + '</td><td>' + d.cargoWeight + '</td></tr>'
                            }
                        }
                        $('.ydtb').find('tbody').html(str);
                        $('.ydtb').show();
                    }
                }
            });
        }
    };
    var declareData = function () {
        Data.declareData({id: url.get('id')}, function (json) {
            var str = '';
            if (json && 'resBody' in json && json.resBody) {
                str += '<div class="files"> <div class="top">PDF<span data-type="yld" class="glyphicon glyphicon-circle-arrow-down" data-key="' + url.get('id') + '"></span> </div> <a href="javascript:void(0);" class="dp-b">电子预录单</a> </div>' +
                    '<div class="files"> <div class="top">PDF<span data-type="ckd" class="glyphicon glyphicon-circle-arrow-down" data-key="' + url.get('id') + '"></span> </div> <a href="javascript:void(0);" class="dp-b">放行通知书</a> </div>';
            }
            $('.yl-part').find('.dp-tb').append(str);
        });
    };
    var subData = function () {
        $(document).on('change', '.td-sg,.fd-sg', function () {
            $(this).parents('tr').css('background-color', $(this).prop('checked') ? '#c7edff' : '#fff');
        });
        $(document).on('click', '#sel-td', function () {
            $('.td-sg').prop('checked', $(this).prop('checked')).trigger('change');
        });
        $(document).on('click', '#sel-fd-all', function () {
            var tb = $(this).parents('table');
            tb.find('.fd-sg').prop('checked', $(this).prop('checked')).trigger('change');
        });
        $(document).on('click', '.sg-tab', function () {
            $(this).addClass('active');
            $('#' + $(this).data('tar')).addClass('active');
            $(this).siblings().removeClass('active');
            $('#' + $(this).data('tar')).siblings().removeClass('active');
            $('#cdd').prop('disabled', $(this).data('tar') == 'wfdhw');
        });
        $(document).on('click', '.yfd-btn', function () {
            var _this = $(this);
            _this.find('.fl-r').html(_this.find('.fl-r').html() == '+展开' ? '-收起' : '+展开');
            var tar = $($(this).data('target'));
            if (_this.data('time') == 0) {
                $('.loading-part').show();
                Data.orderDetail({
                    orderId: url.get('id')
                    , subOrderNum: $(this).data('id')
                    , agentCompanyId: 10000
                }, function (json) {
                    if (json && 'resCode' in json && json.resCode == 0) {
                        _this.data('time', 1);
                        var str = '';
                        var body = json.resBody || {};
                        var o = 'order' in body && body.order || {};
                        //if(o.orderShipper && o.orderShipper in o && 'contactName' in o.orderShipper && o.orderShipper.contactName && o.orderShipper.contactName=='null'){
                        //
                        //}else{
                        //
                        //}
                        //发货人信息拼接
                        str += '<div class="fd-top fill">'
                        if (o.orderShipper && 'contactName' in o.orderShipper && o.orderShipper.contactName && o.orderShipper.contactName!='null' ) {
                            str += '<div class="fd-info"> <p class="title">发货人信息 <a href="javascript:void(0);" class="show-contact" data-t="发货人" data-sid="' + (o.subNum || 0) + '" data-dz="' + o.orderShipper.contactAddress + '" data-fax="' + o.orderShipper.contactFax + '">编辑</a> </p>';
                            str += '<p class="osName">' + o.orderShipper.contactName + '</p> <p class="oscp">' + o.orderShipper.contactPerson + '</p> <p class="osTel">' + o.orderShipper.contactTel + '</p> <p class="osEmail">' + o.orderShipper.contactEmail + '</p> </div>';
                        } else {
                            str += '<div class="fd-info"> <p class="title">发货人信息 <a href="javascript:void(0);" class="show-contact" data-t="发货人" data-sid="' + (o.subNum || 0) + '" data-dz="' + o.orderShipper.contactAddress + '" data-fax="' + o.orderShipper.contactFax + '">编辑</a>  </p>';
                            str += '<p class="no-sfhr">暂无发货人信息</p></div>'
                        }
                        //收货人信息拼接
                        if (o.orderConsignee && 'contactName' in o.orderConsignee && o.orderConsignee.contactName && o.orderConsignee.contactName!='null') {
                            str += '<div class="fd-info">' +
                                '<p class="title">收货人信息 ' +
                                '<a href="javascript:void(0);" class="show-contact" data-t="收货人" data-sid="' + (o.subNum || 0) + '" data-dz="' + o.orderConsignee.contactAddress  + '" data-fax="' + o.orderConsignee.contactFax + '">编辑</a>' +
                                '</p>';
                            str += '<p class="ocName">' + o.orderConsignee.contactName + '</p> ' +
                                '<p class="occp">' + o.orderConsignee.contactPerson + '</p> ' +
                                '<p class="ocTel">' + o.orderConsignee.contactTel + '</p>' +
                                ' <p class="ocEmail">' + o.orderConsignee.contactEmail + '</p>' +
                                ' </div>';
                        } else {
                            str += '<div class="fd-info"> ' +
                                '<p class="title">收货人信息 ' +
                                '<a href="javascript:void(0);" class="show-contact" data-t="收货人" data-sid="' + (o.subNum || 0) + '" data-dz="' + o.orderConsignee.contactAddress + '" data-fax="' + o.orderConsignee.contactFax + '">编辑</a>' +
                                ' </p>';
                            str += '<p class="no-sfhr">暂无收货人信息</p></div>'
                        }
                        //通知人信息拼接
                        if (o.orderNotifier && 'contactName' in o.orderNotifier && o.orderNotifier.contactName && o.orderNotifier.contactName!='null') {
                            str += '<div class="fd-info"> <p class="title">通知人信息 <a href="javascript:void(0);" class="show-contact" data-t="通知人" data-sid="' + (o.subNum || 0) + '" data-dz="' + o.orderNotifier.contactAddress + '" data-fax="' + o.orderNotifier.contactFax + '">编辑</a> </p>';
                            str += '<p class="otName">' + o.orderNotifier.contactName + '</p> <p class="otcp">' + o.orderNotifier.contactPerson + '</p> <p class="otTel">' + o.orderNotifier.contactTel + '</p> <p class="otEmail">' + o.orderNotifier.contactEmail + '</p> </div>';
                        } else {
                            str += '<div class="fd-info"> <p class="title">通知人信息 <a href="javascript:void(0);" class="show-contact" data-t="通知人" data-sid="' + (o.subNum || 0) + '" data-dz="" data-fax="">编辑</a> </p>';
                            str += '<p class="no-sfhr">暂无通知人信息</p></div>'
                        }
                        //品名拼
                        str += '<div class="fd-info"><p class="title">品名 <a href="javascript:void(0);" class="cg-name-btn" data-id="' + o.orderId + '" data-sid="' + o.subNum + '" data-name="' + o.subCargoName + '" data-mark="' + (o.cargo.packageMark || '') + '">编辑</a> </p> <p>' + o.subCargoName + '</p> </div>';
                        str += '<div class="fd-info"><p class="title">唛头 </p><p>' + (o.cargo.packageMark || '') + '</p> </div></div>';
//markName
                        //拼接table
                        str += '<div class="fd-middle"> <p class="title">分单货物信息 <a href="/vip/order/detail/ensure?id=' + o.orderId + '&sid=' + o.subNum + '" target="_blank" class="fl-r">查看分单</a> </p><table border="1" class="mg-b">' +
                            ' <thead> <tr>  <td>进仓编号</td> <td>长(CM)</td> <td>宽(CM)</td> <td>高(CM)</td> <td>件数(PCS)</td> <td>重量(KGS)</td> <td>体积(CBM)</td> <td>包装</td> <td>损毁</td> <td>变形</td> <td>受潮</td> <td>其他</td> <td>备注</td> </tr> </thead> <tbody>';
                        var storage = 'storage' in body && body.storage || {};
                        var entryList = 'entryList' in storage && storage.entryList || [];
                        var zjjs = 0, zjzl = 0, zjtj = 0, zjps = 0, zjbx = 0, zjsc = 0, zjqt = 0,xindan=0;
                        for (var e in entryList) {
                            if (entryList.hasOwnProperty(e)) {
                                var dt1 = entryList[e];
                                var dt = entryList[e].entryDetail;
                                var xjjs = 0, xjzl = 0, xjtj = 0, xjps = 0, xjbx = 0, xjsc = 0, xjqt = 0;
                                for (var d1 in dt) {
                                    if (dt.hasOwnProperty(d1)) {
                                        var d = dt[d1];
                                        xjjs += d.itemCount;
                                        zjjs += d.itemCount;
                                        xjtj += d.itemCount * d.itemHeight * d.itemLength * d.itemWidth / 1000000;
                                        zjtj += d.itemCount * d.itemHeight * d.itemLength * d.itemWidth / 1000000;
                                        str += '<tr> <td>' + dt1.entryNum + '</td> ' +
                                            '<td>' + d.itemLength + '</td> <td>' + d.itemWidth + '</td> <td>' + d.itemHeight + '</td>' +
                                            ' <td>' + d.itemCount + '</td> <td>-</td> <td>' + myformat.formatvolume(d.itemCount * d.itemHeight * d.itemLength * d.itemWidth / 1000000) + '</td> ' +
                                            '<td>' + dt1.packageType + '</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr>';
                                    }
                                }
                                zjzl = o.cargo.cargoWeight;
                                //xindan=
                                zjps += dt1.damageCount;
                                zjbx += dt1.transformCount;
                                zjsc += dt1.dampCount;
                                zjqt += dt1.otherCount;
                                str += '<tr class="tr-xj"> <td>小计</td> <td colspan="3" class="font-g">更新时间（' + dt1.storageTime + '）</td>' +
                                    ' <td>' + xjjs + '</td> <td>-</td> <td>' + myformat.formatvolume(xjtj) + '</td> <td></td>' +
                                    '<td>' + (dt1.damageCount || '-') + '</td> <td>' + (dt1.transformCount || '-') + '</td> <td>' + (dt1.dampCount || '-') + '</td> <td>' + (dt1.otherCount || '-') + '</td> <td>-</td> </tr>'
                            }
                        }
                        str += '<tr class="tr-zj"> <td>总计</td> <td colspan="3"></td> <td>' + zjjs + '</td> ' +
                            '<td>' + zjzl + '</td> <td>' + myformat.formatvolume(zjtj) + '</td> <td></td> <td>' + (zjps || '') + '</td>' +
                            ' <td>' + (zjbx || '') + '</td> <td>' + (zjsc || '') + '</td> <td>' + (zjqt || '') + '</td> <td></td> </tr></tbody></table></div>';
                        //订单附件拼接
                        str += '<div class="fd-bottom"><div class="ddfj-pub fill"><p class="title fill"><span class="one">分单相关文件</span> ' +
                            '<span class="two"><span class="wxts">温馨提示：</span>请尽快上传报关单、报关委托书、装箱单、发票等资料，文件格式支持.doc/.docx/.xls/.xlsx/.pdf/.jpg/.png/.bmp' +
                            '<br>请检查资料证件上传是否齐全，如果齐全，可向报关行</span></p><div class="add" data-sid="' + o.subNum + '"> <div class="top"> + </div> <a href="javascript:void(0);" class="dp-b">添加文件</a> <input type="file" id="up-file-fd" data-sid="' + o.subNum + '"> </div></div></div>';
                        //下载打印文件
                        str +='<div class="fd-fileDown"><p class="title">文件下载</p><div class="left">' +
                            '<p>下载/打印文件</p>'+
                                //<div class="dp-b fl-l dl" id="open_map" data-id="<%= o.warehouseId %>">
                                //<a href="javascript:void(0);">
                                //<span class="dp-b img">图</span>
                                //<span class="dp-b txt">进仓地图</span>
                                //</a>
                                //
                                //<div class="cover dp-n"></div>
                                //</div>
                                //<div class="dp-b fl-l dl dl-bh" data-id="<%= o.airwayId %>">
                                //<a href="javascript:void(0);">
                                //<span class="dp-b img">保</span>
                                //<span class="dp-b txt">货物保函</span>
                                //</a>
                                //
                                //<div class="cover dp-n"></div>
                                //</div>
                                //<div class="dp-b fl-l dl dl-price">
                                //<a href="javascript:void(0);">
                                //<span class="dp-b img">报</span>
                                //<span class="dp-b txt">导出报价单</span>
                                //</a>
                                //
                                //<div class="cover dp-n"></div>
                                //</div>
                            '<div class="dp-b fl-l dl dl-yld" data-type="21" data-key="0"><a href="javascript:void(0);"><span class="dp-b img">预</span><span class="dp-b txt">预录单</span></a><div class="cover dp-n"></div><div class="tmp dp-n"></div></div>'+
                            '<div class="dp-b fl-l dl dl-file" data-type="22" data-key="0"><a href="javascript:void(0);"><span class="dp-b img">查</span><span class="dp-b txt">查验费用单</span></a> <div class="cover dp-n"></div></div>'+
                            '</div></div>';
                        tar.html(str);
                        tar.collapse('toggle');
                        var data22=0;
                        Data.fileList({id: url.get('id'), sid: o.subNum || ''}, function (json) {
                            if (json && 'resCode' in json && json.resCode == 0 && json.resBody) {
                                var str = '';
                                var arr = json.resBody;
                                for (var a in arr) {
                                    if (arr.hasOwnProperty(a)) {
                                        var d = arr[a];
                                        if (d.fileType == 20) {
                                            str += '<div class="up-part"> <div class="top">' + d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> ' +
                                                '<a href="javascript:void(0);" class="rm" data-key="' + d.keyName + '"></a> ' +
                                                '</div> <a href="javascript:void(0);" class="dp-b">' + d.fileName + '</a> ' +
                                                '</div>';
                                        } else if (d.fileType == 22) {
                                            data22=1;
                                           // $('.dl-file[data-type="' + d.fileType + '"]').data('key', d.keyName);
                                            _this.parent().find('.fd-info-body').find('.fd-fileDown').find(".dl-file").data('key', d.keyName);
                                        } else if (d.fileType == 21) {
                                            var yld = '';
                                            yld += '<div class="up-part"> <div class="top">' + arr[a].fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl glyphicon glyphicon-circle-arrow-down" data-key="' + d.keyName + '"></a> </div> <a href="javascript:void(0);" class="dp-b">' + arr[a].fileName + '</a> </div>'
                                            //$('.fxtzs-fill').append(yld);
                                            _this.parent().find('.fd-info-body').find('.fd-fileDown').find('.tmp').append(yld);
                                            $('.fxtzs').show();
                                        } else {
                                            var ele = $('.add-type[data-type=' + d.fileType + ']');
                                            ele.addClass('active');
                                            ele.find('input').hide();
                                            ele.find('.top').html(d.fileExtension.toUpperCase() + '<a href="javascript:void(0);" class="dl" data-key="' + d.keyName + '"></a> <a href="javascript:void(0);" class="rm-type" data-key="' + d.keyName + '"></a> ');
                                            ele.find('.f-name').html(d.fileName);
                                        }
                                    }
                                }
                                if(data22==0){
                                    $('.dl[data-type="22"]').addClass('none-f');
                                }
                                $('.add[data-sid="' + o.subNum + '"]').before(str);
                            }
                        });
                    } else {
                        Modal.setAlert('获取分单详情失败，请重试！');
                    }
                    $('.loading-part').hide();
                });
            } else {
                tar.collapse('toggle');
            }
        });
        $(document).on('click', '.yfd-sg', function (event) {
            event.stopPropagation();
        });
    };
    var createSub = function () {
        var type = {
            cf: 0,     //0是未拆分过的，1是拆分过的
            n: 0,         //0是拆往新订单，1是拆往已有订单
            sid: ''    //已拆分过的分单号
            , tosdi: ''  //拆往哪个订单
            , oriwei: ''   //已拆分重量
            , arr: []   //转移的货物数据
        };
        var initModal = function () {
            $('.w-e').hide();
            $('.y-n').hide();
            $('.y-e').hide();
            $('.fd-alert-part').find('input[type="text"]').val('');
            $('#czxfd').triggle('click');
        };
        $(document).on('change', '#yyfd-fdh', function () {
            var opt = $(this).find('option:selected');
            var ele = $('.fd-alert-part');
            ele.find('.mbfd').html(opt.val());
            ele.find('.mb').find('.ori-wei').html(opt.data('wei'))
        });
        $(document).on('click', 'input[name="sel-fd-type"]', function () {
            $('.w-e').hide();
            $('.y-n').hide();
            $('.y-e').hide();
            $('.fd-alert-part').find('.f-pt').show();
            $('.fd-alert-part').find('.s-pt').hide();
            var ele = $('.alert-body');
            var n = ele.find('.new');
            var e = ele.find('.exist');
            if ($('input[name="sel-fd-type"]:checked').val() == 1) {
                type.n = 0;
                n.show();
                e.hide();
            } else {
                type.n = 1;
                n.hide();
                e.show();
            }
        });
        $(document).on('click', '#w-cfd', function () {
            type.cf = 0;
            type.sid = null;
            var arr = [];
            var table = $(this).parent().siblings('table');
            table.find('.td-sg:checked').each(function () {
                var d = JSON.parse($(this).data('dt').replace(/\'/g, "\""));
                d['warehouseEntryNum'] = $(this).data('enum');
                arr.push(d);
            });
            type.arr = arr;
            if (table.find('.td-sg:checked').length > 0) {
                Data.NewSubNum({orderId: url.get('id')}, function (json) {
                    var num = json && 'resBody' in json && json.resBody || '';
                    $('#nfd-fdh').val(num);
                    $('.white-back').removeClass('dp-n');
                    $('.fd-alert-part').removeClass('dp-n');
                });
            }
        });
        $(document).on('click', '.ycf-cfd', function () {
            type.cf = 1;
            type.sid = $(this).data('id');
            type.oriwei = $(this).data('wei');
            var arr = [];
            var table = $(this).parent().siblings('table');
            table.find('.fd-sg:checked').each(function () {
                var d = JSON.parse($(this).data('dt').replace(/\'/g, "\""));
                d['warehouseEntryNum'] = $(this).data('enum');
                arr.push(d);
            });
            type.arr = arr;
            if (table.find('.fd-sg:checked').length > 0) {
                Data.NewSubNum({orderId: url.get('id')}, function (json) {
                    var num = json && 'resBody' in json && json.resBody || '';
                    $('#nfd-fdh').val(num);
                    $('.white-back').removeClass('dp-n');
                    $('.fd-alert-part').removeClass('dp-n');
                });
            }
        });
        $(document).on('click', '#create-fd', function () {
            var _this = $(this);
            var pass = true;
            if (type.cf == 0 && type.n == 0) {//未拆分货物拆往新分单
                $('.nfd-required').each(function () {
                    if (!$(this).val()) {
                        pass = false;
                        $(this).addClass('warm');
                    } else {
                        $(this).removeClass('warm');
                    }
                });
                if (pass) {
                    var data = {
                        "orderId": url.get('id'),
                        "orderSubNum": $('#nfd-fdh').val(),
                        "cargoName": $('#nfd-pm').val(),
                        "weight": $('#nfd-zl').val(),
                        "entryItemList": type.arr
                    };
                    Data.newStorage(data, function (json) {
                        if (json && 'resCode' in json && json.resCode == 0) {
                            Modal.setAlert('分单创建成功!', null, function () {
                                location.reload();
                            });
                        } else {
                            Modal.setAlert(json.resMsg || '分单创建失败，请重试！');
                        }
                    });
                }
            }
            if (type.cf == 0 && type.n == 1) {//未拆分货物拆往已有分单
                if ($('#yyfd-fdh').find('option').length > 0) {
                    var we = $('.w-e');
                    var option = $('#yyfd-fdh').find('option:selected');
                    we.find('.mbfd').html(option.val());
                    we.find('.ori-wei').html(option.data('wei'));
                    we.siblings().hide();
                    we.show();
                    _this.parent().find('.f-pt').hide();
                    _this.parent().find('.s-pt').show();
                } else {
                    Modal.setAlert('暂无可选分单，请拆至新分单！');
                }
            }
            if (type.cf == 1 && type.n == 0) {
                $('.nfd-required').each(function () {
                    if (!$(this).val()) {
                        pass = false;
                        $(this).addClass('warm');
                    } else {
                        $(this).removeClass('warm');
                    }
                });
                if (pass) {
                    var yn = $('.y-n');
                    yn.siblings().hide();
                    yn.show();
                    yn.find('.body').html(type.oriwei + ' KG');
                    _this.parent().find('.f-pt').hide();
                    _this.parent().find('.s-pt').show();
                }
            }
            if (type.cf == 1 && type.n == 1) {
                if ($('#yyfd-fdh').find('option').length > 0) {
                    var ye = $('.y-e');
                    var option = $('#yyfd-fdh').find('option:selected');
                    ye.find('.mbfd').html(option.val());
                    ye.find('.bcfd').html(type.sid);
                    ye.find('.mb').find('.ori-wei').html(option.data('wei'));
                    ye.find('.bc').find('.ori-wei').html(option.data('wei'));
                    ye.siblings().hide();
                    ye.show();
                    _this.parent().find('.f-pt').hide();
                    _this.parent().find('.s-pt').show();
                } else {
                    Modal.setAlert('暂无可选分单，请拆至新分单！');
                }
            }
        });
        $(document).on('click', '#fd-tz', function () {
            if (type.cf == 0 && type.n == 1) {//未拆分货物拆往已有分单
                if ($('#w-e--n-w').val()) {
                    $('#w-e--n-w').removeClass('warm');
                    var data = {
                        "orderId": url.get('id'),
                        "subNum": $('#yyfd-fdh').find('option:selected').val(),
                        "cargoName": "",
                        "entryItemList": type.arr,
                        "weight": $('#w-e--n-w').val()
                    };
                    Data.addStorage(data, function (json) {
                        if (json && 'resCode' in json && json.resCode == 0) {
                            Modal.setAlert('分单操作成功!', null, function () {
                                location.reload();
                            });
                        } else {
                            Modal.setAlert(json.resMsg || '分单操作失败，请重试！');
                        }
                    });
                } else {
                    $('#w-e--n-w').addClass('warm');
                }
            }
            if (type.cf == 1 && type.n == 0) {
                if ($('#y-n-xzl').val()) {
                    $('#y-n-xzl').removeClass('warm');
                    var d1 = {
                        "orderId": url.get('id'),
                        "subNum": type.sid,
                        "subNumTo": $('#nfd-fdh').val(),
                        "cargoName": $('#nfd-pm').val(),
                        "entryItemList": type.arr,
                        "weight": $('#y-n-xzl').val(),
                        "weightTo": $('#nfd-zl').val()
                    };
                    Data.moveStorage(d1, function (json) {
                        if (json && 'resCode' in json && json.resCode == 0) {
                            Modal.setAlert('分单操作成功!', null, function () {
                                location.reload();
                            });
                        } else {
                            Modal.setAlert(json.resMsg || '分单操作失败，请重试！');
                        }
                    });
                } else {
                    $('#y-n-xzl').addClass('warm');
                }
            }
            if (type.cf == 1 && type.n == 1) {
                if ($('#y-e-b-zl').val() && $('#y-e-mb-zl').val()) {
                    $('#y-e-b-zl').removeClass('warm');
                    $('#y-e-mb-zl').removeClass('warm');
                    var d2 = {
                        "orderId": url.get('id'),
                        "subNum": type.sid,
                        "subNumTo": $('#yyfd-fdh').find('option:selected').val(),
                        "cargoName": '',
                        "entryItemList": type.arr,
                        "weight": $('#y-e-b-zl').val(),
                        "weightTo": $('#y-e-mb-zl').val()
                    };
                    Data.moveStorage(d2, function (json) {
                        if (json && 'resCode' in json && json.resCode == 0) {
                            Modal.setAlert('分单操作成功!', null, function () {
                                location.reload();
                            });
                        } else {
                            Modal.setAlert(json.resMsg || '分单操作失败，请重试！');
                        }
                    });

                } else {
                    if (!$('#y-e-b-zl').val()) {
                        $('#y-e-b-zl').addClass('warm');
                    } else {
                        $('#y-e-b-zl').removeClass('warm');
                    }
                    if (!$('#y-e-mb-zl').val()) {
                        $('#y-e-mb-zl').addClass('warm');
                    } else {
                        $('#y-e-mb-zl').removeClass('warm');
                    }
                }
            }
        });
        $(document).on('click', '#fd-btz', function () {
            if (type.cf == 0 && type.n == 1) {//未拆分货物拆往已有分单
                var data = {
                    "orderId": url.get('id'),
                    "subNum": $('#yyfd-fdh').find('option:selected').val(),
                    "cargoName": "",
                    "entryItemList": type.arr,
                    "weight": $('.w-e').find('.ori-wei').html()
                };
                Data.addStorage(data, function (json) {
                    if (json && 'resCode' in json && json.resCode == 0) {
                        Modal.setAlert('分单操作成功!', null, function () {
                            location.reload();
                        });
                    } else {
                        Modal.setAlert(json.resMsg || '分单操作失败，请重试！');
                    }
                });
            }
            if (type.cf == 1 && type.n == 0) {
                var d1 = {
                    "orderId": url.get('id'),
                    "subNum": type.sid,
                    "subNumTo": $('#nfd-fdh').val(),
                    "cargoName": $('#nfd-pm').val(),
                    "entryItemList": type.arr,
                    "weight": type.oriwei,
                    "weightTo": $('#nfd-zl').val()
                };
                Data.moveStorage(d1, function (json) {
                    if (json && 'resCode' in json && json.resCode == 0) {
                        Modal.setAlert('分单操作成功!', null, function () {
                            location.reload();
                        });
                    } else {
                        Modal.setAlert(json.resMsg || '分单操作失败，请重试！');
                    }
                });
            }
            if (type.cf == 1 && type.n == 1) {
                var d2 = {
                    "orderId": url.get('id'),
                    "subNum": type.sid,
                    "subNumTo": $('#yyfd-fdh').find('option:selected').val(),
                    "cargoName": '',
                    "entryItemList": type.arr,
                    "weight": type.oriwei,
                    "weightTo": $('#yyfd-fdh').find('option:selected').data('wei')
                };
                Data.moveStorage(d2, function (json) {
                    if (json && 'resCode' in json && json.resCode == 0) {
                        Modal.setAlert('分单操作成功!', null, function () {
                            location.reload();
                        });
                    } else {
                        Modal.setAlert(json.resMsg || '分单操作失败，请重试！');
                    }
                });
            }
        });
    };
    var changeName = function () {
        var cgid, cgsid,cgname,markname;
        $(document).on('click', '.cg-name-btn', function () {
            cgid = $(this).data('id');
            cgsid = $(this).data('sid');
            cgname= $(this).data('name');
            markname= $(this).data('mark');
            $('#cg-name').val(cgname);
            $('#mark-subname').val(markname);
            $('.name-part').removeClass('dp-n');
            $('.white-back').removeClass('dp-n');
        });
        $(document).on('click', '#name-ensure', function () {
            if ($('#cg-name').val()) {
                $('#cg-name').removeClass('warm');
                Data.changeName({
                    "orderId": cgid,
                    "subNum": cgsid,
                    "subCargoName": $('#cg-name').val(),
                    "markName": $('#mark-subname').val()
                }, function (json) {
                    if (json && 'resCode' in json && json.resCode == 0) {
                        Modal.setAlert('修改成功!', null, function () {
                            location.reload();
                        });
                    } else {
                        Modal.setAlert(json.resMsg || '修改失败，请重试！');
                    }
                });
            } else {
                $('#cg-name').addClass('warm');
            }
        });
    };
    //杂费费用的引入
    var extraInit = function () {
        var data = {
            airCompanyCode: $('#aIc').html() || '',
            agentCompanyId:$('#aId').html()
        };
        Data.zfexpenseTem(data, function (json) {
            var arr =[];
            var str ='';
            if (json && 'resCode' in json && json.resCode == 0) {
                if(json.resBody && 'expenseTemplate' in json.resBody ){
                    arr=json.resBody['expenseTemplate'];
                    //刚开始的时候是返回的是对象所以即使调用属性名还是无法识别，所以使用这种方法。
                }
                for (var a in arr) {
                    if (arr.hasOwnProperty(a)) {
                        var d = arr[a];
                        str += '<tr><td>' + d.itemName + '</td><td>' + d.itemPrice + '</td><td>' + (d.itemRemark || '/') + '</td></tr>'
                    }
                }
                $('.other-list').find('tbody').html(str);
            }
        });
    };
    var otherinit = function(){
        $(".jg-modal").tooltip();
        //小数点控制
        $('#entrysize').html(myformat.formatvolume($('#entrysize').data('size'))+' CBM');
        $('#declaresize').html(myformat.formatvolume($('#declaresize').data('size'))+' CBM');
        $('#entrysize2').find('font').html(myformat.formatvolume( $('#entrysize2').find('font').html()));
        $('.item-tj').html(myformat.formatvolume($('.item-tj').html()));
        $('.xj-tj').html(myformat.formatvolume($('.xj-tj').html()));
        $('.total-tj').html(myformat.formatvolume($('.total-tj').html()));
    }
    var run = function () {
        listener();
        submit();
        upload();
        fileList();
        declareData();
        changeLine();
        airline();
        getCompany();
        contact();
        dlMap();
        dlBh();
        trackInit();
        subData();
        changeName();
        createSub();
        //extraInit();
        otherinit();
    };
    return {
        run: run
    }
}());
module.exports = Listener;
},{"../frame/burster":5,"../frame/function":6,"../frame/modal":7,"./data":1,"./dom":2}],5:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/24.
 */
"use strict";

(function ($) {
    /**
     * 生成分页器
     * @param ele 需要添加分页器的元素
     * @param offset 偏移量，即从第data-offset开始
     * @param length 总记录条数
     * @param showPages 分页器显示的页数，超过则隐藏多余的页
     * @param rows 每页显示的记录条数
     */
    $.burster = function (ele, offset, length, showPages, rows) {
        offset = offset ? parseInt(offset) : 0;
        //将分页器装入table中
        if (length && length > offset) {
            var pageHtml = ""
                , ass = ""//清空需要装入的html
                , beforePages = Math.ceil(offset / rows)//需要显示的前页数/当前页
                , afterPages = Math.ceil((length - offset ) / rows)//需要显示的后页数
                , pages = Math.ceil(length / rows) //总页数
                , k = 0;
            //alert("总页数" + pages + " 前页数 " + beforePages + " 后页数 " + afterPages);
            //若页数小于showPages页，则全部显示
            if (pages >= 0 && pages <= showPages) {
                for (k = 0; k < pages; k++) {
                    if (k == beforePages) {
                        pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                    } else {
                        pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                    }
                }
            } else if (pages > showPages) {//总页数大于showPages页
                if (beforePages <= Math.ceil(showPages / 2) && afterPages > showPages + 1) {
                    for (k = 0; k < showPages; k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages <= Math.ceil(showPages / 2) && afterPages == showPages + 1) {
                    for (k = 0; k < showPages - 1; k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages <= Math.ceil(showPages / 2) && afterPages <= showPages) {
                    for (k = 0; k < showPages - 1; k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > Math.ceil(showPages / 2) && beforePages <= showPages && afterPages > showPages) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > showPages && afterPages > showPages) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > Math.ceil(showPages / 2) && beforePages <= pages && afterPages <= showPages && afterPages > Math.ceil(showPages / 2) + 1) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > pages && afterPages <= showPages && afterPages > Math.ceil(showPages / 2) + 1) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > Math.ceil(showPages / 2) && afterPages <= Math.ceil(showPages / 2) + 1) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < pages; k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                }
            }
            //判断"首页"和"末页"是否可点击
            var firstPage, lastPage;
            if (offset == 0) {//此时首页无法点击
                firstPage = '<li class="disabled"><a class="pages" data-offset="0">首页</a></li>';
                lastPage = '<li><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '" >末页</a></li>';
            } else if ((offset + rows) >= length) {//此时末页无法点击
                firstPage = '<li><a class="pages" data-offset="0">首页</a></li>';
                lastPage = '<li class="disabled"><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '">末页</a></li>';
            } else {
                firstPage = '<li><a class="pages" data-offset="0">首页</a></li>';
                lastPage = '<li><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '">末页</a></li>';
            }
            //判断"上一页"和"下一页"是否存在
            var upPage, downPage;
            if (offset == 0 || (offset < rows && (offset % rows != 0))) {
                upPage = "<li class='disabled'><a class='pages' func='previous' data-offset='" + parseInt(offset) + "' >上页</a></li>"
            } else {
                upPage = "<li><a class='pages' func='previous' data-offset='" + (parseInt(offset) - parseInt(rows)) + "' >上页</a></li>";
            }
            if (offset >= (length - rows)) {
                downPage = "<li class='disabled'><a class='pages' func='next' data-offset='" + parseInt(offset) + "'>下页</a></li>"
            } else {
                downPage = "<li><a class='pages' func='next' data-offset='" + parseInt(parseInt(offset) + parseInt(rows)) + "'>下页</a></li>"
            }
            if (pages != 1) {
                //分页部分
                ass += "<div id='pager' class='pager-info'>" +
                    "<h6 id='result' class='pager-record'>共有<span>" + length + "</span>条记录</h6>" +
                    "<ul class='pagination'>" + firstPage + upPage + pageHtml + downPage + lastPage + "</ul></div>";
                //table中注入拼装的记录
                ele.html(ass);
            } else {//无法分页清空分页器
                ele.html('');
            }
        }
    }
}(jQuery));
},{}],6:[function(require,module,exports){
/**
 * Created by jeremy on 2016/2/26.
 * @version 1.0.0 created 通用性功能方法
 */

'use strict';

var Fun = (function () {
    var _timeOut = 100000;//请求超时时间为10s
    /**
     * 封装ajax
     * @param option
     * {
     *      url:"请求的地址"
     *      ,method:"请求的方法"
     *      ,async:"是否并发"
     *      ,data:"发送的数据"
     *      ,success:"成功时回调"
     *      ,error:"失败/超时时回调"
     *      ,timeout:"超时时间"
     *      ,complete:"完成后的回调"
     * }
     */
    var ajax = function (option) {
        //ajax开始时应显示“加载信息框”
        Modal.showLoading();
        $.ajax({
            url: option.url
            , type: "type" in option && option.type || "GET"
            , timeout: option.timeout || _timeOut
            , data: "data" in option && option.data || {}
            , dataType: "json"
            , async: ("async" in option && option.async) ? true : false
            , success: function (json) {
                if ("status" in json && json.status > 0 && "data" in json) {
                    if ("success" in option) {
                        option.success(json.data);
                    } else {
                        Modal.setAlert("无success方法!");
                    }
                } else if ("error" in option && option.error instanceof Function) {
                    option.error(json);
                } else {
                    Modal.setAlert('操作失败!');
                }
            }, error: function (xhr) {//404或者超时
                if ("error" in option && option.error instanceof Function) {
                    //提示用户错误信息
                    Modal.showLoading(false);
                    Modal.setAlert("连接服务器失败，状态：" + (xhr.status || -1) + ",信息：" + (xhr.statusText || "-"));
                    option.error(xhr.status, xhr.statusText);//回调请求的状态和错误信息
                }
            }, complete: function (xhr, type) {
                //关闭“加载信息框”
                Modal.showLoading(false);
                if ("complete" in option && option.complete instanceof Function) {
                    option.complete(xhr, type);//回调请求的xhr信息和类型
                }
            }
        });
    };
    //全选和单选的绑定
    var setCheckboxListener = function (allCheck, radioChecks) {
        //筛选单选按钮组
        var radioValueEles = $(radioChecks);
        //点击全选时，同组按钮被同步
        $(document).delegate(allCheck, "click", function () {
            if (radioValueEles && radioValueEles.length > 0) {
                for (var _r = 0; _r < radioValueEles.length; _r++) {
                    radioValueEles[_r].checked = $(this).is(":checked");
                }
            }
        });
        //点击单选按钮时，
        $(document).delegate(radioChecks, "click", function () {
            $(allCheck)[0].checked = $(radioChecks + ":checked").length == $(radioChecks).length;
        });
    };
    var url = (function () {
        var get = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURI(r[2]);
            return null;
        };
        /**
         * 根据参数列表长度进行判断，兼容IE9
         * @returns {string}
         */
        var set = function () {
            if (arguments.length === 1 && typeof arguments[0] === 'object') {//一个对象，使用key标记value
                var obj = arguments[0]
                    , search = location.search;
                for (var o in obj) {
                    if (obj.hasOwnProperty(o)) {
                        search = changeURLKeyValue(search, o, obj[o]);
                    }
                }
                if ('pushState' in history) {
                    history.pushState(null, document.title, search);
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, search);//返回重新构造后search串
                }
            } else if (arguments.length === 2) {//key+value
                var key = arguments[0]
                    , value = arguments[1];
                if ('pushState' in history) {
                    history.pushState(null, document.title, changeURLKeyValue(location.toString(), key, value));
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, changeURLKeyValue(location.search, key, value));//返回重新构造后search串
                }
            }
            function changeURLKeyValue(url, arg, arg_val) {
                var pattern = arg + '=([^&]*)';
                var replaceText = arg + '=' + arg_val;
                if (url.match(pattern)) {
                    var tmp = '/(' + arg + '=)([^&]*)/gi';
                    tmp = url.replace(eval(tmp), replaceText);
                    return tmp;
                } else {
                    if (url.match('[\?]')) {
                        return url + '&' + replaceText;
                    } else {
                        return url + '?' + replaceText;
                    }
                }
            }
        };
        return {
            get: get
            , set: set
        }
    }());
    var formatImage=function (path, size, ele) {
        if(path instanceof  Array && path.length>0){
            path = path[0];
        }
        var IMAGE_SIZE = {
            original: {
                path: "",
                size: ""
            },
            xlarge: {
                path: "_xlarge",
                size: "660*660"
            },
            large: {
                path: "_large",
                size: "420*420"
            },
            middle: {
                path: "_middle",
                size: "300*300"
            },
            small: {
                path: "_small",
                size: "240*240"
            },
            little: {
                path: "_little",
                size: "120*120"
            },
            micro: {
                path: "_micro",
                size: "60*60"
            }
        };
        size = IMAGE_SIZE[size || "middle"] || IMAGE_SIZE.middle;
        var pathTemp = /\.\w+?$/.exec(path);
        if (!pathTemp) {
            path += size.path;
        } else {
            path = (path.substr(0, pathTemp.index || path.length)) + size.path + pathTemp[0];
        }
        if (ele && ele.attr) {
            ele.attr("src", path);
        }
        return path;
    };

    var format = (function () {
        var formatamount = function(_value){
            return parseFloat(_value).toFixed(2);
        };
        //体积格式化小数点2位
        var formatvolume = function(_value){
            return parseFloat(_value).toFixed(3);
        };
        //重量格式化小数点2位
        var formatweight = function(_value){
            return parseFloat(_value).toFixed(3);
        };
        return {
            formatamount: formatamount
            , formatvolume: formatvolume
            , formatweight: formatweight
        }
    }());
    return {
        ajax: ajax
        , getTimtout: _timeOut
        , setCheckboxListener: setCheckboxListener
        , url: url
        , formatImage: formatImage
        , format: format
    }
}());

exports.ajax = Fun.ajax;
exports.getTimeout = Fun.getTimtout;
exports.setCheckboxListener = Fun.setCheckboxListener;
exports.url = Fun.url;
exports.format = Fun.format;
exports.formatImage = Fun.formatImage;

},{}],7:[function(require,module,exports){
/**
 * Created by jeremy on 2016/2/24.
 * @version 1.0.0 created
 */

'use strict';

//构造信息框主体
var Modal = (function () {
    //构造原始类
    function M(m) {
        this.s = m.s;//是否显示
        this.id = m.id;
    }

    //构造标准show方法，用于继承
    M.prototype.show = function () {
        var ele = document.getElementById(this.id);
        if (ele) {
            if (this.s && !isShow()) {//显示当前隐藏
                ele.className = ele.className.replace("dp-n", "");
            } else if (!this.s && isShow()) {//隐藏当前显示
                ele.className += " dp-n";
            }
            //去除两边的空格
            ele.className = String(ele.className).trim();
        }
        function isShow() {//是否已显示，无class时显示
            return ele.className.split("dp-n").length == 1;
        }
    };

    //加载信息框
    var loading = (function () {
        //初始化生成加载信息框
        var init = function () {
            if (!document.getElementById("loading_modal_element")) {
                $('body').append('<div id="loading_modal_element" class="loading-modal-body dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="loading-modal-image"></div>' +
                    '<div class="loading-modal-text">' +
                    '<h2>玩命加载中……</h2>' +
                    '</div></div>');
            }
            return false;
        };
        //显示、隐藏信息框
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;//无参数显示信息框
            var m = new M({id: "loading_modal_element", s: s});
            m.show();
        };
        return {
            init: init
            , show: show
        }
    }());
    //弹出信息框
    var alert = (function () {
        var init = function () {
            if (!document.getElementById("alert_modal_element")) {
                $('body').append('<div id="alert_modal_element" class="alert-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="alert-modal-content">' +
                    '<div class="alert-modal-body"><span class="alert-modal-text"></span></div>' +
                    '<div class="alert-modal-footer"><button id="alert_modal_close" class="alert-modal-button">关闭</button></div>' +
                    '</div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "alert_modal_element", s: s});
            m.show();
        };
        /**
         * 设置弹出信息框
         * @param msg       显示的信息，支持html
         * @param sed       倒计时关闭时间，单位：second
         * @param callback  关闭触发回调函数
         */
        var set = function (msg, sed, callback) {
            var ele = document.getElementById("alert_modal_element");
            if (msg) {
                if (typeof msg === 'object') {//应对后端返回提示时使用Object封装
                    msg = JSON.stringify(msg);
                }
                if(ele){
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }else{
                    init();
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }
                show();
            }
            if (sed > 0) {
                setTimeout(function () {
                    show(false);
                }, 1000 * sed);
            }//无关闭时间或者关闭时间为0，不自动关闭
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#alert_modal_close").on("click", function () {
                if (callback && callback instanceof Function) {
                    callback();
                }
                show(false);
                //阻止事件继续传递
                return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //选择信息框
    var confirm = (function () {
        var init = function () {
            if (!document.getElementById("confirm_modal_element")) {
                $('body').append('<div id="confirm_modal_element" class="confirm-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="confirm-modal-content">' +
                    '<div id="confirm_modal_header" class="confirm-modal-header dp-n"></div>' +
                    '<div class="confirm-modal-body"><span id="confirm_modal_text" class="confirm-modal-text"></span></div>' +
                    '<div class="confirm-modal-footer">' +
                    '<div class="footer-button-success"><button class="confirm-modal-button  modal-success" data-confirm="success">确认</button></div>' +
                    '<div class="footer-button-false"><button class="confirm-modal-button" data-confirm="error">取消</button></div>' +
                    '</div></div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "confirm_modal_element", s: s});
            m.show();
        };
        /**
         * 设置选择信息框的内容
         * @param option    配置
         * {
         *      title:"头部显示的信息"
         *      ,text:"显示的提示信息"
         *      ,success:"点击成功后的回调"
         *      ,error:"点击失败后的回调"
         *      ,complete:"点击按钮后的整体回调"
         * }
         */
        var bar = 0;
        var set = function (option) {
            if (!option) {
                return false;
            }
            if ("title" in option && option.title.length > 0) {//有头部，则显示头部
                document.getElementById("confirm_modal_header").innerHTML = option.title;
            }
            if ("text" in option && option.text.length > 0) {//有内容，则显示整个选择信息框
                document.getElementById("confirm_modal_text").innerHTML = option.text;
            }
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#confirm_modal_element").find(".confirm-modal-button").off("click").on("click", function () {
                //fixme .off("click")用于防止多次触发<--很玄学，我也不知道为什么，但是请不要修改。
                var atr = $(this).attr("data-confirm");//选择的按钮
                bar++;
                if (option && atr in option && option[atr] instanceof Function) {
                    option[atr]();
                }
                if (option && "complete" in option && option.complete instanceof Function) {
                    option.complete();//若有完成函数，则执行
                } else {//否则，关闭选择框
                    show(false);
                }
                //阻止事件继续传递
                //return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //覆盖层
    var cover = (function () {
        var init = function () {
            if (!document.getElementById("cover_modal_element")) {
                $('body').append('<div id="cover_modal_element" class="cover-modal-element dp-n"></div>');
            }
            return false;
        };
        var hide = function () {
            document.getElementById("cover_modal_element").style.display = "none";
        };
        var show = function () {
            document.getElementById("cover_modal_element").style.display = "block";
        };
        return {
            init: init
            , show: show
            , hide: hide
        }
    }());
    return {
        initLoading: loading.init
        , showLoading: loading.show

        , initAlert: alert.init
        , showAlert: alert.show
        , setAlert: alert.set

        , initConfirm: confirm.init
        , setConfirm: confirm.set
        , showConfirm: confirm.show
        , initCover: cover.init
    }
}());

//页面加载完毕后生成四个自定义模态框
setTimeout(function () {
    //页面加载时生成一个覆盖层
    Modal.initCover();
    //页面加载时生成一个加载信息框
    Modal.initLoading();
    //页面加载时生成一个弹出信息框
    Modal.initAlert();
    //页面加载时生成一个选择信息框
    Modal.initConfirm();
}, 100);


//抛出上层调用
exports.showLoading = Modal.showLoading;
exports.setAlert = Modal.setAlert;
exports.showAlert = Modal.showAlert;
exports.setConfirm = Modal.setConfirm;
exports.showConfirm = Modal.showConfirm;
},{}],8:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/22.
 */
"use strict";
var head = function () {
    //时间格式化
    Date.prototype.Format = function (fmt) { //author: Jeremyyy
        var o = {
            "M+": this.getMonth() + 1, //月份
            "d+": this.getDate(), //日
            "h+": this.getHours(), //小时
            "m+": this.getMinutes(), //分
            "s+": this.getSeconds(), //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    };
    //返回顶部
    $(document).on('click', '.back-top', function () {
        $("html,body").animate({scrollTop:0},100);
        return false;
    });
    $(document).on('mouseenter', '.vip-part', function () {
        $(this).children('.vip-select').stop(true);
        $(this).children('.vip-select').slideDown(100);
        return false;
    });
    $(document).on('mouseleave', '.vip-part', function () {
        $(this).children('.vip-select').stop(true);
        $(this).children('.vip-select').slideUp(100);
        return false;
    });
    $(document).on('mouseenter', '.wechat-logo', function () {
        $(this).children('.big-wechat').fadeIn(200);
        return false;
    });
    $(document).on('mouseleave', '.wechat-logo', function () {
        $(this).children('.big-wechat').fadeOut(200);
        return false;
    });
};
module.exports.head = head;
},{}],9:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/22.
 */
"use strict";
var listener = (function () {
    var run = function () {
        //头部点击事件
        require('./head').head();
    };
    return {
        run: run
    }
}());
module.exports = listener;
},{"./head":8}]},{},[3])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL252bS92Ni4yLjAvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImRhdGEuanMiLCJkb20uanMiLCJpbmRleC5qcyIsImxpc3RlbmVyLmpzIiwiLi4vZnJhbWUvYnVyc3Rlci5qcyIsIi4uL2ZyYW1lL2Z1bmN0aW9uLmpzIiwiLi4vZnJhbWUvbW9kYWwuanMiLCIuLi9nZW5lcmFsL2hlYWQuanMiLCIuLi9nZW5lcmFsL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0aUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25rREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ROQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQXVzZXIgb24gMjAxNi8xMi82LlxyXG4gKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBEYXRhID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRyYSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvYWlybGluZS9leHRyYSdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgcmVmdXNlID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlci9yZWZ1c2UnXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIGVudHJ5ID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlci9lbnRyeSdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgZG93biA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvZG93bi9vc3NEb3duJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB1cCA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvZG93bi9vc3NVcCdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgb3NzVXBsb2FkID0gZnVuY3Rpb24gKHBhcmFtLCBkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgIHZhciBmb3JtZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgIGZvcm1kYXRhLmFwcGVuZChcIk9TU0FjY2Vzc0tleUlkXCIsIHBhcmFtLkFjY2Vzc0tleUlkKTtcclxuICAgICAgICBmb3JtZGF0YS5hcHBlbmQoXCJwb2xpY3lcIiwgcGFyYW0uUG9saWN5KTtcclxuICAgICAgICBmb3JtZGF0YS5hcHBlbmQoXCJTaWduYXR1cmVcIiwgcGFyYW0uU2lnbmF0dXJlKTtcclxuICAgICAgICBmb3JtZGF0YS5hcHBlbmQoXCJrZXlcIiwgcGFyYW0uS2V5bmFtZSk7XHJcbiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKFwiQ29udGVudC1EaXNwb3NpdGlvblwiLCBcImF0dGFjaG1lbnQ7ZmlsZW5hbWU9XFxcIlwiICsgZGF0YS5uYW1lICsgXCJcXFwiXCIpO1xyXG4gICAgICAgIGZvcm1kYXRhLmFwcGVuZChcImZpbGVcIiwgZGF0YSk7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBwYXJhbS5VcGxvYWRVUkxcclxuICAgICAgICAgICAgLCBkYXRhOiBmb3JtZGF0YVxyXG4gICAgICAgICAgICAsIHByb2Nlc3NEYXRhOiBmYWxzZVxyXG4gICAgICAgICAgICAsIGNhY2hlOiBmYWxzZVxyXG4gICAgICAgICAgICAsIGFzeW5jOiBmYWxzZVxyXG4gICAgICAgICAgICAsIGNvbnRlbnRUeXBlOiBmYWxzZVxyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF9kYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogMVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBlcnJvcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAtMVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgYWRkRmlsZSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXJGaWxlL2FkZCdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgcmVtb3ZlRmlsZSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXJGaWxlL3JlbW92ZSdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgZmlsZUxpc3QgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVyRmlsZS9saXN0J1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBnZXRDb2RlID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9haXJsaW5lL2FpcmNvbSdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgYWlycG9ydCA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvYWlybGluZS9haXJwb3J0J1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBncFNlYXJjaCA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXIvZ3BTZWFyY2gnXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHN1Ym1pdENoYW5nZSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXIvc3VibWl0Q2hhbmdlJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBwZXJzb25BZGQgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVyL3BlcnNvbkFkZCdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvL+WIhuWNlea3u+WKoOaUtuWPkei0p+S6uuS/oeaBr1xyXG4gICAgdmFyIHN1Yk9yZGVycGVyc29uQWRkID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlci9zdWJPcmRlcnBlcnNvbkFkZCdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgY29udGFjdExpc3QgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3JlY2VpdmUnXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHdhcmVob3VzZSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXIvZGV0YWlsJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBjb21wYW55RGV0YWlsID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlci9jb21wYW55RGV0YWlsJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBkZWNsYXJlRGF0YSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXIvZGVjbGFyZURhdGEnXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHRyYWNrID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9vcmRlci90cmFjaydcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgb3JkZXJEZXRhaWwgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL29yZGVyL29yZGVyRGV0YWlsJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v6LS555So5pWw5o2u5byV5YWlXHJcbiAgICB2YXIgZXhwZW5zZVRleCA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvYWlybGluZS9leHBlbnNldEV4bXBsYXRlJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v5YiG5Y2V6LS555So5pWw5o2u5byV5YWlXHJcbiAgICB2YXIgemZleHBlbnNlVGVtID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9haXJsaW5lL3pGZXhwZW5zZVRlbSdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgY2hhbmdlTmFtZSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvb3JkZXIvY2hhbmdlTmFtZSdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGV4dHJhOiBleHRyYVxyXG4gICAgICAgICwgcmVmdXNlOiByZWZ1c2VcclxuICAgICAgICAsIGVudHJ5OiBlbnRyeVxyXG4gICAgICAgICwgcGVyc29uQWRkOiBwZXJzb25BZGRcclxuICAgICAgICAsIGRvd246IGRvd25cclxuICAgICAgICAsIHVwOiB1cFxyXG4gICAgICAgICwgb3NzVXBsb2FkOiBvc3NVcGxvYWRcclxuICAgICAgICAsIGFkZEZpbGU6IGFkZEZpbGVcclxuICAgICAgICAsIHJlbW92ZUZpbGU6IHJlbW92ZUZpbGVcclxuICAgICAgICAsIGZpbGVMaXN0OiBmaWxlTGlzdFxyXG4gICAgICAgICwgYWlycG9ydDogYWlycG9ydFxyXG4gICAgICAgICwgZ2V0Q29kZTogZ2V0Q29kZVxyXG4gICAgICAgICwgZ3BTZWFyY2g6IGdwU2VhcmNoXHJcbiAgICAgICAgLCBzdWJtaXRDaGFuZ2U6IHN1Ym1pdENoYW5nZVxyXG4gICAgICAgICwgY29udGFjdExpc3Q6IGNvbnRhY3RMaXN0XHJcbiAgICAgICAgLCB3YXJlaG91c2U6IHdhcmVob3VzZVxyXG4gICAgICAgICwgY29tcGFueURldGFpbDogY29tcGFueURldGFpbFxyXG4gICAgICAgICwgdHJhY2s6IHRyYWNrXHJcbiAgICAgICAgLCBkZWNsYXJlRGF0YTogZGVjbGFyZURhdGFcclxuICAgICAgICAsIG9yZGVyRGV0YWlsOiBvcmRlckRldGFpbFxyXG4gICAgICAgICwgY2hhbmdlTmFtZTogY2hhbmdlTmFtZVxyXG4gICAgICAgICwgZXhwZW5zZVRleDogZXhwZW5zZVRleFxyXG4gICAgICAgICx6ZmV4cGVuc2VUZW06emZleHBlbnNlVGVtXHJcbiAgICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzLkRhdGEgPSBEYXRhOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEF1c2VyIG9uIDIwMTYvMTIvNy5cclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG52YXIgRG9tID0gKGZ1bmN0aW9uICgpIHtcclxuICB2YXIgcmVuZGVyR3AgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgaWYgKGRhdGEgJiYgJ3Jlc0NvZGUnIGluIGRhdGEgJiYgZGF0YS5yZXNDb2RlID09IDApIHtcclxuICAgICAgdmFyIGpzb24gPSBkYXRhLnJlc0JvZHk7XHJcbiAgICAgIGlmICgnc0xpc3QnIGluIGpzb24gJiYganNvbi5zTGlzdCBpbnN0YW5jZW9mIEFycmF5ICYmIGpzb24uc0xpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHZhciBsaXN0ID0ganNvbi5zTGlzdDtcclxuICAgICAgICBmb3IgKHZhciBsIGluIGxpc3QpIHtcclxuICAgICAgICAgIGlmIChsaXN0Lmhhc093blByb3BlcnR5KGwpKSB7XHJcbiAgICAgICAgICAgIHZhciBvYmogPSBsaXN0W2xdO1xyXG4gICAgICAgICAgICBzdHIgKz0gcmVuZGVyKG9iaik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoJy5ncC1udW0nKS5odG1sKCfmoLnmja7mgqjnmoTmlLnphY3kv6Hmga/miJHku6zkuLrmgqjmjqjojZAgJyArIGxpc3QubGVuZ3RoICsgJyDmnaHoiKrnur/vvIznu5PmnpzvvJogJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3RyID0gJzx0cj48dGQgY29sc3Bhbj1cIjhcIj7mmoLml7bmsqHmnInmgqjmkJzntKLnmoToiKrnur/kv6Hmga88L3RkPjwvdHI+JztcclxuICAgICAgICAkKCcuZ3AtbnVtJykuaHRtbCgn5qC55o2u5oKo55qE5pS56YWN5L+h5oGv5oiR5Lus5Li65oKo5o6o6I2QIDAg5p2h6Iiq57q/77yM57uT5p6c77yaICcpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzdHIgPSAnPHRyPjx0ZCBjb2xzcGFuPVwiOFwiPuaaguaXtuayoeacieaCqOaQnOe0oueahOiIque6v+S/oeaBrzwvdGQ+PC90cj4nO1xyXG4gICAgICAkKCcuZ3AtbnVtJykuaHRtbCgn5qC55o2u5oKo55qE5pS56YWN5L+h5oGv5oiR5Lus5Li65oKo5o6o6I2QIDAg5p2h6Iiq57q/77yM57uT5p6c77yaICcpO1xyXG4gICAgfVxyXG4gICAgJCgnLmN0Yi1ib2R5IHRib2R5JykuaHRtbChzdHIpO1xyXG4gICAgZnVuY3Rpb24gcmVuZGVyKGQpIHtcclxuICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICB2YXIgYXJyID0gZC50cmFuc1BvcnQgfHwgW107XHJcbiAgICAgIGZvciAodmFyIGEgaW4gYXJyKSB7XHJcbiAgICAgICAgaWYgKGFyci5oYXNPd25Qcm9wZXJ0eShhKSkge1xyXG4gICAgICAgICAgc3RyICs9IGFyclthXS5wb3J0Q29kZSArIChhID09IGFyci5sZW5ndGggLSAxID8gJycgOiAnIC0+ICcpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiAnPHRyPiA8dGQ+PGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJncC1zZ1wiIGRhdGEtaWQ9XCInICsgZC5haXJ3YXlJZCArICdcIi8+PC90ZD4gPHRkPicgK1xyXG4gICAgICAgICcgPGRpdiBjbGFzcz1cInBvcnRcIj4gPHNwYW4gY2xhc3M9XCJzXCI+JyArIGQuZGVwdE5vZGUucG9ydENvZGUgKyAnPC9zcGFuPiA8c3Bhbj4nICsgZC5kZXB0Tm9kZS5wb3J0TmFtZSArICc8L3NwYW4+JyArXHJcbiAgICAgICAgJyA8L2Rpdj4gPGRpdiBjbGFzcz1cImxvZ29cIj4gPHNwYW4gY2xhc3M9XCJ0b3BcIj48L3NwYW4+IDxzcGFuIGNsYXNzPVwiY1wiPicgKyBkLmFpckNvbXBhbnlDb2RlICsgJzwvc3Bhbj4gJyArXHJcbiAgICAgICAgJzwvZGl2PiA8ZGl2IGNsYXNzPVwicG9ydFwiPiA8c3BhbiBjbGFzcz1cImVcIj4nICsgZC5kZXN0Tm9kZS5wb3J0Q29kZSArICc8L3NwYW4+IDxzcGFuPicgKyBkLmRlc3ROb2RlLnBvcnROYW1lICsgJzwvc3Bhbj4gPC9kaXY+JyArXHJcbiAgICAgICAgJyA8L3RkPiA8dGQ+IDxkaXYgY2xhc3M9XCJsZ1wiPiAnICsgKHN0ciB8fCAnLycpICsgJzwvZGl2PiA8ZGl2IGNsYXNzPVwiZGF5c1wiPiAnICtcclxuICAgICAgICAnPHNwYW4gY2xhc3M9XCInICsgKGQuZmxpZ2h0RGF5LmluZGV4T2YoMSkgPj0gMCA/ICdhY3RpdmUnIDogJycpICsgJ1wiPuS4gDwvc3Bhbj4gJyArXHJcbiAgICAgICAgJzxzcGFuIGNsYXNzPVwiJyArIChkLmZsaWdodERheS5pbmRleE9mKDIpID49IDAgPyAnYWN0aXZlJyA6ICcnKSArICdcIj7kuow8L3NwYW4+IDxzcGFuIGNsYXNzPVwiJyArIChkLmZsaWdodERheS5pbmRleE9mKDMpID49IDAgPyAnYWN0aXZlJyA6ICcnKSArICdcIj7kuIk8L3NwYW4+ICcgK1xyXG4gICAgICAgICc8c3BhbiBjbGFzcz1cIicgKyAoZC5mbGlnaHREYXkuaW5kZXhPZig0KSA+PSAwID8gJ2FjdGl2ZScgOiAnJykgKyAnXCI+5ZubPC9zcGFuPiA8c3BhbiBjbGFzcz1cIicgKyAoZC5mbGlnaHREYXkuaW5kZXhPZig1KSA+PSAwID8gJ2FjdGl2ZScgOiAnJykgKyAnXCI+5LqUPC9zcGFuPiA8c3BhbiBjbGFzcz1cIicgKyAoZC5mbGlnaHREYXkuaW5kZXhPZig2KSA+PSAwID8gJ2FjdGl2ZScgOiAnJykgKyAnXCI+5YWtPC9zcGFuPicgK1xyXG4gICAgICAgICcgPHNwYW4gY2xhc3M9XCInICsgKGQuZmxpZ2h0RGF5LmluZGV4T2YoNykgPj0gMCA/ICdhY3RpdmUnIDogJycpICsgJ1wiPuaXpTwvc3Bhbj4gPC9kaXY+IDwvdGQ+JyArXHJcbiAgICAgICAgJyA8dGQgY2xhc3M9XCJmb250LXJlZFwiPicgKyBkLmFpcndheVByaWNlLnJhdGVbMF0ucG9saWN5Wyc0NSddICsgJzwvdGQ+IDx0ZCBjbGFzcz1cImZvbnQtcmVkXCI+JyArIGQuYWlyd2F5UHJpY2UucmF0ZVswXS5wb2xpY3lbJzEwMCddICsgJzwvdGQ+JyArXHJcbiAgICAgICAgJyA8dGQgY2xhc3M9XCJmb250LXJlZFwiPicgKyBkLmFpcndheVByaWNlLnJhdGVbMF0ucG9saWN5WyczMDAnXSArICc8L3RkPiA8dGQgY2xhc3M9XCJmb250LXJlZFwiPicgKyBkLmFpcndheVByaWNlLnJhdGVbMF0ucG9saWN5Wyc1MDAnXSArICc8L3RkPiA8dGQgY2xhc3M9XCJmb250LXJlZFwiPicgKyBkLmFpcndheVByaWNlLnJhdGVbMF0ucG9saWN5WycxMDAwJ10gKyAnPC90ZD4gPC90cj4nXHJcbiAgICB9XHJcbiAgfTtcclxuICB2YXIgcmVjb21tZW5kID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgIHZhciBzdHIgPSAnJ1xyXG4gICAgICAsIG51bTtcclxuICAgIGlmIChkYXRhICYmICdyZXNDb2RlJyBpbiBkYXRhICYmIGRhdGEucmVzQ29kZSA9PSAwICYmICdyZXNCb2R5JyBpbiBkYXRhKSB7XHJcbiAgICAgIGlmICgnbGlzdCcgaW4gZGF0YS5yZXNCb2R5ICYmIGRhdGEucmVzQm9keS5saXN0IGluc3RhbmNlb2YgQXJyYXkgJiYgZGF0YS5yZXNCb2R5Lmxpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHZhciBsaXN0ID0gZGF0YS5yZXNCb2R5Lmxpc3Q7XHJcbiAgICAgICAgZm9yICh2YXIgbCBpbiBsaXN0KSB7XHJcbiAgICAgICAgICBpZiAobGlzdC5oYXNPd25Qcm9wZXJ0eShsKSkge1xyXG4gICAgICAgICAgICBzdHIgKz0gcmVuZChsaXN0W2xdKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgbnVtID0gbGlzdC5sZW5ndGg7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3RyID0gJzx0ciBjbGFzcz1cIndyb25nLW1zZ1wiPjx0ZCBjb2xzcGFuPVwiN1wiPuaaguaXtuayoeacieacrOiuouWNleeahOaOqOiNkOiIque6v++8gTwvdGQ+PC90cj4nO1xyXG4gICAgICAgIG51bSA9IDA7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHN0ciA9ICc8dHIgY2xhc3M9XCJ3cm9uZy1tc2dcIj48dGQgY29sc3Bhbj1cIjdcIj7ojrflj5bmjqjojZDoiKrnur/lpLHotKXvvIw8YSBocmVmPVwiXCI+6K+35Yi35paw6YeN6K+VPC9hPu+8gTwvdGQ+PC90cj4nO1xyXG4gICAgICBudW0gPSAwO1xyXG4gICAgfVxyXG4gICAgJCgnLnJjLWJveCcpLmZpbmQoJ3Rib2R5JykuaHRtbChzdHIpO1xyXG4gICAgJCgnLnJjLXN1bScpLmh0bWwobnVtKTtcclxuICAgIGZ1bmN0aW9uIHJlbmQoZCkge1xyXG4gICAgICByZXR1cm4gJzx0cj48dGQ+JyArIChkLkFpcmNvbXBhTmFtZSArIGQuRmxpZ2h0Tm8pICsgJzwvdGQ+JyArXHJcbiAgICAgICAgJzx0ZD4nICsgKGQuT3JpZ2luUG9ydCArIGQuT3JpZ2luUG9ydENvZGUgKyAnLScgKyBkLkRlc3Rwb3J0ICsgZC5EZXN0cG9ydENvZGUpICsgJzwvdGQ+JyArXHJcbiAgICAgICAgJzx0ZD4nICsgKGQuSXNEaXJlY3QgPyAn55u06L6+JyA6ICfkuK3ovawnKSArICc8L3RkPicgK1xyXG4gICAgICAgICc8dGQ+JyArIGQuRmxpZ2h0VGltZSArICc8L3RkPicgK1xyXG4gICAgICAgICc8dGQ+MjAxNi0wOC0xMiAxMjozMDwvdGQ+JyArXHJcbiAgICAgICAgJzx0ZD5DTlkgMjAzOTMuMzA8L3RkPicgK1xyXG4gICAgICAgICc8dGQ+PGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJyZWNvbW1lbmRcIi8+PC90ZD48L3RyPidcclxuICAgIH07XHJcbiAgfTtcclxuICByZXR1cm4ge1xyXG4gICAgcmVuZGVyR3A6IHJlbmRlckdwXHJcbiAgICAsIHJlY29tbWVuZDogcmVjb21tZW5kXHJcbiAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cy5Eb20gPSBEb207IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQXVzZXIgb24gMjAxNi8xMi8yLlxyXG4gKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnJlcXVpcmUoJy4uL2dlbmVyYWwnKS5ydW4oKTtcclxucmVxdWlyZSgnLi9saXN0ZW5lcicpLnJ1bigpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEplcmVteSBvbiAyMDE2LzExLzIyLlxyXG4gKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBEYXRhID0gcmVxdWlyZSgnLi9kYXRhJykuRGF0YVxyXG4gICAgLCBEb20gPSByZXF1aXJlKCcuL2RvbScpLkRvbTtcclxudmFyIE1vZGFsID0gcmVxdWlyZSgnLi4vZnJhbWUvbW9kYWwnKTtcclxudmFyIHVybCA9IHJlcXVpcmUoJy4uL2ZyYW1lL2Z1bmN0aW9uJykudXJsXHJcbiAgICAsbXlmb3JtYXQgPSByZXF1aXJlKCcuLi9mcmFtZS9mdW5jdGlvbicpLmZvcm1hdDtcclxucmVxdWlyZSgnLi4vZnJhbWUvYnVyc3RlcicpO1xyXG4vL+aKpeS7t+WNleaVsOaNrlxyXG52YXIgTGlzdGVuZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG9wZVNpZCA9ICcnO1xyXG4gICAgdmFyIG9JZCA9ICQoJyN1cC1maWxlJykuZGF0YSgnaWQnKTtcclxuICAgIC8v5b6F5Yig6Zmk55qE5YWD57SgXHJcbiAgICB2YXIgcmVtb3ZlRWxlO1xyXG4gICAgLy/nvJPlrZjliKDpmaTlhoXlrrlcclxuICAgIHZhciByZW1vdmVGaWxlID0ge1xyXG4gICAgICAgIFwib3JkZXJJZFwiOiBvSWQsXHJcbiAgICAgICAgXCJrZXlOYW1lXCI6IDBcclxuICAgIH07XHJcbiAgICAvL+eOsOacieiIque6vybmlLnphY3oiKrnur9cclxuICAgIHZhciBub3cgPSB7fSwgY2hhbmdlID0ge307XHJcbiAgICB2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5yZWxvYWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2xvc2UtYnRuJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5hbGVydC1wYXJ0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNob3ctY2hhbmdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLmNoYW5nZS1wYXJ0Jyk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcuZ3Atc2VhcmNoIGlucHV0JykuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdiA9ICQodGhpcykuZGF0YSgndicpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS52YWwodik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmNoYW5nZS10YicpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgZWxlLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaG93LWRwcmljZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcucHJpY2UtbGlzdCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaG93LW90aGVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBleHRyYUluaXQoKTtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcub3RoZXItbGlzdCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaG93LXJlZnVzZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcucmVmdXNlLXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZW5zdXJlLWVudGVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5lbnN1cmUtZGF0YScpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJ2Eucm0nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZUZpbGVbJ2tleU5hbWUnXSA9ICQodGhpcykuZGF0YSgna2V5Jyk7XHJcbiAgICAgICAgICAgIHJlbW92ZUVsZSA9ICQodGhpcykucGFyZW50cygnLnVwLXBhcnQnKTtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcucmVtb3ZlLXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdhLnJtLXR5cGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZUZpbGVbJ2tleU5hbWUnXSA9ICQodGhpcykuZGF0YSgna2V5Jyk7XHJcbiAgICAgICAgICAgIHJlbW92ZUVsZSA9ICQodGhpcykucGFyZW50cygnLmFkZC10eXBlJyk7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnLnJlbW92ZS10eXBlLXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdhLmRsJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZmlsZSA9ICQodGhpcykuZGF0YSgna2V5Jyk7XHJcbiAgICAgICAgICAgIERhdGEuZG93bih7ZmlsZTogZmlsZX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQm9keScgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKGpzb24ucmVzQm9keSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZGwtZmlsZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSAkKHRoaXMpLmRhdGEoJ2tleScpO1xyXG4gICAgICAgICAgICBpZiAoZmlsZSAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICBEYXRhLmRvd24oe2ZpbGU6IGZpbGV9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNCb2R5JyBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKGpzb24ucmVzQm9keSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy99IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICBNb2RhbC5zZXRBbGVydCgn5pqC5pegJyArICQodGhpcykuZmluZCgnLnR4dCcpLmh0bWwoKSk7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZ3Atcy1idG4nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgJCgnLnMtcmVxdWlyZScpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEkKHRoaXMpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHBhc3MpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiZGVwdENvZGVcIjogJCgnI2dwLXN0YXJ0JykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJkZXN0Q29kZVwiOiAkKCcjZ3AtZW5kJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJmbGlnaHREYXRlXCI6IG5ldyBEYXRlKCQoJyNncC10aW1lJykudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiYWlyQ29tcGFueUNvZGVcIjogJCgnI2dwLWNvbScpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwidHJhbnNDb3VudFwiOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIFwib2Zmc2V0XCI6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJsaW1pdFwiOiAyMFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIERhdGEuZ3BTZWFyY2goZGF0YSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBEb20ucmVuZGVyR3AoanNvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmNoYW5nZS10YicpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjY2hhbmdlLWVuc3VyZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY2hhbmdlID0gbnVsbDtcclxuICAgICAgICAgICAgbm93ID0ge1xyXG4gICAgICAgICAgICAgICAgczogJCgnI2dwLXN0YXJ0JykuZGF0YSgndicpXHJcbiAgICAgICAgICAgICAgICAsIGU6ICQoJyNncC1lbmQnKS5kYXRhKCd2JylcclxuICAgICAgICAgICAgICAgICwgYzogJCgnI2dwLWNvbScpLmRhdGEoJ3YnKVxyXG4gICAgICAgICAgICAgICAgLCBkOiAkKCcjZ3AtdGltZScpLmRhdGEoJ3YnKVxyXG4gICAgICAgICAgICAgICAgLCBsOiAkKCcuaHhsaicpLmRhdGEoJ3YnKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnaW5wdXRbbmFtZT1cImdwLXNnXCJdOmNoZWNrZWQnKTtcclxuICAgICAgICAgICAgaWYgKGVsZS5sZW5ndGggPiAwICYmIGVsZS5kYXRhKCdpZCcpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHIgPSBlbGUucGFyZW50cygndHInKTtcclxuICAgICAgICAgICAgICAgIGNoYW5nZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBzOiB0ci5maW5kKCcucycpLnRleHQoKVxyXG4gICAgICAgICAgICAgICAgICAgICwgZTogdHIuZmluZCgnLmUnKS50ZXh0KClcclxuICAgICAgICAgICAgICAgICAgICAsIGM6IHRyLmZpbmQoJy5jJykudGV4dCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLCBkOiAkKCcjZ3AtdGltZScpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLCBsOiB0ci5maW5kKCcubGcnKS50ZXh0KClcclxuICAgICAgICAgICAgICAgICAgICAsIGFpZDogdHIuZmluZCgnaW5wdXRbbmFtZT1cImdwLXNnXCJdJykuZGF0YSgnaWQnKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcuY2hhbmdlLXBhcnQnKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcnQgPSAkKCcuZW5zdXJlLWNoYW5nZS1wYXJ0Jyk7XHJcbiAgICAgICAgICAgICAgICBwYXJ0LmZpbmQoJy5iLXMnKS5odG1sKG5vdy5zKTtcclxuICAgICAgICAgICAgICAgIHBhcnQuZmluZCgnLmItZScpLmh0bWwobm93LmUpO1xyXG4gICAgICAgICAgICAgICAgcGFydC5maW5kKCcuYi1jJykuaHRtbChub3cuYyk7XHJcbiAgICAgICAgICAgICAgICBwYXJ0LmZpbmQoJy5iLWQnKS5odG1sKG5vdy5kKTtcclxuICAgICAgICAgICAgICAgIHBhcnQuZmluZCgnLmItbCcpLmh0bWwobm93LmwpO1xyXG4gICAgICAgICAgICAgICAgcGFydC5maW5kKCcuYS1zJykuaHRtbChjaGFuZ2Uucyk7XHJcbiAgICAgICAgICAgICAgICBwYXJ0LmZpbmQoJy5hLWUnKS5odG1sKGNoYW5nZS5lKTtcclxuICAgICAgICAgICAgICAgIHBhcnQuZmluZCgnLmEtYycpLmh0bWwoY2hhbmdlLmMpO1xyXG4gICAgICAgICAgICAgICAgcGFydC5maW5kKCcuYS1kJykuaHRtbChjaGFuZ2UuZCk7XHJcbiAgICAgICAgICAgICAgICBwYXJ0LmZpbmQoJy5hLWwnKS5odG1sKGNoYW5nZS5sKTtcclxuICAgICAgICAgICAgICAgIHBhcnQucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2xvc2UtYnRuLXRoaXMnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJy5jaGFuZ2UtcGFydCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5lbnN1cmUtY2hhbmdlLXBhcnQnKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjc3VibWl0LWNoYW5nZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBcIm9yZGVySWRcIjogJCh0aGlzKS5kYXRhKCdpZCcpLFxyXG4gICAgICAgICAgICAgICAgXCJtZW1iZXJJZFwiOiAwLFxyXG4gICAgICAgICAgICAgICAgXCJhaXJ3YXlJZFwiOiBjaGFuZ2UuYWlkLFxyXG4gICAgICAgICAgICAgICAgXCJmbGlnaHREYXRlXCI6IGNoYW5nZS5kXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIERhdGEuc3VibWl0Q2hhbmdlKGRhdGEsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5lbnN1cmUtY2hhbmdlLXBhcnQnKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5jaGFuZ2Utc3VjY2VzcycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbi0tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcubGVmdC1zZWNvbmRzJykuaHRtbChuKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+aUuemFjeWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmRsLXByaWNlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkbERhdGFbJ3R6ciddID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogZmhyLmNvbnRhY3ROYW1lfHwnJ1xyXG4gICAgICAgICAgICAgICAgLCBhZGRyZXNzOiBmaHIuY29udGFjdEFkZHJlc3N8fCcnXHJcbiAgICAgICAgICAgICAgICAsIHRlbDogZmhyLmNvbnRhY3RUZWx8fCcnXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGRsRGF0YVsnYnR6ciddID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogc2hyLmNvbnRhY3ROYW1lfHwnJ1xyXG4gICAgICAgICAgICAgICAgLCBhZGRyZXNzOiBzaHIuY29udGFjdEFkZHJlc3N8fCcnXHJcbiAgICAgICAgICAgICAgICAsIHRlbDogc2hyLmNvbnRhY3RUZWx8fCcnXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8v5paw5re75Yqg6YCa55+l5Lq6XHJcbiAgICAgICAgICAgIGRsRGF0YVsndHpyJ10gPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB0enIuY29udGFjdE5hbWV8fCcnXHJcbiAgICAgICAgICAgICAgICAsIGFkZHJlc3M6IHR6ci5jb250YWN0QWRkcmVzc3x8JydcclxuICAgICAgICAgICAgICAgICwgdGVsOiB0enIuY29udGFjdFRlbHx8JydcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9hcGkvZG93bi9iamQnXHJcbiAgICAgICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAgICAgLCBkYXRhOiB7ZDogZGxEYXRhLCBuYW1lOiAn5oql5Lu35Y2VJ31cclxuICAgICAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJ3N0YXR1cycgaW4ganNvbiAmJiBqc29uLnN0YXR1cyA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKFwiL2dldEltZ0NvZGUvYmpkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNkbC13YXJlaG91c2UnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjb2RlID0gJzwhRE9DVFlQRSBodG1sPiA8aHRtbCBsYW5nPVwiZW5cIj4gPGhlYWQ+IDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiPiA8dGl0bGU+VGl0bGU8L3RpdGxlPiA8c3R5bGU+ICoge21hcmdpbjogMDtwYWRkaW5nOiAwO30uY29udGFpbmVyIHt3aWR0aDogMTIwMHB4O21hcmdpbjogMCBhdXRvO3BhZGRpbmc6IDIwcHggMDt9LmluZm8ge3dpZHRoOiA1MCU7aGVpZ2h0OiAzMHB4O2xpbmUtaGVpZ2h0OiAzMHB4O2Zsb2F0OiBsZWZ0O2ZvbnQtd2VpZ2h0OiA2MDA7fS50aXRsZSB7bGluZS1oZWlnaHQ6IDUwcHg7aGVpZ2h0OiA1MHB4O2ZvbnQtc2l6ZTogMjBweDtmb250LXdlaWdodDogNjAwO2NsZWFyOiBib3RoO30udGltZSB7aGVpZ2h0OiAzMHB4O2xpbmUtaGVpZ2h0OiAzMHB4O3RleHQtYWxpZ246IHJpZ2h0O310YWJsZSB7d2lkdGg6IDEwMCU7Ym9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTt9dGQge2hlaWdodDogMzBweDt0ZXh0LWFsaWduOiBjZW50ZXI7Ym9yZGVyOiAxcHggc29saWQgI2NjYzt9dGhlYWQgdGQge2JhY2tncm91bmQ6ICM2NjY7Y29sb3I6ICNmZmY7fSA8L3N0eWxlPiA8L2hlYWQ+IDxib2R5PiA8ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+IDxwIGNsYXNzPVwiaW5mb1wiPuiuouWNlee8luWPt++8micgKyAkKCcud2FyZWhvdXNlLXRiJykuZGF0YSgnZGRiaCcpICsgJzxzcGFuPjwvc3Bhbj48L3A+IDxwIGNsYXNzPVwiaW5mb1wiPui/m+S7k+e8luWPt++8micgKyAkKCcud2FyZWhvdXNlLXRiJykuZGF0YSgnamNiaCcpICsgJzxzcGFuPjwvc3Bhbj48L3A+IDxwIGNsYXNzPVwiaW5mb1wiPuWuouaIt+WQjeensO+8micgKyAkKCcud2FyZWhvdXNlLXRiJykuZGF0YSgna2htYycpICsgJzxzcGFuPjwvc3Bhbj48L3A+IDxwIGNsYXNzPVwiaW5mb1wiPui/m+S7k+eKtuaAge+8micgKyAkKCcud2FyZWhvdXNlLXRiJykuZGF0YSgnamN6dCcpICsgJzxzcGFuPjwvc3Bhbj48L3A+IDxwIGNsYXNzPVwidGl0bGVcIj7ov5vku5PmmI7nu4Y8L3A+IDx0YWJsZT4nICsgJCgnLndhcmVob3VzZS10YicpLmh0bWwoKSArICc8L3RhYmxlPiA8cCBjbGFzcz1cInRpbWVcIj7lr7zlh7rml7bpl7TvvJonICsgbmV3IERhdGUoKS5Gb3JtYXQoJ3l5eXktTU0tZGQnKSArICc8c3Bhbj48L3NwYW4+PC9wPiA8L2Rpdj4gPC9ib2R5PiA8L2h0bWw+J1xyXG4gICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9kb3duL3BkZidcclxuICAgICAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICAgICAsIGRhdGE6IHtjb2RlOiBjb2RlLCBuYW1lOiAn6L+b5LuT5piO57uGJ31cclxuICAgICAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJ3N0YXR1cycgaW4ganNvbiAmJiBqc29uLnN0YXR1cyA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKFwiL2dldEltZ0NvZGUvcGRmXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5kbC15bGQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlkID09XCJtYWluLXlsZFwiKSB7IC8v5Li75Y2VXHJcbiAgICAgICAgICAgICAgICBpZiAoJCgnLnlsLXBhcnQnKS5maW5kKCcuZHAtdGInKS5maW5kKCcuZmlsZXMnKS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy55bC1wYXJ0JykuZmluZCgnLmRwLXRiJykuaHRtbCgn5pqC5peg6aKE5b2V5Y2VJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5maW5kKCcudG1wJykuZmluZCgnYScpLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnlsLXBhcnQnKS5maW5kKCcuZHAtdGInKS5odG1sKCfmmoLml6DpooTlvZXljZUnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnlsLXBhcnQnKS5maW5kKCcuZHAtdGInKS5odG1sKCQodGhpcykuZmluZCgnLnRtcCcpLmh0bWwoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcueWwtcGFydCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vdmFyIGV4dHJhSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgIHZhciBlbGUgPSAkKCcub3RoZXItbGlzdCcpO1xyXG4gICAgLy8gICAgdmFyIGRhdGEgPSB7XHJcbiAgICAvLyAgICAgICAgYWlyQ29tcGFueUNvZGU6IGVsZS5kYXRhKCdpZCcpIHx8ICcnXHJcbiAgICAvLyAgICB9O1xyXG4gICAgLy8gICAgRGF0YS5leHRyYShkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgLy8gICAgICAgIGNvbnNvbGUubG9nKGpzb24pO1xyXG4gICAgLy8gICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAvLyAgICAgICAgICAgIHZhciBhcnIgPSBqc29uLnJlc0JvZHkgfHwgW11cclxuICAgIC8vICAgICAgICAgICAgICAgICwgc3RyID0gJyc7XHJcbiAgICAvLyAgICAgICAgICAgIGZvciAodmFyIGEgaW4gYXJyKSB7XHJcbiAgICAvLyAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhcnJbYV07XHJcbiAgICAvL1xyXG4gICAgLy8gICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPHRyPjx0ZD4nICsgZC5pdGVtTmFtZSArICc8L3RkPjx0ZD4nICsgZC5pdGVtUHJpY2UgKyAnPC90ZD48dGQ+JyArIChkLml0ZW1SZW1hcmsgfHwgJy8nKSArICc8L3RkPjwvdHI+J1xyXG4gICAgLy8gICAgICAgICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgICAgIGVsZS5maW5kKCd0Ym9keScpLmh0bWwoc3RyKTtcclxuICAgIC8vICAgICAgICB9XHJcbiAgICAvLyAgICB9KTtcclxuICAgIC8vfTtcclxuICAgIHZhciBzdWJtaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNyZWZ1c2UtZW5zdXJlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIGlkID0gJCgnaW5wdXRbbmFtZT1cInJlYXNvblwiXTpjaGVja2VkJykucHJvcCgnaWQnKTtcclxuICAgICAgICAgICAgdmFyIHR4dCA9ICcnO1xyXG4gICAgICAgICAgICBpZiAoaWQgPT0gJ3I1Jykge1xyXG4gICAgICAgICAgICAgICAgdHh0ID0gJCgnI3RleHQtcjQnKS52YWwoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHR4dCA9ICQoJyMnICsgaWQpLnNpYmxpbmdzKCdsYWJlbCcpLmh0bWwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIFwiY29tbWVudFwiOiB0eHQsXHJcbiAgICAgICAgICAgICAgICBcIm9yZGVySWRcIjogZWxlLmRhdGEoJ2lkJylcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgRGF0YS5yZWZ1c2UoZGF0YSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+WPlua2iOaIkOWKn++8gScsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCflj5bmtojlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNlbnRyeS1lbnN1cmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgXCJtZW1iZXJJZFwiOiAwLFxyXG4gICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6ICQodGhpcykuZGF0YSgnaWQnKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBEYXRhLmVudHJ5KGRhdGEsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfnoa7orqTmiJDlip/vvIEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn56Gu6K6k5aSx6LSl77yM6K+36YeN6K+V77yBJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjcmVtb3ZlLWVuc3VyZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgRGF0YS5yZW1vdmVGaWxlKHJlbW92ZUZpbGUsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUVsZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnJlbW92ZS1wYXJ0JykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+WIoOmZpOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3JlbW92ZS10eXBlLWVuc3VyZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgRGF0YS5yZW1vdmVGaWxlKHJlbW92ZUZpbGUsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUVsZS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRWxlLmZpbmQoJy50b3AnKS5odG1sKCcrJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSByZW1vdmVFbGUuZmluZCgnLmYtbmFtZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuaHRtbChhLmRhdGEoJ25hbWUnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRWxlLmZpbmQoJ2lucHV0Jykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykuYWRkQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcucmVtb3ZlLXR5cGUtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfliKDpmaTlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHVwbG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2hhbmdlJywgJyN1cC1maWxlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJyID0gWydkb2MnLCAnZG9jeCcsICd4bHMnLCAneGxzeCcsICdwZGYnLCAnanBnJywgJ3BuZycsICdibXAnXTtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdXHJcbiAgICAgICAgICAgICAgICAsIHNpemUgPSB0aGlzLmZpbGVzWzBdLnNpemVcclxuICAgICAgICAgICAgICAgICwgbmFtZSA9IHRoaXMuZmlsZXNbMF0ubmFtZTtcclxuICAgICAgICAgICAgdmFyIG5hID0gbmFtZS5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICBpZiAoYXJyLmluZGV4T2YobmFbbmEubGVuZ3RoIC0gMV0udG9Mb3dlckNhc2UoKSkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNpemUgPCAyMDk3MTUyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgRGF0YS51cCh7XCJmaWxlXCI6IG5hbWV9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEub3NzVXBsb2FkKHRva2VuLCBmaWxlLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhICYmICdzdGF0dXMnIGluIGRhdGEgJiYgZGF0YS5zdGF0dXMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6IF90aGlzLmRhdGEoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGVOYW1lXCI6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGVDb21tZW50XCI6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlOYW1lXCI6IHRva2VuLktleW5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgXCJmaWxlVHlwZVwiOiAyMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBzdWJOdW06IF90aGlzLmRhdGEoJ3NpZCcpID09IDAgPyAnJyA6IF90aGlzLmRhdGEoJ3NpZCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEuYWRkRmlsZShkLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDAgJiYganNvbi5yZXNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBqc29uLnJlc0JvZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICc8ZGl2IGNsYXNzPVwidXAtcGFydFwiPiA8ZGl2IGNsYXNzPVwidG9wXCI+JyArIGQuZmlsZUV4dGVuc2lvbi50b1VwcGVyQ2FzZSgpICsgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkbFwiIGRhdGEta2V5PVwiJyArIGQua2V5TmFtZSArICdcIj48L2E+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cInJtXCIgZGF0YS1rZXk9XCInICsgZC5rZXlOYW1lICsgJ1wiPjwvYT4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cImRwLWJcIj4nICsgZC5maWxlTmFtZSArICc8L2E+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcudXBsb2FkJykuZmluZCgnLmFkZCcpLmJlZm9yZShzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5LiK5Lyg5aSx6LSl77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmgqjkuIrkvKDnmoTmlofku7botoXov4cyTe+8geivt+mHjeaWsOmAieaLqeOAgicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aWh+S7tuagvOW8j+aUr+aMgS5kb2MvLmRvY3gvLnhscy8ueGxzeC8ucGRmLy5qcGcvLnBuZy8uYm1wJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2hhbmdlJywgJy51cC10eXBlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJyID0gWydkb2MnLCAnZG9jeCcsICd4bHMnLCAneGxzeCcsICdwZGYnLCAnanBnJywgJ3BuZycsICdibXAnXTtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdXHJcbiAgICAgICAgICAgICAgICAsIHNpemUgPSB0aGlzLmZpbGVzWzBdLnNpemVcclxuICAgICAgICAgICAgICAgICwgbmFtZSA9IHRoaXMuZmlsZXNbMF0ubmFtZTtcclxuICAgICAgICAgICAgdmFyIG5hID0gbmFtZS5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICBpZiAoYXJyLmluZGV4T2YobmFbbmEubGVuZ3RoIC0gMV0udG9Mb3dlckNhc2UoKSkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNpemUgPCAyMDk3MTUyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgRGF0YS51cCh7XCJmaWxlXCI6IG5hbWV9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEub3NzVXBsb2FkKHRva2VuLCBmaWxlLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhICYmICdzdGF0dXMnIGluIGRhdGEgJiYgZGF0YS5zdGF0dXMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6IF90aGlzLmRhdGEoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGVOYW1lXCI6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGVDb21tZW50XCI6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlOYW1lXCI6IHRva2VuLktleW5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgXCJmaWxlVHlwZVwiOiBfdGhpcy5kYXRhKCd0eXBlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YS5hZGRGaWxlKGQsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCAmJiBqc29uLnJlc0JvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlID0gX3RoaXMucGFyZW50cygnLmFkZC10eXBlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9IGQuZmlsZUV4dGVuc2lvbi50b1VwcGVyQ2FzZSgpICsgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkbFwiIGRhdGEta2V5PVwiJyArIGQua2V5TmFtZSArICdcIj48L2E+IDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJybS10eXBlXCIgZGF0YS1rZXk9XCInICsgZC5rZXlOYW1lICsgJ1wiPjwvYT4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGUuZmluZCgnLnRvcCcpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGUuZmluZCgnLmYtbmFtZScpLmh0bWwoZC5maWxlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmZpbmQoJ2lucHV0JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5LiK5Lyg5aSx6LSl77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmgqjkuIrkvKDnmoTmlofku7botoXov4cyTe+8geivt+mHjeaWsOmAieaLqeOAgicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aWh+S7tuagvOW8j+aUr+aMgS5kb2MvLmRvY3gvLnhscy8ueGxzeC8ucGRmLy5qcGcvLnBuZy8uYm1wJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2hhbmdlJywgJyN1cC1maWxlLWZkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJyID0gWydkb2MnLCAnZG9jeCcsICd4bHMnLCAneGxzeCcsICdwZGYnLCAnanBnJywgJ3BuZycsICdibXAnXTtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdXHJcbiAgICAgICAgICAgICAgICAsIHNpemUgPSB0aGlzLmZpbGVzWzBdLnNpemVcclxuICAgICAgICAgICAgICAgICwgbmFtZSA9IHRoaXMuZmlsZXNbMF0ubmFtZTtcclxuICAgICAgICAgICAgdmFyIG5hID0gbmFtZS5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICBpZiAoYXJyLmluZGV4T2YobmFbbmEubGVuZ3RoIC0gMV0udG9Mb3dlckNhc2UoKSkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNpemUgPCAyMDk3MTUyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgRGF0YS51cCh7XCJmaWxlXCI6IG5hbWV9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEub3NzVXBsb2FkKHRva2VuLCBmaWxlLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhICYmICdzdGF0dXMnIGluIGRhdGEgJiYgZGF0YS5zdGF0dXMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6IHVybC5nZXQoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGVOYW1lXCI6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpbGVDb21tZW50XCI6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlOYW1lXCI6IHRva2VuLktleW5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgXCJmaWxlVHlwZVwiOiAyMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBzdWJOdW06IF90aGlzLmRhdGEoJ3NpZCcpID09IDAgPyAnJyA6IF90aGlzLmRhdGEoJ3NpZCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEuYWRkRmlsZShkLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDAgJiYganNvbi5yZXNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBqc29uLnJlc0JvZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICc8ZGl2IGNsYXNzPVwidXAtcGFydFwiPiA8ZGl2IGNsYXNzPVwidG9wXCI+JyArIGQuZmlsZUV4dGVuc2lvbi50b1VwcGVyQ2FzZSgpICsgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkbFwiIGRhdGEta2V5PVwiJyArIGQua2V5TmFtZSArICdcIj48L2E+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cInJtXCIgZGF0YS1rZXk9XCInICsgZC5rZXlOYW1lICsgJ1wiPjwvYT4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cImRwLWJcIj4nICsgZC5maWxlTmFtZSArICc8L2E+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnRzKCcuZGRmai1wdWInKS5maW5kKCcuYWRkJykuYmVmb3JlKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfkuIrkvKDlpLHotKXvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aCqOS4iuS8oOeahOaWh+S7tui2hei/hzJN77yB6K+36YeN5paw6YCJ5oup44CCJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5paH5Lu25qC85byP5pSv5oyBLmRvYy8uZG9jeC8ueGxzLy54bHN4Ly5wZGYvLmpwZy8ucG5nLy5ibXAnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBmaWxlTGlzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBEYXRhLmZpbGVMaXN0KHtpZDogdXJsLmdldCgnaWQnKSwgc2lkOiB1cmwuZ2V0KCdzaWQnKX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwICYmIGpzb24ucmVzQm9keSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhMjIgPSAwO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYXJyW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5maWxlVHlwZSA9PSAyMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPVwidXAtcGFydFwiPiA8ZGl2IGNsYXNzPVwidG9wXCI+JyArIGQuZmlsZUV4dGVuc2lvbi50b1VwcGVyQ2FzZSgpICsgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkbFwiIGRhdGEta2V5PVwiJyArIGQua2V5TmFtZSArICdcIj48L2E+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwicm1cIiBkYXRhLWtleT1cIicgKyBkLmtleU5hbWUgKyAnXCI+PC9hPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+IDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkcC1iXCI+JyArIGQuZmlsZU5hbWUgKyAnPC9hPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLmZpbGVUeXBlID09IDIyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhMjIgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLmRsLWZpbGVbZGF0YS10eXBlPVwiJyArIGQuZmlsZVR5cGUgKyAnXCJdJykuZGF0YSgna2V5JywgZC5rZXlOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLmZpbGVUeXBlID09IDIxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeWxkID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5bGQgKz0gJzxkaXYgY2xhc3M9XCJmaWxlc1wiPiA8ZGl2IGNsYXNzPVwidG9wXCI+JyArIGFyclthXS5maWxlRXh0ZW5zaW9uLnRvVXBwZXJDYXNlKCkgKyAnPHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNpcmNsZS1hcnJvdy1kb3duXCIgZGF0YS1rZXk9XCInICsgYXJyW2FdLmtleU5hbWUgKyAnXCI+PC9zcGFuPiA8L2Rpdj4gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cImRwLWJcIj4nICsgYXJyW2FdLmZpbGVOYW1lICsgJzwvYT4gPC9kaXY+J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnlsLXBhcnQnKS5maW5kKCcuZHAtdGInKS5hcHBlbmQoeWxkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGUgPSAkKCcuYWRkLXR5cGVbZGF0YS10eXBlPScgKyBkLmZpbGVUeXBlICsgJ10nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGUuZmluZCgnaW5wdXQnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGUuZmluZCgnLnRvcCcpLmh0bWwoZC5maWxlRXh0ZW5zaW9uLnRvVXBwZXJDYXNlKCkgKyAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cImRsXCIgZGF0YS1rZXk9XCInICsgZC5rZXlOYW1lICsgJ1wiPjwvYT4gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cInJtLXR5cGVcIiBkYXRhLWtleT1cIicgKyBkLmtleU5hbWUgKyAnXCI+PC9hPiAnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZS5maW5kKCcuZi1uYW1lJykuaHRtbChkLmZpbGVOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChkYXRhMjIgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5kbFtkYXRhLXR5cGU9XCIyMlwiXScpLmFkZENsYXNzKCdub25lLWYnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICQoJy51cGxvYWQnKS5maW5kKCcuYWRkJykuYmVmb3JlKHN0cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgY2hhbmdlTGluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKCcjZ3AtdGltZScpLmRhdGV0aW1lcGlja2VyKHtcclxuICAgICAgICAgICAgZm9ybWF0OiAneXl5eS1tbS1kZCcsLy/ml6XmnJ/nmoTmoLzlvI9cclxuICAgICAgICAgICAgc3RhcnREYXRlOiBuZXcgRGF0ZSgkKCcjZ3AtdGltZScpLnZhbCgpKSwvL+mAieaLqeWZqOeahOW8gOWni+aXpeacn1xyXG4gICAgICAgICAgICBhdXRvY2xvc2U6IHRydWUsLy/ml6XmnJ/pgInmi6nlrozmiJDlkI7mmK/lkKblhbPpl63pgInmi6nmoYZcclxuICAgICAgICAgICAgYm9vdGNzc1ZlcjogMywvL+aYvuekuuWQkeW3puWQkeWPs+eahOeureWktFxyXG4gICAgICAgICAgICBsYW5ndWFnZTogJ3poLUNOJywvL+ivreiogFxyXG4gICAgICAgICAgICBtaW5WaWV3OiBcIm1vbnRoXCIvL+ihqOekuuaXpeacn+mAieaLqeeahOacgOWwj+iMg+WbtO+8jOm7mOiupOaYr2hvdXJcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgYWlybGluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignYmx1cicsICcjZ3AtZW5kJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoISQodGhpcykucHJvcCgncmVhZG9ubHknKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEkKHRoaXMpLnByb3AoJ3JlYWRvbmx5JykpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgdWwgPSBfdGhpcy5zaWJsaW5ncygnLmFqYXgtcGFydCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdWwuY2hpbGRyZW4oJy5hY3RpdmUnKS5kYXRhKCd2YWwnKSB8fCB1bC5maW5kKCdsaTpmaXJzdC1jaGlsZCcpLmRhdGEoJ3ZhbCcpIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykudmFsKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZGF0YSgndmFsJywgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdWwuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2tleXVwJywgJyNncC1lbmQnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBpZiAoISQodGhpcykucHJvcCgncmVhZG9ubHknKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgICwgdWwgPSBfdGhpcy5zaWJsaW5ncygnLmFqYXgtcGFydCcpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdWwuZmluZCgnLmFjdGl2ZScpLmluZGV4KCkgfHwgMFxyXG4gICAgICAgICAgICAgICAgICAgICwgbGVuID0gdWwuY2hpbGRyZW4oKS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7Ly/lm57ovabplK5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHVsLmNoaWxkcmVuKCcuYWN0aXZlJykuZGF0YSgndmFsJykgfHwgdWwuZmluZCgnbGk6Zmlyc3QtY2hpbGQnKS5kYXRhKCd2YWwnKSB8fCAnJztcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnZhbChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ3ZhbCcsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDM4KSB7Ly/kuIrplK5cclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGluZGV4ID09IDAgPyBsZW4gLSAxIDogaW5kZXggLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykuZXEoaW5kZXgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDQwKSB7Ly/kuIvplK5cclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGluZGV4ID09IGxlbiAtIDEgPyAwIDogaW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykuZXEoaW5kZXgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7Ly/mraPluLjovpPlhaVcclxuICAgICAgICAgICAgICAgICAgICBEYXRhLmFpcnBvcnQoe2tleTogX3RoaXMudmFsKCl9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQm9keScgaW4ganNvbiAmJiBqc29uLnJlc0JvZHkgaW5zdGFuY2VvZiBBcnJheSAmJiBqc29uLnJlc0JvZHkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICcnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBib2R5ID0ganNvbi5yZXNCb2R5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiBib2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvZHkuaGFzT3duUHJvcGVydHkoYikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBib2R5W2JdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzxsaSBkYXRhLXZhbD1cIicgKyBkLmFpcnBvcnRDb2RlICsgJ1wiIGNsYXNzPVwiJyArIChiID09IDAgPyAnYWN0aXZlJyA6ICcnKSArICdcIj4nICsgZC5kaXNwbGF5TmFtZSArICc8L2xpPidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bC5odG1sKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bC5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZW92ZXInLCAnLmFqYXgtcGFydCBsaScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCEkKHRoaXMpLnByb3AoJ3JlYWRvbmx5JykpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBnZXRDb21wYW55ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8v6I635Y+W5py65Zy65ZCN56ewXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2tleXVwJywgJyNncC1jb20nLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBpZiAoISQodGhpcykucHJvcCgncmVhZG9ubHknKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgICwgdWwgPSBfdGhpcy5zaWJsaW5ncygnLmFqYXgtcGFydCcpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdWwuZmluZCgnLmFjdGl2ZScpLmluZGV4KCkgfHwgMFxyXG4gICAgICAgICAgICAgICAgICAgICwgbGVuID0gdWwuY2hpbGRyZW4oKS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7Ly/lm57ovabplK5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHVsLmNoaWxkcmVuKCcuYWN0aXZlJykuZGF0YSgndmFsJykgfHwgdWwuZmluZCgnbGk6Zmlyc3QtY2hpbGQnKS5kYXRhKCd2YWwnKSB8fCAnJztcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnZhbChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ3ZhbCcsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDM4KSB7Ly/kuIrplK5cclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGluZGV4ID09IDAgPyBsZW4gLSAxIDogaW5kZXggLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykuZXEoaW5kZXgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDQwKSB7Ly/kuIvplK5cclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGluZGV4ID09IGxlbiAtIDEgPyAwIDogaW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmZpbmQoJ2xpJykuZXEoaW5kZXgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7Ly/mraPluLjovpPlhaVcclxuICAgICAgICAgICAgICAgICAgICBEYXRhLmdldENvZGUoe2tleTogX3RoaXMudmFsKCl9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQm9keScgaW4ganNvbiAmJiBqc29uLnJlc0JvZHkgaW5zdGFuY2VvZiBBcnJheSAmJiBqc29uLnJlc0JvZHkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICcnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBib2R5ID0ganNvbi5yZXNCb2R5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiBib2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvZHkuaGFzT3duUHJvcGVydHkoYikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBib2R5W2JdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzxsaSBkYXRhLXZhbD1cIicgKyBkLmFpcmxpbmVDb2RlICsgJ1wiIGNsYXNzPVwiJyArIChiID09IDAgPyAnYWN0aXZlJyA6ICcnKSArICdcIj4nICsgZC5jb21wYW55TmFtZSArICc8L2xpPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdWwuaHRtbChzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdWwuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvL2lucHV05aSx5Y6754Sm54K5XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2JsdXInLCAnI2dwLWNvbScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCEkKHRoaXMpLnByb3AoJ3JlYWRvbmx5JykpIHtcclxuICAgICAgICAgICAgICAgIHZhciB1bCA9ICQodGhpcykuc2libGluZ3MoJy5hamF4LXBhcnQnKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdWwuY2hpbGRyZW4oJy5hY3RpdmUnKS5kYXRhKCd2YWwnKSB8fCB1bC5maW5kKCdsaTpmaXJzdC1jaGlsZCcpLmRhdGEoJ3ZhbCcpIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS52YWwoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ3ZhbCcsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgdWwuaGlkZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIGNvbnRhY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHBiID0ge1xyXG4gICAgICAgICAgICB0eXBlOiAxICAvLzHkuLrlj5HotKfkurrmk43kvZzvvIwy5Li65pS26LSn5Lq65pON5L2c77yMM+S4uumAmuefpeS6ulxyXG4gICAgICAgICAgICAsIG9wZXJhdGU6IDEgIC8vMeS4uuaWsOW7uuaTjeS9nO+8jDLkuLrmkJzntKLmk43kvZxcclxuICAgICAgICAgICAgLCBvZmZzZXQ6IDAgIC8v5pCc57Si5YiG6aG15YGP56e76YePXHJcbiAgICAgICAgICAgICwgbGltaXQ6IDUgICAgLy/liIbpobXpmZDliLbmnaHmlbBcclxuICAgICAgICAgICAgLCBkYXRhOiB7fSAgLy/nvJPlrZjor7fmsYLmlbDmja5cclxuICAgICAgICB9O1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2xvc2UtYycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcGIub2Zmc2V0ID0gMDtcclxuICAgICAgICAgICAgJCgnLmNvbnRhY3QtbW9kYWwnKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/mlLblj5HotKfkurrkv6Hmga/nvJbovpFcclxuICAgICAgICB2YXIgc05tLHNOYyxzTm4sc05lO1xyXG4gICAgICAgIC8vdmFyIHNwYW5UZXh0PWZ1bmN0aW9uKG9iaixpKXtcclxuICAgICAgICAvLyAgICAkKCcjcy1uYW1lJykudmFsKCcnKTtcclxuICAgICAgICAvLyAgICAkKCcjcy1keicpLnZhbCgnJyk7XHJcbiAgICAgICAgLy8gICAgJCgnI3MtZGgnKS52YWwoJycpO1xyXG4gICAgICAgIC8vICAgICQoJyNzLXBlcnNvbicpLnZhbCgnJyk7XHJcbiAgICAgICAgLy8gICAgJCgnI3MtbWFpbCcpLnZhbCgnJyk7XHJcbiAgICAgICAgLy8gICAgJCgnI3MtY3onKS52YWwoJycpO1xyXG4gICAgICAgIC8vICAgIHZhciBwYXJlbnQ9JChvYmopLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJ3NwYW4nKS5lcShpKS5wYXJlbnQoKS5jbG9uZSgpO1xyXG4gICAgICAgIC8vICAgIHBhcmVudC5maW5kKCdzcGFuJykucmVtb3ZlKCk7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuIHBhcmVudC50ZXh0KCk7XHJcbiAgICAgICAgLy8gICAgcGFyZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIC8vfTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNob3ctY29udGFjdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcGIudHlwZSA9ICQodGhpcykuZGF0YSgndCcpID09ICfmlLbotKfkuronID8gMiA6IDE7XHJcbiAgICAgICAgICAgIHN3aXRjaCgkKHRoaXMpLmRhdGEoJ3QnKSl7XHJcbiAgICAgICAgICAgICAgICBjYXNlICfmlLbotKfkuronOlxyXG4gICAgICAgICAgICAgICAgICAgIHBiLnR5cGU9MjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ+WPkei0p+S6uic6XHJcbiAgICAgICAgICAgICAgICAgICAgcGIudHlwZT0xO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAn6YCa55+l5Lq6JzpcclxuICAgICAgICAgICAgICAgICAgICBwYi50eXBlPTM7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3BlU2lkID0gJCh0aGlzKS5kYXRhKCdzaWQnKSB8fCBudWxsO1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLmNvbnRhY3QtbW9kYWwnKTtcclxuICAgICAgICAgICAgdmFyIGQ7XHJcbiAgICAgICAgICAgIC8vdmFyIGQgPSBwYi50eXBlID09IDEgPyBmaHIgOiBzaHI7XHJcbiAgICAgICAgICAgIHN3aXRjaChwYi50eXBlKXtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICBkPWZocjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICBkPXNocjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICBkPXR6cjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxlLmZpbmQoJy5jb250YWN0LXBhZ2UnKS5odG1sKCcnKTtcclxuICAgICAgICAgICAgJCgnLmN0LXJlcXVpcmUnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLm5ldycpLnNob3coKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJy5zZWFyY2gnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcjc2F2ZS1jb250YWN0Jykuc2hvdygpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnI2Vuc3VyZS1jb250YWN0JykuaGlkZSgpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnI3MtbmFtZScpLnZhbChkLmNvbnRhY3ROYW1lIHx8ICcnKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJyNzLWR6JykudmFsKGQuY29udGFjdEFkZHJlc3MgfHwgJycpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnI3MtcGVyc29uJykudmFsKGQuY29udGFjdFBlcnNvbiB8fCAnJyk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcjcy1kaCcpLnZhbChkLmNvbnRhY3RUZWwgfHwgJycpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnI3MtbWFpbCcpLnZhbChkLmNvbnRhY3RFbWFpbCB8fCAnJyk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcjcy1jeicpLnZhbChkLmNvbnRhY3RGYXggfHwgJycpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmhlYWRlcicpLmh0bWwoJCh0aGlzKS5kYXRhKCd0JykgKyAn6K6+572uPHNwYW4gY2xhc3M9XCJjbG9zZS1jXCI+WDwvc3Bhbj4nKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJy5zaG93LW5hbWUnKS5odG1sKCQodGhpcykuZGF0YSgndCcpKTtcclxuICAgICAgICAgICAgJCgnI2MtbmFtZScpLnZhbCgnJyk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCd0Ym9keScpLmh0bWwoJzx0ciBjbGFzcz1cIndyb25nXCI+IDx0ZCBjb2xzcGFuPVwiNVwiPuivt+aQnOe0ojwvdGQ+IDwvdHI+Jyk7XHJcbiAgICAgICAgICAgIGVsZS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/mlLblj5HotKfkurrkv6Hmga/nvJbovpFcclxuICAgICAgICB2YXIgc05tLHNOYyxzTm4sc05lO1xyXG4gICAgICAgICAgICAvL3BiLnR5cGUgPSAkKHRoaXMpLmRhdGEoJ3QnKSA9PSAn5pS26LSn5Lq6JyA/IDIgOiAxO1xyXG4gICAgICAgICAgICAvLyQoJyNzLW5hbWUnKS52YWwoJycpO1xyXG4gICAgICAgICAgICAvLyQoJyNzLWRoJykudmFsKCcnKTtcclxuICAgICAgICAgICAgLy8kKCcjcy1wZXJzb24nKS52YWwoJycpO1xyXG4gICAgICAgICAgICAvLyQoJyNzLW1haWwnKS52YWwoJycpO1xyXG4gICAgICAgICAgICBvcGVTaWQgPSAkKHRoaXMpLmRhdGEoJ3NpZCcpIHx8IG51bGw7XHJcbiAgICAgICAgICAgIHZhciBlbGUgPSAkKCcuY29udGFjdC1tb2RhbCcpO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZmQtdG9wIC5zaG93LWNvbnRhY3QnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCgkKHRoaXMpLmRhdGEoJ3QnKSl7XHJcbiAgICAgICAgICAgICAgICBjYXNlICfmlLbotKfkuronOlxyXG4gICAgICAgICAgICAgICAgICAgIHBiLnR5cGU9MjtcclxuICAgICAgICAgICAgICAgICAgICBzTm09JCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCcub2NOYW1lJykuaHRtbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNOYz0kKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJy5vY2NwJykuaHRtbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNObj0kKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJy5vY1RlbCcpLmh0bWwoKTtcclxuICAgICAgICAgICAgICAgICAgICBzTmU9JCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCcub2NFbWFpbCcpLmh0bWwoKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ+WPkei0p+S6uic6XHJcbiAgICAgICAgICAgICAgICAgICAgcGIudHlwZT0xO1xyXG4gICAgICAgICAgICAgICAgICAgIHNObT0kKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJy5vc05hbWUnKS5odG1sKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc05jPSQodGhpcykucGFyZW50KCkucGFyZW50KCkuZmluZCgnLm9zY3AnKS5odG1sKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc05uPSQodGhpcykucGFyZW50KCkucGFyZW50KCkuZmluZCgnLm9zVGVsJykuaHRtbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNOZT0kKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJy5vc0VtYWlsJykuaHRtbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAn6YCa55+l5Lq6JzpcclxuICAgICAgICAgICAgICAgICAgICBwYi50eXBlPTM7XHJcbiAgICAgICAgICAgICAgICAgICAgc05tPSQodGhpcykucGFyZW50KCkucGFyZW50KCkuZmluZCgnLm90TmFtZScpLmh0bWwoKTtcclxuICAgICAgICAgICAgICAgICAgICBzTmM9JCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCcub3RjcCcpLmh0bWwoKTtcclxuICAgICAgICAgICAgICAgICAgICBzTm49JCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCcub3RUZWwnKS5odG1sKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc05lPXNOZT0kKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJy5vdEVtYWlsJykuaHRtbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgc2R6PSQodGhpcykuZGF0YSgnZHonKSB8fCAnJztcclxuICAgICAgICAgICAgdmFyIHNjej0kKHRoaXMpLmRhdGEoJ2ZheCcpIHx8ICcnO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmNvbnRhY3QtcGFnZScpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAkKCcuY3QtcmVxdWlyZScpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcubmV3Jykuc2hvdygpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLnNlYXJjaCcpLmhpZGUoKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJyNzYXZlLWNvbnRhY3QnKS5zaG93KCk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcjZW5zdXJlLWNvbnRhY3QnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcjcy1uYW1lJykudmFsKHNObSB8fCAnJykgO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnI3MtZHonKS52YWwoc2R6IHx8ICcnKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJyNzLXBlcnNvbicpLnZhbChzTmMgfHwgJycpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnI3MtZGgnKS52YWwoc05uIHx8ICcnKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJyNzLW1haWwnKS52YWwoc05lIHx8ICcnKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJyNzLWN6JykudmFsKHNjeiB8fCAnJyk7XHJcbiAgICAgICAgICAgIGVsZS5maW5kKCcuaGVhZGVyJykuaHRtbCgkKHRoaXMpLmRhdGEoJ3QnKSArICforr7nva48c3BhbiBjbGFzcz1cImNsb3NlLWNcIj5YPC9zcGFuPicpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLnNob3ctbmFtZScpLmh0bWwoJCh0aGlzKS5kYXRhKCd0JykpO1xyXG4gICAgICAgICAgICAkKCcjYy1uYW1lJykudmFsKCcnKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJ3Rib2R5JykuaHRtbCgnPHRyIGNsYXNzPVwid3JvbmdcIj4gPHRkIGNvbHNwYW49XCI1XCI+6K+35pCc57SiPC90ZD4gPC90cj4nKTtcclxuICAgICAgICAgICAgZWxlLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zZWwtdHAgc3BhbicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy5jb250YWN0LW1vZGFsJyk7XHJcbiAgICAgICAgICAgIHBiLm9wZXJhdGUgPSAkKHRoaXMpLmRhdGEoJ3RwJyk7XHJcbiAgICAgICAgICAgIGlmIChwYi5vcGVyYXRlID09IDEpIHtcclxuICAgICAgICAgICAgICAgIGVsZS5maW5kKCcubmV3Jykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgZWxlLmZpbmQoJyNzYXZlLWNvbnRhY3QnKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICBlbGUuZmluZCgnLnNlYXJjaCcpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIGVsZS5maW5kKCcjZW5zdXJlLWNvbnRhY3QnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlbGUuZmluZCgnLm5ldycpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIGVsZS5maW5kKCcjc2F2ZS1jb250YWN0JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgZWxlLmZpbmQoJy5zZWFyY2gnKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICBlbGUuZmluZCgnI2Vuc3VyZS1jb250YWN0Jykuc2hvdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/kuLvljZXmt7vliqDmlLblj5HotKfkurrkv6Hmga9cclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3NhdmUtY29udGFjdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy5jb250YWN0LW1vZGFsJyk7XHJcbiAgICAgICAgICAgIHZhciBwYXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgJCgnLmN0LXJlcXVpcmUnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHBhc3MpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIFwib3JkZXJJZFwiOiAkKHRoaXMpLmRhdGEoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJtZW1iZXJJZFwiOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIFwic3ViTnVtXCI6IG9wZVNpZCxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3RUeXBlXCI6IHBiLnR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWN0TmFtZVwiOiBlbGUuZmluZCgnI3MtbmFtZScpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGFjdEFkZHJlc3NcIjogZWxlLmZpbmQoJyNzLWR6JykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWN0UGVyc29uXCI6IGVsZS5maW5kKCcjcy1wZXJzb24nKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3RUZWxcIjogZWxlLmZpbmQoJyNzLWRoJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWN0RmF4XCI6IGVsZS5maW5kKCcjcy1jeicpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGFjdEVtYWlsXCI6IGVsZS5maW5kKCcjcy1tYWlsJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJpc1NhdmVcIjogJCgnI3Mtc2F2ZScpLnByb3AoJ2NoZWNrZWQnKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIERhdGEucGVyc29uQWRkKGRhdGEsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coanNvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+iuvue9ruaIkOWKn++8gScsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn6K6+572u5aSx6LSl77yM6K+36YeN6K+V77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2Vuc3VyZS1jb250YWN0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgaWQgPSAkKCdpbnB1dFtuYW1lPVwiYy1zZ1wiXTpjaGVja2VkJykuZGF0YSgnaWQnKTtcclxuICAgICAgICAgICAgaWYgKGlkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHBiLmRhdGFbaWRdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy5jb250YWN0LW1vZGFsJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBcIm9yZGVySWRcIjogJCh0aGlzKS5kYXRhKCdpZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGFjdFR5cGVcIjogcGIudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVwiOiBvcGVTaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWN0TmFtZVwiOiBkLmNvbnRhY3ROYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGFjdEFkZHJlc3NcIjogZC5jb250YWN0QWRkcmVzcyxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3RQZXJzb25cIjogZC5jb250YWN0UGVyc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGFjdFRlbFwiOiBkLmNvbnRhY3RUZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWN0RmF4XCI6IGQuY29udGFjdEZheCxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3RFbWFpbFwiOiBkLmNvbnRhY3RFbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICBcImlzU2F2ZVwiOiAkKCcjcy1zYXZlJykucHJvcCgnY2hlY2tlZCcpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgRGF0YS5wZXJzb25BZGQoZGF0YSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhqc29uKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn6K6+572u5oiQ5Yqf77yBJywgbnVsbCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICforr7nva7lpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfor7fpgInmi6nkuIDkuKrmlLblj5HotKfkurrvvIEnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjc2VhcmNoLXAnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHBiLm9mZnNldCA9IDA7XHJcbiAgICAgICAgICAgIGNJbml0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5jb250YWN0LXBhZ2UgLnBhZ2VzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBwYi5vZmZzZXQgPSAkKHRoaXMpLmRhdGEoJ29mZnNldCcpO1xyXG4gICAgICAgICAgICBjSW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBjSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICB0cDogcGIudHlwZVxyXG4gICAgICAgICAgICAgICAgLCBrZXk6ICQoJyNjLW5hbWUnKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgLCBvZmZzZXQ6IHBiLm9mZnNldFxyXG4gICAgICAgICAgICAgICAgLCBsaW1pdDogcGIubGltaXRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgRGF0YS5jb250YWN0TGlzdChkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgICAgICAgICAgcGIuZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXJyID0ganNvbi5yZXNCb2R5LnNMaXN0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyci5oYXNPd25Qcm9wZXJ0eShhKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYXJyW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBiLmRhdGFbZC5jb250YWN0SWRdID0gZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJyA8dHI+IDx0ZD48aW5wdXQgZGF0YS1pZD1cIicgKyBkLmNvbnRhY3RJZCArICdcIiB0eXBlPVwicmFkaW9cIiBuYW1lPVwiYy1zZ1wiLz48L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIDx0ZD4nICsgZC5jb250YWN0TmFtZSArICc8L3RkPiA8dGQ+JyArIGQuY29udGFjdEFkZHJlc3MgKyAnPC90ZD4gPHRkPicgKyBkLmNvbnRhY3RQZXJzb24gKyAnPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyA8dGQ+JyArIGQuY29udGFjdFRlbCArICc8L3RkPiA8L3RyPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5idXJzdGVyKCQoJy5jb250YWN0LXBhZ2UnKSwgcGIub2Zmc2V0IHx8IDAsIGpzb24ucmVzQm9keS50b3RhbENvdW50LCA1LCBwYi5saW1pdCB8fCA1KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzx0ciBjbGFzcz1cIndyb25nXCI+IDx0ZCBjb2xzcGFuPVwiNVwiPuaaguaXoOaUtuWPkei0p+S6uu+8jOivt+a3u+WKoO+8gTwvdGQ+IDwvdHI+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnLmNvbnRhY3QtcGFnZScpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8dHIgY2xhc3M9XCJ3cm9uZ1wiPiA8dGQgY29sc3Bhbj1cIjVcIj7or7fmsYLlh7rplJnvvIzor7fph43or5XvvIE8L3RkPiA8L3RyPic7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmNvbnRhY3QtcGFnZScpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJCgnLmNvbnRhY3QtbW9kYWwnKS5maW5kKCd0Ym9keScpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBjb25zb2xlLmxvZyhkbERhdGEpO1xyXG4gICAgdmFyIGRsTWFwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjb3Blbl9tYXAnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIERhdGEud2FyZWhvdXNlKHtpZDogJCh0aGlzKS5kYXRhKCdpZCcpfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBqc29uLnJlc0JvZHkgfHwge307XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnctbmFtZScpLmh0bWwoZC53YXJlaG91c2VOYW1lIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnctYWRkcmVzcycpLmh0bWwoZC53YXJlaG91c2VBZGRyZXNzIHx8ICcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLnctdGVsJykuaHRtbChkLndhcmVob3VzZUNvbnRhY3QgfHwgJy8nICsgJyjnlLXor53vvJonICsgZC53YXJlaG91c2VUZWwgfHwgJy8nICsgJ++8jOS8oOecn++8micgKyBkLndhcmVob3VzZUZheCB8fCAnLycgKyAnKScpO1xyXG4gICAgICAgICAgICAgICAgICAgIERhdGEuZG93bih7XCJmaWxlXCI6IGQud2FyZWhvdXNlTWFwfSwgZnVuY3Rpb24gKGJvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvZHkgJiYgJ3Jlc0NvZGUnIGluIGJvZHkgJiYgYm9keS5yZXNDb2RlID09IDAgJiYgYm9keS5yZXNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlID0gJzxpbWcgYWx0PVwi6L+b5LuT5Zyw5Zu+XCIgc3JjPVwiJyArIGJvZHkucmVzQm9keSArICdcIi8+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5tYXAtbWFpbicpLmh0bWwoZWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjZGwtbWFwJykuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8kKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vJCgnLm1hcCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZGwtbWFwJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLmRsLXBhcnQnKS5odG1sKCk7XHJcbiAgICAgICAgICAgIHZhciBzdHIgPSAnPCFET0NUWVBFIGh0bWw+IDxodG1sIGxhbmc9XCJ6aC1DTlwiPiA8aGVhZD4gPG1ldGEgY2hhcnNldD1cIlVURi04XCI+IDxtZXRhIG5hbWU9XCJHZW5lcmF0b3JcIiBjb250ZW50PVwiSmVyZW15XCI+IDxtZXRhIG5hbWU9XCJBdXRob3JcIiBjb250ZW50PVwiSmVyZW15XCI+IDxtZXRhIG5hbWU9XCJLZXl3b3Jkc1wiIGNvbnRlbnQ9XCJcIj4gPG1ldGEgbmFtZT1cIkRlc2NyaXB0aW9uXCIgY29udGVudD1cIlwiPiA8dGl0bGU+IOS4i+i9vei/m+S7k+WcsOWbviA8L3RpdGxlPiA8c3R5bGU+LmJvZHl7d2lkdGg6MTIwMHB4O21hcmdpbjowIGF1dG87fXB7aGVpZ2h0OjMwcHg7bGluZS1oZWlnaHQ6MzBweDt9cCBzcGFue2Rpc3BsYXk6YmxvY2s7ZmxvYXQ6bGVmdDtoZWlnaHQ6MzBweDtsaW5lLWhlaWdodDozMHB4O30udGl0bGV7d2lkdGg6MTAwcHg7dGV4dC1hbGlnbjpsZWZ0O30ubWFwLW1haW57aGVpZ2h0OjYwMHB4O3dpZHRoOjEwMCV9aW1ne2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7fSA8L3N0eWxlPiA8L2hlYWQ+IDxib2R5PiA8ZGl2IGNsYXNzPVwiYm9keVwiPiAnICsgZWxlICsgJzwvZGl2PiA8L2JvZHk+IDwvaHRtbD4nO1xyXG4gICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9kb3duL3BkZidcclxuICAgICAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICAgICAsIGRhdGE6IHtjb2RlOiBzdHIsIG5hbWU6ICfov5vku5PlnLDlm74nfVxyXG4gICAgICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgnc3RhdHVzJyBpbiBqc29uICYmIGpzb24uc3RhdHVzID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oXCIvZ2V0SW1nQ29kZS9wZGZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgZGxCaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWdlbnRDb21wYW55SWQ6IDEwMDAwXHJcbiAgICAgICAgICAgICwgYWlyQ29tcGFueUNvZGU6IGRsRGF0YS5oa2dzXHJcbiAgICAgICAgICAgICwgYWlycG9ydENvZGU6IGRsRGF0YS5xeWdcclxuICAgICAgICB9O1xyXG4gICAgICAgIERhdGEuY29tcGFueURldGFpbChkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNCb2R5JyBpbiBqc29uICYmIGpzb24ucmVzQm9keSBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0ganNvbi5yZXNCb2R5O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImZpbGVzXCI+IDxkaXYgY2xhc3M9XCJ0b3BcIj4nICsgYXJyW2FdLmZpbGVFeHRlbnNpb24udG9VcHBlckNhc2UoKSArICc8c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2lyY2xlLWFycm93LWRvd25cIiBkYXRhLWtleT1cIicgKyBhcnJbYV0ua2V5TmFtZSArICdcIj48L3NwYW4+IDwvZGl2PiA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwiZHAtYlwiPicgKyBhcnJbYV0uZmlsZU5hbWUgKyAnPC9hPiA8L2Rpdj4nXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3RyID0gJzxkaXYgY2xhc3M9XCJuby1maWxlXCI+5pqC5peg5L+d5Ye977yBPC9kaXY+J1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICQoJy5iaC1wYXJ0JykuZmluZCgnLmRwLXRiJykuaHRtbChzdHIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZGwtYmgnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnLmJoLXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZ2x5cGhpY29uLWNpcmNsZS1hcnJvdy1kb3duJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoJCh0aGlzKS5kYXRhKCd0eXBlJykgPT0gJ3lsZCcpIHtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSAnL3ZpcC9vcmRlci9kZXRhaWwveWxkP2lkPScgKyAkKHRoaXMpLmRhdGEoJ2tleScpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCQodGhpcykuZGF0YSgndHlwZScpID09ICdja2QnKSB7XHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gJy92aXAvb3JkZXIvZGV0YWlsL2NrZD9pZD0nICsgJCh0aGlzKS5kYXRhKCdrZXknKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBmaWxlID0gJCh0aGlzKS5kYXRhKCdrZXknKTtcclxuICAgICAgICAgICAgICAgIERhdGEuZG93bih7ZmlsZTogZmlsZX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0JvZHknIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oanNvbi5yZXNCb2R5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB0cmFja0luaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgIHZhciBpZCA9ICQoJyN5ZGgnKS5kYXRhKCdubycpO1xyXG4gICAgICAgIGlmIChpZCAhPSAwKSB7XHJcbiAgICAgICAgICAgIERhdGEudHJhY2soe2lkOiBpZH0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQm9keScgaW4ganNvbiAmJiBqc29uLnJlc0JvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJ3RyYWNrTGlzdCcgaW4gYiAmJiBiLnRyYWNrTGlzdCBpbnN0YW5jZW9mIEFycmF5ICYmIGIudHJhY2tMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyciA9IGIudHJhY2tMaXN0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyci5oYXNPd25Qcm9wZXJ0eShhKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYXJyW2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPHRyPjx0ZD4nICsgZC5pdGVtRGF0ZSArICc8L3RkPjx0ZD4nICsgZC5pdGVtTG9jYXRpb24gKyAnPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD4nICsgZC5pdGVtQ29kZSArICc8L3RkPjx0ZD4nICsgZC5pdGVtRGVzY3JpcHRpb24gKyAnPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD4nICsgZC5jYXJnb0NvdW50ICsgJzwvdGQ+PHRkPicgKyBkLmNhcmdvV2VpZ2h0ICsgJzwvdGQ+PC90cj4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnlkdGInKS5maW5kKCd0Ym9keScpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnlkdGInKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdmFyIGRlY2xhcmVEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIERhdGEuZGVjbGFyZURhdGEoe2lkOiB1cmwuZ2V0KCdpZCcpfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQm9keScgaW4ganNvbiAmJiBqc29uLnJlc0JvZHkpIHtcclxuICAgICAgICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImZpbGVzXCI+IDxkaXYgY2xhc3M9XCJ0b3BcIj5QREY8c3BhbiBkYXRhLXR5cGU9XCJ5bGRcIiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2lyY2xlLWFycm93LWRvd25cIiBkYXRhLWtleT1cIicgKyB1cmwuZ2V0KCdpZCcpICsgJ1wiPjwvc3Bhbj4gPC9kaXY+IDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkcC1iXCI+55S15a2Q6aKE5b2V5Y2VPC9hPiA8L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZpbGVzXCI+IDxkaXYgY2xhc3M9XCJ0b3BcIj5QREY8c3BhbiBkYXRhLXR5cGU9XCJja2RcIiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2lyY2xlLWFycm93LWRvd25cIiBkYXRhLWtleT1cIicgKyB1cmwuZ2V0KCdpZCcpICsgJ1wiPjwvc3Bhbj4gPC9kaXY+IDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkcC1iXCI+5pS+6KGM6YCa55+l5LmmPC9hPiA8L2Rpdj4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICQoJy55bC1wYXJ0JykuZmluZCgnLmRwLXRiJykuYXBwZW5kKHN0cik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHN1YkRhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NoYW5nZScsICcudGQtc2csLmZkLXNnJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3RyJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgJCh0aGlzKS5wcm9wKCdjaGVja2VkJykgPyAnI2M3ZWRmZicgOiAnI2ZmZicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjc2VsLXRkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcudGQtc2cnKS5wcm9wKCdjaGVja2VkJywgJCh0aGlzKS5wcm9wKCdjaGVja2VkJykpLnRyaWdnZXIoJ2NoYW5nZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjc2VsLWZkLWFsbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHRiID0gJCh0aGlzKS5wYXJlbnRzKCd0YWJsZScpO1xyXG4gICAgICAgICAgICB0Yi5maW5kKCcuZmQtc2cnKS5wcm9wKCdjaGVja2VkJywgJCh0aGlzKS5wcm9wKCdjaGVja2VkJykpLnRyaWdnZXIoJ2NoYW5nZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2ctdGFiJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgJCgnIycgKyAkKHRoaXMpLmRhdGEoJ3RhcicpKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQodGhpcykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQoJyMnICsgJCh0aGlzKS5kYXRhKCd0YXInKSkuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQoJyNjZGQnKS5wcm9wKCdkaXNhYmxlZCcsICQodGhpcykuZGF0YSgndGFyJykgPT0gJ3dmZGh3Jyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy55ZmQtYnRuJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICBfdGhpcy5maW5kKCcuZmwtcicpLmh0bWwoX3RoaXMuZmluZCgnLmZsLXInKS5odG1sKCkgPT0gJyvlsZXlvIAnID8gJy3mlLbotbcnIDogJyvlsZXlvIAnKTtcclxuICAgICAgICAgICAgdmFyIHRhciA9ICQoJCh0aGlzKS5kYXRhKCd0YXJnZXQnKSk7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5kYXRhKCd0aW1lJykgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgJCgnLmxvYWRpbmctcGFydCcpLnNob3coKTtcclxuICAgICAgICAgICAgICAgIERhdGEub3JkZXJEZXRhaWwoe1xyXG4gICAgICAgICAgICAgICAgICAgIG9yZGVySWQ6IHVybC5nZXQoJ2lkJylcclxuICAgICAgICAgICAgICAgICAgICAsIHN1Yk9yZGVyTnVtOiAkKHRoaXMpLmRhdGEoJ2lkJylcclxuICAgICAgICAgICAgICAgICAgICAsIGFnZW50Q29tcGFueUlkOiAxMDAwMFxyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kYXRhKCd0aW1lJywgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJvZHkgPSBqc29uLnJlc0JvZHkgfHwge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvID0gJ29yZGVyJyBpbiBib2R5ICYmIGJvZHkub3JkZXIgfHwge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYoby5vcmRlclNoaXBwZXIgJiYgby5vcmRlclNoaXBwZXIgaW4gbyAmJiAnY29udGFjdE5hbWUnIGluIG8ub3JkZXJTaGlwcGVyICYmIG8ub3JkZXJTaGlwcGVyLmNvbnRhY3ROYW1lICYmIG8ub3JkZXJTaGlwcGVyLmNvbnRhY3ROYW1lPT0nbnVsbCcpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL31lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/lj5HotKfkurrkv6Hmga/mi7zmjqVcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPVwiZmQtdG9wIGZpbGxcIj4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvLm9yZGVyU2hpcHBlciAmJiAnY29udGFjdE5hbWUnIGluIG8ub3JkZXJTaGlwcGVyICYmIG8ub3JkZXJTaGlwcGVyLmNvbnRhY3ROYW1lICYmIG8ub3JkZXJTaGlwcGVyLmNvbnRhY3ROYW1lIT0nbnVsbCcgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzxkaXYgY2xhc3M9XCJmZC1pbmZvXCI+IDxwIGNsYXNzPVwidGl0bGVcIj7lj5HotKfkurrkv6Hmga8gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cInNob3ctY29udGFjdFwiIGRhdGEtdD1cIuWPkei0p+S6ulwiIGRhdGEtc2lkPVwiJyArIChvLnN1Yk51bSB8fCAwKSArICdcIiBkYXRhLWR6PVwiJyArIG8ub3JkZXJTaGlwcGVyLmNvbnRhY3RBZGRyZXNzICsgJ1wiIGRhdGEtZmF4PVwiJyArIG8ub3JkZXJTaGlwcGVyLmNvbnRhY3RGYXggKyAnXCI+57yW6L6RPC9hPiA8L3A+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPHAgY2xhc3M9XCJvc05hbWVcIj4nICsgby5vcmRlclNoaXBwZXIuY29udGFjdE5hbWUgKyAnPC9wPiA8cCBjbGFzcz1cIm9zY3BcIj4nICsgby5vcmRlclNoaXBwZXIuY29udGFjdFBlcnNvbiArICc8L3A+IDxwIGNsYXNzPVwib3NUZWxcIj4nICsgby5vcmRlclNoaXBwZXIuY29udGFjdFRlbCArICc8L3A+IDxwIGNsYXNzPVwib3NFbWFpbFwiPicgKyBvLm9yZGVyU2hpcHBlci5jb250YWN0RW1haWwgKyAnPC9wPiA8L2Rpdj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPVwiZmQtaW5mb1wiPiA8cCBjbGFzcz1cInRpdGxlXCI+5Y+R6LSn5Lq65L+h5oGvIDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJzaG93LWNvbnRhY3RcIiBkYXRhLXQ9XCLlj5HotKfkurpcIiBkYXRhLXNpZD1cIicgKyAoby5zdWJOdW0gfHwgMCkgKyAnXCIgZGF0YS1kej1cIicgKyBvLm9yZGVyU2hpcHBlci5jb250YWN0QWRkcmVzcyArICdcIiBkYXRhLWZheD1cIicgKyBvLm9yZGVyU2hpcHBlci5jb250YWN0RmF4ICsgJ1wiPue8lui+kTwvYT4gIDwvcD4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8cCBjbGFzcz1cIm5vLXNmaHJcIj7mmoLml6Dlj5HotKfkurrkv6Hmga88L3A+PC9kaXY+J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5pS26LSn5Lq65L+h5oGv5ou85o6lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvLm9yZGVyQ29uc2lnbmVlICYmICdjb250YWN0TmFtZScgaW4gby5vcmRlckNvbnNpZ25lZSAmJiBvLm9yZGVyQ29uc2lnbmVlLmNvbnRhY3ROYW1lICYmIG8ub3JkZXJDb25zaWduZWUuY29udGFjdE5hbWUhPSdudWxsJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPVwiZmQtaW5mb1wiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8cCBjbGFzcz1cInRpdGxlXCI+5pS26LSn5Lq65L+h5oGvICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwic2hvdy1jb250YWN0XCIgZGF0YS10PVwi5pS26LSn5Lq6XCIgZGF0YS1zaWQ9XCInICsgKG8uc3ViTnVtIHx8IDApICsgJ1wiIGRhdGEtZHo9XCInICsgby5vcmRlckNvbnNpZ25lZS5jb250YWN0QWRkcmVzcyAgKyAnXCIgZGF0YS1mYXg9XCInICsgby5vcmRlckNvbnNpZ25lZS5jb250YWN0RmF4ICsgJ1wiPue8lui+kTwvYT4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9wPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzxwIGNsYXNzPVwib2NOYW1lXCI+JyArIG8ub3JkZXJDb25zaWduZWUuY29udGFjdE5hbWUgKyAnPC9wPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHAgY2xhc3M9XCJvY2NwXCI+JyArIG8ub3JkZXJDb25zaWduZWUuY29udGFjdFBlcnNvbiArICc8L3A+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8cCBjbGFzcz1cIm9jVGVsXCI+JyArIG8ub3JkZXJDb25zaWduZWUuY29udGFjdFRlbCArICc8L3A+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyA8cCBjbGFzcz1cIm9jRW1haWxcIj4nICsgby5vcmRlckNvbnNpZ25lZS5jb250YWN0RW1haWwgKyAnPC9wPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImZkLWluZm9cIj4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxwIGNsYXNzPVwidGl0bGVcIj7mlLbotKfkurrkv6Hmga8gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJzaG93LWNvbnRhY3RcIiBkYXRhLXQ9XCLmlLbotKfkurpcIiBkYXRhLXNpZD1cIicgKyAoby5zdWJOdW0gfHwgMCkgKyAnXCIgZGF0YS1kej1cIicgKyBvLm9yZGVyQ29uc2lnbmVlLmNvbnRhY3RBZGRyZXNzICsgJ1wiIGRhdGEtZmF4PVwiJyArIG8ub3JkZXJDb25zaWduZWUuY29udGFjdEZheCArICdcIj7nvJbovpE8L2E+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyA8L3A+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPHAgY2xhc3M9XCJuby1zZmhyXCI+5pqC5peg5pS26LSn5Lq65L+h5oGvPC9wPjwvZGl2PidcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+mAmuefpeS6uuS/oeaBr+aLvOaOpVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoby5vcmRlck5vdGlmaWVyICYmICdjb250YWN0TmFtZScgaW4gby5vcmRlck5vdGlmaWVyICYmIG8ub3JkZXJOb3RpZmllci5jb250YWN0TmFtZSAmJiBvLm9yZGVyTm90aWZpZXIuY29udGFjdE5hbWUhPSdudWxsJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPVwiZmQtaW5mb1wiPiA8cCBjbGFzcz1cInRpdGxlXCI+6YCa55+l5Lq65L+h5oGvIDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJzaG93LWNvbnRhY3RcIiBkYXRhLXQ9XCLpgJrnn6XkurpcIiBkYXRhLXNpZD1cIicgKyAoby5zdWJOdW0gfHwgMCkgKyAnXCIgZGF0YS1kej1cIicgKyBvLm9yZGVyTm90aWZpZXIuY29udGFjdEFkZHJlc3MgKyAnXCIgZGF0YS1mYXg9XCInICsgby5vcmRlck5vdGlmaWVyLmNvbnRhY3RGYXggKyAnXCI+57yW6L6RPC9hPiA8L3A+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPHAgY2xhc3M9XCJvdE5hbWVcIj4nICsgby5vcmRlck5vdGlmaWVyLmNvbnRhY3ROYW1lICsgJzwvcD4gPHAgY2xhc3M9XCJvdGNwXCI+JyArIG8ub3JkZXJOb3RpZmllci5jb250YWN0UGVyc29uICsgJzwvcD4gPHAgY2xhc3M9XCJvdFRlbFwiPicgKyBvLm9yZGVyTm90aWZpZXIuY29udGFjdFRlbCArICc8L3A+IDxwIGNsYXNzPVwib3RFbWFpbFwiPicgKyBvLm9yZGVyTm90aWZpZXIuY29udGFjdEVtYWlsICsgJzwvcD4gPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImZkLWluZm9cIj4gPHAgY2xhc3M9XCJ0aXRsZVwiPumAmuefpeS6uuS/oeaBryA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwic2hvdy1jb250YWN0XCIgZGF0YS10PVwi6YCa55+l5Lq6XCIgZGF0YS1zaWQ9XCInICsgKG8uc3ViTnVtIHx8IDApICsgJ1wiIGRhdGEtZHo9XCJcIiBkYXRhLWZheD1cIlwiPue8lui+kTwvYT4gPC9wPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzxwIGNsYXNzPVwibm8tc2ZoclwiPuaaguaXoOmAmuefpeS6uuS/oeaBrzwvcD48L2Rpdj4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/lk4HlkI3mi7xcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPVwiZmQtaW5mb1wiPjxwIGNsYXNzPVwidGl0bGVcIj7lk4HlkI0gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cImNnLW5hbWUtYnRuXCIgZGF0YS1pZD1cIicgKyBvLm9yZGVySWQgKyAnXCIgZGF0YS1zaWQ9XCInICsgby5zdWJOdW0gKyAnXCIgZGF0YS1uYW1lPVwiJyArIG8uc3ViQ2FyZ29OYW1lICsgJ1wiIGRhdGEtbWFyaz1cIicgKyAoby5jYXJnby5wYWNrYWdlTWFyayB8fCAnJykgKyAnXCI+57yW6L6RPC9hPiA8L3A+IDxwPicgKyBvLnN1YkNhcmdvTmFtZSArICc8L3A+IDwvZGl2Pic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImZkLWluZm9cIj48cCBjbGFzcz1cInRpdGxlXCI+5ZSb5aS0IDwvcD48cD4nICsgKG8uY2FyZ28ucGFja2FnZU1hcmsgfHwgJycpICsgJzwvcD4gPC9kaXY+PC9kaXY+JztcclxuLy9tYXJrTmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+aLvOaOpXRhYmxlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImZkLW1pZGRsZVwiPiA8cCBjbGFzcz1cInRpdGxlXCI+5YiG5Y2V6LSn54mp5L+h5oGvIDxhIGhyZWY9XCIvdmlwL29yZGVyL2RldGFpbC9lbnN1cmU/aWQ9JyArIG8ub3JkZXJJZCArICcmc2lkPScgKyBvLnN1Yk51bSArICdcIiB0YXJnZXQ9XCJfYmxhbmtcIiBjbGFzcz1cImZsLXJcIj7mn6XnnIvliIbljZU8L2E+IDwvcD48dGFibGUgYm9yZGVyPVwiMVwiIGNsYXNzPVwibWctYlwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyA8dGhlYWQ+IDx0cj4gIDx0ZD7ov5vku5PnvJblj7c8L3RkPiA8dGQ+6ZW/KENNKTwvdGQ+IDx0ZD7lrr0oQ00pPC90ZD4gPHRkPumrmChDTSk8L3RkPiA8dGQ+5Lu25pWwKFBDUyk8L3RkPiA8dGQ+6YeN6YePKEtHUyk8L3RkPiA8dGQ+5L2T56evKENCTSk8L3RkPiA8dGQ+5YyF6KOFPC90ZD4gPHRkPuaNn+avgTwvdGQ+IDx0ZD7lj5jlvaI8L3RkPiA8dGQ+5Y+X5r2uPC90ZD4gPHRkPuWFtuS7ljwvdGQ+IDx0ZD7lpIfms6g8L3RkPiA8L3RyPiA8L3RoZWFkPiA8dGJvZHk+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JhZ2UgPSAnc3RvcmFnZScgaW4gYm9keSAmJiBib2R5LnN0b3JhZ2UgfHwge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRyeUxpc3QgPSAnZW50cnlMaXN0JyBpbiBzdG9yYWdlICYmIHN0b3JhZ2UuZW50cnlMaXN0IHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgempqcyA9IDAsIHpqemwgPSAwLCB6anRqID0gMCwgempwcyA9IDAsIHpqYnggPSAwLCB6anNjID0gMCwgempxdCA9IDAseGluZGFuPTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGUgaW4gZW50cnlMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW50cnlMaXN0Lmhhc093blByb3BlcnR5KGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR0MSA9IGVudHJ5TGlzdFtlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHQgPSBlbnRyeUxpc3RbZV0uZW50cnlEZXRhaWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhqanMgPSAwLCB4anpsID0gMCwgeGp0aiA9IDAsIHhqcHMgPSAwLCB4amJ4ID0gMCwgeGpzYyA9IDAsIHhqcXQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQxIGluIGR0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdC5oYXNPd25Qcm9wZXJ0eShkMSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gZHRbZDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGpqcyArPSBkLml0ZW1Db3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpqanMgKz0gZC5pdGVtQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4anRqICs9IGQuaXRlbUNvdW50ICogZC5pdGVtSGVpZ2h0ICogZC5pdGVtTGVuZ3RoICogZC5pdGVtV2lkdGggLyAxMDAwMDAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgemp0aiArPSBkLml0ZW1Db3VudCAqIGQuaXRlbUhlaWdodCAqIGQuaXRlbUxlbmd0aCAqIGQuaXRlbVdpZHRoIC8gMTAwMDAwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPHRyPiA8dGQ+JyArIGR0MS5lbnRyeU51bSArICc8L3RkPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHRkPicgKyBkLml0ZW1MZW5ndGggKyAnPC90ZD4gPHRkPicgKyBkLml0ZW1XaWR0aCArICc8L3RkPiA8dGQ+JyArIGQuaXRlbUhlaWdodCArICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgPHRkPicgKyBkLml0ZW1Db3VudCArICc8L3RkPiA8dGQ+LTwvdGQ+IDx0ZD4nICsgbXlmb3JtYXQuZm9ybWF0dm9sdW1lKGQuaXRlbUNvdW50ICogZC5pdGVtSGVpZ2h0ICogZC5pdGVtTGVuZ3RoICogZC5pdGVtV2lkdGggLyAxMDAwMDAwKSArICc8L3RkPiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHRkPicgKyBkdDEucGFja2FnZVR5cGUgKyAnPC90ZD4gPHRkPi08L3RkPiA8dGQ+LTwvdGQ+IDx0ZD4tPC90ZD4gPHRkPi08L3RkPiA8dGQ+LTwvdGQ+IDwvdHI+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6anpsID0gby5jYXJnby5jYXJnb1dlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3hpbmRhbj1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6anBzICs9IGR0MS5kYW1hZ2VDb3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6amJ4ICs9IGR0MS50cmFuc2Zvcm1Db3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6anNjICs9IGR0MS5kYW1wQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgempxdCArPSBkdDEub3RoZXJDb3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJzx0ciBjbGFzcz1cInRyLXhqXCI+IDx0ZD7lsI/orqE8L3RkPiA8dGQgY29sc3Bhbj1cIjNcIiBjbGFzcz1cImZvbnQtZ1wiPuabtOaWsOaXtumXtO+8iCcgKyBkdDEuc3RvcmFnZVRpbWUgKyAn77yJPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyA8dGQ+JyArIHhqanMgKyAnPC90ZD4gPHRkPi08L3RkPiA8dGQ+JyArIG15Zm9ybWF0LmZvcm1hdHZvbHVtZSh4anRqKSArICc8L3RkPiA8dGQ+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD4nICsgKGR0MS5kYW1hZ2VDb3VudCB8fCAnLScpICsgJzwvdGQ+IDx0ZD4nICsgKGR0MS50cmFuc2Zvcm1Db3VudCB8fCAnLScpICsgJzwvdGQ+IDx0ZD4nICsgKGR0MS5kYW1wQ291bnQgfHwgJy0nKSArICc8L3RkPiA8dGQ+JyArIChkdDEub3RoZXJDb3VudCB8fCAnLScpICsgJzwvdGQ+IDx0ZD4tPC90ZD4gPC90cj4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8dHIgY2xhc3M9XCJ0ci16alwiPiA8dGQ+5oC76K6hPC90ZD4gPHRkIGNvbHNwYW49XCIzXCI+PC90ZD4gPHRkPicgKyB6ampzICsgJzwvdGQ+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD4nICsgemp6bCArICc8L3RkPiA8dGQ+JyArIG15Zm9ybWF0LmZvcm1hdHZvbHVtZSh6anRqKSArICc8L3RkPiA8dGQ+PC90ZD4gPHRkPicgKyAoempwcyB8fCAnJykgKyAnPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgPHRkPicgKyAoempieCB8fCAnJykgKyAnPC90ZD4gPHRkPicgKyAoempzYyB8fCAnJykgKyAnPC90ZD4gPHRkPicgKyAoempxdCB8fCAnJykgKyAnPC90ZD4gPHRkPjwvdGQ+IDwvdHI+PC90Ym9keT48L3RhYmxlPjwvZGl2Pic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v6K6i5Y2V6ZmE5Lu25ou85o6lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPGRpdiBjbGFzcz1cImZkLWJvdHRvbVwiPjxkaXYgY2xhc3M9XCJkZGZqLXB1YiBmaWxsXCI+PHAgY2xhc3M9XCJ0aXRsZSBmaWxsXCI+PHNwYW4gY2xhc3M9XCJvbmVcIj7liIbljZXnm7jlhbPmlofku7Y8L3NwYW4+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidHdvXCI+PHNwYW4gY2xhc3M9XCJ3eHRzXCI+5rip6aao5o+Q56S677yaPC9zcGFuPuivt+WwveW/q+S4iuS8oOaKpeWFs+WNleOAgeaKpeWFs+WnlOaJmOS5puOAgeijheeuseWNleOAgeWPkeelqOetiei1hOaWme+8jOaWh+S7tuagvOW8j+aUr+aMgS5kb2MvLmRvY3gvLnhscy8ueGxzeC8ucGRmLy5qcGcvLnBuZy8uYm1wJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGJyPuivt+ajgOafpei1hOaWmeivgeS7tuS4iuS8oOaYr+WQpum9kOWFqO+8jOWmguaenOm9kOWFqO+8jOWPr+WQkeaKpeWFs+ihjDwvc3Bhbj48L3A+PGRpdiBjbGFzcz1cImFkZFwiIGRhdGEtc2lkPVwiJyArIG8uc3ViTnVtICsgJ1wiPiA8ZGl2IGNsYXNzPVwidG9wXCI+ICsgPC9kaXY+IDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkcC1iXCI+5re75Yqg5paH5Lu2PC9hPiA8aW5wdXQgdHlwZT1cImZpbGVcIiBpZD1cInVwLWZpbGUtZmRcIiBkYXRhLXNpZD1cIicgKyBvLnN1Yk51bSArICdcIj4gPC9kaXY+PC9kaXY+PC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/kuIvovb3miZPljbDmlofku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9JzxkaXYgY2xhc3M9XCJmZC1maWxlRG93blwiPjxwIGNsYXNzPVwidGl0bGVcIj7mlofku7bkuIvovb08L3A+PGRpdiBjbGFzcz1cImxlZnRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8cD7kuIvovb0v5omT5Y2w5paH5Lu2PC9wPicrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy88ZGl2IGNsYXNzPVwiZHAtYiBmbC1sIGRsXCIgaWQ9XCJvcGVuX21hcFwiIGRhdGEtaWQ9XCI8JT0gby53YXJlaG91c2VJZCAlPlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLzxzcGFuIGNsYXNzPVwiZHAtYiBpbWdcIj7lm748L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy88c3BhbiBjbGFzcz1cImRwLWIgdHh0XCI+6L+b5LuT5Zyw5Zu+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy88ZGl2IGNsYXNzPVwiY292ZXIgZHAtblwiPjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy88ZGl2IGNsYXNzPVwiZHAtYiBmbC1sIGRsIGRsLWJoXCIgZGF0YS1pZD1cIjwlPSBvLmFpcndheUlkICU+XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy88YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vPHNwYW4gY2xhc3M9XCJkcC1iIGltZ1wiPuS/nTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLzxzcGFuIGNsYXNzPVwiZHAtYiB0eHRcIj7otKfniankv53lh708L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy88L2E+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLzxkaXYgY2xhc3M9XCJjb3ZlciBkcC1uXCI+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy88L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLzxkaXYgY2xhc3M9XCJkcC1iIGZsLWwgZGwgZGwtcHJpY2VcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy88c3BhbiBjbGFzcz1cImRwLWIgaW1nXCI+5oqlPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vPHNwYW4gY2xhc3M9XCJkcC1iIHR4dFwiPuWvvOWHuuaKpeS7t+WNlTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLzwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vPGRpdiBjbGFzcz1cImNvdmVyIGRwLW5cIj48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLzwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkcC1iIGZsLWwgZGwgZGwteWxkXCIgZGF0YS10eXBlPVwiMjFcIiBkYXRhLWtleT1cIjBcIj48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPjxzcGFuIGNsYXNzPVwiZHAtYiBpbWdcIj7pooQ8L3NwYW4+PHNwYW4gY2xhc3M9XCJkcC1iIHR4dFwiPumihOW9leWNlTwvc3Bhbj48L2E+PGRpdiBjbGFzcz1cImNvdmVyIGRwLW5cIj48L2Rpdj48ZGl2IGNsYXNzPVwidG1wIGRwLW5cIj48L2Rpdj48L2Rpdj4nK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkcC1iIGZsLWwgZGwgZGwtZmlsZVwiIGRhdGEtdHlwZT1cIjIyXCIgZGF0YS1rZXk9XCIwXCI+PGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj48c3BhbiBjbGFzcz1cImRwLWIgaW1nXCI+5p+lPC9zcGFuPjxzcGFuIGNsYXNzPVwiZHAtYiB0eHRcIj7mn6XpqozotLnnlKjljZU8L3NwYW4+PC9hPiA8ZGl2IGNsYXNzPVwiY292ZXIgZHAtblwiPjwvZGl2PjwvZGl2PicrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyLmNvbGxhcHNlKCd0b2dnbGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEyMj0wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBEYXRhLmZpbGVMaXN0KHtpZDogdXJsLmdldCgnaWQnKSwgc2lkOiBvLnN1Yk51bSB8fCAnJ30sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCAmJiBqc29uLnJlc0JvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyciA9IGpzb24ucmVzQm9keTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJyLmhhc093blByb3BlcnR5KGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGFyclthXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLmZpbGVUeXBlID09IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc8ZGl2IGNsYXNzPVwidXAtcGFydFwiPiA8ZGl2IGNsYXNzPVwidG9wXCI+JyArIGQuZmlsZUV4dGVuc2lvbi50b1VwcGVyQ2FzZSgpICsgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgY2xhc3M9XCJkbFwiIGRhdGEta2V5PVwiJyArIGQua2V5TmFtZSArICdcIj48L2E+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cInJtXCIgZGF0YS1rZXk9XCInICsgZC5rZXlOYW1lICsgJ1wiPjwvYT4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cImRwLWJcIj4nICsgZC5maWxlTmFtZSArICc8L2E+ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5maWxlVHlwZSA9PSAyMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEyMj0xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJCgnLmRsLWZpbGVbZGF0YS10eXBlPVwiJyArIGQuZmlsZVR5cGUgKyAnXCJdJykuZGF0YSgna2V5JywgZC5rZXlOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQoKS5maW5kKCcuZmQtaW5mby1ib2R5JykuZmluZCgnLmZkLWZpbGVEb3duJykuZmluZChcIi5kbC1maWxlXCIpLmRhdGEoJ2tleScsIGQua2V5TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQuZmlsZVR5cGUgPT0gMjEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeWxkID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWxkICs9ICc8ZGl2IGNsYXNzPVwidXAtcGFydFwiPiA8ZGl2IGNsYXNzPVwidG9wXCI+JyArIGFyclthXS5maWxlRXh0ZW5zaW9uLnRvVXBwZXJDYXNlKCkgKyAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cImRsIGdseXBoaWNvbiBnbHlwaGljb24tY2lyY2xlLWFycm93LWRvd25cIiBkYXRhLWtleT1cIicgKyBkLmtleU5hbWUgKyAnXCI+PC9hPiA8L2Rpdj4gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cImRwLWJcIj4nICsgYXJyW2FdLmZpbGVOYW1lICsgJzwvYT4gPC9kaXY+J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vJCgnLmZ4dHpzLWZpbGwnKS5hcHBlbmQoeWxkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQoKS5maW5kKCcuZmQtaW5mby1ib2R5JykuZmluZCgnLmZkLWZpbGVEb3duJykuZmluZCgnLnRtcCcpLmFwcGVuZCh5bGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5meHR6cycpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy5hZGQtdHlwZVtkYXRhLXR5cGU9JyArIGQuZmlsZVR5cGUgKyAnXScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlLmZpbmQoJ2lucHV0JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZS5maW5kKCcudG9wJykuaHRtbChkLmZpbGVFeHRlbnNpb24udG9VcHBlckNhc2UoKSArICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwiZGxcIiBkYXRhLWtleT1cIicgKyBkLmtleU5hbWUgKyAnXCI+PC9hPiA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwicm0tdHlwZVwiIGRhdGEta2V5PVwiJyArIGQua2V5TmFtZSArICdcIj48L2E+ICcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZS5maW5kKCcuZi1uYW1lJykuaHRtbChkLmZpbGVOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhMjI9PTApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuZGxbZGF0YS10eXBlPVwiMjJcIl0nKS5hZGRDbGFzcygnbm9uZS1mJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5hZGRbZGF0YS1zaWQ9XCInICsgby5zdWJOdW0gKyAnXCJdJykuYmVmb3JlKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfojrflj5bliIbljZXor6bmg4XlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmxvYWRpbmctcGFydCcpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGFyLmNvbGxhcHNlKCd0b2dnbGUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcueWZkLXNnJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBjcmVhdGVTdWIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHR5cGUgPSB7XHJcbiAgICAgICAgICAgIGNmOiAwLCAgICAgLy8w5piv5pyq5ouG5YiG6L+H55qE77yMMeaYr+aLhuWIhui/h+eahFxyXG4gICAgICAgICAgICBuOiAwLCAgICAgICAgIC8vMOaYr+aLhuW+gOaWsOiuouWNle+8jDHmmK/mi4blvoDlt7LmnInorqLljZVcclxuICAgICAgICAgICAgc2lkOiAnJyAgICAvL+W3suaLhuWIhui/h+eahOWIhuWNleWPt1xyXG4gICAgICAgICAgICAsIHRvc2RpOiAnJyAgLy/mi4blvoDlk6rkuKrorqLljZVcclxuICAgICAgICAgICAgLCBvcml3ZWk6ICcnICAgLy/lt7Lmi4bliIbph43ph49cclxuICAgICAgICAgICAgLCBhcnI6IFtdICAgLy/ovaznp7vnmoTotKfnianmlbDmja5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBpbml0TW9kYWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJy53LWUnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICQoJy55LW4nKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICQoJy55LWUnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICQoJy5mZC1hbGVydC1wYXJ0JykuZmluZCgnaW5wdXRbdHlwZT1cInRleHRcIl0nKS52YWwoJycpO1xyXG4gICAgICAgICAgICAkKCcjY3p4ZmQnKS50cmlnZ2xlKCdjbGljaycpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NoYW5nZScsICcjeXlmZC1mZGgnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBvcHQgPSAkKHRoaXMpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLmZkLWFsZXJ0LXBhcnQnKTtcclxuICAgICAgICAgICAgZWxlLmZpbmQoJy5tYmZkJykuaHRtbChvcHQudmFsKCkpO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLm1iJykuZmluZCgnLm9yaS13ZWknKS5odG1sKG9wdC5kYXRhKCd3ZWknKSlcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnaW5wdXRbbmFtZT1cInNlbC1mZC10eXBlXCJdJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcudy1lJykuaGlkZSgpO1xyXG4gICAgICAgICAgICAkKCcueS1uJykuaGlkZSgpO1xyXG4gICAgICAgICAgICAkKCcueS1lJykuaGlkZSgpO1xyXG4gICAgICAgICAgICAkKCcuZmQtYWxlcnQtcGFydCcpLmZpbmQoJy5mLXB0Jykuc2hvdygpO1xyXG4gICAgICAgICAgICAkKCcuZmQtYWxlcnQtcGFydCcpLmZpbmQoJy5zLXB0JykuaGlkZSgpO1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLmFsZXJ0LWJvZHknKTtcclxuICAgICAgICAgICAgdmFyIG4gPSBlbGUuZmluZCgnLm5ldycpO1xyXG4gICAgICAgICAgICB2YXIgZSA9IGVsZS5maW5kKCcuZXhpc3QnKTtcclxuICAgICAgICAgICAgaWYgKCQoJ2lucHV0W25hbWU9XCJzZWwtZmQtdHlwZVwiXTpjaGVja2VkJykudmFsKCkgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgdHlwZS5uID0gMDtcclxuICAgICAgICAgICAgICAgIG4uc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgZS5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlLm4gPSAxO1xyXG4gICAgICAgICAgICAgICAgbi5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICBlLnNob3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjdy1jZmQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHR5cGUuY2YgPSAwO1xyXG4gICAgICAgICAgICB0eXBlLnNpZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcclxuICAgICAgICAgICAgdmFyIHRhYmxlID0gJCh0aGlzKS5wYXJlbnQoKS5zaWJsaW5ncygndGFibGUnKTtcclxuICAgICAgICAgICAgdGFibGUuZmluZCgnLnRkLXNnOmNoZWNrZWQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkID0gSlNPTi5wYXJzZSgkKHRoaXMpLmRhdGEoJ2R0JykucmVwbGFjZSgvXFwnL2csIFwiXFxcIlwiKSk7XHJcbiAgICAgICAgICAgICAgICBkWyd3YXJlaG91c2VFbnRyeU51bSddID0gJCh0aGlzKS5kYXRhKCdlbnVtJyk7XHJcbiAgICAgICAgICAgICAgICBhcnIucHVzaChkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHR5cGUuYXJyID0gYXJyO1xyXG4gICAgICAgICAgICBpZiAodGFibGUuZmluZCgnLnRkLXNnOmNoZWNrZWQnKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBEYXRhLk5ld1N1Yk51bSh7b3JkZXJJZDogdXJsLmdldCgnaWQnKX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG51bSA9IGpzb24gJiYgJ3Jlc0JvZHknIGluIGpzb24gJiYganNvbi5yZXNCb2R5IHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJyNuZmQtZmRoJykudmFsKG51bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5mZC1hbGVydC1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy55Y2YtY2ZkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0eXBlLmNmID0gMTtcclxuICAgICAgICAgICAgdHlwZS5zaWQgPSAkKHRoaXMpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgIHR5cGUub3Jpd2VpID0gJCh0aGlzKS5kYXRhKCd3ZWknKTtcclxuICAgICAgICAgICAgdmFyIGFyciA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgdGFibGUgPSAkKHRoaXMpLnBhcmVudCgpLnNpYmxpbmdzKCd0YWJsZScpO1xyXG4gICAgICAgICAgICB0YWJsZS5maW5kKCcuZmQtc2c6Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBKU09OLnBhcnNlKCQodGhpcykuZGF0YSgnZHQnKS5yZXBsYWNlKC9cXCcvZywgXCJcXFwiXCIpKTtcclxuICAgICAgICAgICAgICAgIGRbJ3dhcmVob3VzZUVudHJ5TnVtJ10gPSAkKHRoaXMpLmRhdGEoJ2VudW0nKTtcclxuICAgICAgICAgICAgICAgIGFyci5wdXNoKGQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdHlwZS5hcnIgPSBhcnI7XHJcbiAgICAgICAgICAgIGlmICh0YWJsZS5maW5kKCcuZmQtc2c6Y2hlY2tlZCcpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIERhdGEuTmV3U3ViTnVtKHtvcmRlcklkOiB1cmwuZ2V0KCdpZCcpfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbnVtID0ganNvbiAmJiAncmVzQm9keScgaW4ganNvbiAmJiBqc29uLnJlc0JvZHkgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnI25mZC1mZGgnKS52YWwobnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmZkLWFsZXJ0LXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2NyZWF0ZS1mZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIHBhc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAodHlwZS5jZiA9PSAwICYmIHR5cGUubiA9PSAwKSB7Ly/mnKrmi4bliIbotKfnianmi4blvoDmlrDliIbljZVcclxuICAgICAgICAgICAgICAgICQoJy5uZmQtcmVxdWlyZWQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISQodGhpcykudmFsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6IHVybC5nZXQoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib3JkZXJTdWJOdW1cIjogJCgnI25mZC1mZGgnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjYXJnb05hbWVcIjogJCgnI25mZC1wbScpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndlaWdodFwiOiAkKCcjbmZkLXpsJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW50cnlJdGVtTGlzdFwiOiB0eXBlLmFyclxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgRGF0YS5uZXdTdG9yYWdlKGRhdGEsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5YiG5Y2V5Yib5bu65oiQ5YqfIScsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+WIhuWNleWIm+W7uuWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGUuY2YgPT0gMCAmJiB0eXBlLm4gPT0gMSkgey8v5pyq5ouG5YiG6LSn54mp5ouG5b6A5bey5pyJ5YiG5Y2VXHJcbiAgICAgICAgICAgICAgICBpZiAoJCgnI3l5ZmQtZmRoJykuZmluZCgnb3B0aW9uJykubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB3ZSA9ICQoJy53LWUnKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gJCgnI3l5ZmQtZmRoJykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2UuZmluZCgnLm1iZmQnKS5odG1sKG9wdGlvbi52YWwoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2UuZmluZCgnLm9yaS13ZWknKS5odG1sKG9wdGlvbi5kYXRhKCd3ZWknKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2Uuc2libGluZ3MoKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2Uuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudCgpLmZpbmQoJy5mLXB0JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudCgpLmZpbmQoJy5zLXB0Jykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5pqC5peg5Y+v6YCJ5YiG5Y2V77yM6K+35ouG6Iez5paw5YiG5Y2V77yBJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGUuY2YgPT0gMSAmJiB0eXBlLm4gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgJCgnLm5mZC1yZXF1aXJlZCcpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghJCh0aGlzKS52YWwoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB5biA9ICQoJy55LW4nKTtcclxuICAgICAgICAgICAgICAgICAgICB5bi5zaWJsaW5ncygpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB5bi5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgeW4uZmluZCgnLmJvZHknKS5odG1sKHR5cGUub3Jpd2VpICsgJyBLRycpO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudCgpLmZpbmQoJy5mLXB0JykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudCgpLmZpbmQoJy5zLXB0Jykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlLmNmID09IDEgJiYgdHlwZS5uID09IDEpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkKCcjeXlmZC1mZGgnKS5maW5kKCdvcHRpb24nKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHllID0gJCgnLnktZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSAkKCcjeXlmZC1mZGgnKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICB5ZS5maW5kKCcubWJmZCcpLmh0bWwob3B0aW9uLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICB5ZS5maW5kKCcuYmNmZCcpLmh0bWwodHlwZS5zaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHllLmZpbmQoJy5tYicpLmZpbmQoJy5vcmktd2VpJykuaHRtbChvcHRpb24uZGF0YSgnd2VpJykpO1xyXG4gICAgICAgICAgICAgICAgICAgIHllLmZpbmQoJy5iYycpLmZpbmQoJy5vcmktd2VpJykuaHRtbChvcHRpb24uZGF0YSgnd2VpJykpO1xyXG4gICAgICAgICAgICAgICAgICAgIHllLnNpYmxpbmdzKCkuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHllLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQoKS5maW5kKCcuZi1wdCcpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQoKS5maW5kKCcucy1wdCcpLnNob3coKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aaguaXoOWPr+mAieWIhuWNle+8jOivt+aLhuiHs+aWsOWIhuWNle+8gScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNmZC10eicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGUuY2YgPT0gMCAmJiB0eXBlLm4gPT0gMSkgey8v5pyq5ouG5YiG6LSn54mp5ouG5b6A5bey5pyJ5YiG5Y2VXHJcbiAgICAgICAgICAgICAgICBpZiAoJCgnI3ctZS0tbi13JykudmFsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcjdy1lLS1uLXcnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9yZGVySWRcIjogdXJsLmdldCgnaWQnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJOdW1cIjogJCgnI3l5ZmQtZmRoJykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY2FyZ29OYW1lXCI6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW50cnlJdGVtTGlzdFwiOiB0eXBlLmFycixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3ZWlnaHRcIjogJCgnI3ctZS0tbi13JykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIERhdGEuYWRkU3RvcmFnZShkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+WIhuWNleaTjeS9nOaIkOWKnyEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfliIbljZXmk43kvZzlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcjdy1lLS1uLXcnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlLmNmID09IDEgJiYgdHlwZS5uID09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmICgkKCcjeS1uLXh6bCcpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnI3ktbi14emwnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkMSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6IHVybC5nZXQoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViTnVtXCI6IHR5cGUuc2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVRvXCI6ICQoJyNuZmQtZmRoJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY2FyZ29OYW1lXCI6ICQoJyNuZmQtcG0nKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnRyeUl0ZW1MaXN0XCI6IHR5cGUuYXJyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndlaWdodFwiOiAkKCcjeS1uLXh6bCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndlaWdodFRvXCI6ICQoJyNuZmQtemwnKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgRGF0YS5tb3ZlU3RvcmFnZShkMSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfliIbljZXmk43kvZzmiJDlip8hJywgbnVsbCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn5YiG5Y2V5pON5L2c5aSx6LSl77yM6K+36YeN6K+V77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnI3ktbi14emwnKS5hZGRDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlLmNmID09IDEgJiYgdHlwZS5uID09IDEpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkKCcjeS1lLWItemwnKS52YWwoKSAmJiAkKCcjeS1lLW1iLXpsJykudmFsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcjeS1lLWItemwnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJyN5LWUtbWItemwnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkMiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6IHVybC5nZXQoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViTnVtXCI6IHR5cGUuc2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVRvXCI6ICQoJyN5eWZkLWZkaCcpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNhcmdvTmFtZVwiOiAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnRyeUl0ZW1MaXN0XCI6IHR5cGUuYXJyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndlaWdodFwiOiAkKCcjeS1lLWItemwnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3ZWlnaHRUb1wiOiAkKCcjeS1lLW1iLXpsJykudmFsKClcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIERhdGEubW92ZVN0b3JhZ2UoZDIsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5YiG5Y2V5pON5L2c5oiQ5YqfIScsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+WIhuWNleaTjeS9nOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISQoJyN5LWUtYi16bCcpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyN5LWUtYi16bCcpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3ktZS1iLXpsJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkKCcjeS1lLW1iLXpsJykudmFsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3ktZS1tYi16bCcpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3ktZS1tYi16bCcpLnJlbW92ZUNsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNmZC1idHonLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlLmNmID09IDAgJiYgdHlwZS5uID09IDEpIHsvL+acquaLhuWIhui0p+eJqeaLhuW+gOW3suacieWIhuWNlVxyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJvcmRlcklkXCI6IHVybC5nZXQoJ2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzdWJOdW1cIjogJCgnI3l5ZmQtZmRoJykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjYXJnb05hbWVcIjogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBcImVudHJ5SXRlbUxpc3RcIjogdHlwZS5hcnIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJ3ZWlnaHRcIjogJCgnLnctZScpLmZpbmQoJy5vcmktd2VpJykuaHRtbCgpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgRGF0YS5hZGRTdG9yYWdlKGRhdGEsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+WIhuWNleaTjeS9nOaIkOWKnyEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+WIhuWNleaTjeS9nOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlLmNmID09IDEgJiYgdHlwZS5uID09IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBkMSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBcIm9yZGVySWRcIjogdXJsLmdldCgnaWQnKSxcclxuICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVwiOiB0eXBlLnNpZCxcclxuICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVRvXCI6ICQoJyNuZmQtZmRoJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjYXJnb05hbWVcIjogJCgnI25mZC1wbScpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiZW50cnlJdGVtTGlzdFwiOiB0eXBlLmFycixcclxuICAgICAgICAgICAgICAgICAgICBcIndlaWdodFwiOiB0eXBlLm9yaXdlaSxcclxuICAgICAgICAgICAgICAgICAgICBcIndlaWdodFRvXCI6ICQoJyNuZmQtemwnKS52YWwoKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIERhdGEubW92ZVN0b3JhZ2UoZDEsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgJ3Jlc0NvZGUnIGluIGpzb24gJiYganNvbi5yZXNDb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+WIhuWNleaTjeS9nOaIkOWKnyEnLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+WIhuWNleaTjeS9nOWksei0pe+8jOivt+mHjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlLmNmID09IDEgJiYgdHlwZS5uID09IDEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkMiA9IHtcclxuICAgICAgICAgICAgICAgICAgICBcIm9yZGVySWRcIjogdXJsLmdldCgnaWQnKSxcclxuICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVwiOiB0eXBlLnNpZCxcclxuICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVRvXCI6ICQoJyN5eWZkLWZkaCcpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY2FyZ29OYW1lXCI6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiZW50cnlJdGVtTGlzdFwiOiB0eXBlLmFycixcclxuICAgICAgICAgICAgICAgICAgICBcIndlaWdodFwiOiB0eXBlLm9yaXdlaSxcclxuICAgICAgICAgICAgICAgICAgICBcIndlaWdodFRvXCI6ICQoJyN5eWZkLWZkaCcpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLmRhdGEoJ3dlaScpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgRGF0YS5tb3ZlU3RvcmFnZShkMiwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydCgn5YiG5Y2V5pON5L2c5oiQ5YqfIScsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChqc29uLnJlc01zZyB8fCAn5YiG5Y2V5pON5L2c5aSx6LSl77yM6K+36YeN6K+V77yBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgY2hhbmdlTmFtZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY2dpZCwgY2dzaWQsY2duYW1lLG1hcmtuYW1lO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2ctbmFtZS1idG4nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNnaWQgPSAkKHRoaXMpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgIGNnc2lkID0gJCh0aGlzKS5kYXRhKCdzaWQnKTtcclxuICAgICAgICAgICAgY2duYW1lPSAkKHRoaXMpLmRhdGEoJ25hbWUnKTtcclxuICAgICAgICAgICAgbWFya25hbWU9ICQodGhpcykuZGF0YSgnbWFyaycpO1xyXG4gICAgICAgICAgICAkKCcjY2ctbmFtZScpLnZhbChjZ25hbWUpO1xyXG4gICAgICAgICAgICAkKCcjbWFyay1zdWJuYW1lJykudmFsKG1hcmtuYW1lKTtcclxuICAgICAgICAgICAgJCgnLm5hbWUtcGFydCcpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI25hbWUtZW5zdXJlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoJCgnI2NnLW5hbWUnKS52YWwoKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnI2NnLW5hbWUnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgRGF0YS5jaGFuZ2VOYW1lKHtcclxuICAgICAgICAgICAgICAgICAgICBcIm9yZGVySWRcIjogY2dpZCxcclxuICAgICAgICAgICAgICAgICAgICBcInN1Yk51bVwiOiBjZ3NpZCxcclxuICAgICAgICAgICAgICAgICAgICBcInN1YkNhcmdvTmFtZVwiOiAkKCcjY2ctbmFtZScpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwibWFya05hbWVcIjogJCgnI21hcmstc3VibmFtZScpLnZhbCgpXHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfkv67mlLnmiJDlip8hJywgbnVsbCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnIHx8ICfkv67mlLnlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQoJyNjZy1uYW1lJykuYWRkQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v5p2C6LS56LS555So55qE5byV5YWlXHJcbiAgICB2YXIgZXh0cmFJbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICBhaXJDb21wYW55Q29kZTogJCgnI2FJYycpLmh0bWwoKSB8fCAnJyxcclxuICAgICAgICAgICAgYWdlbnRDb21wYW55SWQ6JCgnI2FJZCcpLmh0bWwoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgRGF0YS56ZmV4cGVuc2VUZW0oZGF0YSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgdmFyIGFyciA9W107XHJcbiAgICAgICAgICAgIHZhciBzdHIgPScnO1xyXG4gICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYoanNvbi5yZXNCb2R5ICYmICdleHBlbnNlVGVtcGxhdGUnIGluIGpzb24ucmVzQm9keSApe1xyXG4gICAgICAgICAgICAgICAgICAgIGFycj1qc29uLnJlc0JvZHlbJ2V4cGVuc2VUZW1wbGF0ZSddO1xyXG4gICAgICAgICAgICAgICAgICAgIC8v5Yia5byA5aeL55qE5pe25YCZ5piv6L+U5Zue55qE5piv5a+56LGh5omA5Lul5Y2z5L2/6LCD55So5bGe5oCn5ZCN6L+Y5piv5peg5rOV6K+G5Yir77yM5omA5Lul5L2/55So6L+Z56eN5pa55rOV44CCXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBhIGluIGFycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcnIuaGFzT3duUHJvcGVydHkoYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhcnJbYV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnPHRyPjx0ZD4nICsgZC5pdGVtTmFtZSArICc8L3RkPjx0ZD4nICsgZC5pdGVtUHJpY2UgKyAnPC90ZD48dGQ+JyArIChkLml0ZW1SZW1hcmsgfHwgJy8nKSArICc8L3RkPjwvdHI+J1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICQoJy5vdGhlci1saXN0JykuZmluZCgndGJvZHknKS5odG1sKHN0cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgb3RoZXJpbml0ID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAkKFwiLmpnLW1vZGFsXCIpLnRvb2x0aXAoKTtcclxuICAgICAgICAvL+Wwj+aVsOeCueaOp+WItlxyXG4gICAgICAgICQoJyNlbnRyeXNpemUnKS5odG1sKG15Zm9ybWF0LmZvcm1hdHZvbHVtZSgkKCcjZW50cnlzaXplJykuZGF0YSgnc2l6ZScpKSsnIENCTScpO1xyXG4gICAgICAgICQoJyNkZWNsYXJlc2l6ZScpLmh0bWwobXlmb3JtYXQuZm9ybWF0dm9sdW1lKCQoJyNkZWNsYXJlc2l6ZScpLmRhdGEoJ3NpemUnKSkrJyBDQk0nKTtcclxuICAgICAgICAkKCcjZW50cnlzaXplMicpLmZpbmQoJ2ZvbnQnKS5odG1sKG15Zm9ybWF0LmZvcm1hdHZvbHVtZSggJCgnI2VudHJ5c2l6ZTInKS5maW5kKCdmb250JykuaHRtbCgpKSk7XHJcbiAgICAgICAgJCgnLml0ZW0tdGonKS5odG1sKG15Zm9ybWF0LmZvcm1hdHZvbHVtZSgkKCcuaXRlbS10aicpLmh0bWwoKSkpO1xyXG4gICAgICAgICQoJy54ai10aicpLmh0bWwobXlmb3JtYXQuZm9ybWF0dm9sdW1lKCQoJy54ai10aicpLmh0bWwoKSkpO1xyXG4gICAgICAgICQoJy50b3RhbC10aicpLmh0bWwobXlmb3JtYXQuZm9ybWF0dm9sdW1lKCQoJy50b3RhbC10aicpLmh0bWwoKSkpO1xyXG4gICAgfVxyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsaXN0ZW5lcigpO1xyXG4gICAgICAgIHN1Ym1pdCgpO1xyXG4gICAgICAgIHVwbG9hZCgpO1xyXG4gICAgICAgIGZpbGVMaXN0KCk7XHJcbiAgICAgICAgZGVjbGFyZURhdGEoKTtcclxuICAgICAgICBjaGFuZ2VMaW5lKCk7XHJcbiAgICAgICAgYWlybGluZSgpO1xyXG4gICAgICAgIGdldENvbXBhbnkoKTtcclxuICAgICAgICBjb250YWN0KCk7XHJcbiAgICAgICAgZGxNYXAoKTtcclxuICAgICAgICBkbEJoKCk7XHJcbiAgICAgICAgdHJhY2tJbml0KCk7XHJcbiAgICAgICAgc3ViRGF0YSgpO1xyXG4gICAgICAgIGNoYW5nZU5hbWUoKTtcclxuICAgICAgICBjcmVhdGVTdWIoKTtcclxuICAgICAgICAvL2V4dHJhSW5pdCgpO1xyXG4gICAgICAgIG90aGVyaW5pdCgpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcnVuOiBydW5cclxuICAgIH1cclxufSgpKTtcclxubW9kdWxlLmV4cG9ydHMgPSBMaXN0ZW5lcjsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNi8xMS8yNC5cclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uICgkKSB7XHJcbiAgICAvKipcclxuICAgICAqIOeUn+aIkOWIhumhteWZqFxyXG4gICAgICogQHBhcmFtIGVsZSDpnIDopoHmt7vliqDliIbpobXlmajnmoTlhYPntKBcclxuICAgICAqIEBwYXJhbSBvZmZzZXQg5YGP56e76YeP77yM5Y2z5LuO56ysZGF0YS1vZmZzZXTlvIDlp4tcclxuICAgICAqIEBwYXJhbSBsZW5ndGgg5oC76K6w5b2V5p2h5pWwXHJcbiAgICAgKiBAcGFyYW0gc2hvd1BhZ2VzIOWIhumhteWZqOaYvuekuueahOmhteaVsO+8jOi2hei/h+WImemakOiXj+WkmuS9meeahOmhtVxyXG4gICAgICogQHBhcmFtIHJvd3Mg5q+P6aG15pi+56S655qE6K6w5b2V5p2h5pWwXHJcbiAgICAgKi9cclxuICAgICQuYnVyc3RlciA9IGZ1bmN0aW9uIChlbGUsIG9mZnNldCwgbGVuZ3RoLCBzaG93UGFnZXMsIHJvd3MpIHtcclxuICAgICAgICBvZmZzZXQgPSBvZmZzZXQgPyBwYXJzZUludChvZmZzZXQpIDogMDtcclxuICAgICAgICAvL+WwhuWIhumhteWZqOijheWFpXRhYmxl5LitXHJcbiAgICAgICAgaWYgKGxlbmd0aCAmJiBsZW5ndGggPiBvZmZzZXQpIHtcclxuICAgICAgICAgICAgdmFyIHBhZ2VIdG1sID0gXCJcIlxyXG4gICAgICAgICAgICAgICAgLCBhc3MgPSBcIlwiLy/muIXnqbrpnIDopoHoo4XlhaXnmoRodG1sXHJcbiAgICAgICAgICAgICAgICAsIGJlZm9yZVBhZ2VzID0gTWF0aC5jZWlsKG9mZnNldCAvIHJvd3MpLy/pnIDopoHmmL7npLrnmoTliY3pobXmlbAv5b2T5YmN6aG1XHJcbiAgICAgICAgICAgICAgICAsIGFmdGVyUGFnZXMgPSBNYXRoLmNlaWwoKGxlbmd0aCAtIG9mZnNldCApIC8gcm93cykvL+mcgOimgeaYvuekuueahOWQjumhteaVsFxyXG4gICAgICAgICAgICAgICAgLCBwYWdlcyA9IE1hdGguY2VpbChsZW5ndGggLyByb3dzKSAvL+aAu+mhteaVsFxyXG4gICAgICAgICAgICAgICAgLCBrID0gMDtcclxuICAgICAgICAgICAgLy9hbGVydChcIuaAu+mhteaVsFwiICsgcGFnZXMgKyBcIiDliY3pobXmlbAgXCIgKyBiZWZvcmVQYWdlcyArIFwiIOWQjumhteaVsCBcIiArIGFmdGVyUGFnZXMpO1xyXG4gICAgICAgICAgICAvL+iLpemhteaVsOWwj+S6jnNob3dQYWdlc+mhte+8jOWImeWFqOmDqOaYvuekulxyXG4gICAgICAgICAgICBpZiAocGFnZXMgPj0gMCAmJiBwYWdlcyA8PSBzaG93UGFnZXMpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBwYWdlczsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2VzID4gc2hvd1BhZ2VzKSB7Ly/mgLvpobXmlbDlpKfkuo5zaG93UGFnZXPpobVcclxuICAgICAgICAgICAgICAgIGlmIChiZWZvcmVQYWdlcyA8PSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgJiYgYWZ0ZXJQYWdlcyA+IHNob3dQYWdlcyArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgc2hvd1BhZ2VzOyBrKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoKHBhZ2VzIC0gMSkgKiByb3dzKSArIFwiJz4uLi5cIiArIHBhZ2VzICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPD0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICYmIGFmdGVyUGFnZXMgPT0gc2hvd1BhZ2VzICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBzaG93UGFnZXMgLSAxOyBrKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoKHBhZ2VzIC0gMSkgKiByb3dzKSArIFwiJz4uLi5cIiArIHBhZ2VzICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPD0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICYmIGFmdGVyUGFnZXMgPD0gc2hvd1BhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gMDsgayA8IHNob3dQYWdlcyAtIDE7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBiZWZvcmVQYWdlcyA8PSBzaG93UGFnZXMgJiYgYWZ0ZXJQYWdlcyA+IHNob3dQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9JzAnPjEuLi48L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGsgPSBiZWZvcmVQYWdlcyAtIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDE7IGsgPCBiZWZvcmVQYWdlcyArIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKTsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaSBjbGFzcz0nYWN0aXZlJyA+PGE+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZVBhZ2VzID4gc2hvd1BhZ2VzICYmIGFmdGVyUGFnZXMgPiBzaG93UGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgYmVmb3JlUGFnZXMgKyBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMik7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBiZWZvcmVQYWdlcyA8PSBwYWdlcyAmJiBhZnRlclBhZ2VzIDw9IHNob3dQYWdlcyAmJiBhZnRlclBhZ2VzID4gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9JzAnPjEuLi48L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGsgPSBiZWZvcmVQYWdlcyAtIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDE7IGsgPCBiZWZvcmVQYWdlcyArIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKTsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaSBjbGFzcz0nYWN0aXZlJyA+PGE+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZVBhZ2VzID4gcGFnZXMgJiYgYWZ0ZXJQYWdlcyA8PSBzaG93UGFnZXMgJiYgYWZ0ZXJQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgYmVmb3JlUGFnZXMgKyBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMik7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBhZnRlclBhZ2VzIDw9IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgcGFnZXM7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+WIpOaWrVwi6aaW6aG1XCLlkoxcIuacq+mhtVwi5piv5ZCm5Y+v54K55Ye7XHJcbiAgICAgICAgICAgIHZhciBmaXJzdFBhZ2UsIGxhc3RQYWdlO1xyXG4gICAgICAgICAgICBpZiAob2Zmc2V0ID09IDApIHsvL+atpOaXtummlumhteaXoOazleeCueWHu1xyXG4gICAgICAgICAgICAgICAgZmlyc3RQYWdlID0gJzxsaSBjbGFzcz1cImRpc2FibGVkXCI+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiMFwiPummlumhtTwvYT48L2xpPic7XHJcbiAgICAgICAgICAgICAgICBsYXN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiJyArIHBhcnNlSW50KHBhcnNlSW50KChsZW5ndGggJSByb3dzID09IDAgPyAobGVuZ3RoIC0gMSkgOiBsZW5ndGgpIC8gcm93cykgKiByb3dzKSArICdcIiA+5pyr6aG1PC9hPjwvbGk+JztcclxuICAgICAgICAgICAgfSBlbHNlIGlmICgob2Zmc2V0ICsgcm93cykgPj0gbGVuZ3RoKSB7Ly/mraTml7bmnKvpobXml6Dms5Xngrnlh7tcclxuICAgICAgICAgICAgICAgIGZpcnN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiMFwiPummlumhtTwvYT48L2xpPic7XHJcbiAgICAgICAgICAgICAgICBsYXN0UGFnZSA9ICc8bGkgY2xhc3M9XCJkaXNhYmxlZFwiPjxhIGNsYXNzPVwicGFnZXNcIiBkYXRhLW9mZnNldD1cIicgKyBwYXJzZUludChwYXJzZUludCgobGVuZ3RoICUgcm93cyA9PSAwID8gKGxlbmd0aCAtIDEpIDogbGVuZ3RoKSAvIHJvd3MpICogcm93cykgKyAnXCI+5pyr6aG1PC9hPjwvbGk+JztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiMFwiPummlumhtTwvYT48L2xpPic7XHJcbiAgICAgICAgICAgICAgICBsYXN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiJyArIHBhcnNlSW50KHBhcnNlSW50KChsZW5ndGggJSByb3dzID09IDAgPyAobGVuZ3RoIC0gMSkgOiBsZW5ndGgpIC8gcm93cykgKiByb3dzKSArICdcIj7mnKvpobU8L2E+PC9saT4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v5Yik5patXCLkuIrkuIDpobVcIuWSjFwi5LiL5LiA6aG1XCLmmK/lkKblrZjlnKhcclxuICAgICAgICAgICAgdmFyIHVwUGFnZSwgZG93blBhZ2U7XHJcbiAgICAgICAgICAgIGlmIChvZmZzZXQgPT0gMCB8fCAob2Zmc2V0IDwgcm93cyAmJiAob2Zmc2V0ICUgcm93cyAhPSAwKSkpIHtcclxuICAgICAgICAgICAgICAgIHVwUGFnZSA9IFwiPGxpIGNsYXNzPSdkaXNhYmxlZCc+PGEgY2xhc3M9J3BhZ2VzJyBmdW5jPSdwcmV2aW91cycgZGF0YS1vZmZzZXQ9J1wiICsgcGFyc2VJbnQob2Zmc2V0KSArIFwiJyA+5LiK6aG1PC9hPjwvbGk+XCJcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHVwUGFnZSA9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZnVuYz0ncHJldmlvdXMnIGRhdGEtb2Zmc2V0PSdcIiArIChwYXJzZUludChvZmZzZXQpIC0gcGFyc2VJbnQocm93cykpICsgXCInID7kuIrpobU8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob2Zmc2V0ID49IChsZW5ndGggLSByb3dzKSkge1xyXG4gICAgICAgICAgICAgICAgZG93blBhZ2UgPSBcIjxsaSBjbGFzcz0nZGlzYWJsZWQnPjxhIGNsYXNzPSdwYWdlcycgZnVuYz0nbmV4dCcgZGF0YS1vZmZzZXQ9J1wiICsgcGFyc2VJbnQob2Zmc2V0KSArIFwiJz7kuIvpobU8L2E+PC9saT5cIlxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZG93blBhZ2UgPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGZ1bmM9J25leHQnIGRhdGEtb2Zmc2V0PSdcIiArIHBhcnNlSW50KHBhcnNlSW50KG9mZnNldCkgKyBwYXJzZUludChyb3dzKSkgKyBcIic+5LiL6aG1PC9hPjwvbGk+XCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocGFnZXMgIT0gMSkge1xyXG4gICAgICAgICAgICAgICAgLy/liIbpobXpg6jliIZcclxuICAgICAgICAgICAgICAgIGFzcyArPSBcIjxkaXYgaWQ9J3BhZ2VyJyBjbGFzcz0ncGFnZXItaW5mbyc+XCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwiPGg2IGlkPSdyZXN1bHQnIGNsYXNzPSdwYWdlci1yZWNvcmQnPuWFseaciTxzcGFuPlwiICsgbGVuZ3RoICsgXCI8L3NwYW4+5p2h6K6w5b2VPC9oNj5cIiArXHJcbiAgICAgICAgICAgICAgICAgICAgXCI8dWwgY2xhc3M9J3BhZ2luYXRpb24nPlwiICsgZmlyc3RQYWdlICsgdXBQYWdlICsgcGFnZUh0bWwgKyBkb3duUGFnZSArIGxhc3RQYWdlICsgXCI8L3VsPjwvZGl2PlwiO1xyXG4gICAgICAgICAgICAgICAgLy90YWJsZeS4reazqOWFpeaLvOijheeahOiusOW9lVxyXG4gICAgICAgICAgICAgICAgZWxlLmh0bWwoYXNzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHsvL+aXoOazleWIhumhtea4heepuuWIhumhteWZqFxyXG4gICAgICAgICAgICAgICAgZWxlLmh0bWwoJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KGpRdWVyeSkpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplcmVteSBvbiAyMDE2LzIvMjYuXHJcbiAqIEB2ZXJzaW9uIDEuMC4wIGNyZWF0ZWQg6YCa55So5oCn5Yqf6IO95pa55rOVXHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxudmFyIEZ1biA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgX3RpbWVPdXQgPSAxMDAwMDA7Ly/or7fmsYLotoXml7bml7bpl7TkuLoxMHNcclxuICAgIC8qKlxyXG4gICAgICog5bCB6KOFYWpheFxyXG4gICAgICogQHBhcmFtIG9wdGlvblxyXG4gICAgICoge1xyXG4gICAgICogICAgICB1cmw6XCLor7fmsYLnmoTlnLDlnYBcIlxyXG4gICAgICogICAgICAsbWV0aG9kOlwi6K+35rGC55qE5pa55rOVXCJcclxuICAgICAqICAgICAgLGFzeW5jOlwi5piv5ZCm5bm25Y+RXCJcclxuICAgICAqICAgICAgLGRhdGE6XCLlj5HpgIHnmoTmlbDmja5cIlxyXG4gICAgICogICAgICAsc3VjY2VzczpcIuaIkOWKn+aXtuWbnuiwg1wiXHJcbiAgICAgKiAgICAgICxlcnJvcjpcIuWksei0pS/otoXml7bml7blm57osINcIlxyXG4gICAgICogICAgICAsdGltZW91dDpcIui2heaXtuaXtumXtFwiXHJcbiAgICAgKiAgICAgICxjb21wbGV0ZTpcIuWujOaIkOWQjueahOWbnuiwg1wiXHJcbiAgICAgKiB9XHJcbiAgICAgKi9cclxuICAgIHZhciBhamF4ID0gZnVuY3Rpb24gKG9wdGlvbikge1xyXG4gICAgICAgIC8vYWpheOW8gOWni+aXtuW6lOaYvuekuuKAnOWKoOi9veS/oeaBr+ahhuKAnVxyXG4gICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBvcHRpb24udXJsXHJcbiAgICAgICAgICAgICwgdHlwZTogXCJ0eXBlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi50eXBlIHx8IFwiR0VUXCJcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiBvcHRpb24udGltZW91dCB8fCBfdGltZU91dFxyXG4gICAgICAgICAgICAsIGRhdGE6IFwiZGF0YVwiIGluIG9wdGlvbiAmJiBvcHRpb24uZGF0YSB8fCB7fVxyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgICAgICAsIGFzeW5jOiAoXCJhc3luY1wiIGluIG9wdGlvbiAmJiBvcHRpb24uYXN5bmMpID8gdHJ1ZSA6IGZhbHNlXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChcInN0YXR1c1wiIGluIGpzb24gJiYganNvbi5zdGF0dXMgPiAwICYmIFwiZGF0YVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJzdWNjZXNzXCIgaW4gb3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbi5zdWNjZXNzKGpzb24uZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoXCLml6BzdWNjZXNz5pa55rOVIVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiZXJyb3JcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmVycm9yIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uZXJyb3IoanNvbik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmk43kvZzlpLHotKUhJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGVycm9yOiBmdW5jdGlvbiAoeGhyKSB7Ly80MDTmiJbogIXotoXml7ZcclxuICAgICAgICAgICAgICAgIGlmIChcImVycm9yXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5lcnJvciBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/mj5DnpLrnlKjmiLfplJnor6/kv6Hmga9cclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoXCLov57mjqXmnI3liqHlmajlpLHotKXvvIznirbmgIHvvJpcIiArICh4aHIuc3RhdHVzIHx8IC0xKSArIFwiLOS/oeaBr++8mlwiICsgKHhoci5zdGF0dXNUZXh0IHx8IFwiLVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmVycm9yKHhoci5zdGF0dXMsIHhoci5zdGF0dXNUZXh0KTsvL+Wbnuiwg+ivt+axgueahOeKtuaAgeWSjOmUmeivr+S/oeaBr1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKHhociwgdHlwZSkge1xyXG4gICAgICAgICAgICAgICAgLy/lhbPpl63igJzliqDovb3kv6Hmga/moYbigJ1cclxuICAgICAgICAgICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChcImNvbXBsZXRlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5jb21wbGV0ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmNvbXBsZXRlKHhociwgdHlwZSk7Ly/lm57osIPor7fmsYLnmoR4aHLkv6Hmga/lkoznsbvlnotcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v5YWo6YCJ5ZKM5Y2V6YCJ55qE57uR5a6aXHJcbiAgICB2YXIgc2V0Q2hlY2tib3hMaXN0ZW5lciA9IGZ1bmN0aW9uIChhbGxDaGVjaywgcmFkaW9DaGVja3MpIHtcclxuICAgICAgICAvL+etm+mAieWNlemAieaMiemSrue7hFxyXG4gICAgICAgIHZhciByYWRpb1ZhbHVlRWxlcyA9ICQocmFkaW9DaGVja3MpO1xyXG4gICAgICAgIC8v54K55Ye75YWo6YCJ5pe277yM5ZCM57uE5oyJ6ZKu6KKr5ZCM5q2lXHJcbiAgICAgICAgJChkb2N1bWVudCkuZGVsZWdhdGUoYWxsQ2hlY2ssIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAocmFkaW9WYWx1ZUVsZXMgJiYgcmFkaW9WYWx1ZUVsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX3IgPSAwOyBfciA8IHJhZGlvVmFsdWVFbGVzLmxlbmd0aDsgX3IrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJhZGlvVmFsdWVFbGVzW19yXS5jaGVja2VkID0gJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/ngrnlh7vljZXpgInmjInpkq7ml7bvvIxcclxuICAgICAgICAkKGRvY3VtZW50KS5kZWxlZ2F0ZShyYWRpb0NoZWNrcywgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoYWxsQ2hlY2spWzBdLmNoZWNrZWQgPSAkKHJhZGlvQ2hlY2tzICsgXCI6Y2hlY2tlZFwiKS5sZW5ndGggPT0gJChyYWRpb0NoZWNrcykubGVuZ3RoO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB1cmwgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBnZXQgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChcIihefCYpXCIgKyBuYW1lICsgXCI9KFteJl0qKSgmfCQpXCIsIFwiaVwiKTtcclxuICAgICAgICAgICAgdmFyIHIgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxKS5tYXRjaChyZWcpO1xyXG4gICAgICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gZGVjb2RlVVJJKHJbMl0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOagueaNruWPguaVsOWIl+ihqOmVv+W6pui/m+ihjOWIpOaWre+8jOWFvOWuuUlFOVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ29iamVjdCcpIHsvL+S4gOS4quWvueixoe+8jOS9v+eUqGtleeagh+iusHZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gYXJndW1lbnRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgLCBzZWFyY2ggPSBsb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBvIGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkobykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoID0gY2hhbmdlVVJMS2V5VmFsdWUoc2VhcmNoLCBvLCBvYmpbb10pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgncHVzaFN0YXRlJyBpbiBoaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgZG9jdW1lbnQudGl0bGUsIHNlYXJjaCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCdwdXNoU3RhdGUnIGluIEhpc3RvcnkpIHsvL2llOSDkuI3mlK/mjIFwdXNoU3RhdGXmlrnms5UsamF2YXNjcmlwdC5lanPkuK3mt7vliqBoaXN0b3J5Lmpz5a6M5oiQaHRtbDTlr7lwdXNoU3RhdGXnmoTmlK/mjIFcclxuICAgICAgICAgICAgICAgICAgICBIaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBzZWFyY2gpOy8v6L+U5Zue6YeN5paw5p6E6YCg5ZCOc2VhcmNo5LiyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgey8va2V5K3ZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gYXJndW1lbnRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgLCB2YWx1ZSA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgICAgICAgIGlmICgncHVzaFN0YXRlJyBpbiBoaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgZG9jdW1lbnQudGl0bGUsIGNoYW5nZVVSTEtleVZhbHVlKGxvY2F0aW9uLnRvU3RyaW5nKCksIGtleSwgdmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJ3B1c2hTdGF0ZScgaW4gSGlzdG9yeSkgey8vaWU5IOS4jeaUr+aMgXB1c2hTdGF0ZeaWueazlSxqYXZhc2NyaXB0LmVqc+S4rea3u+WKoGhpc3RvcnkuanPlrozmiJBodG1sNOWvuXB1c2hTdGF0ZeeahOaUr+aMgVxyXG4gICAgICAgICAgICAgICAgICAgIEhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIGNoYW5nZVVSTEtleVZhbHVlKGxvY2F0aW9uLnNlYXJjaCwga2V5LCB2YWx1ZSkpOy8v6L+U5Zue6YeN5paw5p6E6YCg5ZCOc2VhcmNo5LiyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gY2hhbmdlVVJMS2V5VmFsdWUodXJsLCBhcmcsIGFyZ192YWwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gYXJnICsgJz0oW14mXSopJztcclxuICAgICAgICAgICAgICAgIHZhciByZXBsYWNlVGV4dCA9IGFyZyArICc9JyArIGFyZ192YWw7XHJcbiAgICAgICAgICAgICAgICBpZiAodXJsLm1hdGNoKHBhdHRlcm4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9ICcvKCcgKyBhcmcgKyAnPSkoW14mXSopL2dpJztcclxuICAgICAgICAgICAgICAgICAgICB0bXAgPSB1cmwucmVwbGFjZShldmFsKHRtcCksIHJlcGxhY2VUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG1wO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodXJsLm1hdGNoKCdbXFw/XScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwgKyAnJicgKyByZXBsYWNlVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJsICsgJz8nICsgcmVwbGFjZVRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXQ6IGdldFxyXG4gICAgICAgICAgICAsIHNldDogc2V0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIHZhciBmb3JtYXRJbWFnZT1mdW5jdGlvbiAocGF0aCwgc2l6ZSwgZWxlKSB7XHJcbiAgICAgICAgaWYocGF0aCBpbnN0YW5jZW9mICBBcnJheSAmJiBwYXRoLmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgcGF0aCA9IHBhdGhbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBJTUFHRV9TSVpFID0ge1xyXG4gICAgICAgICAgICBvcmlnaW5hbDoge1xyXG4gICAgICAgICAgICAgICAgcGF0aDogXCJcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgeGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl94bGFyZ2VcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiNjYwKjY2MFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9sYXJnZVwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI0MjAqNDIwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWlkZGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWRkbGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMzAwKjMwMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNtYWxsOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9zbWFsbFwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCIyNDAqMjQwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGl0dGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9saXR0bGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMTIwKjEyMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1pY3JvOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWNyb1wiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI2MCo2MFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHNpemUgPSBJTUFHRV9TSVpFW3NpemUgfHwgXCJtaWRkbGVcIl0gfHwgSU1BR0VfU0laRS5taWRkbGU7XHJcbiAgICAgICAgdmFyIHBhdGhUZW1wID0gL1xcLlxcdys/JC8uZXhlYyhwYXRoKTtcclxuICAgICAgICBpZiAoIXBhdGhUZW1wKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gc2l6ZS5wYXRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhdGggPSAocGF0aC5zdWJzdHIoMCwgcGF0aFRlbXAuaW5kZXggfHwgcGF0aC5sZW5ndGgpKSArIHNpemUucGF0aCArIHBhdGhUZW1wWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZWxlICYmIGVsZS5hdHRyKSB7XHJcbiAgICAgICAgICAgIGVsZS5hdHRyKFwic3JjXCIsIHBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGZvcm1hdCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGZvcm1hdGFtb3VudCA9IGZ1bmN0aW9uKF92YWx1ZSl7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KF92YWx1ZSkudG9GaXhlZCgyKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8v5L2T56ev5qC85byP5YyW5bCP5pWw54K5MuS9jVxyXG4gICAgICAgIHZhciBmb3JtYXR2b2x1bWUgPSBmdW5jdGlvbihfdmFsdWUpe1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChfdmFsdWUpLnRvRml4ZWQoMyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvL+mHjemHj+agvOW8j+WMluWwj+aVsOeCuTLkvY1cclxuICAgICAgICB2YXIgZm9ybWF0d2VpZ2h0ID0gZnVuY3Rpb24oX3ZhbHVlKXtcclxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoX3ZhbHVlKS50b0ZpeGVkKDMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZm9ybWF0YW1vdW50OiBmb3JtYXRhbW91bnRcclxuICAgICAgICAgICAgLCBmb3JtYXR2b2x1bWU6IGZvcm1hdHZvbHVtZVxyXG4gICAgICAgICAgICAsIGZvcm1hdHdlaWdodDogZm9ybWF0d2VpZ2h0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgYWpheDogYWpheFxyXG4gICAgICAgICwgZ2V0VGltdG91dDogX3RpbWVPdXRcclxuICAgICAgICAsIHNldENoZWNrYm94TGlzdGVuZXI6IHNldENoZWNrYm94TGlzdGVuZXJcclxuICAgICAgICAsIHVybDogdXJsXHJcbiAgICAgICAgLCBmb3JtYXRJbWFnZTogZm9ybWF0SW1hZ2VcclxuICAgICAgICAsIGZvcm1hdDogZm9ybWF0XHJcbiAgICB9XHJcbn0oKSk7XHJcblxyXG5leHBvcnRzLmFqYXggPSBGdW4uYWpheDtcclxuZXhwb3J0cy5nZXRUaW1lb3V0ID0gRnVuLmdldFRpbXRvdXQ7XHJcbmV4cG9ydHMuc2V0Q2hlY2tib3hMaXN0ZW5lciA9IEZ1bi5zZXRDaGVja2JveExpc3RlbmVyO1xyXG5leHBvcnRzLnVybCA9IEZ1bi51cmw7XHJcbmV4cG9ydHMuZm9ybWF0ID0gRnVuLmZvcm1hdDtcclxuZXhwb3J0cy5mb3JtYXRJbWFnZSA9IEZ1bi5mb3JtYXRJbWFnZTtcclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVyZW15IG9uIDIwMTYvMi8yNC5cclxuICogQHZlcnNpb24gMS4wLjAgY3JlYXRlZFxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbi8v5p6E6YCg5L+h5oGv5qGG5Li75L2TXHJcbnZhciBNb2RhbCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAvL+aehOmAoOWOn+Wni+exu1xyXG4gICAgZnVuY3Rpb24gTShtKSB7XHJcbiAgICAgICAgdGhpcy5zID0gbS5zOy8v5piv5ZCm5pi+56S6XHJcbiAgICAgICAgdGhpcy5pZCA9IG0uaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy/mnoTpgKDmoIflh4ZzaG935pa55rOV77yM55So5LqO57un5om/XHJcbiAgICBNLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlkKTtcclxuICAgICAgICBpZiAoZWxlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnMgJiYgIWlzU2hvdygpKSB7Ly/mmL7npLrlvZPliY3pmpDol49cclxuICAgICAgICAgICAgICAgIGVsZS5jbGFzc05hbWUgPSBlbGUuY2xhc3NOYW1lLnJlcGxhY2UoXCJkcC1uXCIsIFwiXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLnMgJiYgaXNTaG93KCkpIHsvL+makOiXj+W9k+WJjeaYvuekulxyXG4gICAgICAgICAgICAgICAgZWxlLmNsYXNzTmFtZSArPSBcIiBkcC1uXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy/ljrvpmaTkuKTovrnnmoTnqbrmoLxcclxuICAgICAgICAgICAgZWxlLmNsYXNzTmFtZSA9IFN0cmluZyhlbGUuY2xhc3NOYW1lKS50cmltKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGlzU2hvdygpIHsvL+aYr+WQpuW3suaYvuekuu+8jOaXoGNsYXNz5pe25pi+56S6XHJcbiAgICAgICAgICAgIHJldHVybiBlbGUuY2xhc3NOYW1lLnNwbGl0KFwiZHAtblwiKS5sZW5ndGggPT0gMTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8v5Yqg6L295L+h5oGv5qGGXHJcbiAgICB2YXIgbG9hZGluZyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy/liJ3lp4vljJbnlJ/miJDliqDovb3kv6Hmga/moYZcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvYWRpbmdfbW9kYWxfZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD1cImxvYWRpbmdfbW9kYWxfZWxlbWVudFwiIGNsYXNzPVwibG9hZGluZy1tb2RhbC1ib2R5IGRwLW5cIj48ZGl2IGNsYXNzPVwiY292ZXJfbW9kYWxfZWxlbWVudFwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibG9hZGluZy1tb2RhbC1pbWFnZVwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibG9hZGluZy1tb2RhbC10ZXh0XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxoMj7njqnlkb3liqDovb3kuK3igKbigKY8L2gyPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvL+aYvuekuuOAgemakOiXj+S/oeaBr+ahhlxyXG4gICAgICAgIHZhciBzaG93ID0gZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgcyA9IHR5cGVvZiBzID09IFwidW5kZWZpbmVkXCIgPyB0cnVlIDogczsvL+aXoOWPguaVsOaYvuekuuS/oeaBr+ahhlxyXG4gICAgICAgICAgICB2YXIgbSA9IG5ldyBNKHtpZDogXCJsb2FkaW5nX21vZGFsX2VsZW1lbnRcIiwgczogc30pO1xyXG4gICAgICAgICAgICBtLnNob3coKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXRcclxuICAgICAgICAgICAgLCBzaG93OiBzaG93XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIC8v5by55Ye65L+h5oGv5qGGXHJcbiAgICB2YXIgYWxlcnQgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWxlcnRfbW9kYWxfZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD1cImFsZXJ0X21vZGFsX2VsZW1lbnRcIiBjbGFzcz1cImFsZXJ0LW1vZGFsLWVsZW1lbnQgZHAtblwiPjxkaXYgY2xhc3M9XCJjb3Zlcl9tb2RhbF9lbGVtZW50XCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbGVydC1tb2RhbC1jb250ZW50XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbGVydC1tb2RhbC1ib2R5XCI+PHNwYW4gY2xhc3M9XCJhbGVydC1tb2RhbC10ZXh0XCI+PC9zcGFuPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWxlcnQtbW9kYWwtZm9vdGVyXCI+PGJ1dHRvbiBpZD1cImFsZXJ0X21vZGFsX2Nsb3NlXCIgY2xhc3M9XCJhbGVydC1tb2RhbC1idXR0b25cIj7lhbPpl608L2J1dHRvbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHNob3cgPSBmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICBzID0gdHlwZW9mIHMgPT0gXCJ1bmRlZmluZWRcIiA/IHRydWUgOiBzO1xyXG4gICAgICAgICAgICB2YXIgbSA9IG5ldyBNKHtpZDogXCJhbGVydF9tb2RhbF9lbGVtZW50XCIsIHM6IHN9KTtcclxuICAgICAgICAgICAgbS5zaG93KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDorr7nva7lvLnlh7rkv6Hmga/moYZcclxuICAgICAgICAgKiBAcGFyYW0gbXNnICAgICAgIOaYvuekuueahOS/oeaBr++8jOaUr+aMgWh0bWxcclxuICAgICAgICAgKiBAcGFyYW0gc2VkICAgICAgIOWAkuiuoeaXtuWFs+mXreaXtumXtO+8jOWNleS9je+8mnNlY29uZFxyXG4gICAgICAgICAqIEBwYXJhbSBjYWxsYmFjayAg5YWz6Zet6Kem5Y+R5Zue6LCD5Ye95pWwXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHNldCA9IGZ1bmN0aW9uIChtc2csIHNlZCwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdmFyIGVsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWxlcnRfbW9kYWxfZWxlbWVudFwiKTtcclxuICAgICAgICAgICAgaWYgKG1zZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtc2cgPT09ICdvYmplY3QnKSB7Ly/lupTlr7nlkI7nq6/ov5Tlm57mj5DnpLrml7bkvb/nlKhPYmplY3TlsIHoo4VcclxuICAgICAgICAgICAgICAgICAgICBtc2cgPSBKU09OLnN0cmluZ2lmeShtc2cpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoZWxlKXtcclxuICAgICAgICAgICAgICAgICAgICBlbGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImFsZXJ0LW1vZGFsLXRleHRcIilbMF0uaW5uZXJIVE1MID0gbXNnO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYWxlcnQtbW9kYWwtdGV4dFwiKVswXS5pbm5lckhUTUwgPSBtc2c7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzaG93KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHNlZCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwMCAqIHNlZCk7XHJcbiAgICAgICAgICAgIH0vL+aXoOWFs+mXreaXtumXtOaIluiAheWFs+mXreaXtumXtOS4ujDvvIzkuI3oh6rliqjlhbPpl61cclxuICAgICAgICAgICAgLy9maXhtZSDkuovku7bnm5HlkKznmoRpZeWFvOWuueaAp1xyXG4gICAgICAgICAgICAvL+WFs+mXreaMiemSrueahOS6i+S7tuS+puWQrFxyXG4gICAgICAgICAgICAkKFwiI2FsZXJ0X21vZGFsX2Nsb3NlXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAvL+mYu+atouS6i+S7tue7p+e7reS8oOmAklxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXRcclxuICAgICAgICAgICAgLCBzaG93OiBzaG93XHJcbiAgICAgICAgICAgICwgc2V0OiBzZXRcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgLy/pgInmi6nkv6Hmga/moYZcclxuICAgIHZhciBjb25maXJtID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1fbW9kYWxfZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD1cImNvbmZpcm1fbW9kYWxfZWxlbWVudFwiIGNsYXNzPVwiY29uZmlybS1tb2RhbC1lbGVtZW50IGRwLW5cIj48ZGl2IGNsYXNzPVwiY292ZXJfbW9kYWxfZWxlbWVudFwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29uZmlybS1tb2RhbC1jb250ZW50XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgaWQ9XCJjb25maXJtX21vZGFsX2hlYWRlclwiIGNsYXNzPVwiY29uZmlybS1tb2RhbC1oZWFkZXIgZHAtblwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29uZmlybS1tb2RhbC1ib2R5XCI+PHNwYW4gaWQ9XCJjb25maXJtX21vZGFsX3RleHRcIiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtdGV4dFwiPjwvc3Bhbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtZm9vdGVyXCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmb290ZXItYnV0dG9uLXN1Y2Nlc3NcIj48YnV0dG9uIGNsYXNzPVwiY29uZmlybS1tb2RhbC1idXR0b24gIG1vZGFsLXN1Y2Nlc3NcIiBkYXRhLWNvbmZpcm09XCJzdWNjZXNzXCI+56Gu6K6kPC9idXR0b24+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmb290ZXItYnV0dG9uLWZhbHNlXCI+PGJ1dHRvbiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtYnV0dG9uXCIgZGF0YS1jb25maXJtPVwiZXJyb3JcIj7lj5bmtog8L2J1dHRvbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHNob3cgPSBmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICBzID0gdHlwZW9mIHMgPT0gXCJ1bmRlZmluZWRcIiA/IHRydWUgOiBzO1xyXG4gICAgICAgICAgICB2YXIgbSA9IG5ldyBNKHtpZDogXCJjb25maXJtX21vZGFsX2VsZW1lbnRcIiwgczogc30pO1xyXG4gICAgICAgICAgICBtLnNob3coKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiuvue9rumAieaLqeS/oeaBr+ahhueahOWGheWuuVxyXG4gICAgICAgICAqIEBwYXJhbSBvcHRpb24gICAg6YWN572uXHJcbiAgICAgICAgICoge1xyXG4gICAgICAgICAqICAgICAgdGl0bGU6XCLlpLTpg6jmmL7npLrnmoTkv6Hmga9cIlxyXG4gICAgICAgICAqICAgICAgLHRleHQ6XCLmmL7npLrnmoTmj5DnpLrkv6Hmga9cIlxyXG4gICAgICAgICAqICAgICAgLHN1Y2Nlc3M6XCLngrnlh7vmiJDlip/lkI7nmoTlm57osINcIlxyXG4gICAgICAgICAqICAgICAgLGVycm9yOlwi54K55Ye75aSx6LSl5ZCO55qE5Zue6LCDXCJcclxuICAgICAgICAgKiAgICAgICxjb21wbGV0ZTpcIueCueWHu+aMiemSruWQjueahOaVtOS9k+Wbnuiwg1wiXHJcbiAgICAgICAgICogfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBiYXIgPSAwO1xyXG4gICAgICAgIHZhciBzZXQgPSBmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICghb3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKFwidGl0bGVcIiBpbiBvcHRpb24gJiYgb3B0aW9uLnRpdGxlLmxlbmd0aCA+IDApIHsvL+acieWktOmDqO+8jOWImeaYvuekuuWktOmDqFxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtX21vZGFsX2hlYWRlclwiKS5pbm5lckhUTUwgPSBvcHRpb24udGl0bGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKFwidGV4dFwiIGluIG9wdGlvbiAmJiBvcHRpb24udGV4dC5sZW5ndGggPiAwKSB7Ly/mnInlhoXlrrnvvIzliJnmmL7npLrmlbTkuKrpgInmi6nkv6Hmga/moYZcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybV9tb2RhbF90ZXh0XCIpLmlubmVySFRNTCA9IG9wdGlvbi50ZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vZml4bWUg5LqL5Lu255uR5ZCs55qEaWXlhbzlrrnmgKdcclxuICAgICAgICAgICAgLy/lhbPpl63mjInpkq7nmoTkuovku7bkvqblkKxcclxuICAgICAgICAgICAgJChcIiNjb25maXJtX21vZGFsX2VsZW1lbnRcIikuZmluZChcIi5jb25maXJtLW1vZGFsLWJ1dHRvblwiKS5vZmYoXCJjbGlja1wiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIC8vZml4bWUgLm9mZihcImNsaWNrXCIp55So5LqO6Ziy5q2i5aSa5qyh6Kem5Y+RPC0t5b6I546E5a2m77yM5oiR5Lmf5LiN55+l6YGT5Li65LuA5LmI77yM5L2G5piv6K+35LiN6KaB5L+u5pS544CCXHJcbiAgICAgICAgICAgICAgICB2YXIgYXRyID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1jb25maXJtXCIpOy8v6YCJ5oup55qE5oyJ6ZKuXHJcbiAgICAgICAgICAgICAgICBiYXIrKztcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb24gJiYgYXRyIGluIG9wdGlvbiAmJiBvcHRpb25bYXRyXSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uW2F0cl0oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb24gJiYgXCJjb21wbGV0ZVwiIGluIG9wdGlvbiAmJiBvcHRpb24uY29tcGxldGUgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbi5jb21wbGV0ZSgpOy8v6Iul5pyJ5a6M5oiQ5Ye95pWw77yM5YiZ5omn6KGMXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Ugey8v5ZCm5YiZ77yM5YWz6Zet6YCJ5oup5qGGXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL+mYu+atouS6i+S7tue7p+e7reS8oOmAklxyXG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICAsIHNob3c6IHNob3dcclxuICAgICAgICAgICAgLCBzZXQ6IHNldFxyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICAvL+imhuebluWxglxyXG4gICAgdmFyIGNvdmVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvdmVyX21vZGFsX2VsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJjb3Zlcl9tb2RhbF9lbGVtZW50XCIgY2xhc3M9XCJjb3Zlci1tb2RhbC1lbGVtZW50IGRwLW5cIj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgaGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb3Zlcl9tb2RhbF9lbGVtZW50XCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBzaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvdmVyX21vZGFsX2VsZW1lbnRcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXRcclxuICAgICAgICAgICAgLCBzaG93OiBzaG93XHJcbiAgICAgICAgICAgICwgaGlkZTogaGlkZVxyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGluaXRMb2FkaW5nOiBsb2FkaW5nLmluaXRcclxuICAgICAgICAsIHNob3dMb2FkaW5nOiBsb2FkaW5nLnNob3dcclxuXHJcbiAgICAgICAgLCBpbml0QWxlcnQ6IGFsZXJ0LmluaXRcclxuICAgICAgICAsIHNob3dBbGVydDogYWxlcnQuc2hvd1xyXG4gICAgICAgICwgc2V0QWxlcnQ6IGFsZXJ0LnNldFxyXG5cclxuICAgICAgICAsIGluaXRDb25maXJtOiBjb25maXJtLmluaXRcclxuICAgICAgICAsIHNldENvbmZpcm06IGNvbmZpcm0uc2V0XHJcbiAgICAgICAgLCBzaG93Q29uZmlybTogY29uZmlybS5zaG93XHJcbiAgICAgICAgLCBpbml0Q292ZXI6IGNvdmVyLmluaXRcclxuICAgIH1cclxufSgpKTtcclxuXHJcbi8v6aG16Z2i5Yqg6L295a6M5q+V5ZCO55Sf5oiQ5Zub5Liq6Ieq5a6a5LmJ5qih5oCB5qGGXHJcbnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgLy/pobXpnaLliqDovb3ml7bnlJ/miJDkuIDkuKropobnm5blsYJcclxuICAgIE1vZGFsLmluaXRDb3ZlcigpO1xyXG4gICAgLy/pobXpnaLliqDovb3ml7bnlJ/miJDkuIDkuKrliqDovb3kv6Hmga/moYZcclxuICAgIE1vZGFsLmluaXRMb2FkaW5nKCk7XHJcbiAgICAvL+mhtemdouWKoOi9veaXtueUn+aIkOS4gOS4quW8ueWHuuS/oeaBr+ahhlxyXG4gICAgTW9kYWwuaW5pdEFsZXJ0KCk7XHJcbiAgICAvL+mhtemdouWKoOi9veaXtueUn+aIkOS4gOS4qumAieaLqeS/oeaBr+ahhlxyXG4gICAgTW9kYWwuaW5pdENvbmZpcm0oKTtcclxufSwgMTAwKTtcclxuXHJcblxyXG4vL+aKm+WHuuS4iuWxguiwg+eUqFxyXG5leHBvcnRzLnNob3dMb2FkaW5nID0gTW9kYWwuc2hvd0xvYWRpbmc7XHJcbmV4cG9ydHMuc2V0QWxlcnQgPSBNb2RhbC5zZXRBbGVydDtcclxuZXhwb3J0cy5zaG93QWxlcnQgPSBNb2RhbC5zaG93QWxlcnQ7XHJcbmV4cG9ydHMuc2V0Q29uZmlybSA9IE1vZGFsLnNldENvbmZpcm07XHJcbmV4cG9ydHMuc2hvd0NvbmZpcm0gPSBNb2RhbC5zaG93Q29uZmlybTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNi8xMS8yMi5cclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG52YXIgaGVhZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIC8v5pe26Ze05qC85byP5YyWXHJcbiAgICBEYXRlLnByb3RvdHlwZS5Gb3JtYXQgPSBmdW5jdGlvbiAoZm10KSB7IC8vYXV0aG9yOiBKZXJlbXl5eVxyXG4gICAgICAgIHZhciBvID0ge1xyXG4gICAgICAgICAgICBcIk0rXCI6IHRoaXMuZ2V0TW9udGgoKSArIDEsIC8v5pyI5Lu9XHJcbiAgICAgICAgICAgIFwiZCtcIjogdGhpcy5nZXREYXRlKCksIC8v5pelXHJcbiAgICAgICAgICAgIFwiaCtcIjogdGhpcy5nZXRIb3VycygpLCAvL+Wwj+aXtlxyXG4gICAgICAgICAgICBcIm0rXCI6IHRoaXMuZ2V0TWludXRlcygpLCAvL+WIhlxyXG4gICAgICAgICAgICBcInMrXCI6IHRoaXMuZ2V0U2Vjb25kcygpLCAvL+enklxyXG4gICAgICAgICAgICBcInErXCI6IE1hdGguZmxvb3IoKHRoaXMuZ2V0TW9udGgoKSArIDMpIC8gMyksIC8v5a2j5bqmXHJcbiAgICAgICAgICAgIFwiU1wiOiB0aGlzLmdldE1pbGxpc2Vjb25kcygpIC8v5q+r56eSXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoLyh5KykvLnRlc3QoZm10KSkgZm10ID0gZm10LnJlcGxhY2UoUmVnRXhwLiQxLCAodGhpcy5nZXRGdWxsWWVhcigpICsgXCJcIikuc3Vic3RyKDQgLSBSZWdFeHAuJDEubGVuZ3RoKSk7XHJcbiAgICAgICAgZm9yICh2YXIgayBpbiBvKVxyXG4gICAgICAgICAgICBpZiAobmV3IFJlZ0V4cChcIihcIiArIGsgKyBcIilcIikudGVzdChmbXQpKSBmbXQgPSBmbXQucmVwbGFjZShSZWdFeHAuJDEsIChSZWdFeHAuJDEubGVuZ3RoID09IDEpID8gKG9ba10pIDogKChcIjAwXCIgKyBvW2tdKS5zdWJzdHIoKFwiXCIgKyBvW2tdKS5sZW5ndGgpKSk7XHJcbiAgICAgICAgcmV0dXJuIGZtdDtcclxuICAgIH07XHJcbiAgICAvL+i/lOWbnumhtumDqFxyXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5iYWNrLXRvcCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKFwiaHRtbCxib2R5XCIpLmFuaW1hdGUoe3Njcm9sbFRvcDowfSwxMDApO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG4gICAgJChkb2N1bWVudCkub24oJ21vdXNlZW50ZXInLCAnLnZpcC1wYXJ0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQodGhpcykuY2hpbGRyZW4oJy52aXAtc2VsZWN0Jykuc3RvcCh0cnVlKTtcclxuICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCcudmlwLXNlbGVjdCcpLnNsaWRlRG93bigxMDApO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG4gICAgJChkb2N1bWVudCkub24oJ21vdXNlbGVhdmUnLCAnLnZpcC1wYXJ0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQodGhpcykuY2hpbGRyZW4oJy52aXAtc2VsZWN0Jykuc3RvcCh0cnVlKTtcclxuICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCcudmlwLXNlbGVjdCcpLnNsaWRlVXAoMTAwKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWVudGVyJywgJy53ZWNoYXQtbG9nbycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCcuYmlnLXdlY2hhdCcpLmZhZGVJbigyMDApO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG4gICAgJChkb2N1bWVudCkub24oJ21vdXNlbGVhdmUnLCAnLndlY2hhdC1sb2dvJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQodGhpcykuY2hpbGRyZW4oJy5iaWctd2VjaGF0JykuZmFkZU91dCgyMDApO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG59O1xyXG5tb2R1bGUuZXhwb3J0cy5oZWFkID0gaGVhZDsiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNi8xMS8yMi5cclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG52YXIgbGlzdGVuZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+WktOmDqOeCueWHu+S6i+S7tlxyXG4gICAgICAgIHJlcXVpcmUoJy4vaGVhZCcpLmhlYWQoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJ1bjogcnVuXHJcbiAgICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzID0gbGlzdGVuZXI7Il19
