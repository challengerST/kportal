(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/24.
 */
"use strict";

(function ($) {
    /**
     * 生成分页器
     * @param ele 需要添加分页器的元素
     * @param offset 偏移量，即从第data-offset开始
     * @param length 总记录条数
     * @param showPages 分页器显示的页数，超过则隐藏多余的页
     * @param rows 每页显示的记录条数
     */
    $.burster = function (ele, offset, length, showPages, rows) {
        offset = offset ? parseInt(offset) : 0;
        //将分页器装入table中
        if (length && length > offset) {
            var pageHtml = ""
                , ass = ""//清空需要装入的html
                , beforePages = Math.ceil(offset / rows)//需要显示的前页数/当前页
                , afterPages = Math.ceil((length - offset ) / rows)//需要显示的后页数
                , pages = Math.ceil(length / rows) //总页数
                , k = 0;
            //alert("总页数" + pages + " 前页数 " + beforePages + " 后页数 " + afterPages);
            //若页数小于showPages页，则全部显示
            if (pages >= 0 && pages <= showPages) {
                for (k = 0; k < pages; k++) {
                    if (k == beforePages) {
                        pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                    } else {
                        pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                    }
                }
            } else if (pages > showPages) {//总页数大于showPages页
                if (beforePages <= Math.ceil(showPages / 2) && afterPages > showPages + 1) {
                    for (k = 0; k < showPages; k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages <= Math.ceil(showPages / 2) && afterPages == showPages + 1) {
                    for (k = 0; k < showPages - 1; k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages <= Math.ceil(showPages / 2) && afterPages <= showPages) {
                    for (k = 0; k < showPages - 1; k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > Math.ceil(showPages / 2) && beforePages <= showPages && afterPages > showPages) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > showPages && afterPages > showPages) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > Math.ceil(showPages / 2) && beforePages <= pages && afterPages <= showPages && afterPages > Math.ceil(showPages / 2) + 1) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > pages && afterPages <= showPages && afterPages > Math.ceil(showPages / 2) + 1) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < beforePages + Math.ceil(showPages / 2); k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                    pageHtml += "<li><a class='pages' data-offset='" + ((pages - 1) * rows) + "'>..." + pages + "</a></li>";
                } else if (beforePages > Math.ceil(showPages / 2) && afterPages <= Math.ceil(showPages / 2) + 1) {
                    pageHtml += "<li><a class='pages' data-offset='0'>1...</a></li>";
                    for (k = beforePages - Math.ceil(showPages / 2) + 1; k < pages; k++) {
                        if (k == beforePages) {
                            pageHtml += "<li class='active' ><a>" + (k + 1) + "</a></li>";
                        } else {
                            pageHtml += "<li><a class='pages' data-offset='" + (k * rows) + "'>" + (k + 1) + "</a></li>";
                        }
                    }
                }
            }
            //判断"首页"和"末页"是否可点击
            var firstPage, lastPage;
            if (offset == 0) {//此时首页无法点击
                firstPage = '<li class="disabled"><a class="pages" data-offset="0">首页</a></li>';
                lastPage = '<li><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '" >末页</a></li>';
            } else if ((offset + rows) >= length) {//此时末页无法点击
                firstPage = '<li><a class="pages" data-offset="0">首页</a></li>';
                lastPage = '<li class="disabled"><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '">末页</a></li>';
            } else {
                firstPage = '<li><a class="pages" data-offset="0">首页</a></li>';
                lastPage = '<li><a class="pages" data-offset="' + parseInt(parseInt((length % rows == 0 ? (length - 1) : length) / rows) * rows) + '">末页</a></li>';
            }
            //判断"上一页"和"下一页"是否存在
            var upPage, downPage;
            if (offset == 0 || (offset < rows && (offset % rows != 0))) {
                upPage = "<li class='disabled'><a class='pages' func='previous' data-offset='" + parseInt(offset) + "' >上页</a></li>"
            } else {
                upPage = "<li><a class='pages' func='previous' data-offset='" + (parseInt(offset) - parseInt(rows)) + "' >上页</a></li>";
            }
            if (offset >= (length - rows)) {
                downPage = "<li class='disabled'><a class='pages' func='next' data-offset='" + parseInt(offset) + "'>下页</a></li>"
            } else {
                downPage = "<li><a class='pages' func='next' data-offset='" + parseInt(parseInt(offset) + parseInt(rows)) + "'>下页</a></li>"
            }
            if (pages != 1) {
                //分页部分
                ass += "<div id='pager' class='pager-info'>" +
                    "<h6 id='result' class='pager-record'>共有<span>" + length + "</span>条记录</h6>" +
                    "<ul class='pagination'>" + firstPage + upPage + pageHtml + downPage + lastPage + "</ul></div>";
                //table中注入拼装的记录
                ele.html(ass);
            } else {//无法分页清空分页器
                ele.html('');
            }
        }
    }
}(jQuery));
},{}],2:[function(require,module,exports){
/**
 * Created by jeremy on 2016/2/26.
 * @version 1.0.0 created 通用性功能方法
 */

'use strict';

var Fun = (function () {
    var _timeOut = 100000;//请求超时时间为10s
    /**
     * 封装ajax
     * @param option
     * {
     *      url:"请求的地址"
     *      ,method:"请求的方法"
     *      ,async:"是否并发"
     *      ,data:"发送的数据"
     *      ,success:"成功时回调"
     *      ,error:"失败/超时时回调"
     *      ,timeout:"超时时间"
     *      ,complete:"完成后的回调"
     * }
     */
    var ajax = function (option) {
        //ajax开始时应显示“加载信息框”
        Modal.showLoading();
        $.ajax({
            url: option.url
            , type: "type" in option && option.type || "GET"
            , timeout: option.timeout || _timeOut
            , data: "data" in option && option.data || {}
            , dataType: "json"
            , async: ("async" in option && option.async) ? true : false
            , success: function (json) {
                if ("status" in json && json.status > 0 && "data" in json) {
                    if ("success" in option) {
                        option.success(json.data);
                    } else {
                        Modal.setAlert("无success方法!");
                    }
                } else if ("error" in option && option.error instanceof Function) {
                    option.error(json);
                } else {
                    Modal.setAlert('操作失败!');
                }
            }, error: function (xhr) {//404或者超时
                if ("error" in option && option.error instanceof Function) {
                    //提示用户错误信息
                    Modal.showLoading(false);
                    Modal.setAlert("连接服务器失败，状态：" + (xhr.status || -1) + ",信息：" + (xhr.statusText || "-"));
                    option.error(xhr.status, xhr.statusText);//回调请求的状态和错误信息
                }
            }, complete: function (xhr, type) {
                //关闭“加载信息框”
                Modal.showLoading(false);
                if ("complete" in option && option.complete instanceof Function) {
                    option.complete(xhr, type);//回调请求的xhr信息和类型
                }
            }
        });
    };
    //全选和单选的绑定
    var setCheckboxListener = function (allCheck, radioChecks) {
        //筛选单选按钮组
        var radioValueEles = $(radioChecks);
        //点击全选时，同组按钮被同步
        $(document).delegate(allCheck, "click", function () {
            if (radioValueEles && radioValueEles.length > 0) {
                for (var _r = 0; _r < radioValueEles.length; _r++) {
                    radioValueEles[_r].checked = $(this).is(":checked");
                }
            }
        });
        //点击单选按钮时，
        $(document).delegate(radioChecks, "click", function () {
            $(allCheck)[0].checked = $(radioChecks + ":checked").length == $(radioChecks).length;
        });
    };
    var url = (function () {
        var get = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURI(r[2]);
            return null;
        };
        /**
         * 根据参数列表长度进行判断，兼容IE9
         * @returns {string}
         */
        var set = function () {
            if (arguments.length === 1 && typeof arguments[0] === 'object') {//一个对象，使用key标记value
                var obj = arguments[0]
                    , search = location.search;
                for (var o in obj) {
                    if (obj.hasOwnProperty(o)) {
                        search = changeURLKeyValue(search, o, obj[o]);
                    }
                }
                if ('pushState' in history) {
                    history.pushState(null, document.title, search);
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, search);//返回重新构造后search串
                }
            } else if (arguments.length === 2) {//key+value
                var key = arguments[0]
                    , value = arguments[1];
                if ('pushState' in history) {
                    history.pushState(null, document.title, changeURLKeyValue(location.toString(), key, value));
                } else if ('pushState' in History) {//ie9 不支持pushState方法,javascript.ejs中添加history.js完成html4对pushState的支持
                    History.pushState(null, null, changeURLKeyValue(location.search, key, value));//返回重新构造后search串
                }
            }
            function changeURLKeyValue(url, arg, arg_val) {
                var pattern = arg + '=([^&]*)';
                var replaceText = arg + '=' + arg_val;
                if (url.match(pattern)) {
                    var tmp = '/(' + arg + '=)([^&]*)/gi';
                    tmp = url.replace(eval(tmp), replaceText);
                    return tmp;
                } else {
                    if (url.match('[\?]')) {
                        return url + '&' + replaceText;
                    } else {
                        return url + '?' + replaceText;
                    }
                }
            }
        };
        return {
            get: get
            , set: set
        }
    }());
    var formatImage=function (path, size, ele) {
        if(path instanceof  Array && path.length>0){
            path = path[0];
        }
        var IMAGE_SIZE = {
            original: {
                path: "",
                size: ""
            },
            xlarge: {
                path: "_xlarge",
                size: "660*660"
            },
            large: {
                path: "_large",
                size: "420*420"
            },
            middle: {
                path: "_middle",
                size: "300*300"
            },
            small: {
                path: "_small",
                size: "240*240"
            },
            little: {
                path: "_little",
                size: "120*120"
            },
            micro: {
                path: "_micro",
                size: "60*60"
            }
        };
        size = IMAGE_SIZE[size || "middle"] || IMAGE_SIZE.middle;
        var pathTemp = /\.\w+?$/.exec(path);
        if (!pathTemp) {
            path += size.path;
        } else {
            path = (path.substr(0, pathTemp.index || path.length)) + size.path + pathTemp[0];
        }
        if (ele && ele.attr) {
            ele.attr("src", path);
        }
        return path;
    };
    return {
        ajax: ajax
        , getTimtout: _timeOut
        , setCheckboxListener: setCheckboxListener
        , url: url
        , formatImage: formatImage
    }
}());

exports.ajax = Fun.ajax;
exports.getTimeout = Fun.getTimtout;
exports.setCheckboxListener = Fun.setCheckboxListener;
exports.url = Fun.url;
exports.formatImage = Fun.formatImage;

},{}],3:[function(require,module,exports){
/**
 * Created by jeremy on 2016/2/24.
 * @version 1.0.0 created
 */

'use strict';

//构造信息框主体
var Modal = (function () {
    //构造原始类
    function M(m) {
        this.s = m.s;//是否显示
        this.id = m.id;
    }

    //构造标准show方法，用于继承
    M.prototype.show = function () {
        var ele = document.getElementById(this.id);
        if (ele) {
            if (this.s && !isShow()) {//显示当前隐藏
                ele.className = ele.className.replace("dp-n", "");
            } else if (!this.s && isShow()) {//隐藏当前显示
                ele.className += " dp-n";
            }
            //去除两边的空格
            ele.className = String(ele.className).trim();
        }
        function isShow() {//是否已显示，无class时显示
            return ele.className.split("dp-n").length == 1;
        }
    };

    //加载信息框
    var loading = (function () {
        //初始化生成加载信息框
        var init = function () {
            if (!document.getElementById("loading_modal_element")) {
                $('body').append('<div id="loading_modal_element" class="loading-modal-body dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="loading-modal-image"></div>' +
                    '<div class="loading-modal-text">' +
                    '<h2>玩命加载中……</h2>' +
                    '</div></div>');
            }
            return false;
        };
        //显示、隐藏信息框
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;//无参数显示信息框
            var m = new M({id: "loading_modal_element", s: s});
            m.show();
        };
        return {
            init: init
            , show: show
        }
    }());
    //弹出信息框
    var alert = (function () {
        var init = function () {
            if (!document.getElementById("alert_modal_element")) {
                $('body').append('<div id="alert_modal_element" class="alert-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="alert-modal-content">' +
                    '<div class="alert-modal-body"><span class="alert-modal-text"></span></div>' +
                    '<div class="alert-modal-footer"><button id="alert_modal_close" class="alert-modal-button">关闭</button></div>' +
                    '</div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "alert_modal_element", s: s});
            m.show();
        };
        /**
         * 设置弹出信息框
         * @param msg       显示的信息，支持html
         * @param sed       倒计时关闭时间，单位：second
         * @param callback  关闭触发回调函数
         */
        var set = function (msg, sed, callback) {
            var ele = document.getElementById("alert_modal_element");
            if (msg) {
                if (typeof msg === 'object') {//应对后端返回提示时使用Object封装
                    msg = JSON.stringify(msg);
                }
                if(ele){
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }else{
                    init();
                    ele.getElementsByClassName("alert-modal-text")[0].innerHTML = msg;
                }
                show();
            }
            if (sed > 0) {
                setTimeout(function () {
                    show(false);
                }, 1000 * sed);
            }//无关闭时间或者关闭时间为0，不自动关闭
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#alert_modal_close").on("click", function () {
                if (callback && callback instanceof Function) {
                    callback();
                }
                show(false);
                //阻止事件继续传递
                return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //选择信息框
    var confirm = (function () {
        var init = function () {
            if (!document.getElementById("confirm_modal_element")) {
                $('body').append('<div id="confirm_modal_element" class="confirm-modal-element dp-n"><div class="cover_modal_element"></div>' +
                    '<div class="confirm-modal-content">' +
                    '<div id="confirm_modal_header" class="confirm-modal-header dp-n"></div>' +
                    '<div class="confirm-modal-body"><span id="confirm_modal_text" class="confirm-modal-text"></span></div>' +
                    '<div class="confirm-modal-footer">' +
                    '<div class="footer-button-success"><button class="confirm-modal-button  modal-success" data-confirm="success">确认</button></div>' +
                    '<div class="footer-button-false"><button class="confirm-modal-button" data-confirm="error">取消</button></div>' +
                    '</div></div></div>');
            }
            return false;
        };
        var show = function (s) {
            s = typeof s == "undefined" ? true : s;
            var m = new M({id: "confirm_modal_element", s: s});
            m.show();
        };
        /**
         * 设置选择信息框的内容
         * @param option    配置
         * {
         *      title:"头部显示的信息"
         *      ,text:"显示的提示信息"
         *      ,success:"点击成功后的回调"
         *      ,error:"点击失败后的回调"
         *      ,complete:"点击按钮后的整体回调"
         * }
         */
        var bar = 0;
        var set = function (option) {
            if (!option) {
                return false;
            }
            if ("title" in option && option.title.length > 0) {//有头部，则显示头部
                document.getElementById("confirm_modal_header").innerHTML = option.title;
            }
            if ("text" in option && option.text.length > 0) {//有内容，则显示整个选择信息框
                document.getElementById("confirm_modal_text").innerHTML = option.text;
            }
            //fixme 事件监听的ie兼容性
            //关闭按钮的事件侦听
            $("#confirm_modal_element").find(".confirm-modal-button").off("click").on("click", function () {
                //fixme .off("click")用于防止多次触发<--很玄学，我也不知道为什么，但是请不要修改。
                var atr = $(this).attr("data-confirm");//选择的按钮
                bar++;
                if (option && atr in option && option[atr] instanceof Function) {
                    option[atr]();
                }
                if (option && "complete" in option && option.complete instanceof Function) {
                    option.complete();//若有完成函数，则执行
                } else {//否则，关闭选择框
                    show(false);
                }
                //阻止事件继续传递
                //return false;
            });
        };
        return {
            init: init
            , show: show
            , set: set
        }
    }());
    //覆盖层
    var cover = (function () {
        var init = function () {
            if (!document.getElementById("cover_modal_element")) {
                $('body').append('<div id="cover_modal_element" class="cover-modal-element dp-n"></div>');
            }
            return false;
        };
        var hide = function () {
            document.getElementById("cover_modal_element").style.display = "none";
        };
        var show = function () {
            document.getElementById("cover_modal_element").style.display = "block";
        };
        return {
            init: init
            , show: show
            , hide: hide
        }
    }());
    return {
        initLoading: loading.init
        , showLoading: loading.show

        , initAlert: alert.init
        , showAlert: alert.show
        , setAlert: alert.set

        , initConfirm: confirm.init
        , setConfirm: confirm.set
        , showConfirm: confirm.show
        , initCover: cover.init
    }
}());

//页面加载完毕后生成四个自定义模态框
setTimeout(function () {
    //页面加载时生成一个覆盖层
    Modal.initCover();
    //页面加载时生成一个加载信息框
    Modal.initLoading();
    //页面加载时生成一个弹出信息框
    Modal.initAlert();
    //页面加载时生成一个选择信息框
    Modal.initConfirm();
}, 100);


//抛出上层调用
exports.showLoading = Modal.showLoading;
exports.setAlert = Modal.setAlert;
exports.showAlert = Modal.showAlert;
exports.setConfirm = Modal.setConfirm;
exports.showConfirm = Modal.showConfirm;
},{}],4:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/22.
 */
"use strict";
var head = function () {
    //时间格式化
    Date.prototype.Format = function (fmt) { //author: Jeremyyy
        var o = {
            "M+": this.getMonth() + 1, //月份
            "d+": this.getDate(), //日
            "h+": this.getHours(), //小时
            "m+": this.getMinutes(), //分
            "s+": this.getSeconds(), //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    };
    //返回顶部
    $(document).on('click', '.back-top', function () {
        $("html,body").animate({scrollTop:0},100);
        return false;
    });
    $(document).on('mouseenter', '.vip-part', function () {
        $(this).children('.vip-select').stop(true);
        $(this).children('.vip-select').slideDown(100);
        return false;
    });
    $(document).on('mouseleave', '.vip-part', function () {
        $(this).children('.vip-select').stop(true);
        $(this).children('.vip-select').slideUp(100);
        return false;
    });
    $(document).on('mouseenter', '.wechat-logo', function () {
        $(this).children('.big-wechat').fadeIn(200);
        return false;
    });
    $(document).on('mouseleave', '.wechat-logo', function () {
        $(this).children('.big-wechat').fadeOut(200);
        return false;
    });
};
module.exports.head = head;
},{}],5:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/22.
 */
"use strict";
var listener = (function () {
    var run = function () {
        //头部点击事件
        require('./head').head();
    };
    return {
        run: run
    }
}());
module.exports = listener;
},{"./head":4}],6:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/24.
 */
"use strict";
var Data = (function () {
    var list = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/receive'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var update = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/receive/update'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var add = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/receive/add'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var del = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/receive/del'
            , type: 'post'
            , data: data
            , dataType: 'json'
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var up = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/down/ossUp'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var ossUpload = function (param, data, callback) {
        var _data = {};
        var formdata = new FormData();
        formdata.append("OSSAccessKeyId", param.AccessKeyId);
        formdata.append("policy", param.Policy);
        formdata.append("Signature", param.Signature);
        formdata.append("key", param.Keyname);
        formdata.append("Content-Disposition", "attachment;filename=\"" + data.name + "\"");
        formdata.append("file", data);
        $.ajax({
            url: param.UploadURL
            , data: formdata
            , processData: false
            , cache: false
            , async: false
            , contentType: false
            , type: 'post'
            , timeout: 100000
            , success: function () {
                _data = {
                    status: 1
                }
            }, error: function () {
                _data = {
                    status: -1
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var excelReader = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/receive/excelReader'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    var multiAdd = function (data, callback) {
        var _data = {};
        $.ajax({
            url: '/api/receive/multiAdd'
            , type: 'post'
            , dataType: 'json'
            , data: data
            , timeout: 100000
            , success: function (json) {
                if (json && "resCode" in json) {
                    _data = json;
                } else {
                    _data = {};
                }
            }, complete: function () {
                if (callback && callback instanceof Function) {
                    callback(_data);
                }
            }
        });
    };
    return {
        list: list
        , update: update
        , add: add
        , del: del
        , up: up
        , ossUpload: ossUpload
        , excelReader: excelReader
        , multiAdd: multiAdd
    }
}());
module.exports.Data = Data;
},{}],7:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/12/29.
 */
'use strict';
require('../frame/burster');
var Dom = (function () {
    var list = function (json, ele, param) {
        var str = '';
        if (json && 'resCode' in json && json.resCode == 0 && 'resBody' in json && json.resBody && 'sList' in json.resBody) {
            if (json.resBody.sList instanceof Array && json.resBody.sList.length > 0) {
                var body = json.resBody.sList;
                for (var b in body) {
                    if (body.hasOwnProperty(b)) {
                        str += render(body[b]);
                    }
                }
                $.burster($(".page-box"), param.offset || 0, json.resBody.totalCount, 5, param.limit || 10);
            } else {
                str = '<tr class="wrong-msg"><td colspan="7">暂无信息，新添加！</td></tr>';
                $('.page-box').html('');
            }
        } else {
            str = '<tr class="wrong-msg"><td colspan="7">获取列表失败，<a href="">请刷新重试</a>！</td></tr>';
            $('.page-box').html('');
        }
        ele.find('tbody').html(str);
        function render(d) {
            return '<tr> <td>' + (d.contactName || '-') + '</td> ' +
                '<td>' + (d.contactAddress || '-') + '</td> ' +
                '<td>' + (d.contactPerson || '-') + '</td> <td>' + (d.contactTel || '-') + '</td>' +
                ' <td> <a href="javascript:void(0);" class="show-detail" data-tp="receive" data-info="' +
                d.contactName + ',' + d.contactAddress + ',' + d.contactPerson + ',' + d.contactTel + ',' + d.contactEmail + ',' + d.contactFax + ',' + d.contactId
                + '">详情</a> ' +
                '<a href="javascript:void(0);" class="delete-btn" data-id="' + d.contactId + '">删除</a> </td> </tr>'
        }
    };
    return {
        list: list
    }
}());
module.exports.Dom = Dom;
},{"../frame/burster":1}],8:[function(require,module,exports){
/**
 * Created by Auser on 2016/12/2.
 */
"use strict";
require('../general').run();

require('./listener').run();
},{"../general":5,"./listener":9}],9:[function(require,module,exports){
/**
 * Created by Jeremy on 2016/11/22.
 */
"use strict";
var url = require('../frame/function').url;
var Modal = require('../frame/modal');
var Data = require('./data').Data
    , Dom = require('./dom').Dom;
var Listener = (function () {
    var listener = function () {
        $(document).on('click', '.search-btn', function () {
            url.set('offset', 0);
            init();
        });
        $(document).on('click', '.tb-c', function () {
            var ele = $('#' + $(this).data('tar'));
            url.set('offset', 0);
            url.set('tb', $(this).data('tar'));
            $(this).addClass('active');
            $(this).siblings().removeClass('active');
            ele.addClass('active');
            ele.siblings().removeClass('active');
            init();
        });
        $(document).on('click', '.delete-btn', function () {
            $('.white-back').removeClass('dp-n');
            $('.delete-part').removeClass('dp-n');
            $('#delete-ensure').data('id', $(this).data('id'));
        });
        $(document).on('click', '.close-btn', function () {
            $('.white-back').addClass('dp-n');
            $('.alert-part').addClass('dp-n');
            $('.ticket-modal').find('input').val('');
        });
        $(document).on('click', '.add', function () {
            $('.s-require').removeClass('warm');
            var ele = $('.ticket-modal');
            var str = $(this).data('nm') + '<span class="close-btn">X</span>';
            ele.find('.header').html(str);
            $('.white-back').removeClass('dp-n');
            ele.removeClass('dp-n');
            $('#submit').data('id', 0)
        });
        $(document).on('click', '.show-detail', function () {
            $('.s-require').removeClass('warm');
            var ele = $('.ticket-modal');
            var str = $(this).data('tp') == 'receive' ? '收货人详情' : '发货人详情';
            str += '<span class="close-btn">X</span>';
            ele.find('.header').html(str);
            var d = $(this).data('info').split(',');
            $('#name').val(d[0] || '-');
            $('#dz').val(d[1] || '-');
            $('#person').val(d[2] || '-');
            $('#dh').val(d[3] || '-');
            $('#mail').val(d[4] || '-');
            $('#cz').val(d[5] || '-');
            $('.white-back').removeClass('dp-n');
            ele.removeClass('dp-n');
            $('#submit').data('id', d[6]);
        });
        $(document).on('click', '#submit', function () {
            var tb = url.get('tb') || 'receive';
            var id = $(this).data('id');
            var pass = true;
            $('.s-require').each(function () {
                if ($(this).val()) {
                    $(this).removeClass('warm');
                } else {
                    $(this).addClass('warm');
                    pass = false;
                }
            });
            if (pass) {
                var data = {
                    "contactId": id == 0 ? null : id,
                    "contactType": tb == 'receive' ? 2 : 1,
                    "contactAlias": $('#mc').val(),
                    "contactName": $('#name').val(),
                    "contactAddress": $('#dz').val(),
                    "contactPerson": $('#person').val(),
                    "contactTel": $('#dh').val(),
                    "contactFax": $('#cz').val(),
                    "contactEmail": $('#mail').val(),
                    "contactState": 1,
                    "contactRemarks": '',
                    "createDt": new Date(),
                    "modifyDt": new Date()
                };
                if (id == 0) {//新增
                    Data.add(data, function (json) {
                        if (json && 'resCode' in json && json.resCode != 0) {
                            Modal.setAlert(json.resMsg);
                        } else {
                            Modal.setAlert(json.resMsg || '新增成功', null, function () {
                                location.reload();
                            });
                        }
                    })
                } else {//修改
                    Data.update(data, function (json) {
                        if (json && 'resCode' in json && json.resCode != 0) {
                            Modal.setAlert(json.resMsg);
                        } else {
                            Modal.setAlert(json.resMsg || '修改成功', null, function () {
                                location.reload();
                            });
                        }
                    });
                }
            }
        });
        $(document).on('click', '#delete-ensure', function () {
            Data.del({list: [$(this).data('id')]}, function (json) {
                if (json && 'resCode' in json && json.resCode != 0) {
                    Modal.setAlert(json.resMsg);
                } else {
                    Modal.setAlert(json.resMsg || '删除成功', null, function () {
                        location.reload();
                    });
                }
            });
        });
        $(document).on('click', '.pages', function () {
            url.set('offset', $(this).data('offset'));
            init();
        });
    };
    var init = function () {
        var tb = url.get('tb') || 'receive';
        var load = '<tr class="wrong-msg"><td colspan="9"><div class="loading-box"><div class="spinner"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div><div class="rect4"></div><div class="rect5"></div> </div></div></td></tr>';
        $('#' + tb).find('tbody').html(load);
        var data = {
            tp: tb == 'send' ? 1 : 2
            , key: tb == 'send' ? $('#s-name').val() : $('#r-name').val()
            , offset: url.get('offset') || 0
            , limit: 20
        };
        Data.list(data, function (json) {
            Dom.list(json, $('#' + tb), data);
        });
    };
    var excel = function () {
        var excelData = [];
        $(document).on('click', '.multi-add', function () {
            $('.white-back').removeClass('dp-n');
            $('.batch-part').removeClass('dp-n');
        });
        $(document).on('change', '#multi-btn', function () {
            var arr = ['xls', 'xlsx'];
            var file = this.files[0]
                , size = this.files[0].size
                , name = this.files[0].name;
            var na = name.split('.');
            if (arr.indexOf(na[na.length - 1]) >= 0) {
                if (size < 512000) {
                    Data.up({"file": name}, function (json) {
                        var token;
                        if (json && 'resCode' in json && json.resCode == 0) {
                            token = json.resBody;
                        }
                        if (token) {
                            Data.ossUpload(token, file, function (data) {
                                if (data && 'status' in data && data.status > 0) {
                                    Data.excelReader({file: token.Keyname}, function (excel) {
                                        if (excel && 'resBody' in excel && excel.resBody instanceof Array) {
                                            excelData = excel.resBody || [];
                                            $('.excel-name').html(name);
                                            $('.square').html('xls').addClass('excel-al');
                                        } else {
                                            Modal.setAlert(excel.resMsg || '读取失败，请重试！');
                                        }
                                    });
                                }
                            });
                        }
                    });
                } else {
                    Modal.setAlert('您上传的文件超过500K！请重新选择。');
                }
            } else {
                Modal.setAlert('文件格式支持.xls/.xlsx/');
            }
        });
        $(document).on('click', '#batch-ensure', function () {
            var data = {
                "contacts": excelData,
                "memberId": 0,
                "companyId": 0,
                "RequiresValidationContext": true,
                "ErrorMessage": "string",
                "ErrorMessageResourceName": "string",
                "ErrorMessageResourceType": "string",
                "TypeId": {}
            };
            Data.multiAdd(data, function (add) {
                if (add && 'resCode' in add && add.resCode == 0) {
                    Modal.setAlert('成功导入 ' + add.resBody.SuccessCount + ' 条记录。', null, function () {
                        location.reload();
                    });
                } else {
                    Modal.setAlert(add.resMsg || '保存失败，请重试！');
                }
            });
        });
    };
    var run = function () {
        listener();
        init();
        excel();
    };
    return {
        run: run
    }
}());
module.exports = Listener;
},{"../frame/function":2,"../frame/modal":3,"./data":6,"./dom":7}]},{},[8])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6L252bS92Ni4yLjAvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi4uL2ZyYW1lL2J1cnN0ZXIuanMiLCIuLi9mcmFtZS9mdW5jdGlvbi5qcyIsIi4uL2ZyYW1lL21vZGFsLmpzIiwiLi4vZ2VuZXJhbC9oZWFkLmpzIiwiLi4vZ2VuZXJhbC9pbmRleC5qcyIsImRhdGEuanMiLCJkb20uanMiLCJpbmRleC5qcyIsImxpc3RlbmVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcclxuICogQ3JlYXRlZCBieSBKZXJlbXkgb24gMjAxNi8xMS8yNC5cclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uICgkKSB7XHJcbiAgICAvKipcclxuICAgICAqIOeUn+aIkOWIhumhteWZqFxyXG4gICAgICogQHBhcmFtIGVsZSDpnIDopoHmt7vliqDliIbpobXlmajnmoTlhYPntKBcclxuICAgICAqIEBwYXJhbSBvZmZzZXQg5YGP56e76YeP77yM5Y2z5LuO56ysZGF0YS1vZmZzZXTlvIDlp4tcclxuICAgICAqIEBwYXJhbSBsZW5ndGgg5oC76K6w5b2V5p2h5pWwXHJcbiAgICAgKiBAcGFyYW0gc2hvd1BhZ2VzIOWIhumhteWZqOaYvuekuueahOmhteaVsO+8jOi2hei/h+WImemakOiXj+WkmuS9meeahOmhtVxyXG4gICAgICogQHBhcmFtIHJvd3Mg5q+P6aG15pi+56S655qE6K6w5b2V5p2h5pWwXHJcbiAgICAgKi9cclxuICAgICQuYnVyc3RlciA9IGZ1bmN0aW9uIChlbGUsIG9mZnNldCwgbGVuZ3RoLCBzaG93UGFnZXMsIHJvd3MpIHtcclxuICAgICAgICBvZmZzZXQgPSBvZmZzZXQgPyBwYXJzZUludChvZmZzZXQpIDogMDtcclxuICAgICAgICAvL+WwhuWIhumhteWZqOijheWFpXRhYmxl5LitXHJcbiAgICAgICAgaWYgKGxlbmd0aCAmJiBsZW5ndGggPiBvZmZzZXQpIHtcclxuICAgICAgICAgICAgdmFyIHBhZ2VIdG1sID0gXCJcIlxyXG4gICAgICAgICAgICAgICAgLCBhc3MgPSBcIlwiLy/muIXnqbrpnIDopoHoo4XlhaXnmoRodG1sXHJcbiAgICAgICAgICAgICAgICAsIGJlZm9yZVBhZ2VzID0gTWF0aC5jZWlsKG9mZnNldCAvIHJvd3MpLy/pnIDopoHmmL7npLrnmoTliY3pobXmlbAv5b2T5YmN6aG1XHJcbiAgICAgICAgICAgICAgICAsIGFmdGVyUGFnZXMgPSBNYXRoLmNlaWwoKGxlbmd0aCAtIG9mZnNldCApIC8gcm93cykvL+mcgOimgeaYvuekuueahOWQjumhteaVsFxyXG4gICAgICAgICAgICAgICAgLCBwYWdlcyA9IE1hdGguY2VpbChsZW5ndGggLyByb3dzKSAvL+aAu+mhteaVsFxyXG4gICAgICAgICAgICAgICAgLCBrID0gMDtcclxuICAgICAgICAgICAgLy9hbGVydChcIuaAu+mhteaVsFwiICsgcGFnZXMgKyBcIiDliY3pobXmlbAgXCIgKyBiZWZvcmVQYWdlcyArIFwiIOWQjumhteaVsCBcIiArIGFmdGVyUGFnZXMpO1xyXG4gICAgICAgICAgICAvL+iLpemhteaVsOWwj+S6jnNob3dQYWdlc+mhte+8jOWImeWFqOmDqOaYvuekulxyXG4gICAgICAgICAgICBpZiAocGFnZXMgPj0gMCAmJiBwYWdlcyA8PSBzaG93UGFnZXMpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBwYWdlczsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2VzID4gc2hvd1BhZ2VzKSB7Ly/mgLvpobXmlbDlpKfkuo5zaG93UGFnZXPpobVcclxuICAgICAgICAgICAgICAgIGlmIChiZWZvcmVQYWdlcyA8PSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgJiYgYWZ0ZXJQYWdlcyA+IHNob3dQYWdlcyArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgc2hvd1BhZ2VzOyBrKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoKHBhZ2VzIC0gMSkgKiByb3dzKSArIFwiJz4uLi5cIiArIHBhZ2VzICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPD0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICYmIGFmdGVyUGFnZXMgPT0gc2hvd1BhZ2VzICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBzaG93UGFnZXMgLSAxOyBrKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsgPT0gYmVmb3JlUGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpIGNsYXNzPSdhY3RpdmUnID48YT5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoayAqIHJvd3MpICsgXCInPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGk+PGEgY2xhc3M9J3BhZ2VzJyBkYXRhLW9mZnNldD0nXCIgKyAoKHBhZ2VzIC0gMSkgKiByb3dzKSArIFwiJz4uLi5cIiArIHBhZ2VzICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlUGFnZXMgPD0gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICYmIGFmdGVyUGFnZXMgPD0gc2hvd1BhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gMDsgayA8IHNob3dQYWdlcyAtIDE7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBiZWZvcmVQYWdlcyA8PSBzaG93UGFnZXMgJiYgYWZ0ZXJQYWdlcyA+IHNob3dQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9JzAnPjEuLi48L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGsgPSBiZWZvcmVQYWdlcyAtIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDE7IGsgPCBiZWZvcmVQYWdlcyArIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKTsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaSBjbGFzcz0nYWN0aXZlJyA+PGE+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZVBhZ2VzID4gc2hvd1BhZ2VzICYmIGFmdGVyUGFnZXMgPiBzaG93UGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgYmVmb3JlUGFnZXMgKyBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMik7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBiZWZvcmVQYWdlcyA8PSBwYWdlcyAmJiBhZnRlclBhZ2VzIDw9IHNob3dQYWdlcyAmJiBhZnRlclBhZ2VzID4gTWF0aC5jZWlsKHNob3dQYWdlcyAvIDIpICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9JzAnPjEuLi48L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGsgPSBiZWZvcmVQYWdlcyAtIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDE7IGsgPCBiZWZvcmVQYWdlcyArIE1hdGguY2VpbChzaG93UGFnZXMgLyAyKTsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrID09IGJlZm9yZVBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaSBjbGFzcz0nYWN0aXZlJyA+PGE+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKGsgKiByb3dzKSArIFwiJz5cIiArIChrICsgMSkgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VIdG1sICs9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZGF0YS1vZmZzZXQ9J1wiICsgKChwYWdlcyAtIDEpICogcm93cykgKyBcIic+Li4uXCIgKyBwYWdlcyArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZVBhZ2VzID4gcGFnZXMgJiYgYWZ0ZXJQYWdlcyA8PSBzaG93UGFnZXMgJiYgYWZ0ZXJQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgYmVmb3JlUGFnZXMgKyBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMik7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArICgocGFnZXMgLSAxKSAqIHJvd3MpICsgXCInPi4uLlwiICsgcGFnZXMgKyBcIjwvYT48L2xpPlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmVQYWdlcyA+IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSAmJiBhZnRlclBhZ2VzIDw9IE1hdGguY2VpbChzaG93UGFnZXMgLyAyKSArIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PScwJz4xLi4uPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gYmVmb3JlUGFnZXMgLSBNYXRoLmNlaWwoc2hvd1BhZ2VzIC8gMikgKyAxOyBrIDwgcGFnZXM7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA9PSBiZWZvcmVQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUh0bWwgKz0gXCI8bGkgY2xhc3M9J2FjdGl2ZScgPjxhPlwiICsgKGsgKyAxKSArIFwiPC9hPjwvbGk+XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlSHRtbCArPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGRhdGEtb2Zmc2V0PSdcIiArIChrICogcm93cykgKyBcIic+XCIgKyAoayArIDEpICsgXCI8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+WIpOaWrVwi6aaW6aG1XCLlkoxcIuacq+mhtVwi5piv5ZCm5Y+v54K55Ye7XHJcbiAgICAgICAgICAgIHZhciBmaXJzdFBhZ2UsIGxhc3RQYWdlO1xyXG4gICAgICAgICAgICBpZiAob2Zmc2V0ID09IDApIHsvL+atpOaXtummlumhteaXoOazleeCueWHu1xyXG4gICAgICAgICAgICAgICAgZmlyc3RQYWdlID0gJzxsaSBjbGFzcz1cImRpc2FibGVkXCI+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiMFwiPummlumhtTwvYT48L2xpPic7XHJcbiAgICAgICAgICAgICAgICBsYXN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiJyArIHBhcnNlSW50KHBhcnNlSW50KChsZW5ndGggJSByb3dzID09IDAgPyAobGVuZ3RoIC0gMSkgOiBsZW5ndGgpIC8gcm93cykgKiByb3dzKSArICdcIiA+5pyr6aG1PC9hPjwvbGk+JztcclxuICAgICAgICAgICAgfSBlbHNlIGlmICgob2Zmc2V0ICsgcm93cykgPj0gbGVuZ3RoKSB7Ly/mraTml7bmnKvpobXml6Dms5Xngrnlh7tcclxuICAgICAgICAgICAgICAgIGZpcnN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiMFwiPummlumhtTwvYT48L2xpPic7XHJcbiAgICAgICAgICAgICAgICBsYXN0UGFnZSA9ICc8bGkgY2xhc3M9XCJkaXNhYmxlZFwiPjxhIGNsYXNzPVwicGFnZXNcIiBkYXRhLW9mZnNldD1cIicgKyBwYXJzZUludChwYXJzZUludCgobGVuZ3RoICUgcm93cyA9PSAwID8gKGxlbmd0aCAtIDEpIDogbGVuZ3RoKSAvIHJvd3MpICogcm93cykgKyAnXCI+5pyr6aG1PC9hPjwvbGk+JztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiMFwiPummlumhtTwvYT48L2xpPic7XHJcbiAgICAgICAgICAgICAgICBsYXN0UGFnZSA9ICc8bGk+PGEgY2xhc3M9XCJwYWdlc1wiIGRhdGEtb2Zmc2V0PVwiJyArIHBhcnNlSW50KHBhcnNlSW50KChsZW5ndGggJSByb3dzID09IDAgPyAobGVuZ3RoIC0gMSkgOiBsZW5ndGgpIC8gcm93cykgKiByb3dzKSArICdcIj7mnKvpobU8L2E+PC9saT4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v5Yik5patXCLkuIrkuIDpobVcIuWSjFwi5LiL5LiA6aG1XCLmmK/lkKblrZjlnKhcclxuICAgICAgICAgICAgdmFyIHVwUGFnZSwgZG93blBhZ2U7XHJcbiAgICAgICAgICAgIGlmIChvZmZzZXQgPT0gMCB8fCAob2Zmc2V0IDwgcm93cyAmJiAob2Zmc2V0ICUgcm93cyAhPSAwKSkpIHtcclxuICAgICAgICAgICAgICAgIHVwUGFnZSA9IFwiPGxpIGNsYXNzPSdkaXNhYmxlZCc+PGEgY2xhc3M9J3BhZ2VzJyBmdW5jPSdwcmV2aW91cycgZGF0YS1vZmZzZXQ9J1wiICsgcGFyc2VJbnQob2Zmc2V0KSArIFwiJyA+5LiK6aG1PC9hPjwvbGk+XCJcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHVwUGFnZSA9IFwiPGxpPjxhIGNsYXNzPSdwYWdlcycgZnVuYz0ncHJldmlvdXMnIGRhdGEtb2Zmc2V0PSdcIiArIChwYXJzZUludChvZmZzZXQpIC0gcGFyc2VJbnQocm93cykpICsgXCInID7kuIrpobU8L2E+PC9saT5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob2Zmc2V0ID49IChsZW5ndGggLSByb3dzKSkge1xyXG4gICAgICAgICAgICAgICAgZG93blBhZ2UgPSBcIjxsaSBjbGFzcz0nZGlzYWJsZWQnPjxhIGNsYXNzPSdwYWdlcycgZnVuYz0nbmV4dCcgZGF0YS1vZmZzZXQ9J1wiICsgcGFyc2VJbnQob2Zmc2V0KSArIFwiJz7kuIvpobU8L2E+PC9saT5cIlxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZG93blBhZ2UgPSBcIjxsaT48YSBjbGFzcz0ncGFnZXMnIGZ1bmM9J25leHQnIGRhdGEtb2Zmc2V0PSdcIiArIHBhcnNlSW50KHBhcnNlSW50KG9mZnNldCkgKyBwYXJzZUludChyb3dzKSkgKyBcIic+5LiL6aG1PC9hPjwvbGk+XCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocGFnZXMgIT0gMSkge1xyXG4gICAgICAgICAgICAgICAgLy/liIbpobXpg6jliIZcclxuICAgICAgICAgICAgICAgIGFzcyArPSBcIjxkaXYgaWQ9J3BhZ2VyJyBjbGFzcz0ncGFnZXItaW5mbyc+XCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwiPGg2IGlkPSdyZXN1bHQnIGNsYXNzPSdwYWdlci1yZWNvcmQnPuWFseaciTxzcGFuPlwiICsgbGVuZ3RoICsgXCI8L3NwYW4+5p2h6K6w5b2VPC9oNj5cIiArXHJcbiAgICAgICAgICAgICAgICAgICAgXCI8dWwgY2xhc3M9J3BhZ2luYXRpb24nPlwiICsgZmlyc3RQYWdlICsgdXBQYWdlICsgcGFnZUh0bWwgKyBkb3duUGFnZSArIGxhc3RQYWdlICsgXCI8L3VsPjwvZGl2PlwiO1xyXG4gICAgICAgICAgICAgICAgLy90YWJsZeS4reazqOWFpeaLvOijheeahOiusOW9lVxyXG4gICAgICAgICAgICAgICAgZWxlLmh0bWwoYXNzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHsvL+aXoOazleWIhumhtea4heepuuWIhumhteWZqFxyXG4gICAgICAgICAgICAgICAgZWxlLmh0bWwoJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KGpRdWVyeSkpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplcmVteSBvbiAyMDE2LzIvMjYuXHJcbiAqIEB2ZXJzaW9uIDEuMC4wIGNyZWF0ZWQg6YCa55So5oCn5Yqf6IO95pa55rOVXHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxudmFyIEZ1biA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgX3RpbWVPdXQgPSAxMDAwMDA7Ly/or7fmsYLotoXml7bml7bpl7TkuLoxMHNcclxuICAgIC8qKlxyXG4gICAgICog5bCB6KOFYWpheFxyXG4gICAgICogQHBhcmFtIG9wdGlvblxyXG4gICAgICoge1xyXG4gICAgICogICAgICB1cmw6XCLor7fmsYLnmoTlnLDlnYBcIlxyXG4gICAgICogICAgICAsbWV0aG9kOlwi6K+35rGC55qE5pa55rOVXCJcclxuICAgICAqICAgICAgLGFzeW5jOlwi5piv5ZCm5bm25Y+RXCJcclxuICAgICAqICAgICAgLGRhdGE6XCLlj5HpgIHnmoTmlbDmja5cIlxyXG4gICAgICogICAgICAsc3VjY2VzczpcIuaIkOWKn+aXtuWbnuiwg1wiXHJcbiAgICAgKiAgICAgICxlcnJvcjpcIuWksei0pS/otoXml7bml7blm57osINcIlxyXG4gICAgICogICAgICAsdGltZW91dDpcIui2heaXtuaXtumXtFwiXHJcbiAgICAgKiAgICAgICxjb21wbGV0ZTpcIuWujOaIkOWQjueahOWbnuiwg1wiXHJcbiAgICAgKiB9XHJcbiAgICAgKi9cclxuICAgIHZhciBhamF4ID0gZnVuY3Rpb24gKG9wdGlvbikge1xyXG4gICAgICAgIC8vYWpheOW8gOWni+aXtuW6lOaYvuekuuKAnOWKoOi9veS/oeaBr+ahhuKAnVxyXG4gICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBvcHRpb24udXJsXHJcbiAgICAgICAgICAgICwgdHlwZTogXCJ0eXBlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi50eXBlIHx8IFwiR0VUXCJcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiBvcHRpb24udGltZW91dCB8fCBfdGltZU91dFxyXG4gICAgICAgICAgICAsIGRhdGE6IFwiZGF0YVwiIGluIG9wdGlvbiAmJiBvcHRpb24uZGF0YSB8fCB7fVxyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgICAgICAsIGFzeW5jOiAoXCJhc3luY1wiIGluIG9wdGlvbiAmJiBvcHRpb24uYXN5bmMpID8gdHJ1ZSA6IGZhbHNlXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChcInN0YXR1c1wiIGluIGpzb24gJiYganNvbi5zdGF0dXMgPiAwICYmIFwiZGF0YVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJzdWNjZXNzXCIgaW4gb3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbi5zdWNjZXNzKGpzb24uZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoXCLml6BzdWNjZXNz5pa55rOVIVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiZXJyb3JcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmVycm9yIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uZXJyb3IoanNvbik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmk43kvZzlpLHotKUhJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGVycm9yOiBmdW5jdGlvbiAoeGhyKSB7Ly80MDTmiJbogIXotoXml7ZcclxuICAgICAgICAgICAgICAgIGlmIChcImVycm9yXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5lcnJvciBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/mj5DnpLrnlKjmiLfplJnor6/kv6Hmga9cclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoXCLov57mjqXmnI3liqHlmajlpLHotKXvvIznirbmgIHvvJpcIiArICh4aHIuc3RhdHVzIHx8IC0xKSArIFwiLOS/oeaBr++8mlwiICsgKHhoci5zdGF0dXNUZXh0IHx8IFwiLVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmVycm9yKHhoci5zdGF0dXMsIHhoci5zdGF0dXNUZXh0KTsvL+Wbnuiwg+ivt+axgueahOeKtuaAgeWSjOmUmeivr+S/oeaBr1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKHhociwgdHlwZSkge1xyXG4gICAgICAgICAgICAgICAgLy/lhbPpl63igJzliqDovb3kv6Hmga/moYbigJ1cclxuICAgICAgICAgICAgICAgIE1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChcImNvbXBsZXRlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5jb21wbGV0ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmNvbXBsZXRlKHhociwgdHlwZSk7Ly/lm57osIPor7fmsYLnmoR4aHLkv6Hmga/lkoznsbvlnotcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8v5YWo6YCJ5ZKM5Y2V6YCJ55qE57uR5a6aXHJcbiAgICB2YXIgc2V0Q2hlY2tib3hMaXN0ZW5lciA9IGZ1bmN0aW9uIChhbGxDaGVjaywgcmFkaW9DaGVja3MpIHtcclxuICAgICAgICAvL+etm+mAieWNlemAieaMiemSrue7hFxyXG4gICAgICAgIHZhciByYWRpb1ZhbHVlRWxlcyA9ICQocmFkaW9DaGVja3MpO1xyXG4gICAgICAgIC8v54K55Ye75YWo6YCJ5pe277yM5ZCM57uE5oyJ6ZKu6KKr5ZCM5q2lXHJcbiAgICAgICAgJChkb2N1bWVudCkuZGVsZWdhdGUoYWxsQ2hlY2ssIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAocmFkaW9WYWx1ZUVsZXMgJiYgcmFkaW9WYWx1ZUVsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX3IgPSAwOyBfciA8IHJhZGlvVmFsdWVFbGVzLmxlbmd0aDsgX3IrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJhZGlvVmFsdWVFbGVzW19yXS5jaGVja2VkID0gJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/ngrnlh7vljZXpgInmjInpkq7ml7bvvIxcclxuICAgICAgICAkKGRvY3VtZW50KS5kZWxlZ2F0ZShyYWRpb0NoZWNrcywgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoYWxsQ2hlY2spWzBdLmNoZWNrZWQgPSAkKHJhZGlvQ2hlY2tzICsgXCI6Y2hlY2tlZFwiKS5sZW5ndGggPT0gJChyYWRpb0NoZWNrcykubGVuZ3RoO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB1cmwgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBnZXQgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChcIihefCYpXCIgKyBuYW1lICsgXCI9KFteJl0qKSgmfCQpXCIsIFwiaVwiKTtcclxuICAgICAgICAgICAgdmFyIHIgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxKS5tYXRjaChyZWcpO1xyXG4gICAgICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gZGVjb2RlVVJJKHJbMl0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOagueaNruWPguaVsOWIl+ihqOmVv+W6pui/m+ihjOWIpOaWre+8jOWFvOWuuUlFOVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ29iamVjdCcpIHsvL+S4gOS4quWvueixoe+8jOS9v+eUqGtleeagh+iusHZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gYXJndW1lbnRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgLCBzZWFyY2ggPSBsb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBvIGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkobykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoID0gY2hhbmdlVVJMS2V5VmFsdWUoc2VhcmNoLCBvLCBvYmpbb10pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgncHVzaFN0YXRlJyBpbiBoaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgZG9jdW1lbnQudGl0bGUsIHNlYXJjaCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCdwdXNoU3RhdGUnIGluIEhpc3RvcnkpIHsvL2llOSDkuI3mlK/mjIFwdXNoU3RhdGXmlrnms5UsamF2YXNjcmlwdC5lanPkuK3mt7vliqBoaXN0b3J5Lmpz5a6M5oiQaHRtbDTlr7lwdXNoU3RhdGXnmoTmlK/mjIFcclxuICAgICAgICAgICAgICAgICAgICBIaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBzZWFyY2gpOy8v6L+U5Zue6YeN5paw5p6E6YCg5ZCOc2VhcmNo5LiyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgey8va2V5K3ZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gYXJndW1lbnRzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgLCB2YWx1ZSA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgICAgICAgIGlmICgncHVzaFN0YXRlJyBpbiBoaXN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgZG9jdW1lbnQudGl0bGUsIGNoYW5nZVVSTEtleVZhbHVlKGxvY2F0aW9uLnRvU3RyaW5nKCksIGtleSwgdmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJ3B1c2hTdGF0ZScgaW4gSGlzdG9yeSkgey8vaWU5IOS4jeaUr+aMgXB1c2hTdGF0ZeaWueazlSxqYXZhc2NyaXB0LmVqc+S4rea3u+WKoGhpc3RvcnkuanPlrozmiJBodG1sNOWvuXB1c2hTdGF0ZeeahOaUr+aMgVxyXG4gICAgICAgICAgICAgICAgICAgIEhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIGNoYW5nZVVSTEtleVZhbHVlKGxvY2F0aW9uLnNlYXJjaCwga2V5LCB2YWx1ZSkpOy8v6L+U5Zue6YeN5paw5p6E6YCg5ZCOc2VhcmNo5LiyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gY2hhbmdlVVJMS2V5VmFsdWUodXJsLCBhcmcsIGFyZ192YWwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gYXJnICsgJz0oW14mXSopJztcclxuICAgICAgICAgICAgICAgIHZhciByZXBsYWNlVGV4dCA9IGFyZyArICc9JyArIGFyZ192YWw7XHJcbiAgICAgICAgICAgICAgICBpZiAodXJsLm1hdGNoKHBhdHRlcm4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9ICcvKCcgKyBhcmcgKyAnPSkoW14mXSopL2dpJztcclxuICAgICAgICAgICAgICAgICAgICB0bXAgPSB1cmwucmVwbGFjZShldmFsKHRtcCksIHJlcGxhY2VUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG1wO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodXJsLm1hdGNoKCdbXFw/XScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwgKyAnJicgKyByZXBsYWNlVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJsICsgJz8nICsgcmVwbGFjZVRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXQ6IGdldFxyXG4gICAgICAgICAgICAsIHNldDogc2V0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIHZhciBmb3JtYXRJbWFnZT1mdW5jdGlvbiAocGF0aCwgc2l6ZSwgZWxlKSB7XHJcbiAgICAgICAgaWYocGF0aCBpbnN0YW5jZW9mICBBcnJheSAmJiBwYXRoLmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgcGF0aCA9IHBhdGhbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBJTUFHRV9TSVpFID0ge1xyXG4gICAgICAgICAgICBvcmlnaW5hbDoge1xyXG4gICAgICAgICAgICAgICAgcGF0aDogXCJcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgeGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl94bGFyZ2VcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiNjYwKjY2MFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhcmdlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9sYXJnZVwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI0MjAqNDIwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWlkZGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWRkbGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMzAwKjMwMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNtYWxsOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9zbWFsbFwiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCIyNDAqMjQwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGl0dGxlOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9saXR0bGVcIixcclxuICAgICAgICAgICAgICAgIHNpemU6IFwiMTIwKjEyMFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1pY3JvOiB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcIl9taWNyb1wiLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogXCI2MCo2MFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHNpemUgPSBJTUFHRV9TSVpFW3NpemUgfHwgXCJtaWRkbGVcIl0gfHwgSU1BR0VfU0laRS5taWRkbGU7XHJcbiAgICAgICAgdmFyIHBhdGhUZW1wID0gL1xcLlxcdys/JC8uZXhlYyhwYXRoKTtcclxuICAgICAgICBpZiAoIXBhdGhUZW1wKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gc2l6ZS5wYXRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhdGggPSAocGF0aC5zdWJzdHIoMCwgcGF0aFRlbXAuaW5kZXggfHwgcGF0aC5sZW5ndGgpKSArIHNpemUucGF0aCArIHBhdGhUZW1wWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZWxlICYmIGVsZS5hdHRyKSB7XHJcbiAgICAgICAgICAgIGVsZS5hdHRyKFwic3JjXCIsIHBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGFqYXg6IGFqYXhcclxuICAgICAgICAsIGdldFRpbXRvdXQ6IF90aW1lT3V0XHJcbiAgICAgICAgLCBzZXRDaGVja2JveExpc3RlbmVyOiBzZXRDaGVja2JveExpc3RlbmVyXHJcbiAgICAgICAgLCB1cmw6IHVybFxyXG4gICAgICAgICwgZm9ybWF0SW1hZ2U6IGZvcm1hdEltYWdlXHJcbiAgICB9XHJcbn0oKSk7XHJcblxyXG5leHBvcnRzLmFqYXggPSBGdW4uYWpheDtcclxuZXhwb3J0cy5nZXRUaW1lb3V0ID0gRnVuLmdldFRpbXRvdXQ7XHJcbmV4cG9ydHMuc2V0Q2hlY2tib3hMaXN0ZW5lciA9IEZ1bi5zZXRDaGVja2JveExpc3RlbmVyO1xyXG5leHBvcnRzLnVybCA9IEZ1bi51cmw7XHJcbmV4cG9ydHMuZm9ybWF0SW1hZ2UgPSBGdW4uZm9ybWF0SW1hZ2U7XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplcmVteSBvbiAyMDE2LzIvMjQuXHJcbiAqIEB2ZXJzaW9uIDEuMC4wIGNyZWF0ZWRcclxuICovXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG4vL+aehOmAoOS/oeaBr+ahhuS4u+S9k1xyXG52YXIgTW9kYWwgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgLy/mnoTpgKDljp/lp4vnsbtcclxuICAgIGZ1bmN0aW9uIE0obSkge1xyXG4gICAgICAgIHRoaXMucyA9IG0uczsvL+aYr+WQpuaYvuekulxyXG4gICAgICAgIHRoaXMuaWQgPSBtLmlkO1xyXG4gICAgfVxyXG5cclxuICAgIC8v5p6E6YCg5qCH5YeGc2hvd+aWueazle+8jOeUqOS6jue7p+aJv1xyXG4gICAgTS5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pZCk7XHJcbiAgICAgICAgaWYgKGVsZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zICYmICFpc1Nob3coKSkgey8v5pi+56S65b2T5YmN6ZqQ6JePXHJcbiAgICAgICAgICAgICAgICBlbGUuY2xhc3NOYW1lID0gZWxlLmNsYXNzTmFtZS5yZXBsYWNlKFwiZHAtblwiLCBcIlwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5zICYmIGlzU2hvdygpKSB7Ly/pmpDol4/lvZPliY3mmL7npLpcclxuICAgICAgICAgICAgICAgIGVsZS5jbGFzc05hbWUgKz0gXCIgZHAtblwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v5Y676Zmk5Lik6L6555qE56m65qC8XHJcbiAgICAgICAgICAgIGVsZS5jbGFzc05hbWUgPSBTdHJpbmcoZWxlLmNsYXNzTmFtZSkudHJpbSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBpc1Nob3coKSB7Ly/mmK/lkKblt7LmmL7npLrvvIzml6BjbGFzc+aXtuaYvuekulxyXG4gICAgICAgICAgICByZXR1cm4gZWxlLmNsYXNzTmFtZS5zcGxpdChcImRwLW5cIikubGVuZ3RoID09IDE7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvL+WKoOi9veS/oeaBr+ahhlxyXG4gICAgdmFyIGxvYWRpbmcgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8v5Yid5aeL5YyW55Sf5oiQ5Yqg6L295L+h5oGv5qGGXHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2FkaW5nX21vZGFsX2VsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJsb2FkaW5nX21vZGFsX2VsZW1lbnRcIiBjbGFzcz1cImxvYWRpbmctbW9kYWwtYm9keSBkcC1uXCI+PGRpdiBjbGFzcz1cImNvdmVyX21vZGFsX2VsZW1lbnRcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImxvYWRpbmctbW9kYWwtaW1hZ2VcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImxvYWRpbmctbW9kYWwtdGV4dFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8aDI+546p5ZG95Yqg6L295Lit4oCm4oCmPC9oMj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy/mmL7npLrjgIHpmpDol4/kv6Hmga/moYZcclxuICAgICAgICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgIHMgPSB0eXBlb2YgcyA9PSBcInVuZGVmaW5lZFwiID8gdHJ1ZSA6IHM7Ly/ml6Dlj4LmlbDmmL7npLrkv6Hmga/moYZcclxuICAgICAgICAgICAgdmFyIG0gPSBuZXcgTSh7aWQ6IFwibG9hZGluZ19tb2RhbF9lbGVtZW50XCIsIHM6IHN9KTtcclxuICAgICAgICAgICAgbS5zaG93KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0XHJcbiAgICAgICAgICAgICwgc2hvdzogc2hvd1xyXG4gICAgICAgIH1cclxuICAgIH0oKSk7XHJcbiAgICAvL+W8ueWHuuS/oeaBr+ahhlxyXG4gICAgdmFyIGFsZXJ0ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFsZXJ0X21vZGFsX2VsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJhbGVydF9tb2RhbF9lbGVtZW50XCIgY2xhc3M9XCJhbGVydC1tb2RhbC1lbGVtZW50IGRwLW5cIj48ZGl2IGNsYXNzPVwiY292ZXJfbW9kYWxfZWxlbWVudFwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWxlcnQtbW9kYWwtY29udGVudFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWxlcnQtbW9kYWwtYm9keVwiPjxzcGFuIGNsYXNzPVwiYWxlcnQtbW9kYWwtdGV4dFwiPjwvc3Bhbj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFsZXJ0LW1vZGFsLWZvb3RlclwiPjxidXR0b24gaWQ9XCJhbGVydF9tb2RhbF9jbG9zZVwiIGNsYXNzPVwiYWxlcnQtbW9kYWwtYnV0dG9uXCI+5YWz6ZetPC9idXR0b24+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBzaG93ID0gZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgcyA9IHR5cGVvZiBzID09IFwidW5kZWZpbmVkXCIgPyB0cnVlIDogcztcclxuICAgICAgICAgICAgdmFyIG0gPSBuZXcgTSh7aWQ6IFwiYWxlcnRfbW9kYWxfZWxlbWVudFwiLCBzOiBzfSk7XHJcbiAgICAgICAgICAgIG0uc2hvdygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6K6+572u5by55Ye65L+h5oGv5qGGXHJcbiAgICAgICAgICogQHBhcmFtIG1zZyAgICAgICDmmL7npLrnmoTkv6Hmga/vvIzmlK/mjIFodG1sXHJcbiAgICAgICAgICogQHBhcmFtIHNlZCAgICAgICDlgJLorqHml7blhbPpl63ml7bpl7TvvIzljZXkvY3vvJpzZWNvbmRcclxuICAgICAgICAgKiBAcGFyYW0gY2FsbGJhY2sgIOWFs+mXreinpuWPkeWbnuiwg+WHveaVsFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBzZXQgPSBmdW5jdGlvbiAobXNnLCBzZWQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFsZXJ0X21vZGFsX2VsZW1lbnRcIik7XHJcbiAgICAgICAgICAgIGlmIChtc2cpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbXNnID09PSAnb2JqZWN0Jykgey8v5bqU5a+55ZCO56uv6L+U5Zue5o+Q56S65pe25L2/55SoT2JqZWN05bCB6KOFXHJcbiAgICAgICAgICAgICAgICAgICAgbXNnID0gSlNPTi5zdHJpbmdpZnkobXNnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKGVsZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJhbGVydC1tb2RhbC10ZXh0XCIpWzBdLmlubmVySFRNTCA9IG1zZztcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICBlbGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImFsZXJ0LW1vZGFsLXRleHRcIilbMF0uaW5uZXJIVE1MID0gbXNnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2hvdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzZWQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBzaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0sIDEwMDAgKiBzZWQpO1xyXG4gICAgICAgICAgICB9Ly/ml6DlhbPpl63ml7bpl7TmiJbogIXlhbPpl63ml7bpl7TkuLow77yM5LiN6Ieq5Yqo5YWz6ZetXHJcbiAgICAgICAgICAgIC8vZml4bWUg5LqL5Lu255uR5ZCs55qEaWXlhbzlrrnmgKdcclxuICAgICAgICAgICAgLy/lhbPpl63mjInpkq7nmoTkuovku7bkvqblkKxcclxuICAgICAgICAgICAgJChcIiNhbGVydF9tb2RhbF9jbG9zZVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgLy/pmLvmraLkuovku7bnu6fnu63kvKDpgJJcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0XHJcbiAgICAgICAgICAgICwgc2hvdzogc2hvd1xyXG4gICAgICAgICAgICAsIHNldDogc2V0XHJcbiAgICAgICAgfVxyXG4gICAgfSgpKTtcclxuICAgIC8v6YCJ5oup5L+h5oGv5qGGXHJcbiAgICB2YXIgY29uZmlybSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtX21vZGFsX2VsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgaWQ9XCJjb25maXJtX21vZGFsX2VsZW1lbnRcIiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtZWxlbWVudCBkcC1uXCI+PGRpdiBjbGFzcz1cImNvdmVyX21vZGFsX2VsZW1lbnRcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtY29udGVudFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPVwiY29uZmlybV9tb2RhbF9oZWFkZXJcIiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtaGVhZGVyIGRwLW5cIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtYm9keVwiPjxzcGFuIGlkPVwiY29uZmlybV9tb2RhbF90ZXh0XCIgY2xhc3M9XCJjb25maXJtLW1vZGFsLXRleHRcIj48L3NwYW4+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb25maXJtLW1vZGFsLWZvb3RlclwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZm9vdGVyLWJ1dHRvbi1zdWNjZXNzXCI+PGJ1dHRvbiBjbGFzcz1cImNvbmZpcm0tbW9kYWwtYnV0dG9uICBtb2RhbC1zdWNjZXNzXCIgZGF0YS1jb25maXJtPVwic3VjY2Vzc1wiPuehruiupDwvYnV0dG9uPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZm9vdGVyLWJ1dHRvbi1mYWxzZVwiPjxidXR0b24gY2xhc3M9XCJjb25maXJtLW1vZGFsLWJ1dHRvblwiIGRhdGEtY29uZmlybT1cImVycm9yXCI+5Y+W5raIPC9idXR0b24+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PjwvZGl2PicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBzaG93ID0gZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgcyA9IHR5cGVvZiBzID09IFwidW5kZWZpbmVkXCIgPyB0cnVlIDogcztcclxuICAgICAgICAgICAgdmFyIG0gPSBuZXcgTSh7aWQ6IFwiY29uZmlybV9tb2RhbF9lbGVtZW50XCIsIHM6IHN9KTtcclxuICAgICAgICAgICAgbS5zaG93KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDorr7nva7pgInmi6nkv6Hmga/moYbnmoTlhoXlrrlcclxuICAgICAgICAgKiBAcGFyYW0gb3B0aW9uICAgIOmFjee9rlxyXG4gICAgICAgICAqIHtcclxuICAgICAgICAgKiAgICAgIHRpdGxlOlwi5aS06YOo5pi+56S655qE5L+h5oGvXCJcclxuICAgICAgICAgKiAgICAgICx0ZXh0Olwi5pi+56S655qE5o+Q56S65L+h5oGvXCJcclxuICAgICAgICAgKiAgICAgICxzdWNjZXNzOlwi54K55Ye75oiQ5Yqf5ZCO55qE5Zue6LCDXCJcclxuICAgICAgICAgKiAgICAgICxlcnJvcjpcIueCueWHu+Wksei0peWQjueahOWbnuiwg1wiXHJcbiAgICAgICAgICogICAgICAsY29tcGxldGU6XCLngrnlh7vmjInpkq7lkI7nmoTmlbTkvZPlm57osINcIlxyXG4gICAgICAgICAqIH1cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgYmFyID0gMDtcclxuICAgICAgICB2YXIgc2V0ID0gZnVuY3Rpb24gKG9wdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoIW9wdGlvbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChcInRpdGxlXCIgaW4gb3B0aW9uICYmIG9wdGlvbi50aXRsZS5sZW5ndGggPiAwKSB7Ly/mnInlpLTpg6jvvIzliJnmmL7npLrlpLTpg6hcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29uZmlybV9tb2RhbF9oZWFkZXJcIikuaW5uZXJIVE1MID0gb3B0aW9uLnRpdGxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChcInRleHRcIiBpbiBvcHRpb24gJiYgb3B0aW9uLnRleHQubGVuZ3RoID4gMCkgey8v5pyJ5YaF5a6577yM5YiZ5pi+56S65pW05Liq6YCJ5oup5L+h5oGv5qGGXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1fbW9kYWxfdGV4dFwiKS5pbm5lckhUTUwgPSBvcHRpb24udGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2ZpeG1lIOS6i+S7tuebkeWQrOeahGll5YW85a655oCnXHJcbiAgICAgICAgICAgIC8v5YWz6Zet5oyJ6ZKu55qE5LqL5Lu25L6m5ZCsXHJcbiAgICAgICAgICAgICQoXCIjY29uZmlybV9tb2RhbF9lbGVtZW50XCIpLmZpbmQoXCIuY29uZmlybS1tb2RhbC1idXR0b25cIikub2ZmKFwiY2xpY2tcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvL2ZpeG1lIC5vZmYoXCJjbGlja1wiKeeUqOS6jumYsuatouWkmuasoeinpuWPkTwtLeW+iOeOhOWtpu+8jOaIkeS5n+S4jeefpemBk+S4uuS7gOS5iO+8jOS9huaYr+ivt+S4jeimgeS/ruaUueOAglxyXG4gICAgICAgICAgICAgICAgdmFyIGF0ciA9ICQodGhpcykuYXR0cihcImRhdGEtY29uZmlybVwiKTsvL+mAieaLqeeahOaMiemSrlxyXG4gICAgICAgICAgICAgICAgYmFyKys7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uICYmIGF0ciBpbiBvcHRpb24gJiYgb3B0aW9uW2F0cl0gaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvblthdHJdKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uICYmIFwiY29tcGxldGVcIiBpbiBvcHRpb24gJiYgb3B0aW9uLmNvbXBsZXRlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uY29tcGxldGUoKTsvL+iLpeacieWujOaIkOWHveaVsO+8jOWImeaJp+ihjFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsvL+WQpuWIme+8jOWFs+mXremAieaLqeahhlxyXG4gICAgICAgICAgICAgICAgICAgIHNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy/pmLvmraLkuovku7bnu6fnu63kvKDpgJJcclxuICAgICAgICAgICAgICAgIC8vcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXRcclxuICAgICAgICAgICAgLCBzaG93OiBzaG93XHJcbiAgICAgICAgICAgICwgc2V0OiBzZXRcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgLy/opobnm5blsYJcclxuICAgIHZhciBjb3ZlciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb3Zlcl9tb2RhbF9lbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwiY292ZXJfbW9kYWxfZWxlbWVudFwiIGNsYXNzPVwiY292ZXItbW9kYWwtZWxlbWVudCBkcC1uXCI+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY292ZXJfbW9kYWxfZWxlbWVudFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb3Zlcl9tb2RhbF9lbGVtZW50XCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0XHJcbiAgICAgICAgICAgICwgc2hvdzogc2hvd1xyXG4gICAgICAgICAgICAsIGhpZGU6IGhpZGVcclxuICAgICAgICB9XHJcbiAgICB9KCkpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpbml0TG9hZGluZzogbG9hZGluZy5pbml0XHJcbiAgICAgICAgLCBzaG93TG9hZGluZzogbG9hZGluZy5zaG93XHJcblxyXG4gICAgICAgICwgaW5pdEFsZXJ0OiBhbGVydC5pbml0XHJcbiAgICAgICAgLCBzaG93QWxlcnQ6IGFsZXJ0LnNob3dcclxuICAgICAgICAsIHNldEFsZXJ0OiBhbGVydC5zZXRcclxuXHJcbiAgICAgICAgLCBpbml0Q29uZmlybTogY29uZmlybS5pbml0XHJcbiAgICAgICAgLCBzZXRDb25maXJtOiBjb25maXJtLnNldFxyXG4gICAgICAgICwgc2hvd0NvbmZpcm06IGNvbmZpcm0uc2hvd1xyXG4gICAgICAgICwgaW5pdENvdmVyOiBjb3Zlci5pbml0XHJcbiAgICB9XHJcbn0oKSk7XHJcblxyXG4vL+mhtemdouWKoOi9veWujOavleWQjueUn+aIkOWbm+S4quiHquWumuS5ieaooeaAgeahhlxyXG5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgIC8v6aG16Z2i5Yqg6L295pe255Sf5oiQ5LiA5Liq6KaG55uW5bGCXHJcbiAgICBNb2RhbC5pbml0Q292ZXIoKTtcclxuICAgIC8v6aG16Z2i5Yqg6L295pe255Sf5oiQ5LiA5Liq5Yqg6L295L+h5oGv5qGGXHJcbiAgICBNb2RhbC5pbml0TG9hZGluZygpO1xyXG4gICAgLy/pobXpnaLliqDovb3ml7bnlJ/miJDkuIDkuKrlvLnlh7rkv6Hmga/moYZcclxuICAgIE1vZGFsLmluaXRBbGVydCgpO1xyXG4gICAgLy/pobXpnaLliqDovb3ml7bnlJ/miJDkuIDkuKrpgInmi6nkv6Hmga/moYZcclxuICAgIE1vZGFsLmluaXRDb25maXJtKCk7XHJcbn0sIDEwMCk7XHJcblxyXG5cclxuLy/mipvlh7rkuIrlsYLosIPnlKhcclxuZXhwb3J0cy5zaG93TG9hZGluZyA9IE1vZGFsLnNob3dMb2FkaW5nO1xyXG5leHBvcnRzLnNldEFsZXJ0ID0gTW9kYWwuc2V0QWxlcnQ7XHJcbmV4cG9ydHMuc2hvd0FsZXJ0ID0gTW9kYWwuc2hvd0FsZXJ0O1xyXG5leHBvcnRzLnNldENvbmZpcm0gPSBNb2RhbC5zZXRDb25maXJtO1xyXG5leHBvcnRzLnNob3dDb25maXJtID0gTW9kYWwuc2hvd0NvbmZpcm07IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSmVyZW15IG9uIDIwMTYvMTEvMjIuXHJcbiAqL1xyXG5cInVzZSBzdHJpY3RcIjtcclxudmFyIGhlYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvL+aXtumXtOagvOW8j+WMllxyXG4gICAgRGF0ZS5wcm90b3R5cGUuRm9ybWF0ID0gZnVuY3Rpb24gKGZtdCkgeyAvL2F1dGhvcjogSmVyZW15eXlcclxuICAgICAgICB2YXIgbyA9IHtcclxuICAgICAgICAgICAgXCJNK1wiOiB0aGlzLmdldE1vbnRoKCkgKyAxLCAvL+aciOS7vVxyXG4gICAgICAgICAgICBcImQrXCI6IHRoaXMuZ2V0RGF0ZSgpLCAvL+aXpVxyXG4gICAgICAgICAgICBcImgrXCI6IHRoaXMuZ2V0SG91cnMoKSwgLy/lsI/ml7ZcclxuICAgICAgICAgICAgXCJtK1wiOiB0aGlzLmdldE1pbnV0ZXMoKSwgLy/liIZcclxuICAgICAgICAgICAgXCJzK1wiOiB0aGlzLmdldFNlY29uZHMoKSwgLy/np5JcclxuICAgICAgICAgICAgXCJxK1wiOiBNYXRoLmZsb29yKCh0aGlzLmdldE1vbnRoKCkgKyAzKSAvIDMpLCAvL+Wto+W6plxyXG4gICAgICAgICAgICBcIlNcIjogdGhpcy5nZXRNaWxsaXNlY29uZHMoKSAvL+avq+enklxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKC8oeSspLy50ZXN0KGZtdCkpIGZtdCA9IGZtdC5yZXBsYWNlKFJlZ0V4cC4kMSwgKHRoaXMuZ2V0RnVsbFllYXIoKSArIFwiXCIpLnN1YnN0cig0IC0gUmVnRXhwLiQxLmxlbmd0aCkpO1xyXG4gICAgICAgIGZvciAodmFyIGsgaW4gbylcclxuICAgICAgICAgICAgaWYgKG5ldyBSZWdFeHAoXCIoXCIgKyBrICsgXCIpXCIpLnRlc3QoZm10KSkgZm10ID0gZm10LnJlcGxhY2UoUmVnRXhwLiQxLCAoUmVnRXhwLiQxLmxlbmd0aCA9PSAxKSA/IChvW2tdKSA6ICgoXCIwMFwiICsgb1trXSkuc3Vic3RyKChcIlwiICsgb1trXSkubGVuZ3RoKSkpO1xyXG4gICAgICAgIHJldHVybiBmbXQ7XHJcbiAgICB9O1xyXG4gICAgLy/ov5Tlm57pobbpg6hcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuYmFjay10b3AnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJChcImh0bWwsYm9keVwiKS5hbmltYXRlKHtzY3JvbGxUb3A6MH0sMTAwKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWVudGVyJywgJy52aXAtcGFydCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCcudmlwLXNlbGVjdCcpLnN0b3AodHJ1ZSk7XHJcbiAgICAgICAgJCh0aGlzKS5jaGlsZHJlbignLnZpcC1zZWxlY3QnKS5zbGlkZURvd24oMTAwKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWxlYXZlJywgJy52aXAtcGFydCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCcudmlwLXNlbGVjdCcpLnN0b3AodHJ1ZSk7XHJcbiAgICAgICAgJCh0aGlzKS5jaGlsZHJlbignLnZpcC1zZWxlY3QnKS5zbGlkZVVwKDEwMCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcbiAgICAkKGRvY3VtZW50KS5vbignbW91c2VlbnRlcicsICcud2VjaGF0LWxvZ28nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJCh0aGlzKS5jaGlsZHJlbignLmJpZy13ZWNoYXQnKS5mYWRlSW4oMjAwKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWxlYXZlJywgJy53ZWNoYXQtbG9nbycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCcuYmlnLXdlY2hhdCcpLmZhZGVPdXQoMjAwKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxufTtcclxubW9kdWxlLmV4cG9ydHMuaGVhZCA9IGhlYWQ7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSmVyZW15IG9uIDIwMTYvMTEvMjIuXHJcbiAqL1xyXG5cInVzZSBzdHJpY3RcIjtcclxudmFyIGxpc3RlbmVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy/lpLTpg6jngrnlh7vkuovku7ZcclxuICAgICAgICByZXF1aXJlKCcuL2hlYWQnKS5oZWFkKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBydW46IHJ1blxyXG4gICAgfVxyXG59KCkpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IGxpc3RlbmVyOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEplcmVteSBvbiAyMDE2LzExLzI0LlxyXG4gKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBEYXRhID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBsaXN0ID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9yZWNlaXZlJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3JlY2VpdmUvdXBkYXRlJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBhZGQgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3JlY2VpdmUvYWRkJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBkZWwgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3JlY2VpdmUvZGVsJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciB1cCA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvZG93bi9vc3NVcCdcclxuICAgICAgICAgICAgLCB0eXBlOiAncG9zdCdcclxuICAgICAgICAgICAgLCBkYXRhVHlwZTogJ2pzb24nXHJcbiAgICAgICAgICAgICwgZGF0YTogZGF0YVxyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBcInJlc0NvZGVcIiBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSBqc29uO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgb3NzVXBsb2FkID0gZnVuY3Rpb24gKHBhcmFtLCBkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfZGF0YSA9IHt9O1xyXG4gICAgICAgIHZhciBmb3JtZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgIGZvcm1kYXRhLmFwcGVuZChcIk9TU0FjY2Vzc0tleUlkXCIsIHBhcmFtLkFjY2Vzc0tleUlkKTtcclxuICAgICAgICBmb3JtZGF0YS5hcHBlbmQoXCJwb2xpY3lcIiwgcGFyYW0uUG9saWN5KTtcclxuICAgICAgICBmb3JtZGF0YS5hcHBlbmQoXCJTaWduYXR1cmVcIiwgcGFyYW0uU2lnbmF0dXJlKTtcclxuICAgICAgICBmb3JtZGF0YS5hcHBlbmQoXCJrZXlcIiwgcGFyYW0uS2V5bmFtZSk7XHJcbiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKFwiQ29udGVudC1EaXNwb3NpdGlvblwiLCBcImF0dGFjaG1lbnQ7ZmlsZW5hbWU9XFxcIlwiICsgZGF0YS5uYW1lICsgXCJcXFwiXCIpO1xyXG4gICAgICAgIGZvcm1kYXRhLmFwcGVuZChcImZpbGVcIiwgZGF0YSk7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBwYXJhbS5VcGxvYWRVUkxcclxuICAgICAgICAgICAgLCBkYXRhOiBmb3JtZGF0YVxyXG4gICAgICAgICAgICAsIHByb2Nlc3NEYXRhOiBmYWxzZVxyXG4gICAgICAgICAgICAsIGNhY2hlOiBmYWxzZVxyXG4gICAgICAgICAgICAsIGFzeW5jOiBmYWxzZVxyXG4gICAgICAgICAgICAsIGNvbnRlbnRUeXBlOiBmYWxzZVxyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIHRpbWVvdXQ6IDEwMDAwMFxyXG4gICAgICAgICAgICAsIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF9kYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogMVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBlcnJvcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAtMVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgZXhjZWxSZWFkZXIgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX2RhdGEgPSB7fTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3JlY2VpdmUvZXhjZWxSZWFkZXInXHJcbiAgICAgICAgICAgICwgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgICAgICwgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgICAgICAgICAsIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgLCB0aW1lb3V0OiAxMDAwMDBcclxuICAgICAgICAgICAgLCBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGpzb24gJiYgXCJyZXNDb2RlXCIgaW4ganNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ganNvbjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAmJiBjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soX2RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIG11bHRpQWRkID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF9kYXRhID0ge307XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9yZWNlaXZlL211bHRpQWRkJ1xyXG4gICAgICAgICAgICAsIHR5cGU6ICdwb3N0J1xyXG4gICAgICAgICAgICAsIGRhdGFUeXBlOiAnanNvbidcclxuICAgICAgICAgICAgLCBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICwgdGltZW91dDogMTAwMDAwXHJcbiAgICAgICAgICAgICwgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChqc29uICYmIFwicmVzQ29kZVwiIGluIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBfZGF0YSA9IGpzb247XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9kYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKF9kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbGlzdDogbGlzdFxyXG4gICAgICAgICwgdXBkYXRlOiB1cGRhdGVcclxuICAgICAgICAsIGFkZDogYWRkXHJcbiAgICAgICAgLCBkZWw6IGRlbFxyXG4gICAgICAgICwgdXA6IHVwXHJcbiAgICAgICAgLCBvc3NVcGxvYWQ6IG9zc1VwbG9hZFxyXG4gICAgICAgICwgZXhjZWxSZWFkZXI6IGV4Y2VsUmVhZGVyXHJcbiAgICAgICAgLCBtdWx0aUFkZDogbXVsdGlBZGRcclxuICAgIH1cclxufSgpKTtcclxubW9kdWxlLmV4cG9ydHMuRGF0YSA9IERhdGE7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSmVyZW15IG9uIDIwMTYvMTIvMjkuXHJcbiAqL1xyXG4ndXNlIHN0cmljdCc7XHJcbnJlcXVpcmUoJy4uL2ZyYW1lL2J1cnN0ZXInKTtcclxudmFyIERvbSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbGlzdCA9IGZ1bmN0aW9uIChqc29uLCBlbGUsIHBhcmFtKSB7XHJcbiAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgIGlmIChqc29uICYmICdyZXNDb2RlJyBpbiBqc29uICYmIGpzb24ucmVzQ29kZSA9PSAwICYmICdyZXNCb2R5JyBpbiBqc29uICYmIGpzb24ucmVzQm9keSAmJiAnc0xpc3QnIGluIGpzb24ucmVzQm9keSkge1xyXG4gICAgICAgICAgICBpZiAoanNvbi5yZXNCb2R5LnNMaXN0IGluc3RhbmNlb2YgQXJyYXkgJiYganNvbi5yZXNCb2R5LnNMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBib2R5ID0ganNvbi5yZXNCb2R5LnNMaXN0O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiBib2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvZHkuaGFzT3duUHJvcGVydHkoYikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IHJlbmRlcihib2R5W2JdKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkLmJ1cnN0ZXIoJChcIi5wYWdlLWJveFwiKSwgcGFyYW0ub2Zmc2V0IHx8IDAsIGpzb24ucmVzQm9keS50b3RhbENvdW50LCA1LCBwYXJhbS5saW1pdCB8fCAxMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzdHIgPSAnPHRyIGNsYXNzPVwid3JvbmctbXNnXCI+PHRkIGNvbHNwYW49XCI3XCI+5pqC5peg5L+h5oGv77yM5paw5re75Yqg77yBPC90ZD48L3RyPic7XHJcbiAgICAgICAgICAgICAgICAkKCcucGFnZS1ib3gnKS5odG1sKCcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHN0ciA9ICc8dHIgY2xhc3M9XCJ3cm9uZy1tc2dcIj48dGQgY29sc3Bhbj1cIjdcIj7ojrflj5bliJfooajlpLHotKXvvIw8YSBocmVmPVwiXCI+6K+35Yi35paw6YeN6K+VPC9hPu+8gTwvdGQ+PC90cj4nO1xyXG4gICAgICAgICAgICAkKCcucGFnZS1ib3gnKS5odG1sKCcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxlLmZpbmQoJ3Rib2R5JykuaHRtbChzdHIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIHJlbmRlcihkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnPHRyPiA8dGQ+JyArIChkLmNvbnRhY3ROYW1lIHx8ICctJykgKyAnPC90ZD4gJyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyAoZC5jb250YWN0QWRkcmVzcyB8fCAnLScpICsgJzwvdGQ+ICcgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD4nICsgKGQuY29udGFjdFBlcnNvbiB8fCAnLScpICsgJzwvdGQ+IDx0ZD4nICsgKGQuY29udGFjdFRlbCB8fCAnLScpICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnIDx0ZD4gPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiBjbGFzcz1cInNob3ctZGV0YWlsXCIgZGF0YS10cD1cInJlY2VpdmVcIiBkYXRhLWluZm89XCInICtcclxuICAgICAgICAgICAgICAgIGQuY29udGFjdE5hbWUgKyAnLCcgKyBkLmNvbnRhY3RBZGRyZXNzICsgJywnICsgZC5jb250YWN0UGVyc29uICsgJywnICsgZC5jb250YWN0VGVsICsgJywnICsgZC5jb250YWN0RW1haWwgKyAnLCcgKyBkLmNvbnRhY3RGYXggKyAnLCcgKyBkLmNvbnRhY3RJZFxyXG4gICAgICAgICAgICAgICAgKyAnXCI+6K+m5oOFPC9hPiAnICtcclxuICAgICAgICAgICAgICAgICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwiZGVsZXRlLWJ0blwiIGRhdGEtaWQ9XCInICsgZC5jb250YWN0SWQgKyAnXCI+5Yig6ZmkPC9hPiA8L3RkPiA8L3RyPidcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBsaXN0OiBsaXN0XHJcbiAgICB9XHJcbn0oKSk7XHJcbm1vZHVsZS5leHBvcnRzLkRvbSA9IERvbTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBBdXNlciBvbiAyMDE2LzEyLzIuXHJcbiAqL1xyXG5cInVzZSBzdHJpY3RcIjtcclxucmVxdWlyZSgnLi4vZ2VuZXJhbCcpLnJ1bigpO1xyXG5cclxucmVxdWlyZSgnLi9saXN0ZW5lcicpLnJ1bigpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEplcmVteSBvbiAyMDE2LzExLzIyLlxyXG4gKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciB1cmwgPSByZXF1aXJlKCcuLi9mcmFtZS9mdW5jdGlvbicpLnVybDtcclxudmFyIE1vZGFsID0gcmVxdWlyZSgnLi4vZnJhbWUvbW9kYWwnKTtcclxudmFyIERhdGEgPSByZXF1aXJlKCcuL2RhdGEnKS5EYXRhXHJcbiAgICAsIERvbSA9IHJlcXVpcmUoJy4vZG9tJykuRG9tO1xyXG52YXIgTGlzdGVuZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2VhcmNoLWJ0bicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdXJsLnNldCgnb2Zmc2V0JywgMCk7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRiLWMnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGUgPSAkKCcjJyArICQodGhpcykuZGF0YSgndGFyJykpO1xyXG4gICAgICAgICAgICB1cmwuc2V0KCdvZmZzZXQnLCAwKTtcclxuICAgICAgICAgICAgdXJsLnNldCgndGInLCAkKHRoaXMpLmRhdGEoJ3RhcicpKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQodGhpcykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIGVsZS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIGVsZS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZGVsZXRlLWJ0bicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcuZGVsZXRlLXBhcnQnKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcjZGVsZXRlLWVuc3VyZScpLmRhdGEoJ2lkJywgJCh0aGlzKS5kYXRhKCdpZCcpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNsb3NlLWJ0bicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5hZGRDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICAkKCcuYWxlcnQtcGFydCcpLmFkZENsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy50aWNrZXQtbW9kYWwnKS5maW5kKCdpbnB1dCcpLnZhbCgnJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5hZGQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoJy5zLXJlcXVpcmUnKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICB2YXIgZWxlID0gJCgnLnRpY2tldC1tb2RhbCcpO1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJCh0aGlzKS5kYXRhKCdubScpICsgJzxzcGFuIGNsYXNzPVwiY2xvc2UtYnRuXCI+WDwvc3Bhbj4nO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmhlYWRlcicpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgJCgnLndoaXRlLWJhY2snKS5yZW1vdmVDbGFzcygnZHAtbicpO1xyXG4gICAgICAgICAgICBlbGUucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgJCgnI3N1Ym1pdCcpLmRhdGEoJ2lkJywgMClcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNob3ctZGV0YWlsJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcucy1yZXF1aXJlJykucmVtb3ZlQ2xhc3MoJ3dhcm0nKTtcclxuICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy50aWNrZXQtbW9kYWwnKTtcclxuICAgICAgICAgICAgdmFyIHN0ciA9ICQodGhpcykuZGF0YSgndHAnKSA9PSAncmVjZWl2ZScgPyAn5pS26LSn5Lq66K+m5oOFJyA6ICflj5HotKfkurror6bmg4UnO1xyXG4gICAgICAgICAgICBzdHIgKz0gJzxzcGFuIGNsYXNzPVwiY2xvc2UtYnRuXCI+WDwvc3Bhbj4nO1xyXG4gICAgICAgICAgICBlbGUuZmluZCgnLmhlYWRlcicpLmh0bWwoc3RyKTtcclxuICAgICAgICAgICAgdmFyIGQgPSAkKHRoaXMpLmRhdGEoJ2luZm8nKS5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICAkKCcjbmFtZScpLnZhbChkWzBdIHx8ICctJyk7XHJcbiAgICAgICAgICAgICQoJyNkeicpLnZhbChkWzFdIHx8ICctJyk7XHJcbiAgICAgICAgICAgICQoJyNwZXJzb24nKS52YWwoZFsyXSB8fCAnLScpO1xyXG4gICAgICAgICAgICAkKCcjZGgnKS52YWwoZFszXSB8fCAnLScpO1xyXG4gICAgICAgICAgICAkKCcjbWFpbCcpLnZhbChkWzRdIHx8ICctJyk7XHJcbiAgICAgICAgICAgICQoJyNjeicpLnZhbChkWzVdIHx8ICctJyk7XHJcbiAgICAgICAgICAgICQoJy53aGl0ZS1iYWNrJykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICAgICAgZWxlLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJyNzdWJtaXQnKS5kYXRhKCdpZCcsIGRbNl0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjc3VibWl0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdGIgPSB1cmwuZ2V0KCd0YicpIHx8ICdyZWNlaXZlJztcclxuICAgICAgICAgICAgdmFyIGlkID0gJCh0aGlzKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICB2YXIgcGFzcyA9IHRydWU7XHJcbiAgICAgICAgICAgICQoJy5zLXJlcXVpcmUnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnd2FybScpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCd3YXJtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHBhc3MpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGFjdElkXCI6IGlkID09IDAgPyBudWxsIDogaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWN0VHlwZVwiOiB0YiA9PSAncmVjZWl2ZScgPyAyIDogMSxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3RBbGlhc1wiOiAkKCcjbWMnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3ROYW1lXCI6ICQoJyNuYW1lJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWN0QWRkcmVzc1wiOiAkKCcjZHonKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3RQZXJzb25cIjogJCgnI3BlcnNvbicpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGFjdFRlbFwiOiAkKCcjZGgnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3RGYXhcIjogJCgnI2N6JykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWN0RW1haWxcIjogJCgnI21haWwnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICBcImNvbnRhY3RTdGF0ZVwiOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGFjdFJlbWFya3NcIjogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVEdFwiOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwibW9kaWZ5RHRcIjogbmV3IERhdGUoKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGlmIChpZCA9PSAwKSB7Ly/mlrDlop5cclxuICAgICAgICAgICAgICAgICAgICBEYXRhLmFkZChkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+aWsOWinuaIkOWKnycsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7Ly/kv67mlLlcclxuICAgICAgICAgICAgICAgICAgICBEYXRhLnVwZGF0ZShkYXRhLCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+S/ruaUueaIkOWKnycsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2RlbGV0ZS1lbnN1cmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIERhdGEuZGVsKHtsaXN0OiBbJCh0aGlzKS5kYXRhKCdpZCcpXX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KGpzb24ucmVzTXNnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoanNvbi5yZXNNc2cgfHwgJ+WIoOmZpOaIkOWKnycsIG51bGwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcucGFnZXMnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHVybC5zZXQoJ29mZnNldCcsICQodGhpcykuZGF0YSgnb2Zmc2V0JykpO1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRiID0gdXJsLmdldCgndGInKSB8fCAncmVjZWl2ZSc7XHJcbiAgICAgICAgdmFyIGxvYWQgPSAnPHRyIGNsYXNzPVwid3JvbmctbXNnXCI+PHRkIGNvbHNwYW49XCI5XCI+PGRpdiBjbGFzcz1cImxvYWRpbmctYm94XCI+PGRpdiBjbGFzcz1cInNwaW5uZXJcIj4gPGRpdiBjbGFzcz1cInJlY3QxXCI+PC9kaXY+IDxkaXYgY2xhc3M9XCJyZWN0MlwiPjwvZGl2PiA8ZGl2IGNsYXNzPVwicmVjdDNcIj48L2Rpdj48ZGl2IGNsYXNzPVwicmVjdDRcIj48L2Rpdj48ZGl2IGNsYXNzPVwicmVjdDVcIj48L2Rpdj4gPC9kaXY+PC9kaXY+PC90ZD48L3RyPic7XHJcbiAgICAgICAgJCgnIycgKyB0YikuZmluZCgndGJvZHknKS5odG1sKGxvYWQpO1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICB0cDogdGIgPT0gJ3NlbmQnID8gMSA6IDJcclxuICAgICAgICAgICAgLCBrZXk6IHRiID09ICdzZW5kJyA/ICQoJyNzLW5hbWUnKS52YWwoKSA6ICQoJyNyLW5hbWUnKS52YWwoKVxyXG4gICAgICAgICAgICAsIG9mZnNldDogdXJsLmdldCgnb2Zmc2V0JykgfHwgMFxyXG4gICAgICAgICAgICAsIGxpbWl0OiAyMFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgRGF0YS5saXN0KGRhdGEsIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgIERvbS5saXN0KGpzb24sICQoJyMnICsgdGIpLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgZXhjZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGV4Y2VsRGF0YSA9IFtdO1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcubXVsdGktYWRkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKCcud2hpdGUtYmFjaycpLnJlbW92ZUNsYXNzKCdkcC1uJyk7XHJcbiAgICAgICAgICAgICQoJy5iYXRjaC1wYXJ0JykucmVtb3ZlQ2xhc3MoJ2RwLW4nKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2hhbmdlJywgJyNtdWx0aS1idG4nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhcnIgPSBbJ3hscycsICd4bHN4J107XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXVxyXG4gICAgICAgICAgICAgICAgLCBzaXplID0gdGhpcy5maWxlc1swXS5zaXplXHJcbiAgICAgICAgICAgICAgICAsIG5hbWUgPSB0aGlzLmZpbGVzWzBdLm5hbWU7XHJcbiAgICAgICAgICAgIHZhciBuYSA9IG5hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgaWYgKGFyci5pbmRleE9mKG5hW25hLmxlbmd0aCAtIDFdKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2l6ZSA8IDUxMjAwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIERhdGEudXAoe1wiZmlsZVwiOiBuYW1lfSwgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAncmVzQ29kZScgaW4ganNvbiAmJiBqc29uLnJlc0NvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW4gPSBqc29uLnJlc0JvZHk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhLm9zc1VwbG9hZCh0b2tlbiwgZmlsZSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiAnc3RhdHVzJyBpbiBkYXRhICYmIGRhdGEuc3RhdHVzID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhLmV4Y2VsUmVhZGVyKHtmaWxlOiB0b2tlbi5LZXluYW1lfSwgZnVuY3Rpb24gKGV4Y2VsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhjZWwgJiYgJ3Jlc0JvZHknIGluIGV4Y2VsICYmIGV4Y2VsLnJlc0JvZHkgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YSA9IGV4Y2VsLnJlc0JvZHkgfHwgW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLmV4Y2VsLW5hbWUnKS5odG1sKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5zcXVhcmUnKS5odG1sKCd4bHMnKS5hZGRDbGFzcygnZXhjZWwtYWwnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoZXhjZWwucmVzTXNnIHx8ICfor7vlj5blpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aCqOS4iuS8oOeahOaWh+S7tui2hei/hzUwMEvvvIHor7fph43mlrDpgInmi6njgIInKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIE1vZGFsLnNldEFsZXJ0KCfmlofku7bmoLzlvI/mlK/mjIEueGxzLy54bHN4LycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNiYXRjaC1lbnN1cmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgXCJjb250YWN0c1wiOiBleGNlbERhdGEsXHJcbiAgICAgICAgICAgICAgICBcIm1lbWJlcklkXCI6IDAsXHJcbiAgICAgICAgICAgICAgICBcImNvbXBhbnlJZFwiOiAwLFxyXG4gICAgICAgICAgICAgICAgXCJSZXF1aXJlc1ZhbGlkYXRpb25Db250ZXh0XCI6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBcIkVycm9yTWVzc2FnZVwiOiBcInN0cmluZ1wiLFxyXG4gICAgICAgICAgICAgICAgXCJFcnJvck1lc3NhZ2VSZXNvdXJjZU5hbWVcIjogXCJzdHJpbmdcIixcclxuICAgICAgICAgICAgICAgIFwiRXJyb3JNZXNzYWdlUmVzb3VyY2VUeXBlXCI6IFwic3RyaW5nXCIsXHJcbiAgICAgICAgICAgICAgICBcIlR5cGVJZFwiOiB7fVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBEYXRhLm11bHRpQWRkKGRhdGEsIGZ1bmN0aW9uIChhZGQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhZGQgJiYgJ3Jlc0NvZGUnIGluIGFkZCAmJiBhZGQucmVzQ29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTW9kYWwuc2V0QWxlcnQoJ+aIkOWKn+WvvOWFpSAnICsgYWRkLnJlc0JvZHkuU3VjY2Vzc0NvdW50ICsgJyDmnaHorrDlvZXjgIInLCBudWxsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2RhbC5zZXRBbGVydChhZGQucmVzTXNnIHx8ICfkv53lrZjlpLHotKXvvIzor7fph43or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsaXN0ZW5lcigpO1xyXG4gICAgICAgIGluaXQoKTtcclxuICAgICAgICBleGNlbCgpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcnVuOiBydW5cclxuICAgIH1cclxufSgpKTtcclxubW9kdWxlLmV4cG9ydHMgPSBMaXN0ZW5lcjsiXX0=
